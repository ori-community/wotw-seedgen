# This file defines all the requirements a player has to fulfill in order to reach a given pickup on the map.
# The pickup names and locations are defined in loc_data.csv.

# All pickups are tied to an anchor, a point on the map. The requirements listed under a pickup are what you need to get from that anchor to that pickup. For more details on this visit https://docs.google.com/document/d/1XAiL4GbyYGr2_PobxWajrOPO9kQ5UOSf4KrbI1rsOBM/view?usp=sharing

# Special Syntax:
# Moki and above:
# BreakWall=x: A wall or corruption with x Health is broken
# BreakCrystal: An energy crystal is broken (In moki this will allow using Sword, Hammer or Bow, in gorlek additionally Shuriken or Grenade, in unsafe additionally Spear)
# Combat=x: An enemy has to be defeated. For a list of enemies visit https://docs.google.com/spreadsheets/d/1AE_ctym6WAwltGK-r6w58ARq0ym2MU4MzFiwg328kjM/view?usp=sharing
# Gorlek and above:
# ShurikenBreak=x: A wall with x Health is broken from behind using Shuriken
# SentryJump=x: Extends to Sentry=1, Sword OR Hammer
# SwordSJump=x: Extends to Sentry=1, Sword
# HammerSJump=x: Extends to Sentry=1, Hammer
# SentryBurn=x: Use x Sentries to melt ice or light lanterns
# RemoveKillPlane: Remove the kill plane at feeding grounds
# Unsafe:
# SentryBreak=x: A wall with x Health is broken from behind using Sentry
# HammerBreak: A wall with is broken from behind using Hammer
# SpearBreak: A wall with is broken from behind using one Spear
# LaunchSwap: Extends to Launch
# FlashSwap: Extends to Flash and having energy to use it
# SentrySwap=x: Extends to Sentry=x
# BlazeSwap=x: Extends to Blaze=x
# WaveDash: Extends to Dash, Regenerate and having energy to use it
# GrenadeJump: Extends to Grenade and having energy to use it
# GrenadeCancel: Extends to Grenade and having energy to use it
# BowCancel: Extends to Bow and having energy to use it
# HammerJump: Extends to Hammer, DoubleJump
# SwordJump: Extends to Sword, DoubleJump
# GrenadeRedirect=x: Extends to Grenade=x
# SentryRedirect=x: Extends to Sentry=x
# PauseHover: Use the pause menu to cancel falling speed
# GlideJump: Extends to Glide
# GlideHammerJump: Extends to Glide, Hammer
# SpearJump=x: Extends to Spear=x

# requirement macros. must go at the top of the file!

requirement DepthsLight:
  moki: UpperDepths.ForestsEyes OR Flash=1
  gorlek: Bow=3  # should be good, right?
  kii: BowCancel  # is this reasonable?
  # unsafe: Grenade=3  # probably enough

anchor HeaderStates:  # States you need to resolve by using the !!set command in headers and that you can't resolve through playing
  state SkipKwolok:  # Used to logically support skipping Kwolok's fight
    moki: Impossible
  state SkipMora1:  # Used to logically support skipping Mora's first combat phase
    moki: Impossible
  state SkipMora2:  # Used to logically support skipping Mora's second combat phase
    moki: Impossible

anchor Teleporters:  # teleporter access
  conn MidnightBurrows.Teleporter:
    moki: BurrowsTP, Bash, Keystone=2
    # okay, soooo: this TP frequently unlocks exactly 4 pickups (the vanilla keystones in that area)
    # It also makes a 4 keystone door available! Without the Keystone=2 line here, the seed generator
    # picks this path, unlocking 4 pickups, then immediately fills those with keystones and gets stuck
  conn MarshSpawn.Main:
    moki: MarshTP
  conn HowlsDen.Teleporter:
    moki: DenTP
  conn EastHollow.Teleporter:
    moki: HollowTP
  conn GladesTown.Teleporter:
    moki: GladesTP
  conn InnerWellspring.Teleporter:
    moki: WellspringTP
  conn WoodsEntry.Teleporter:
    moki: WestWoodsTP
  conn WoodsMain.Teleporter:
    moki: EastWoodsTP
  conn LowerReach.Teleporter:
    moki: ReachTP, Flap
  conn UpperDepths.Teleporter:
    moki: DepthsTP, Glide
  conn EastPools.Teleporter:
    moki: EastPoolsTP, Water
  conn WestPools.Teleporter:
    moki: WestPoolsTP, Water
  conn LowerWastes.WestTP:
    moki: WestWastesTP
  conn LowerWastes.EastTP:
    moki: EastWastesTP, Burrow
  conn UpperWastes.NorthTP:
    moki: OuterRuinsTP, Burrow
  conn WindtornRuins.RuinsTP:
    moki: InnerRuinsTP, Burrow, EastHollow.ForestsVoice, LowerReach.ForestsMemory, UpperDepths.ForestsEyes, WestPools.ForestsStrength
  conn WillowsEnd.InnerTP:
    moki: WillowTP, Burrow
  conn WillowsEnd.Upper:
    moki: ShriekTP, Burrow

anchor MarshSpawn.Main at -799, -4310:  # spawn location / inkwater well
  refill Full

  state NonGladesTeleporter: free
  state MarshSpawn.ToOpherBarrier:
    unsafe: HowlsDen.RainLifted  # https://youtu.be/2k1foADHu1E

  pickup MarshSpawn.FirstPickupEX: free
  pickup MarshSpawn.GrappleHC:
    moki: Grapple, DoubleJump OR Launch
    gorlek:
      Grapple, Dash OR Glide OR Sword OR Hammer  # An air combo is enough to get you from the ceiling plant into range of the lower hanging plant
      SentryJump=1, Launch, DoubleJump # sjump->launch up then either djump on the wall for a launch refresh or djump + weapon stall
      Bash, Grapple, HowlsDen.RainLifted OR Grenade=1
      Bash, Launch, Damage=10, HowlsDen.RainLifted OR Grenade=1
      Bash, Grenade=1, Launch, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer
      Bash, HowlsDen.RainLifted, Launch, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer
    kii:
      Grapple, Sentry=1 OR Shuriken=1 OR Flash=1
      Bash, Launch, HowlsDen.RainLifted OR Grenade=1
      HowlsDen.RainLifted, Launch, Sword  # pogo the mantis between launches
    unsafe:
      Launch  # Launching along the ceiling, starting above the LongSwimEX
      Grapple, Spear=1 OR Blaze=2
      HowlsDen.RainLifted, Bash, DoubleJump OR Glide   # Chain bash the mantis
      # Glitched:
      SwordSJump=2  # 1 grounded near full height, 1 aerial mid height, jump off left wall, swordfloat to pickup
      HammerSJump=2, Sentry=1 OR Shuriken=1 OR Damage=10 OR PauseHover  # 1 grounded near full height, 1 forward attack, 1 aerial mid height, jump off left wall, use hammer floats and extra to pickup
      Grapple, PauseHover OR GrenadeJump OR BlazeSwap=1
      HammerJump, DoubleJump, TripleJump  # Start with either a wjump hjump of a coyote frame one
      FlashSwap  # hehe
  pickup MarshSpawn.BridgeEX: # not a free pickup because you could break the log and softlock yourself
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=1  # Grenade bash straight up from below
    gorlek:
      HowlsDen.RainLifted, Bash  # jump the jumper
      Sword OR Hammer  # Long jump, upslash and neutral slashes are enough with both weapons
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Sentry=1 OR Flash=1
    unsafe: PauseHover OR FlashSwap

  conn Teleporters: free
  conn MarshSpawn.LeftSpawnSignpost: free
  conn MarshSpawn.OpherBarrier: free

# checkpoint at -1021, -4305
# checkpoint at -1068, -4274

anchor MarshSpawn.OpherBarrier at -681, -4309:  # in front of the wall blocking access to MarshPastOpher
  refill Checkpoint

  state MarshSpawn.ToOpherBarrier:
    moki: BreakWall=16
  state MarshSpawn.LogBroken: free

  pickup MarshSpawn.BridgeEX:  # paths that can't get to Main
    moki: Dash OR Glide
    gorlek:
      HowlsDen.RainLifted, Bash  # jump the jumper
      Sword # Long jump, upslash and neutral slashes are enough with both weapons
    kii, MarshSpawn.ToOpherBarrier:
      Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1

  conn MarshPastOpher.MillView:
    moki: MarshSpawn.ToOpherBarrier
  conn MarshSpawn.BrokenBridge:
    moki: MarshSpawn.LogBroken
  conn MarshSpawn.Main:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek:
      Hammer
      Sword, Dash
      SentryJump=1
    kii:
      HowlsDen.RainLifted, Bash
      Dash OR Sword OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

anchor MarshSpawn.BrokenBridge at -643, -4351:  # after dropping down the breaking bridge
  refill Checkpoint

  pickup MarshSpawn.ResilienceShard:
    moki: BreakWall=16
    unsafe: HowlsDen.RainLifted  # Lure mantis
  pickup MarshSpawn.ResilienceOre:
    moki: BreakWall=16, Water
    unsafe:
      HowlsDen.RainLifted, Water # Lure mantis
      Damage=40, HowlsDen.RainLifted OR BreakWall=16
      Damage=20, WaterDash, HowlsDen.RainLifted OR BreakWall=16
  pickup MarshSpawn.BashEC:
    moki: Bash OR Launch
    gorlek: SentryJump=1
    kii: HowlsDen.RainLifted, Sword, DoubleJump, TripleJump  # Pogo on the slime
    unsafe:
      DoubleJump, TripleJump  # https://youtu.be/DIIHU4JiAj4
      HowlsDen.RainLifted, DoubleJump, Sword  # Use pogo of the slime to jump to the ledge
      GrenadeJump  # precise grenade wall jump off of a microwall on the left
  pickup MarshSpawn.PreLupoEX: free
  pickup MarshSpawn.LupoMap:
    moki: SpiritLight=200

  conn MarshSpawn.CaveEntrance: free
  conn MarshSpawn.OpherBarrier:
    moki, MarshSpawn.LogBroken:
      DoubleJump OR Dash OR Launch
      Bash, HowlsDen.RainLifted OR Grenade=1
    gorlek, MarshSpawn.LogBroken:
      SentryJump=1
      Hammer, Glide
    kii, MarshSpawn.LogBroken:
      Hammer
      Sword, Glide OR HowlsDen.RainLifted OR Spear=1 OR Shuriken=1 OR Sentry=1 OR Flash=1  # pogo / Upslash then use energy weapon
    unsafe, MarshSpawn.LogBroken:
      Sentry=2  # not lenient enough for kii
      Grenade  # GrenadeJump=1

anchor MarshSpawn.CaveEntrance at -588, -4393:  # before the door blocking regen tree
  refill Checkpoint

  state MarshSpawn.KeystoneDoor:
    moki: Keystone=2
  state MarshSpawn.TokkBarrier:
    moki: BreakWall=16
    unsafe: HowlsDen.RainLifted  # https://youtu.be/bYN3rhRJUAc

  pickup MarshSpawn.LeverEC:
    moki:
      Grapple, DoubleJump, Bash
      Launch, Bash
      Grapple, Launch
      Bash, Grenade=1, DoubleJump
    gorlek:
      Grapple, Bash, Dash OR Glide  # both weapon float variants are rather awkward
      Bash, Grenade=1
      SentryJump=1, DoubleJump, TripleJump
      SentryJump=1, Bash
      Launch  # different ways to solve
    kii:
      Grapple, Bash, Hammer OR Shuriken=1 OR Sentry=2
      DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # start jumping from under the grappable plant
      Bash, DoubleJump, Dash, Hammer OR Shuriken=1  # start jumping from under the grappable plant then djump to grab the bashable plant
      HowlsDen.RainLifted, Bash  # Lure the mantis, then bash off him
      HowlsDen.RainLifted, DoubleJump, Sword  # Lure the mantis near the door then pogo to reach the wall. Upslash to reach the lever
    unsafe:
      SentryJump=1  # max height
      DoubleJump, TripleJump OR Hammer OR Spear=1
      DoubleJump, Dash, Sword  # coyote dash from under the grappable plant
      Grapple, Bash  # Swing the plant with Grapple

  conn MarshSpawn.RegenDoor:
    moki: MarshSpawn.KeystoneDoor
  conn MarshSpawn.BrokenBridge:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek:
      Dash OR SentryJump=1
      HowlsDen.RainLifted, Bash  # enemy that only spawns at daytime
    kii: Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash  # at night there's a slime that works too
      GlideJump OR GrenadeJump
  conn MarshSpawn.Cave:
    moki: MarshSpawn.TokkBarrier

anchor MarshSpawn.Cave at -707, -4419:  # At Tokk in the Cave
  refill Checkpoint
  refill Health=1

  state MarshSpawn.TokkBarrier:
    gorlek: ShurikenBreak=16
    unsafe: HammerBreak OR SpearBreak
  state MarshSpawn.CaveFight:
    moki: Combat=3xLizard  # at day there's two extra lizards

  quest MarshSpawn.CaveKS:
    moki:
      DoubleJump, Dash OR Grapple
      Bash, DoubleJump OR Dash OR Glide OR Grapple  # day and night both have a slime here
      Launch
      MarshSpawn.CaveFight
    gorlek: DoubleJump OR Bash OR Grapple  # basically the moki paths without assisting abilities
    kii:
      Sword  # Pogo on the slime and slash to the left
      Hammer  # upswing into leftswing
    unsafe: GlideJump OR GrenadeJump
  quest MarshSpawn.TokkKeystoneQuest:
    moki: MarshSpawn.CaveKS

  pickup MarshSpawn.LeftTokkEX:
    moki: BreakWall=10
  pickup MarshSpawn.FightRoomEX:
    moki: BreakWall=10

  conn Tokk: free  # this one is tokk anywhere'd
  conn MarshSpawn.CaveEntrance:
    moki: MarshSpawn.TokkBarrier
  conn MarshSpawn.PoolsBurrowsSignpost:
    moki:
      DoubleJump, Dash OR Grapple
      Bash, DoubleJump OR Dash
      Bash, Grenade=1, Glide OR Grapple
      Launch
      MarshSpawn.CaveFight, DoubleJump OR Dash
      MarshSpawn.CaveFight, Bash, Grenade=1
    gorlek:
      DoubleJump
      Bash, Grenade=1
      MarshSpawn.CaveFight, SentryJump=1  # makes other sentryjump paths unnecessary
      # weapon floats maybe too precise for gorlek
    kii:
      Sword  # Pogo on the slime and slash to the left, Upslash to reach the branch
      Hammer  # weapon floats
      Bash  # use slimes
      MarshSpawn.CaveFight, Shuriken=1 OR Flash=1 OR Sentry=1
      MarshSpawn.CaveFight, Glide, Spear=1
    unsafe:
      Dash  # dash ramp at the first slime to skip the arena
      MarshSpawn.CaveFight, Spear=1  # not lenient enough for kii
      GlideJump OR GrenadeJump

# checkpoint at -845, -4438

anchor MarshSpawn.BurrowFightArena at -959, -4406:  # at the right side of the BurrowFightArena
  refill Health=1

  state MarshSpawn.BurrowArena:  # opening the door to MarshSpawn.LifepactShard by fighting the bad guys
    moki: Regenerate, Damage=40, Combat=Hornbug+Bat+2xSandworm+2xLizard+3xSkeeto+SneezeSlug
    unsafe: Combat=Hornbug+Bat+2xSandworm+2xLizard+3xSkeeto+SneezeSlug

  pickup MarshSpawn.BurrowOre:
    moki:
      Burrow, DoubleJump, Bash, Dash OR Glide OR Grenade=1
      Burrow, Bash, Launch
    gorlek:
      Burrow, DoubleJump OR Dash OR Launch
      # could do a sentryjump into bashgrenade, but I heard that kind of thing is unwelcome ;P
    kii:
      Burrow, Glide OR Hammer OR Sword
      Burrow, Damage=10, Shuriken=1
      Burrow, Shuriken=2
      Burrow, Bash, Grenade=1  # bash the first slime past the arena to reach your grenade
    unsafe: Burrow, Bash  # Bash the first slug up and quickly burrow down and up to catch it midair

  conn MarshSpawn.LifepactLedge:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: Sword OR Hammer OR Damage=10
    kii: Bash OR Sentry=1 OR Flash=1 OR Shuriken=1 OR Spear=1 OR Blaze=1
    unsafe: free  # small edge on the very right of the spikes
      #Bow=1 OR Grenade=1 OR GrenadeCancel OR PauseHover OR GrenadeJump # Bow and Grenade for cancelling vertical momentum
  conn MarshSpawn.PoolsBurrowsSignpost:
    moki: Bash, DoubleJump OR Dash OR Launch OR Glide
    gorlek:
      Bash OR Launch
      Damage=10, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    kii: free
  conn MarshSpawn.LeftSpawnSignpost:
    moki:
      Water, Burrow, Bash, DoubleJump, Dash OR Glide
      Water, Burrow, Bash, Launch
    gorlek: Water, Burrow, DoubleJump OR Dash OR Launch
    kii:
      Burrow, Water, Sword OR Hammer OR Glide OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10
      Burrow, Damage=40
      Burrow, Damage=30, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Burrow, WaterDash, Damage=20, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Burrow, WaterDash, Damage=10, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR PauseHover OR BlazeSwap=1
      Burrow, Damage=20, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR PauseHover OR BlazeSwap=1  # burrow as you exit the sand to exit the water before the 2nd water tick
      Burrow, Water, PauseHover OR BlazeSwap=1

anchor MarshSpawn.LifepactLedge at -931, -4399:  # At the ledge in front of the door blocking Life Pact
  pickup MarshSpawn.LifepactShard:
    moki: MarshSpawn.BurrowArena

  conn MarshSpawn.BurrowFightArena:
    moki:
      DoubleJump, Dash OR Glide
      Dash, Glide
      Launch
    gorlek:
      DoubleJump OR Dash OR Damage=10
      SentryJump=1
    kii:
      Sword OR Hammer
      Glide, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Glide OR Shuriken=2 OR Sentry=2
  conn MarshSpawn.PoolsBurrowsSignpost:  # check for redundancies with BurrowFightArena
    moki: Bash, DoubleJump OR Dash OR Glide OR Launch
    gorlek:
      Bash
      Damage=10, Glide OR Sword OR Hammer
    kii: free

anchor MarshSpawn.PoolsBurrowsSignpost at -898, -4436:  # the waypoint between pools, burrows and marsh
  refill Checkpoint
  refill Energy=1:
    kii: BreakCrystal  # on the ground on the way to Burrows

  quest MarshSpawn.CaveKS: free

  pickup MarshSpawn.CaveOre:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek: SentryJump=1
    kii: Hammer OR Spear=1
    unsafe:
      Bash  # https://youtu.be/1Qo0KvCotvM
      Dash  # Dash ramp
      Sword OR Shuriken=1 OR Flash=1 OR Sentry=1 OR GlideJump OR BlazeSwap=1 OR GrenadeJump
  pickup MarshSpawn.BurrowsApproachLedgeEX:  # Make sure it's not redundant with MarshSpawn.PoolsBurrowsSignpost->MarshSpawn.BeforeBurrows->MarshSpawn.BurrowsApproachLedgeEX
    moki: Bash, DoubleJump
    gorlek: Bash, Dash OR Glide
    kii:
      Bash, Damage=10, Sword OR Hammer  # use upsalsh inbetween the two lanterns. Not mandatory but players will probably use it there.
      Bash, Damage=10, Shuriken=3 OR Sentry=3  # one before the first lantern, one inbetween the two lantern (not mandatory) and a final one with a bash glide
      Bash, Damage=20, Blaze=3 OR Flash=2  # disable Flash inbetween the two lanterns
      Bash, Spear=3, Damage=30  # two dboost before the first lantern (because spear momentum can screw you up) and one at the end with a bash glide
      Bash, Damage=40
    unsafe:
      DoubleJump, TripleJump  # more hardcore parkour

  conn MarshSpawn.BeforeBurrows:
    moki: Bash, DoubleJump OR Dash OR Launch
    gorlek:
      Bash, Glide
      Launch, Glide
      Launch, Damage=10, DoubleJump OR Dash OR Sword OR Hammer
      Launch, DoubleJump, TripleJump OR Dash OR Sword
      Launch, Dash, Sword
    kii:
      Launch, Damage=20
      Launch, DoubleJump, Shuriken=1
      Launch, Dash, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1  # energy stall harder if you bonk into the ceiling inbetween the bashable plant but that actually reset your launch
      Launch, Sword, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Damage=10, Sword OR Hammer  # use upsalsh inbetween the two lanterns. Not mandatory but players will probably use it there.
      Bash, Damage=10, Shuriken=3 OR Sentry=3  # one before the first lantern, one inbetween the two lantern (not mandatory) and a final one with a bash glide
      Bash, Damage=20, Blaze=3 OR Flash=2  # disable Flash inbetween the two lanterns
      Bash, Spear=3, Damage=30  # two dboost before the first lantern (because spear momentum can screw you up) and one at the end with a bash glide
      Bash, Damage=40
    unsafe:
      Bash, Sword OR Hammer
      Bash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10 OR PauseHover  # use a projectile to reach the first lantern
      Launch  # Enough ledges to regain launch
      DoubleJump, TripleJump  # hardcore parkour
      GrenadeJump, DoubleJump, Bash OR Glide OR Damage=10 OR PauseHover  # Triple Grenade Jump is possible but redundant
      GrenadeJump, Damage=30  # damage under the first lantern, damage on the spikes at the top, damage after the second lantern
      SwordSJump=1, Damage=20  # air sjump from below the first lantern, weapon stall to minimize damage
      HammerJump, Damage=10  # Use both of the microwalls near the first lantern, dboost in the spikes under the second lantern. Use a regular double jump + hammer at the end, because a hammer jump goes too high.
  conn MarshSpawn.Cave: free
  conn MarshSpawn.LifepactLedge:
    moki: Bash, DoubleJump OR Dash OR Launch
    gorlek:
      Bash, Damage=10, Glide OR Sword
      Launch, Damage=10
    kii:
      Damage=10, Damage=10, Damage=10, Combat=Slug, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # dboost in spikes before the bat, on the bat projectile and in the spikes before the slime
      Combat=Bat+Slug, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=3 OR Shuriken=3 OR Flash=3 OR Sentry=3
      Combat=Bat+Slug, Damage=10, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=10, DoubleJump OR Sword OR Hammer  # dboost on the bat's projectile
      Damage=10, Combat=Slug, Spear=3 OR Shuriken=3 OR Flash=3 OR Sentry=3  # dboost on bat's projectile
      Damage=10, Damage=10, Combat=Slug, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2  # dboost on bat's projectile then  in the spikes inbetween the slime and the bat
      Bash, Spear=3 OR Shuriken=3 OR Flash=3 OR Sentry=3
      Bash, Damage=10, Damage=10 OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe: free  # microledge at the spikes above the slime
  conn MarshSpawn.BurrowFightArena:  # check for redundancies with LifepactLedge
    gorlek: Bash, SentryJump=1

# checkpoint at -954, -4355
# checkpoint at -1004, -4497

anchor MarshSpawn.BeforeBurrows at -1006, -4497:  # On the island before the Burrows entry
  refill Checkpoint

  pickup MarshSpawn.CrusherSwimEX:
    moki: Water, WaterDash
    kii: WaterDash, Damage=20
    unsafe:
      Bash, Water OR Damage=10  # might be possible without damage if we catch the projectile right?
  pickup MarshSpawn.BurrowsApproachLedgeEX:  # Most Bash paths redundant with BeforeBurrows->PoolsBurrowsSignpost->BurrowsApproachLedgeEX
    moki: Launch
    gorlek: SentryJump=1, Damage=10, DoubleJump, TripleJump  # Land in the spikes under the pickup and triple jump to the left platform
    kii:
      Bash, Sword, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # climb the left wall, cross to the right wall with either a tentacle shot of full combo + energy weapon
      Bash, Glide, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1  # same as above but only upsmash and one horizontal attack
    unsafe:
      Bash
      SentryJump=1, Damage=10, DoubleJump  # Land in the spikes under the pickup and doublejump + upslash to reach the right platform. Hammer upslash is enough to reach the platform, sword upslash the ennemy to refresh your double jump
      GrenadeJump, DoubleJump

  conn MarshSpawn.BurrowsEntry:
    moki:
      Bash, DoubleJump, Dash OR Glide
      Water, WaterDash, Bash, Grenade=1
      Water, WaterDash, DoubleJump, Dash OR Glide
      Launch
    gorlek:
      Bash, DoubleJump
      Bash, Dash, Glide OR Sword OR Hammer
      Water, WaterDash, DoubleJump OR Dash OR SentryJump=1  # With sjump, weapon hover as well
      SentryJump=1, DoubleJump, TripleJump, Dash OR Glide
    kii:
      Bash, Dash OR Glide  # dash land on the right platform then wjump-*> dash in order to cross the final gap / glide bash the projectile then wait midair for the tenacle to appear again
      Bash, Damage=10, Grenade=1, Sword OR Hammer  # dboost in the spikes where the tentacle is then bashnade from the platform on the right
      WaterDash, Damage=20, Dash OR DoubleJump
      WaterDash, Damage=20, Bash, Grenade=1
    unsafe:
      SentryJump=1, DoubleJump, Damage=10  # Weapon hover and damage boost in the first spikes
      Bash  # https://youtu.be/LurSDmDxrVM
  conn MarshSpawn.PoolsBurrowsSignpost:
    moki:
      Bash, DoubleJump, Dash
      Launch, Bash
    gorlek:
      Bash, DoubleJump, TripleJump OR Glide OR Sword OR Hammer
    kii:
      Bash, DoubleJump  # Not an easy path but there is 3 different solutions
      Bash, Dash, Sword OR Hammer OR Sentry=1 OR Flash=1 OR Shuriken=1 OR Spear=1
      Launch, DoubleJump, TripleJump OR Dash OR Glide
      Launch, Damage=10, DoubleJump OR Dash OR Glide
      Launch, Damage=20
    unsafe:
      Launch # https://youtu.be/0BoD2MlGWwU
      Bash, Damage=20 OR Shuriken=2  # https://youtu.be/OgEGIH0fXCQ
      Bash, Damage=10, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      GrenadeJump, DoubleJump, TripleJump OR Bash

anchor MarshSpawn.BurrowsEntry at -937, -4494:  # At the bells puzzle
  refill Checkpoint

  state MarshSpawn.BurrowsOpen:
    moki:
      Bash, DoubleJump, Glide
      Bash, Launch
    gorlek:
      Bash, DoubleJump, Dash
      Bash, Glide
      Bash, Grenade=1 OR SentryJump=1  # do the first 4 notes then land and bashnade from under the left lantern
    kii:
      Bash, DoubleJump  # bashgliding
      Bash, Dash OR Sword  # bash upward on the right lantern to reach the left one
      Bash, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1 # do the first 4 notes then use the jumpad + stall to reach the left lantern
    unsafe: Bash  # fun
  state MarshSpawn.DamageTreeOpen:
    moki: Bash, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Bash

  quest MarshSpawn.TokkTabletQuest:
    moki: MidnightBurrows.TabletQI

  pickup MarshSpawn.DamageTree:
    moki: MarshSpawn.DamageTreeOpen
  pickup MarshSpawn.CrusherSwimEX:  # clean water paths with waterdash originate from MarshSpawn.BeforeBurrows
    kii: WaterDash, Damage=20

  conn Tokk: free
  conn MidnightBurrows.Teleporter:
    moki: MarshSpawn.BurrowsOpen
  conn MarshSpawn.BeforeBurrows:
    moki:
      Glide OR Launch
      DoubleJump, Dash
      Water, DoubleJump OR Dash
      Water, WaterDash
    gorlek:
      Sword
      Hammer, DoubleJump OR Dash
      Damage=10, DoubleJump OR Dash OR Hammer  # splash the water if needed
      Water, DoubleJump OR Dash OR Hammer OR Damage=10
    kii:
      Hammer OR Blaze=5 OR Sentry=3 OR Water OR Damage=20  # Possible with only one dboost in the water but the wall is annoying to climb
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free  # friendly spikes where the tentacles spawn into precise wjump on the final platform to avoid a dboost

# checkpoint at -1067, -4274

anchor MarshSpawn.LeftSpawnSignpost at -954, -4296:  # At the signpost above RockHC
  refill Checkpoint

  pickup MarshSpawn.RockHC: free
  pickup MarshSpawn.LongSwimEX:
    moki: Water
    unsafe:
      Damage=90  # dropping down the right drop-down and holding directions for x dboosts: down-right=2, right=3, down-right=1, right=1, up-right=2 and u can see ori again
      WaterDash, Damage=40  # dropping down the right drop-down and waterdashing in direction x times: down-right=1, right=2, down-right=1, right=1, up-right=2 and u can see ori again
      HowlsDen.RainLifted, WaterDash, Damage=35  # dboost on the Lizard before going into the water
  pickup MarshSpawn.BurrowOre:  # make sure its not redundant with MarshSpawn.LeftSpawnSignpost -> MarshSpawn.BurrowFightArena -> MarshSpawn.BurrowOre
    moki:
      Water, Burrow, Bash, DoubleJump OR Glide  # Bash for the exploding enemy
      Water, Burrow, Bash, Grenade=1, Dash
    gorlek: Water, Burrow, DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Damage=10
    kii:
      Water, Burrow, Shuriken=1  # No other energy weapons because they'll make the CorruptSlug explode and damage you
      Burrow, WaterDash, Damage=10, Shuriken=1
      Burrow, Damage=20, Shuriken=1 OR WaterDash  # 2 water dboost then avoid the spikes or 1 water dboost with wdash then land into the spikes
      Burrow, Damage=30
    unsafe:
      Burrow, Water, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1 OR PauseHover OR FlashSwap  # Precise burrow angle and then wjump off the platform with the CorruptSlug
      Burrow, Damage=20, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1 OR PauseHover OR FlashSwap
      Burrow, WaterDash, Damage=10, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1 OR PauseHover OR FlashSwap
  #pickup MarshSpawn.PoolsPathEX  # All paths are redundant with MarshSpawn.LeftSpawnSignpost -> MarshSpawn.PoolsPath -> MarshSpawn.PoolsPathEX so far

  conn MarshSpawn.Main: free
  conn MarshSpawn.PoolsPath:
    moki:
      DoubleJump, Bash, Glide
      Bash, Launch
    gorlek:
      Bash, DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Damage=10
      Bash, Glide, Damage=10, Sword OR Hammer  # While waiting for 3rd shot do two neutral slashes to stay in the air longer
      Launch, Damage=10, DoubleJump OR Dash  # dboost in the left spikes at the second turret then go under MarshSpawn.PoolsPathEX
      Launch, Glide, Damage=10, Sword OR Hammer  # dboost in the left spikes at the second turret then go under MarshSpawn.PoolsPathEX with glide + upslash
    kii:
      Launch, Damage=6, Glide OR Damage=10  #  land on first turret then launch upward. taking a turret shot for leniency
      Launch, DoubleJump OR Dash  # launch into the ceiling then djump/dash bellow the spike entrance. Land on the turret then land bellow MarshSpawn.PoolsPathEX
      Launch, Glide, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 # launch into the ceiling then glide bellow the spike entrance. Land on the turret then land bellow MarshSpawn.PoolsPathEX
      Bash, DoubleJump, Damage=10
      Bash, Damage=20, DoubleJump OR Glide
    unsafe:
      Bash, Damage=10  # https://youtu.be/UtHsEHXnWA0
      Launch  # https://youtu.be/ZHr718BCSaA
      DoubleJump, Deflector, Sword, Damage=10 OR TripleJump  # https://youtu.be/f-0Q8yuKV_g
      DoubleJump, TripleJump, Deflector, Hammer, Damage=10  # https://youtu.be/_Fz20Cd4WBU
      DoubleJump, HammerJump, Damage=6  # coyote hjump from the left, take a dboost on the 2nd turret projectile to avoid damage from spikes then coyote hjump from the turret
      FlashSwap
  conn MarshSpawn.BurrowFightArena:
    moki:
      Water, Burrow, DoubleJump OR Glide OR Launch
      Water, Burrow, Dash, Bash, Grenade=1
    gorlek: Water, Burrow, Dash OR Sword OR Hammer OR Damage=10
    kii:
      Water, Burrow, Bash OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # With bash, bash the slime upwards then bash it again midair
      Burrow, Damage=20, Bash OR DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR WaterDash  # 2 water dboost then avoid the spikes or 1 water dboost with wdash then land into the spikes
      Burrow, Damage=30
      Burrow, WaterDash, Damage=10, Bash OR DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR WaterDash
    unsafe:
      Burrow, Water, Bow=1 OR Grenade=1 OR Spear=1 OR PauseHover OR FlashSwap
      Burrow, Damage=20, Bow=1 OR Grenade=1 OR Spear=1 OR PauseHover OR FlashSwap
      Burrow, Damage=10, WaterDash, Bow=1 OR Grenade=1 OR Spear=1 OR PauseHover OR FlashSwap
      Burrow, Bash, Water OR Damage=20  # Bash the slug up and quickly burrow down and up to catch it midair
      Burrow, Bash, WaterDash, Damage=10  # Bash the slug up and quickly burrow down and up to catch it midair

anchor MarshSpawn.PoolsPath at -1070, -4275:  # Above the turrets at the left of spawn
  refill Checkpoint

  state PoolsApproach.WheelFreed:  # Make sure it's not redundant with going to PoolsApproach.OnTopOfWheel first
    moki: Water, WaterBreath, Bash
    gorlek: Water, Bash
    # something something waterdash? Unlikely, it looks like bash is hard required for the first wall and if you have bash then you don't need waterdash.

  pickup MarshSpawn.PoolsPathEX:
    moki:
      DoubleJump, Bash, Glide
      Bash, Launch
    gorlek:
      Launch
      Glide, Sword OR Hammer OR DoubleJump OR Dash OR Bash
      DoubleJump, TripleJump OR Dash
      Bash, DoubleJump, Sword OR Hammer OR Damage=10
    kii:
      DoubleJump, Sword
      DoubleJump, Hammer, Shuriken=1
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump OR Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2 OR Damage=20
    unsafe:
      Bash OR Dash OR Sword OR FlashSwap OR BlazeSwap=1 OR SentrySwap=1 OR PauseHover  # Use friendly spikes in front of turret
      DoubleJump OR Glide OR Hammer OR Shuriken=2 OR Sentry=2 OR Damage=10 # Use firendly spikes in front of turret then wjump on friendly spikes bellow the pickup. Shuriken path requires you to angle the shuriken forwards for quicker catching.

  conn PoolsApproach.OnTopOfWheel:
    moki, Water, WaterBreath OR WaterDash:  # since WheelFreed solves this on its own, the other paths don't have to work with a spinning wheel
      PoolsApproach.WheelFreed OR DoubleJump OR Launch
      Bash, Grenade=1
    gorlek, Water:
      PoolsApproach.WheelFreed OR DoubleJump OR Launch
      Bash, Grenade=1
      Hammer OR SwordSJump=1
    kii, Water: Spear=1
    unsafe:
      Water  # Precise wall jump where the tentacle is grabbing the wheel
      WaterDash, Damage=160
  conn MarshSpawn.LeftSpawnSignpost:
    moki:
      Water, WaterDash OR Launch
      Glide, Bash OR Launch
    gorlek:
      Launch, Damage=10
      Water, DoubleJump OR Bash
      Glide, Dash OR DoubleJump
      DoubleJump, Sword OR Dash
    kii:
      Launch
      WaterDash, Damage=10, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Bash OR TripleJump OR Hammer OR Sentry=2  # land on 2nd turret to make it easier
      Bash, Dash  # land on 2nd turret to make it easier
    unsafe:
      Bash
      DoubleJump, Shuriken=1 OR Blaze=2 OR Sentry=1  # blaze/sentry wjump under the last turret
      WaterDash, Damage=6  # dboost on a projectile of the 3rd turret while falling so you don't take damage from the water
      Dash  # Reset your dash on the ceiling

anchor MarshSpawn.RegenDoor at -573, -4393:  # left of regen tree
  state MarshSpawn.KeystoneDoor:
    moki: Keystone=2

  pickup MarshSpawn.RegenTree: free

  conn MarshSpawn.CaveEntrance:
    moki: MarshSpawn.KeystoneDoor
  conn MarshSpawn.HowlApproach:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
      WaterDash  # water always clean
    gorlek:
      Dash, Glide
      SentryJump=1
    kii: Dash OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Spear=1  # Can take a damage so not in kii
      PauseHover  # Pausefloat from the left platform
      GlideJump OR BlazeSwap=1

anchor MarshSpawn.HowlApproach at -500, -4395:  # right of regen tree
  refill Checkpoint

  state MarshSpawn.HowlBurnt: free

  pickup MarshSpawn.RegenTree: free
  pickup MarshSpawn.RecklessShard:
    moki: BreakWall=10
    unsafe: HowlsDen.RainLifted  # https://youtu.be/b31Zd5M4xDg

  conn MarshSpawn.RegenDoor:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek: SentryJump=1  # can do one of a good sjump, a good positioning, pressing left quickly after the sentryjump or spending an extra energy
    kii: Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # upslash to slash left to walljump up
    unsafe: Dash OR PauseHover OR BlazeSwap=1 OR GlideJump
  conn MarshSpawn.MokkTheBrave:
    moki: MarshSpawn.HowlBurnt

anchor MarshSpawn.MokkTheBrave at -376, -4413:  # Next to Mokk the Brave, but outside the bridge if Howl is still lurking

  state MarshSpawn.HowlBurnt: free

  quest MarshSpawn.MokkFangQuest:
    moki: MarshSpawn.HowlBurnt, MarshSpawn.FangQI

  pickup MarshSpawn.RecklessShard:  #Make sure it's not redundant with MarshSpawn.MokkTheBrave->MarshSpawn.HowlApproach->MarshSpawn.RecklessShard
    moki, MarshSpawn.HowlBurnt, BreakWall=10:
      Bash, Grenade=1
    gorlek, MarshSpawn.HowlBurnt, BreakWall=10:
      Dash OR SentryJump=1
      Glide, Sword OR Hammer
    kii, MarshSpawn.HowlBurnt, BreakWall=10:
      Sword
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, MarshSpawn.HowlBurnt:
      BreakWall=10, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR BlazeSwap=1 OR PauseHover
      HowlsDen.RainLifted, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR BlazeSwap=1 OR PauseHover  # https://youtu.be/b31Zd5M4xDg

  conn MarshSpawn.HowlsDenEntrance:
    moki: MarshSpawn.HowlBurnt
  conn MarshSpawn.HowlApproach:
    moki, MarshSpawn.HowlBurnt:
      DoubleJump OR Launch
      HowlsDen.RainLifted, Bash, Grenade=1
      Bash, Grenade=2
    gorlek, MarshSpawn.HowlBurnt:
      SentryJump=2
      Dash, Bash, HowlsDen.RainLifted OR Grenade=1  # Dash for first jump, bash off fronkey for second
    kii:
      Hammer  # upslash -> upslash
      HowlsDen.RainLifted, Sword  # upslash for the first gap, then pogo off the mantis for the second gap
      HowlsDen.RainLifted, Bash, Glide, Shuriken=1 OR Flash=1 OR Sentry=1  # hop to the first ledge and then bash the mantis
    unsafe, MarshSpawn.HowlBurnt:
      Sword  # upslash then downslash to reach the last platform
      HowlsDen.RainLifted, Bash  # Long distance lure for the first jump, simple lure for second
      Dash  # Dash ramp
      Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2  # https://youtu.be/v_1aLNaPJeE
      GrenadeJump
  conn MarshSpawn.AboveHowlArena:  #Vine/enemy only spawn once the rain is lifted. Not many paths without RainLifted because it is free from here and adding paths without is only related to the logic filter (for when we add showing states in it)
    moki:
      Launch
      HowlsDen.RainLifted, DoubleJump OR Bash
    gorlek:
      HowlsDen.RainLifted, Hammer, Dash
      SentryJump=1
      DoubleJump, TripleJump OR Dash
    kii:
      DoubleJump, Glide
      HowlsDen.RainLifted, Sword  # Pogo
      HowlsDen.RainLifted, Shuriken=1, Hammer OR Spear=1
    unsafe:
      HowlsDen.RainLifted, Dash OR Glide OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR BlazeSwap=1 # https://youtu.be/txogGlFUCwU
      GrenadeJump

anchor MarshSpawn.AboveHowlArena at -298, -4388:  # Ledge after the vine on the way to the fang
  refill Checkpoint
  refill Health=1

  pickup MarshSpawn.FangEC:
    moki:
      DoubleJump, Dash  # Stick to the ceiling
      Launch
    gorlek: DoubleJump, TripleJump
    unsafe:
      DoubleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR GlideJump  # djump then second movement option to reach the first wall in the ceiling. Then djump from one side of the wall to the other before going to the next wall with djump
      WaveDash  # Wavedash on the health plant and regen jump
      Dash, BlazeSwap=1 OR SentrySwap=1  # coyote dash on last suspended platform then swap to the right side of the wooden wall under the EC
      BlazeSwap=2 OR SentrySwap=2
      HowlsDen.RainLifted, Bash, Glide, Dash  # use the enemy for everything

  conn MarshSpawn.MokkTheBrave: free
  conn MarshSpawn.FangPlatform:
    moki:
      Launch OR DoubleJump OR Dash
      Bash, Grenade=1
    gorlek: Glide OR Sword OR Hammer OR Damage=10  # Dboost the last gap
    kii: Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Spear=1 OR BlazeSwap=1 OR GrenadeJump OR GlideJump OR PauseHover OR FlashSwap

anchor MarshSpawn.FangPlatform at -218, -4406:  # Next to Howl's Fang
  refill Health=1

  quest MarshSpawn.FangQI: free

  pickup MarshSpawn.FangEC:  #Make sure it's not redundant with MarshSpawn.FangPlatform->MarshSpawn.AboveHowlArena->MarshSpawn.FangEC
    gorlek:
      SentryJump=1
      Bash, Grenade=1
    unsafe:
      HammerJump OR FlashSwap OR BlazeSwap=2 OR SentrySwap=2
      GrenadeJump, DoubleJump OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1

  conn MarshSpawn.AboveHowlArena:
    moki:
      DoubleJump OR Launch
    gorlek:
      Dash
      Glide, Damage=10 OR Sword OR Hammer  # upslash to get on first suspended platform then dboost in the spikes before the checkpoint
      SentryJump=1, Damage=10
    kii:
      Sword, Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10
      Hammer, Spear=1 OR Flash=1 OR Sentry=1 OR Damage=10  # energy weapon to reach right suspended platform (no shuriken because it can push back the platform). Jump in the spikes to reach the left suspended platform without going on the right one
      Damage=10, Damage=10, Damage=10, Damage=20
      Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1:  # energy weapon to avoid 1st dboost
        Damage=10, Damage=10, Damage=20
      Damage=10, Shuriken=1, Damage=10, Shuriken=1, Damage=10  # avoid 2nd dboost and then takes only one tick of damage after the suspended platform
      Damage=10, Flash=1, Damage=10, Flash=1, Damage=10  # same as above
      Damage=10, Sentry=1, Damage=10, Sentry=1, Damage=10  # same as above
      Shuriken=2, Damage=10, Shuriken=1, Damage=10  # avoid 1st and 2nd dboost then takes only one tick of damage after the suspended platform
      Flash=2, Damage=10, Flash=1, Damage=10  # same as above
      Sentry=2, Damage=10, Sentry=1, Damage=10  # same as above
      Sentry=5, Damage=10  # avoid all dboost, energy weapon to get on the right suspended platform then another one to reach the left platform. Final energy usage to only take one tick of damages in spikes
      Flash=5, Damage=10  # same as above
      # No shuriken variant because if it hits a suspended patform, it get pushed back
    unsafe:
      Sword  # upslash then downslash for the last jump
      Hammer
      Shuriken=3 OR Flash=3 OR Sentry=3  #  https://youtu.be/U2khlKTXVzA  The shuriken variant might be a ceiling jump?
      Damage=10, Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=10, Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=10, Spear=1, Damage=10
      Damage=10, Damage=10, Damage=10  # microledge under the left suspended platform to use regen before the 2nd dboost

anchor MarshSpawn.HowlsDenEntrance at -429, -4420:  # Next to MarshSpawn.MokkEX
  pickup MarshSpawn.MokkEX: free

  # There isn't any point to go to HowlsDen.UpperLoopExit from this anchor because it only leads to HowlsDen.RightHC, which is more restricitive than going from UpperLoopEntrance
  conn HowlsDen.AboveBoneBridge: free
  conn MarshSpawn.MokkTheBrave:
    moki, MarshSpawn.HowlBurnt: DoubleJump OR Dash OR Launch OR Glide
    gorlek, MarshSpawn.HowlBurnt: Sword OR Hammer
    kii, MarshSpawn.HowlBurnt: Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # blaze start from the upper platform, the other one from the lower platform
    unsafe: MarshSpawn.HowlBurnt  # precise wjump above the spikes from the lower platform

anchor HowlsDen.UpperLoopExit at -401, -4433:  # Right of the bone door where you exit the loop with right hc
  refill Checkpoint:
    moki: HowlsDen.UpperLoopExitBarrier
  refill Health=1

  state HowlsDen.UpperLoopExitBarrier:
    moki: BreakWall=16

  pickup HowlsDen.RightHC:
    moki: BreakWall=20, Combat=Slug OR Bash OR Launch
    gorlek: BreakWall=20

  conn MarshSpawn.HowlsDenEntrance:  # Make sure it's not redundant with paths doing HowlsDen.UpperLoopExit->HowlsDen.AboveBoneBridge->MarshSpawn.HowlsDenEntrance
    moki: HowlsDen.UpperLoopExitBarrier, DoubleJump OR Dash
    gorlek: HowlsDen.UpperLoopExitBarrier, Glide OR Sword
    kii: HowlsDen.UpperLoopExitBarrier, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: HowlsDen.UpperLoopExitBarrier  # tight jump
  conn HowlsDen.AboveBoneBridge:
    moki: HowlsDen.UpperLoopExitBarrier

anchor HowlsDen.AboveBoneBridge at -446, -4436:  # After the climb up through the keydoor
  refill Checkpoint

  conn HowlsDen.UpperLoopEntrance: free
  conn MarshSpawn.HowlsDenEntrance:
    moki: Launch
    gorlek:
      DoubleJump, TripleJump
      Bash, Grenade=1
    kii: Bash
    unsafe:  # anything using sword/hammer is redundant with going through the upperloop with just sword or hammer
      DoubleJump, Dash OR GlideJump
      SentrySwap=1 OR BlazeSwap=1 OR FlashSwap
  conn HowlsDen.MidwayBottomLoop:
    gorlek: ShurikenBreak=16
    unsafe: HammerBreak OR SpearBreak OR SentryBreak=16

anchor HowlsDen.UpperLoopEntrance at -407, -4451:  # In front of the bone door blocking the loop with the right hc
  refill Checkpoint:
    moki: HowlsDen.UpperLoopEntranceBarrier
    unsafe: BreakWall=12  # checkpoint accessible by damaging the wall without fully breaking it

  state HowlsDen.UpperLoopEntranceBarrier:
    moki: BreakWall=16

  pickup HowlsDen.RightHC:
    moki: HowlsDen.UpperLoopEntranceBarrier, BreakWall=20, Combat=Slug OR Bash OR Launch
    gorlek: HowlsDen.UpperLoopEntranceBarrier, BreakWall=20

  conn HowlsDen.BoneBridge: free
  conn HowlsDen.AboveBoneBridge:
    moki:
      Launch
      Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump
    unsafe:  # If you use sword/hammer, you can take the normal path
      DoubleJump  # wall jump on the small wall between the breakable wall and the spikes
  conn HowlsDen.UpperLoopExit:
    moki:
      HowlsDen.UpperLoopEntranceBarrier, Combat=Slug, DoubleJump OR Dash
      HowlsDen.UpperLoopEntranceBarrier, Bash, DoubleJump OR Dash
    gorlek:
      HowlsDen.UpperLoopEntranceBarrier, DoubleJump OR Dash
      HowlsDen.UpperLoopEntranceBarrier, Glide, Combat=Slug OR Bash
      HowlsDen.UpperLoopEntranceBarrier, Sword OR HammerSJump=1
    kii:
      HowlsDen.UpperLoopEntranceBarrier, Hammer OR Glide OR Bash OR Shuriken=1 OR Sentry=1 OR Flash=1
      HowlsDen.UpperLoopEntranceBarrier, WaterDash, Water OR Damage=10
    unsafe: HowlsDen.UpperLoopEntranceBarrier, Spear=1 OR BlazeSwap=1

anchor HowlsDen.BoneBridge at -371, -4468:  # After the long drop into Howl's Den
  refill Checkpoint

  state HowlsDen.KeystoneDoor:
    moki: Keystone=2
  state HowlsDen.RainLifted:
    moki: HowlsDen.SwordTree
  state HowlsDen.BoneBarrier:  # the barrier blocking the lowest part of Howl's Den
    moki: BreakWall=16

  quest HowlsDen.SwordTree: free

  pickup HowlsDen.BoneOre:
    moki:
      Hammer
      Combat=Mantis+Slug, Spear=1  # spear likes to target the enemies around
  pickup HowlsDen.AboveDoorKS:
    moki: DoubleJump OR Launch
    gorlek:
      Dash
      Bash, Damage=10  # Bash off the fronkey or slime to get to the unstable platform wall jump for the other two jumps
      SentryJump=1  # SentryJump onto the unstable platform, hammer/sword stall to left wall, wall jump to pickup
    kii:
      Sword OR Hammer OR Flash=3 OR Sentry=3  # Shuriken not in kii because throwing it into the platform can push it back
      Flash=2 OR Sentry=2:
        Damage=10
    unsafe:
      Bash
      Shuriken=2 OR Flash=2 OR Sentry=2  # https://youtu.be/ESDKKCgALVc
      Shuriken=1 OR Flash=1 OR Sentry=1:
        Damage=10
      GrenadeJump  # Grenade jump onto the unstable platform then grenade jump to the pickup (requires some horizontal drifting)
  pickup HowlsDen.MagnetShard:  # Can use the barrier near Sword tree because if it got broken you can just go the long way around for free
    moki: BreakWall=10, BreakWall=16 OR Launch
    kii: BreakWall=10, Bash, Grenade=1
    unsafe: BreakWall=10, DoubleJump
  pickup HowlsDen.AboveTPEX:
    moki: HowlsDen.BoneBarrier, BreakWall=10

  conn HowlsDen.UpperLoopEntrance:
    gorlek:
      Launch
      Bash, Grenade=1, DoubleJump, TripleJump
    unsafe:
      DoubleJump, Sword OR TripleJump  # Door skip
      Bash, DoubleJump  # bash chain
      GrenadeJump, DoubleJump
      SentryJump=2  # Sword sjump can go up to HowlsDen.AboveBoneBridge but landing here and doing the loop also solves the connection to AboveBoneBridge
      HammerSJump=1, DoubleJump
  conn HowlsDen.AboveBoneBridge:  # Paths that can reach HowlsDen.AboveBoneBridge but can't do HowlsDen.BoneBridge->HowlsDen.UpperLoopEntrance->HowlsDen.AboveBoneBridge
    unsafe:
      HowlsDen.RainLifted, Bash, Glide  # Bash chain
      HowlsDen.RainLifted, Bash, Grapple, GrenadeCancel OR Grenade=1  # Zoomie off the mantis
  conn HowlsDen.BoneBridgeDoor:
    moki: HowlsDen.KeystoneDoor
  conn HowlsDen.AboveTeleporter:
    moki: HowlsDen.BoneBarrier

anchor HowlsDen.BoneBridgeDoor at -466, -4490:  # checkpoint once you opened the door skip door
  refill Checkpoint

  state HowlsDen.KeystoneDoor:
    moki: Keystone=2

  conn HowlsDen.BoneBridge:
    moki: HowlsDen.KeystoneDoor
  conn HowlsDen.OutsideSecretRoom:
    moki: Water OR Launch OR DoubleJump OR Dash OR Glide
    gorlek: Sword OR Hammer OR Damage=10
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free  # you don't take water damage if you land on the very left of the pound

anchor HowlsDen.OutsideSecretRoom at -495, -4481:  # in front of the breakable wall behind the keystone door
  state HowlsDen.SecretRoomWall:
    moki: BreakWall=20

  conn HowlsDen.SecretRoom:
    moki: HowlsDen.SecretRoomWall
  conn HowlsDen.BoneBridgeDoor:
    moki: Water OR Launch OR DoubleJump OR Dash OR Glide
    gorlek: Sword OR Hammer OR Damage=10
    kii:
      Bash, Grenade=1
      Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Blaze=1 OR PauseHover OR Bow=1 OR Grenade=1 OR GrenadeCancel
  conn HowlsDen.MidwayBottomLoop:
    moki:
      Launch
      Combat=Slug, DoubleJump
      Bash, Grenade=1, Grenade=1 OR Dash OR Glide
    gorlek:
      Dash OR Glide OR Sword
      Bash, Grenade=1, Damage=10
      Water, WaterDash, Bash, Grenade=1
      Water, WaterDash, Damage=10
      HammerSJump=1, HammerSJump=1 OR Damage=10
      Water, WaterDash, HammerSJump=1
    kii:
      Hammer
      Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
      Sentry=3  # two sentries in the air to avoid spikes
      WaterDash, Damage=10, Damage=10
      HowlsDen.RainLifted, Bash, Grenade=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Slime only spawn when the rain is lifted
      HowlsDen.RainLifted, WaterDash, Bash, Water OR Damage=10
    unsafe:
      Sentry=1, SentrySwap=1
      Damage=10, Spear=1 OR BlazeSwap=1  # https://youtu.be/Y5nvYJbEtZg
      BlazeSwap=2 OR PauseHover

anchor HowlsDen.MidwayBottomLoop at -492, -4459:  # At the Health refill behind the door
  refill Health=1

  conn HowlsDen.OutsideSecretRoom: free
  conn HowlsDen.AboveBoneBridge:
    moki:
      BreakWall=16, Launch
      BreakWall=16, DoubleJump, Combat=Slug OR Bash
      BreakWall=16, Dash, Combat=Slug OR Bash
      BreakWall=16, Bash, Grenade=1, Glide
    gorlek:
      BreakWall=16, DoubleJump OR Dash
      BreakWall=16, Bash, Grenade=1, Sword OR Hammer OR Damage=10
      SentryJump=1  # weapon breaks the wall
    kii:
      Hammer
      Sword, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # The last chunck of spikes can repulse sword movement
      BreakWall=16, Shuriken=2 OR Flash=2 OR Sentry=2  # bashnade paths are requires the same amount of energy as those
      BreakWall=16, Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Sword
      BreakWall=16, Spear=1, Spear=1 OR Damage=10  # https://youtu.be/Y5nvYJbEtZg
      Bash, Grenade=1, BreakWall=16  # https://youtu.be/e9edNsLqE9Y

anchor HowlsDen.SecretRoom at -515, -4479:  # The hidden room holding left hc
  refill Checkpoint

  state HowlsDen.SecretRoomWall:  # No paths outside of unsafe because of how weird breaking that wall is
    unsafe: BreakWall=20, Sword OR Hammer OR Bow OR Spear OR Shuriken OR Sentry  # also works with fractured grenade, but not regular grenade

  conn HowlsDen.LeftSecretRoom:
    moki:
      DoubleJump OR Dash OR Launch
      Water, WaterDash
    gorlek:
      Glide  # hold glide before jumping from the moss
      Damage=10, Sword OR Hammer
    kii:
      Sword OR Hammer
      WaterDash, Damage=10
      Shuriken=1 OR Flash=1 OR Sentry=1:  # If you jump at the very edge of the blue moss, you'll hit the spikes
        Damage=10
    unsafe: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10 OR PauseHover
  conn HowlsDen.OutsideSecretRoom:
    moki: HowlsDen.SecretRoomWall

anchor HowlsDen.LeftSecretRoom at -565, -4470:  # Top of the elbow after the moss in the hidden room holding HowlsDen.LeftHC
  pickup HowlsDen.LeftHC:
    moki:
      Combat=SneezeSlug, DoubleJump OR Dash OR Glide
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek: DoubleJump OR Dash OR Sword OR Hammer
    kii:
      Glide OR Sword OR Hammer OR Spear=3 OR Shuriken=3 OR Flash=3 OR Sentry=3
      Damage=10, Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      Damage=10, Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Shuriken=2 OR Flash=2 OR Sentry=2  # Bash the slug to reach the suspended platform. No Spear because it one shot the slug in easy
      Bash, Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10
    unsafe:
      Bash  # https://youtu.be/EJ9tExwpRjA
      Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2 OR PauseHover OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap OR GrenadeJump
      Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

  conn HowlsDen.SecretRoom:
    moki:
      Launch
      DoubleJump, Bash OR Combat=SneezeSlug
      Bash, Grenade=1, Dash OR Glide
    gorlek:
      DoubleJump OR SentryJump=1
      Bash, Grenade=1, Sword OR Hammer OR Damage=10
      Dash, Hammer  # upslash-> hammer to reach the slime's platform
    kii:
      Bash, Sword OR Glide OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10  # Bash the slug to reach the suspended platform then bash a slug's projectile
      # Paths going back to the moss
      Dash OR Hammer
      Sword, Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Sword, Water, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Sword, Damage=10, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # hover with sword to avoid the most water ticks possible
    unsafe:
      Bash OR Sword
      Spear=1, Water OR Grapple OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # https://youtu.be/QYShpOZYmZQ
      Damage=20, Spear=1
      Damage=10, Spear=1, WaterDash OR Glide

# checkpoint at -476, -4441

anchor HowlsDen.AboveTeleporter at -348, -4497:  # After dropping down from the Sword Tree area and destroying the bone barrier
  state HowlsDen.BoneBarrier:
    gorlek: ShurikenBreak=16
    unsafe: SentryBreak=16 OR HammerBreak OR SpearBreak

  pickup HowlsDen.AboveTPEX:
    moki: BreakWall=10
    unsafe: HowlsDen.RainLifted

  conn HowlsDen.Teleporter: free
  conn HowlsDen.BoneBridge:
    moki: HowlsDen.BoneBarrier, Combat=Slug OR DoubleJump OR Bash OR Launch
    kii: HowlsDen.BoneBarrier  # use the left wall, which you can't wjump sometimes

anchor HowlsDen.Teleporter at -328, -4536:  # At the teleporter
  refill Full

  state NonGladesTeleporter: free

  pickup HowlsDen.LaserKS:  # The Lizard at the lever only spawns when you get DoubleJump
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek:
      Dash OR SentryJump=1
    kii:
      Hammer OR Bash OR Shuriken=1
      Glide, Flash=1 OR Sentry=1
      Sword, Flash=1 OR Sentry=1
    unsafe:
      Sword OR GrenadeJump OR GlideJump
      Glide, Spear=1

  conn Teleporters: free
  conn DenShrine:
    moki: Hammer OR Spear=1
  conn HowlsDen.DoubleJumpApproach:  # Don't use the rock, since it can fall in the pit towards the ks
    moki:
      DoubleJump OR Launch
      Glide, Dash
      Bash, Grenade=1
    gorlek: Hammer OR SwordSJump=1
    kii:
      Sword OR Dash OR Spear=1
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: free
  conn HowlsDen.AboveTeleporter:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek: Bash OR SentryJump=1
    kii:
      Sword OR Hammer  # pogo on the slime for sword, upslash for hammer
      Dash, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Spear=1 OR Dash OR GrenadeJump OR SentrySwap=1 OR BlazeSwap=1 OR FlashSwap OR GlideJump

anchor HowlsDen.DoubleJumpApproach at -436, -4528:  # Checkpoint inbetween the teleporter and the tree
  refill Checkpoint

  state HowlsDen.DoubleJumpTreeCombat:  # the game puts this before regen. It's why all the enemies drop tons of health
    moki: Combat=Mantis+2xLizard+SmallSkeeto  # The SmallSkeeto spawns in this arena if the player has Bash.

  pickup HowlsDen.DoubleJumpEX:  # paths going through the fight arena; other paths originate from DoubleJumpTreeLedge
    moki: HowlsDen.DoubleJumpTreeCombat

  conn HowlsDen.DoubleJumpTreeLedge:
    moki: HowlsDen.DoubleJumpTreeCombat OR DoubleJump OR Dash OR Glide OR Launch
    gorlek: Sword OR Hammer
    kii:
      Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2
      Bash, Grenade=1
    unsafe:
      Bash OR SpearJump=1 OR GrenadeJump OR BlazeSwap=1
  conn HowlsDen.Teleporter: free

anchor HowlsDen.DoubleJumpTreeLedge at -514, -4549:  # To the right of the Double Jump Tree
  refill Checkpoint

  pickup HowlsDen.DoubleJumpEX:  # Exploding enemy only spawn once you have Bash
    moki: Launch
    gorlek: SentryJump=1
    kii:
      Bash  # The exploding enemy won't spawn if you respawned at the anchor, but then you can use the lizard instead
    unsafe:
      DoubleJump, TripleJump  # Triple jump from the right wall
      SwordJump OR GrenadeJump OR HammerJump

  conn HowlsDen.DoubleJumpTreeArea: free
  conn HowlsDen.DoubleJumpApproach:
    moki: DoubleJump OR Launch OR Dash OR Glide
    gorlek: Sword OR Hammer
    kii: Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1 OR Blaze=1
    unsafe: free

anchor HowlsDen.DoubleJumpTreeArea at -555, -4552:  # At the Double Jump Tree
  state HowlsDen.BoneBarrier:
    unsafe: free  # Getting djump tree remove this barrier
  state MidnightBurrows.HowlsDenShortcut:
    unsafe: ShurikenBreak=10

  pickup HowlsDen.DoubleJumpTree: free
  pickup HowlsDen.StickyShard: free  # origlow
  pickup HowlsDen.DoubleJumpEX:
    kii: Dash, DoubleJump, TripleJump  # From Sticky shard. Reset your dash onto the ceiling

  conn HowlsDen.DoubleJumpTreeLedge:
    moki:
      DoubleJump OR Glide OR Launch
      Bash, Grenade=1
    gorlek: SentryJump=1
    kii:
      Bash OR Sword OR Dash OR Sentry=3
      Hammer, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1 OR Blaze=1
    unsafe: Hammer OR Shuriken=2 OR Blaze=4 OR Sentry=2 OR SpearJump=1 OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
  conn MidnightBurrows.DenConnection:
    moki: MidnightBurrows.HowlsDenShortcut

anchor DenShrine at -328, -4569:
  nospawn
  refill Full

  state HowlsDen.CombatShrineCompleted:
    moki, Regenerate, Combat=Mantis+2xLizard+4xEnergyRefill+2xSneezeSlug+Mantis+Skeeto+4xEnergyRefill+7xSmallSkeeto+2xSkeeto+4xEnergyRefill+2xLizard+2xMantis:
      Damage=60
      Damage=40, Dash OR Bash OR Launch  # much better if you have good evasion
    unsafe: Combat=Mantis+2xLizard+4xEnergyRefill+2xSneezeSlug+Mantis+Skeeto+4xEnergyRefill+7xSmallSkeeto+2xSkeeto+4xEnergyRefill+2xLizard+2xMantis

  pickup HowlsDen.CombatShrine:
    moki: HowlsDen.CombatShrineCompleted

# checkpoint at -682, -4309

anchor MarshPastOpher.MillView at -596, -4293:  # Standing next to Opher, looking at the Millstone
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal  # to the left

  state MarshSpawn.ToOpherBarrier:
    gorlek: ShurikenBreak=16
    unsafe: HammerBreak OR SpearBreak

  conn OpherShop: free
  conn MarshPastOpher.TrialStart: free
  conn MarshSpawn.OpherBarrier:
    moki: MarshSpawn.ToOpherBarrier
  conn MarshPastOpher.OpherSkipBranch:  # Check for redundancy with
  # the enemies appear once you have water
    gorlek:
      Launch, Bash, Water OR Grenade=1
      Launch, DoubleJump
    kii:
      Bash, Launch, Water OR Grenade=1
      DoubleJump, TripleJump, Bash, Grenade=1, Water OR Grenade=1
    unsafe:
      Water, Bash  # https://youtu.be/9LEokEz5GtA
      DoubleJump, TripleJump, Damage=10
      SwordJump, Damage=20
      HammerJump, DoubleJump
      SentryJump=2  # first one maxheight

anchor MarshPastOpher.OpherSkipBranch at -643, -4270:  # Branch above Opher
# This anchor is a midway for going to MarshPastOpher.PoolsPathEast, since both paths from MarshPastOpher.MillView and MarshPastOpher.BowApproach want to reach that branch
# So all connections towards MarshPastOpher.PoolsPathEast should check for redundancy with MarshPastOpher.BowApproach->MarshPastOpher.PoolsPathEast since it's the "main" way to access PoolPathEast
# Likewise, all paths connecting to that anchor should check for redundancy with MarshPastOpher.BowApproach->MarshPastOpher.PoolsPathEast
  conn MarshPastOpher.MillView: free
  conn MarshPastOpher.PoolsPathEast:
    gorlek:
      Launch, DoubleJump OR Damage=10  # djump/damage/bashnade for leniency because the camera is weird here
      Launch, Bash, Grenade=1
    kii:
      Launch
      Bash, Grenade=1, DoubleJump, TripleJump
    unsafe:
      Water, Bash  # Second part of this video https://youtu.be/9LEokEz5GtA (drop down to MillView to actually start the path)
      DoubleJump, TripleJump, Damage=10
      DoubleJump, Damage=20
      HammerJump, DoubleJump OR Damage=10
      SentryJump=1

anchor MarshPastOpher.TrialStart at -602, -4316:  # Next to the start of the spirit trial
  refill Checkpoint

  state MarshPastOpher.TrunkWall:
    moki: BreakWall=20
    unsafe: free  # https://youtu.be/38jpoWj3Otk

  pickup MarshPastOpher.SpiritTrial:
    moki: MarshPastOpher.TrialActivation, DoubleJump, Dash, Grapple
    gorlek: MarshPastOpher.TrialActivation, Dash, Grapple
    unsafe: MarshPastOpher.TrialActivation, Grapple  # https://youtu.be/sFNJzOvtOwM

  conn MarshPastOpher.UnderTrunk:
    moki: MarshPastOpher.TrunkWall
  conn MarshPastOpher.BowPath:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: free
  # Not using the ShurikenBreak path because both walls have the same amount of health and going to the shrine through the trunk is free, making the shuriken break more restrictive than MarshPastOpher.TrunkWall

# checkpoint at -603, -4316
# checkpoint at -573, -4339

anchor MarshPastOpher.UnderTrunk at -573, -4339:  # After breaking the tree trunk next to MarshPastOpher.TrialStart
  refill Checkpoint

  state MarshPastOpher.TrunkWall:
    unsafe:
      BreakWall=20, Sword OR Hammer OR Blaze OR Sentry OR Grenade  # Not hard to do but too obscure for others difficulties
      ShurikenBreak=20

  pickup MarshPastOpher.TrialLeftEX:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: Sword OR Hammer OR Damage=10  # Horizontal slash combo
    kii: Sentry=1 OR Flash=1 OR Spear=1 OR Blaze=1 OR Shuriken=1  # Use Sentry instead of DoubleJump
    unsafe: free  # https://youtu.be/F_4nWtGCcBM

  conn MarshPastOpher.TrialArea: free
  conn MarshPastOpher.TrialStart:
    moki: MarshPastOpher.TrunkWall

anchor MarshPastOpher.TrialArea at -427, -4342:  # Next to the combat shrine
  refill Checkpoint
  refill Health=1:  # right below
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: free

  state MarshPastOpher.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki:
      Combat=SneezeSlug+Mantis, Grapple, Dash OR Glide
      Bash, Grapple, Dash OR Glide
    gorlek: Grapple, DoubleJump OR Dash OR Glide OR Damage=10
    unsafe: Grapple

  pickup MarshPastOpher.TrialOre: free
  pickup MarshPastOpher.TrialEC:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek:
      Sword  # Horizontal slashes
      Hammer, Damage=10
    kii:
      Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Damage=10, Spear=1 OR Blaze=1
    unsafe:
      Damage=10
      Grenade=1 OR GrenadeCancel # Use grenade before landing on the left bouncepad
  pickup MarshPastOpher.TrialHC:
    moki: Hammer OR Spear=1
    unsafe: free  # the mantis usually jump into spikes
  pickup MarshPastOpher.TrialRightEX:
    moki: DoubleJump OR Launch
    gorlek: SentryJump=1
    kii:
      Bash  # the mantis usually jump into spikes but you can use th slime instead
      Dash, Sword OR Hammer
    unsafe:
      Dash OR Spear=1 OR GrenadeJump OR GlideJump OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap

  conn MarshShrine: free
  conn MarshPastOpher.UnderTrunk:  # Make sure it's not redundant with MarshPastOpher.TrialArea->MarshPastOpher.BowPath->MarshPastOpher.UnderTrunk
    moki:
      DoubleJump, Dash OR Glide
      Dash, Glide
      Grapple OR Launch
    gorlek:
      Damage=10, DoubleJump OR Dash OR Glide
    kii: Damage=20  # If you jump at the wrong place, you'll take another dboost
    unsafe:
      Dash OR DoubleJump OR Damage=10 OR SentrySwap=1 OR BlazeSwap=1 OR FlashSwap
      Spear=1  # https://youtu.be/EYPELh1H0UY
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      Grenade=1, Bash # standing on a piece of wood on the edge of the spikes
  conn MarshPastOpher.BowPath:
    moki, BreakWall=20:
      Bash, DoubleJump OR Dash OR Glide OR Grapple OR Launch
      Combat=Mantis+SneezeSlug, DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek, BreakWall=20:
      Sword OR Hammer OR Launch
      Bash, Grenade=1
    kii, BreakWall=20: Bash OR Shuriken=3 OR Sentry=4 OR Blaze=6
    unsafe: Bash OR DoubleJump OR Dash OR Glide OR Grapple OR Launch OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2 OR PauseHover #  https://youtu.be/4TnvbyW1BHE

anchor MarshShrine at -382, -4341:
  nospawn
  refill Full

  state MarshPastOpher.CombatShrineCompleted:
    moki: Regenerate, Damage=20, Combat=2xSkeeto+2xEnergyRefill+Mantis+4xSmallSkeeto+2xEnergyRefill+Mantis+Skeeto
    unsafe: Combat=2xSkeeto+2xEnergyRefill+Mantis+4xSmallSkeeto+2xEnergyRefill+Mantis+Skeeto

  pickup MarshPastOpher.CombatShrine:
    moki: MarshPastOpher.CombatShrineCompleted

anchor MarshPastOpher.BowPath at -494, -4294:  # checkpoint climbing up to Bow tree
  refill Checkpoint
  refill Health=1
  refill Energy=1:
    moki: BreakCrystal

  pickup MarshPastOpher.SwingPoleEX:  # Make sure it's not redundant with MarshPastOpher.BowPath->MarshPastOpher.BowApproach->MarshPastOpher.SwingPoleEX
    moki:
      Damage=10, Dash OR Glide
      Damage=10, Bash, Grenade=2
    gorlek:
      Damage=10, Sword OR Hammer
      Damage=10, Bash, Grenade=1
    kii:
      Bash, Damage=10  # the mantis disappears when spawning at this anchor but you can use the slime instead
      Damage=10, Blaze=3 OR Sentry=2
    unsafe: Bash OR Shuriken=1 OR Blaze=2 OR Sentry=2

  conn MarshPastOpher.BowApproach:
    moki: DoubleJump OR Launch
    gorlek:
      Dash
      Bash, Grenade=2
      Glide, Sword OR Hammer
    kii:
      Sword OR Hammer
      Sentry=3
      Sentry=2, Shuriken=1 OR Flash=1
      Blaze=3, Spear=1 OR Shuriken=1 OR Flash=1
    unsafe:
      Glide  # make the suspended platform swing
      Shuriken=2 OR GrenadeJump
      Blaze=2, Spear=1 OR Flash=1  # using shuriken is more energy than Shuriken=2 / using sentry is the same energy requirement as Sentry=3
  conn MarshPastOpher.MillView:
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=2
    gorlek:
      Sword OR Hammer
      Bash, Grenade=1
    kii: Bash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Bow=1 OR Grenade=1 OR GrenadeCancel OR PauseHover
  conn MarshPastOpher.TrialStart:  # Make sure it's not redundant with MarshPastOpher.BowPath->MarshPastOpher.MillView->MarshPastOpher.TrialStart
    moki: Bash, Grenade=1
    gorlek: free

anchor MarshPastOpher.BowApproach at -490, -4245:  # On the right ledge above the scenic mill view
  refill Checkpoint
  refill Health=1

  pickup MarshPastOpher.SwingPoleEX:
    moki: Damage=10
    unsafe: free

  conn MarshPastOpher.BowPath: free
  conn MarshPastOpher.BowArea:
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=1
    gorlek: Sword OR Hammer OR Damage=10
    kii: Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Spear=1 OR Blaze=2 OR GrenadeCancel OR PauseHover OR BlazeSwap=1
  conn MarshPastOpher.MillView:
    moki: Bash, Grenade=1  # this is the only non-redundant connection that will ever exist.
  conn MarshPastOpher.PoolsPathEast:
    moki:
      Bow=4, DoubleJump, Dash, Bash, Glide  # autoaim doesn't catch the second target, 2 is needed minimum
      Bow=4, Bash, Launch  # autoaim doesn't catch the second target, 2 is needed minimum
    gorlek:
      Bow=2, Bash, Launch  # the moki path, but without safety energy
      Bow=2, DoubleJump, Bash, TripleJump OR Glide
      Launch, Glide
    kii:
      Launch, Bow=2 OR Spear=3  # break corruption blobs and reset your launch everywhere
      Launch, Spear=2, Grenade=1  # same as bove but more energy efficient
      Launch, DoubleJump OR Dash OR Sword OR Hammer  # Sword/Hammer can break the 2nd corruption blob to reset launch. Pass underneath it and refresh launch on the next wall otherwise
      Launch, Bow=1, Sentry=1 OR Flash=1 OR Shuriken=1  #
      Launch, Spear=1, Sentry=1 OR Flash=1 OR Shuriken=1
      Bash, DoubleJump, TripleJump, Sword OR Hammer OR Bow=1 OR Spear=1 OR Shuriken=1 OR Grenade=1 OR Blaze=1  # sentry doesn't target those blobs so can't use BreakWall
      Spear=3, Bash, DoubleJump, Dash OR Glide OR Hammer OR Sword
      Spear=2, Grenade=1, Bash, DoubleJump, Dash OR Glide OR Hammer OR Sword  # Same as above but more energy efficient
      Bow=2, Bash, DoubleJump, Dash OR Hammer OR Sword  # its easier with hammer than with a sword but it can be a little bit too precise (moved from unsafe)
    unsafe:
      Bow=2 OR Spear=2 OR Grenade=2:
        Bash, DoubleJump OR Dash OR Sword OR Hammer  # https://youtu.be/LeoIWBsq-s0
      Bash, Glide, Bow=1 OR Spear=1 OR Grenade=1 OR Shuriken=1  # https://youtu.be/LJmKEirEloM
      Launch
  conn MarshPastOpher.OpherSkipBranch:  # Make sure it's not redundant with MarshPastOpher.MillView->MarshPastOpher.OpherSkipBranch nor MarshPastOpher.BowApproach->MarshPastOpher.PoolsPathEast
    unsafe:
      PauseHover  # I hope it'll make you regret playing with that trick in logic
      WaveDash, Glide  # wavedash off health plant
      WaveDash, DoubleJump, Sword OR Hammer

anchor MarshPastOpher.BowArea at -443, -4236:  # Ledge to the left of the pit with bow tree.
  refill Energy=1:
    moki: BreakCrystal

  state MarshPastOpher.EyestoneDoor:
    moki: Keystone=2  # crosses where the water would usually be

  pickup MarshPastOpher.BowEC: free  # crosses where the water would usually be
  pickup MarshPastOpher.BowTree: free  # crosses where the water would usually be

  conn MarshPastOpher.UpperBowArea:
    moki:
      Combat=Skeeto, Bow=2, DoubleJump
      Launch
    gorlek:
      SentryJump=2  # can kill the skeeto with your weapon if desired on the sentryjump path
      DoubleJump, TripleJump
      Combat=Skeeto, Bow=2, Dash OR Sword OR Hammer
      Bash, Bow=2, Dash OR Glide OR Sword OR Hammer
      Bash, Grenade=2
    kii:
      Bow=2, DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Dash
    unsafe:
      Bash  # Repositioning the Skeeto. The skeeto doesn't spwn if you spawned at this anchor but you can go to the right and come back by bashing the lizard
      Bow=2 OR DoubleJump OR Dash
  conn WestHollow.Entrance:
    moki: MarshPastOpher.EyestoneDoor  # crosses where the water would usually be
  conn MarshPastOpher.BowApproach:
    moki:
      DoubleJump OR Dash OR Launch
      Combat=Skeeto, Bow=1
    gorlek: Bash OR Sword OR Damage=10
    kii:
      Glide OR Hammer OR Sentry=2 OR Shuriken=1
      Bow=1
    unsafe: Flash=1 OR Sentry=1 OR GrenadeJump OR PauseHover

anchor MarshPastOpher.UpperBowArea at -437, -4211:  # Between the eyestones
  refill Checkpoint
  refill Energy=1:
    moki: BreakCrystal

  pickup MarshPastOpher.LeftEyestone:
    moki: Combat=Skeeto, Bow=1
    gorlek: Bow=1
  pickup MarshPastOpher.RightEyestone:
    moki: Combat=Skeeto, Bow=1
    gorlek: Bow=1

  conn MarshPastOpher.BowArea: free
  conn MarshPastOpher.BowApproach: free

# checkpoint at -383, -4230

anchor MarshPastOpher.PoolsPathEast at -662, -4241:  # On the wood sticking out of the ledge at the top left of the large room with Opher
  refill Checkpoint
  refill Health=1:
    moki: Combat=Mantis+Bat
    gorlek: free
  refill Energy=3:
    moki: BreakCrystal, Combat=Mantis+Bat
    gorlek: BreakCrystal

  pickup MarshPastOpher.CeilingEX:  # the squonkey doesn't reappear if you respawn on this checkpoint
    moki:
      Bash, DoubleJump, Dash
      Launch
    gorlek:
      Bash, DoubleJump
      Bash, Grenade=1, Dash OR Sword OR Hammer
      SwordSJump=1
      HammerSJump=1, DoubleJump OR Dash
    kii:
      Bash, Grenade=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Dash
    unsafe:
      HammerSJump=1
      GrenadeJump, DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash  # Repositioning the squonkey: squonkey respawns when u jump off to the east and back on the ledge

  conn MarshPastOpher.PoolsPathMiddle:  # the squonkey doesn't reappear if you respawn on this checkpoint
    moki: Bash, DoubleJump OR Launch
    gorlek:
      Bash, Dash  # the bat is weird
      Combat=Bat, Launch, DoubleJump OR Dash
    kii:
      Bash, Grenade=1, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10  # grenade to reach 2nd spider, other for going above the 1st spikes
      Bash, Damage=10, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10  # take a dboost in order to reach the 2nd spider
    unsafe:
      Launch
      Bash, Grenade=1 OR Hammer OR Flash=1 OR Sentry=1 OR Damage=10  # Would be just bash if the second bat was dropping a bit from time to time
      DoubleJump, Sword  # https://youtu.be/5DXMPrR-RZo
  conn MarshPastOpher.OpherSkipBranch: free

anchor MarshPastOpher.PoolsPathMiddle at -709, -4181:  # Next to the breakable floor
  refill Checkpoint

  pickup MarshPastOpher.PoolsPathEC:
    moki:
      DoubleJump, Dash OR Glide
      Bash, DoubleJump OR Dash OR Glide OR Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Glide OR Sword OR Hammer
      Glide, Sword OR Hammer
      Bash
      Combat=SpinCrab, SentryJump=1
    kii:
      Glide OR Sword OR Sentry=3 OR DoubleJump
      Hammer, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash  # coyote dash
    unsafe:
      Hammer OR Sentry=2 OR PauseHover

  conn MarshPastOpher.PoolsPathOneWayWall:
    gorlek, ShurikenBreak=20:
      Bash OR Launch OR SentryJump=1
      DoubleJump, TripleJump
    unsafe, ShurikenBreak=20: DoubleJump OR GlideJump OR GrenadeJump
  conn MarshPastOpher.PoolsPathBellowOneWayWall:
    moki:
      Bash, DoubleJump OR Launch
      Launch, Water, Hammer OR Spear=1
    gorlek:
      Bash, Dash OR Glide
      Bash, Sword, Damage=10
      Hammer OR Spear=1:
        Launch, DoubleJump OR Dash OR Glide OR Damage=10
    kii:
      Bash, Sword OR Hammer OR Damage=10
      Bash, Water, Shuriken=1 OR WaterDash
      Launch, Hammer OR Spear=1  # reset launch onto the mushroom above the spikes
      Hammer, Water, WaterDash, DoubleJump
      Spear=1, Water, WaterDash, DoubleJump, TripleJump OR Sword OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      DoubleJump, Spear=1, TripleJump OR Dash OR Water OR Sword OR Damage=10  # https://youtu.be/jbkDaPma9ZE
      Hammer, Bash OR DoubleJump
      Hammer, Damage=10, Damage=20  # https://youtu.be/Qt6Jfi3675I
      Hammer, Water, Damage=20
  conn MarshPastOpher.PoolsPathEast:
    moki: Bash
    gorlek:
      Glide, DoubleJump OR Dash OR Launch
      Damage=10  # more other paths would exist, but seem difficult to do damageless themselves
    kii:
      Glide OR DoubleJump OR Dash OR Launch OR Sentry=2
    unsafe:
      Sword OR Shuriken=1
      Damage=5, Hammer OR Blaze=2 # Take a dboost on the bat projectile instead of the spikes

anchor MarshPastOpher.PoolsPathOneWayWall at -744, -4173:  # Left of the one way wall next to the mortar
  refill Checkpoint:
    moki: BreakWall=20  # Checkpoint accessible without breaking the wall but it'll trap you in

  conn MarshPastOpher.PoolsPathMiddle:
    moki: BreakWall=20
  conn MarshPastOpher.PoolsPathBellowOneWayWall: free
  conn MarshPastOpher.PoolsPathWest:
    moki: Bash, DoubleJump OR Launch
    gorlek:
      Bash, Dash OR Glide OR Sword
      Bash, Hammer, Damage=10
      DoubleJump, Damage=10, TripleJump OR Dash OR Glide OR Sword
      DoubleJump, TripleJump, Dash, Glide OR Sword  # enough tools to allow multiple approaches
      Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=10
    kii:
      Launch
      Bash, Hammer
      Damage=20, DoubleJump OR Dash OR Sentry=3
      DoubleJump, Shuriken=1 OR Flash=1 OR Sentry=1:
        Damage=10
    unsafe:
      Bash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR PauseHover  # https://youtu.be/z61PU_x49ko
      Damage=20, Hammer OR Sentry=2
      Damage=10, DoubleJump OR Dash OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap OR GlideJump

anchor MarshPastOpher.PoolsPathBellowOneWayWall at -754, -4187:  # Platform bellow PoolsPathOneWayWall
  conn MarshPastOpher.PoolsPathOneWayWall:
    moki: Bash OR Launch
    gorlek: SentryJump=1
    unsafe:
      DoubleJump, TripleJump OR Sword OR GlideJump
      GrenadeJump OR HammerJump OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
  conn MarshPastOpher.PoolsPathWest:  # Paths that can't go to PoolsPathOneWayWall or are using the mortar
    kii:
      Bash, Shuriken=1 OR Blaze=3 OR Sentry=2 OR Damage=10  # use the mortar projectile to reach the lantern directly
      DoubleJump, TripleJump, Damage=20 #dmg boosing through the last spikes
    unsafe:
      Damage=30  # dboost in the spikes, land on the friendly spike
      Damage=20, Sword  # pogo the mortar projectile as it touches the ground
  conn MarshPastOpher.PoolsPathEast:  # Paths going backward to break the floor/ceiling
  # No paths with Bash because then you can go to PoolsPathOneWayWall and destroy the wall with either hammer or a single spear
    gorlek:
      Glide, Hammer  # upslash while gliding to avoid the spikes
      Glide, Spear=1, DoubleJump OR Dash
      DoubleJump, Dash, Hammer OR Spear=1
      DoubleJump, Sword, Hammer OR Spear=1
      Water, WaterDash, Hammer OR Spear=1
      Damage=10, WaterDash, Hammer
    kii:
      Hammer, Dash OR DoubleJump
      Dash, Spear=1, Water OR Damage=10 OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # refresh dash into mushroom bellow the mortar
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1:
        Spear=1, Damage=10 OR Water
      DoubleJump, TripleJump, Spear=1
      Damage=20, WaterDash, Spear=1
      Damage=10, WaterDash, Spear=1, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, Spear=2
      DoubleJump, Spear=1, Water OR Damage=10 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR BlazeSwap=1
      Damage=10, WaterDash, Spear=1

anchor MarshPastOpher.PoolsPathWest at -803, -4187:  # Right on top of MarshPastOpher.PoolsPathEX
  refill Checkpoint

  pickup MarshPastOpher.PoolsPathEX: free

  conn MarshPastOpher.PoolsPathOneWayWall:  # Make sure it's not redundant with going to MarshPastOpher.PoolsPathBellowOneWayWall first
    moki:
      Bash, DoubleJump, Dash OR Glide
      Bash, Grenade=1, Dash, Glide
      Launch, DoubleJump OR Dash OR Bash OR Glide
    gorlek:
      Bash, DoubleJump, Sword OR Hammer OR TripleJump
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      Bash, Dash, Glide OR Sword OR Hammer
      SentryJump=1, Bash, Damage=10  # land in the spikes, bash the lantern then air combo with sword or hammer to reach the patform
      DoubleJump, TripleJump, Glide OR Damage=10
      DoubleJump, Damage=10, Dash OR Glide OR Sword OR Hammer
      Dash, Damage=10, Sword OR Hammer
      SwordSJump=1, Damage=10
      Launch  # Reset Launch by hitting the ceiling
    kii:
      Bash, Damage=20
      Bash, Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Sword, Damage=10
      Glide, Damage=10, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Hammer, Shuriken=1 OR Flash=1 OR Sentry=1:  # use the first energy weapon before hitting the spikes
        Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=20, Sentry=3
      DoubleJump, Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Dash
      Damage=10, Dash OR Sword
    unsafe:
      Damage=10, DoubleJump OR Hammer OR Bash
      Bash, Grenade=1  # bash grenade near the spikes, bash glide of the lantern
      SentryJump=1, Bash
  conn MarshPastOpher.PoolsPathBellowOneWayWall:
    gorlek:
      Bash, Grenade=1, Damage=10
      Damage=10, DoubleJump OR Dash
      DoubleJump, TripleJump, Sword OR Hammer
      Glide, DoubleJump OR Dash
    kii:
      Dash, Damage=10, Hammer OR Spear=1 #from the below
      DoubleJump, TripleJump, Damage=10, Hammer OR Spear=1 #from the below
      Damage=10, Glide OR Hammer
      Damage=20, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=30
    unsafe:
      GlideJump OR PauseHover
      HammerSJump=1, Damage=10 OR Water  # hammer breaks the wall, can avoid the damage boost but will land in water
  conn PoolsApproach.MarshBreakableWall:
    gorlek: ShurikenBreak=20

region MidnightBurrows:
  moki: Danger=25
  gorlek: free
  kii: free
  unsafe: free

anchor MidnightBurrows.Teleporter at -945, -4582:  # At the teleporter
  refill Full

  state NonGladesTeleporter: free

  conn Teleporters: free
  conn MidnightBurrows.BelowLupo:
    moki: Combat=SneezeSlug+Bat OR Bash OR Launch
    gorlek: DoubleJump OR Dash OR Damage=16
    kii: free
  conn MarshSpawn.BurrowsEntry:
    moki, MarshSpawn.BurrowsOpen:
      Launch
      Bash, DoubleJump, Dash OR Glide
    gorlek, MarshSpawn.BurrowsOpen:
      Bash, DoubleJump
      SentryJump=3, DoubleJump, Damage=15
    kii, MarshSpawn.BurrowsOpen:
      Bash, Dash OR Glide OR Sword OR Hammer OR Shuriken=3 OR Sentry=4  # Bait shots from the spider
      Bash, Grenade=1, Shuriken=1 OR Sentry=1 OR Flash=1  # bait shots from the spider, land where the mortar is, bait it, grenade, bash the mortar to reach your grenade
    unsafe, MarshSpawn.BurrowsOpen:
      # Bash, Grenade=1
      Bash  # using the projectiles efficiently

anchor MidnightBurrows.BelowLupo at -850, -4579:  # Past the enemies near the teleporter
  pickup MidnightBurrows.LeftKS:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: Sword OR Hammer OR Damage=15
    kii: free  # teleport
  # lupo paths would be redundant with Center

  conn MidnightBurrows.Teleporter:
    moki: Combat=SneezeSlug+Bat OR Bash OR Launch
    gorlek: free
  conn MidnightBurrows.Central:  # The slug can be really annoying if it's on the left of the platform
    moki:
      DoubleJump, Bash
      Launch
    gorlek:
      DoubleJump, Dash OR TripleJump  # if the slug is on the left, jump above it
      Bash, Dash OR Sword OR Hammer OR Glide OR Damage=15
    kii: DoubleJump OR Dash OR Sword OR Hammer OR Glide OR Bash OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2 OR Damage=15  # walljump on the wall left to the slug's platform and jump back in the portal to go near Lupo. From there you have enough momentum to avoid the slug if it's on the left of the platform
    unsafe: free  # jump into the portal and wait until you get enough height. That's it.
      # Blaze=1
      # Grenade=1  # Grenade while in right Teleporter to get to the left ceiling

anchor MidnightBurrows.Central at -781, -4564:  # The ledge left of the big portal room
  refill Checkpoint

  state MidnightBurrows.Lever:  # paths that can't use the anchor because they only work without the lever already pulled
    kii: Damage=15, Blaze=1
    unsafe:
      Damage=15  # may need <60 fps?
      Shuriken=1, Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1  # extend corner boost with shuriken

  pickup MidnightBurrows.LupoMap:
    moki: SpiritLight=50, DoubleJump OR Dash OR Glide
    gorlek: SpiritLight=50
  pickup MidnightBurrows.DeflectorShard:  # check for redundancies with activating the lever
    moki:
      Launch
      MidnightBurrows.Lever, DoubleJump, Dash OR Glide
    gorlek, MidnightBurrows.Lever:  # The slug isn't here if you respawn from the checkpoint
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash OR Glide
    kii, MidnightBurrows.Lever:
      DoubleJump OR Sword OR Hammer OR Shuriken=2 OR Sentry=2 OR Flash=2
      Damage=15, Spear=2 OR Blaze=2
    unsafe:
      # DoubleJump, Sentry=1, Damage=15
      # DoubleJump, Sentry=2
      DoubleJump
      Dash, Bash
      MidnightBurrows.Lever, Damage=15

  conn MidnightBurrows.BelowLupo: free
  conn MidnightBurrows.TabletRoom:
    moki:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek: Bash OR SentryJump=2
    kii: DoubleJump, TripleJump, Damage=30 OR Sword  # with sword, pogo the mortar
    unsafe:
      DoubleJump, Damage=15, TripleJump OR Sword
      Grenade=1
  conn MidnightBurrows.PortalRoom:  # keep in mind that these paths have to work after the lever has been pulled
    moki: Launch OR Glide OR DoubleJump OR Dash
    gorlek: Sword OR Hammer OR Damage=15
    kii: free

anchor MidnightBurrows.TabletRoom at -824, -4531:  # Before the four keystone door
  refill Checkpoint
  refill Health=1

  state MidnightBurrows.KeystoneDoor:
    moki: Keystone=4

  quest MidnightBurrows.TabletQI:
    moki: MidnightBurrows.KeystoneDoor

  conn MidnightBurrows.Central: free

# checkpoint at -698, -4566

anchor MidnightBurrows.PortalRoom at -706, -4588:  # Bottom right of the big room full of portals
  refill Checkpoint

  conn MidnightBurrows.LeverRoom:
    moki:
      Glide
      DoubleJump, Dash
      Bash, DoubleJump OR Dash
      Launch, DoubleJump OR Dash OR Bash
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Sword OR Hammer
      Bash, Sword OR Hammer
      Damage=15, DoubleJump OR Dash OR Bash OR Sword OR Hammer
      Launch
    kii:
      Dash OR Sword OR Sentry=3 OR Damage=30  # Reset dash with ceiling
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2
      Bash, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
      Damage=15, Bash OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2
    unsafe: Bash  # Bash the lantern once to the right then bash it again
  conn MidnightBurrows.BelowUpperKS:  # so far all paths not using MidnightBurrows.Lever would be redundant
    moki: MidnightBurrows.Lever, Launch
    gorlek: MidnightBurrows.Lever, SentryJump=2, DoubleJump OR Dash OR Glide
    kii, MidnightBurrows.Lever:
      DoubleJump, TripleJump, Damage=15
      DoubleJump, Bash  # use the slime then bait the spider
    unsafe, MidnightBurrows.Lever:
      SentryJump=2
      SentryJump=1, DoubleJump, Damage=15
      DoubleJump, Sword OR Damage=15
      Bash
  conn MidnightBurrows.East:  # check for redundancies with activating the lever
    moki:
      Launch
      MidnightBurrows.Lever, DoubleJump OR Dash OR Glide
    gorlek, MidnightBurrows.Lever:
      Sword
      Bash, Grenade=1  # bash the lantern to reach the lever, grenade bash from there
      HammerSJump=1
    kii, MidnightBurrows.Lever:  # you can jump out of the portal above the lever, but it's a bit uncooperative, so it's not considered in kii
      Hammer OR Shuriken=2 OR Sentry=3
      Bash, Shuriken=1 OR Sentry=2
    unsafe: MidnightBurrows.Lever, Bash OR Sentry=1 OR Blaze=1 OR Flash=1 OR Shuriken=1 OR Spear=1
  conn MidnightBurrows.Central:
    moki: MidnightBurrows.Lever
    gorlek: Damage=15
    kii: free

anchor MidnightBurrows.LeverRoom at -685, -4616:  # At the lever lifting the portals
  refill Checkpoint

  state MidnightBurrows.Lever: free

  pickup MidnightBurrows.LowerKS:
    moki:
      Glide OR Launch
      Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Dash, Sword OR Hammer
      Damage=15, DoubleJump OR Dash OR Sword OR Hammer  # boost on the brambles below the keystone
      SentryJump=1  # use the weapon for movement as well
    kii:
      Dash OR Sentry=3
      Damage=15  # boost on the brambles below the keystone
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe: Sword

  conn MidnightBurrows.PortalRoom:
    moki:
      Bash, Launch
      Bash, DoubleJump, Dash OR Glide
      Bash, Dash, Glide
    gorlek:
      Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=15
      Bash, DoubleJump, TripleJump
      Bash, Dash, Glide OR Sword
    kii:
      Launch
      Bash, Damage=15
      Bash, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
      Bash, Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, DoubleJump OR Glide OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Damage=60  # dboost then wall jump on wall above the bashable plant
      DoubleJump, Damage=45, Dash OR Glide OR Shuriken=1 OR Sentry=2  # avoid the dboost on the right of the bashable plant
      DoubleJump, Damage=30, TripleJump OR Sword OR Hammer  # less damage because you can jump on the wall above the bashable plant from lower
      Damage=105  # dboost while going to the left portal
      Damage=75, Dash OR Sword
      Damage=90, Hammer
    unsafe:
      Bash, DoubleJump, Spear=1 OR Flash=1 OR Sentry=1
      Bash, Dash OR Grenade=1
      Bash, Sword, Shuriken=1  # pogo the shuriken
      DoubleJump, TripleJump  # https://youtu.be/OMjOhM767ac
      DoubleJump, Damage=30
      Hammer, Damage=60
      Damage=75

anchor MidnightBurrows.East at -687, -4553:  # Behind the timed-puzzle door
  refill Checkpoint

  conn MidnightBurrows.DenConnection:
    moki: Combat=SneezeSlug+Tentacle OR Bash OR Launch
    gorlek: Dash OR Damage=10
    kii: free

anchor MidnightBurrows.DenConnection at -597, -4549:  # At the wall connecting to Den
  refill Checkpoint

  state MidnightBurrows.HowlsDenShortcut:
    moki: BreakWall=10

  pickup MidnightBurrows.RightKS: free

  conn MidnightBurrows.PortalCorridor:
    moki: Combat=WeakSlug OR Bash OR Launch
    kii: DoubleJump
  conn HowlsDen.DoubleJumpTreeArea:
    moki: MidnightBurrows.HowlsDenShortcut

anchor MidnightBurrows.PortalCorridor at -632, -4525:  # To the right of where floor and ceiling are all portals
  refill Checkpoint

  conn MidnightBurrows.DenConnection: free
  conn MidnightBurrows.BelowUpperKS:
    moki:
      DoubleJump, Glide
      DoubleJump, Dash, Damage=15
      Launch, Glide, Damage=15  # Since patch 3, Launching through a portal gives you a major boost, which in this case quickly ends in spikes
    gorlek:
      Glide
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Dash, Sword OR Hammer
      Launch, Damage=15, DoubleJump OR Dash OR Sword OR Hammer
    kii:
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=15
      Dash, Shuriken=4 OR Sentry=4 OR Damage=15  # use your weapon to slow you down to make it easier to avoid the dboost
      Damage=15, Sword OR Hammer OR Sentry=5
      Damage=30, Sentry=3 OR Blaze=4
      Damage=45, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2 OR Spear=2
      Damage=60
    unsafe: free  # :eyes:
      # Dash
      # Blaze=5, Damage=15
      # Spear=1, Damage=45
      # Bash, Damage=45  # Bash the slime

anchor MidnightBurrows.BelowUpperKS at -724, -4524:  # Just below the upper keystone
  pickup MidnightBurrows.UpperKS:
    moki: Combat=Bat OR Bash
    gorlek: Dash OR Launch
    kii: free

  conn MidnightBurrows.PortalRoom:
    moki: free
  conn MidnightBurrows.PortalCorridor:  # check for redundancies with PortalRoom -> Lever
    kii:
      Damage=15, Blaze=6
      Damage=45, Spear=4
      Damage=60, Flash=2 OR Blaze=4
      Damage=90, Flash=1 OR Blaze=1 OR Spear=1
      Damage=150

region WestHollow:
  moki: Danger=20
  gorlek: free
  kii: free
  unsafe: free

anchor WestHollow.Entrance at -303, -4238:  # At Twillen
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state MarshPastOpher.EyestoneDoor:
    moki: Keystone=2  # we can now open it from Twillen's side

  state WestHollow.PurpleDoorOpen:  # Path who drop from the frog statue originate from InFrontPurpleDoor
    moki, Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      DoubleJump, Dash
      Launch
      Bash, Grenade=1
    gorlek, Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      SentryJump=1, DoubleJump
      DoubleJump, TripleJump
      Glide, DoubleJump OR Dash  # Glide from the slime's position
    kii, Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Hammer, Dash OR DoubleJump
      Glide, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 # Glide from the slime's position
      Bash  # Bash the slime
    unsafe, Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Glide, Blaze=1
      GlideJump
      GrenadeJump  # Grenade Wall Jump

  pickup WestHollow.CrusherHC: free

  conn TwillenShop: free
  conn MarshPastOpher.BowArea:
    moki, MarshPastOpher.EyestoneDoor:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek, MarshPastOpher.EyestoneDoor:
      Dash OR Glide OR Sword OR Hammer OR Damage=10  # Go through the lower part
    kii, MarshPastOpher.EyestoneDoor: Bash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: MarshPastOpher.EyestoneDoor  # (free with tight platforming)
  conn WestHollow.MokiByTwillen:
    moki: Launch OR Bash  # the slug
    gorlek:
      DoubleJump, TripleJump
      SentryJump=1
    kii:
      Sword, DoubleJump OR Dash OR Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # pogo the slime
      DoubleJump, Hammer
    unsafe:
      Sword  # pogo the slime
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR GlideJump OR BlazeSwap=1
      GrenadeJump
  conn WestHollow.InFrontPurpleDoorEnemyPaths:  # check for redundancies with MokiByTwillen
    # using the dirty water may be softlockable if you drain the water. Currently draining the water provides no advantage for this connection, so no paths using the water can exist
    moki:
      Combat=2xSlug, Bow=1, DoubleJump OR Dash  # the camera only reliably moves to the tongue if you can kill the slug
      DoubleJump, Dash OR Glide
    gorlek:
      Bow=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=10  # deal with the camera
      DoubleJump, Sword OR Hammer
    kii:
      Bow=1, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash
      Glide, Sword OR Hammer  # with sword, pogo the slime
    unsafe:
      Bow=1, BlazeSwap=1 OR GrenadeCancel
      DoubleJump OR GlideJump
  conn WestHollow.HollowDrainMiddle:
    moki: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained
    unsafe:
      #Dash swim
      Damage=60
      WaterDash, Damage=20

anchor WestHollow.MokiByTwillen at -230, -4229:  # The moki to the upper left of Twillen, standing on a bridge
  # this anchor was newly added while validating the moki and gorlek paths for this area
  # As such, connections to and from this anchor may be lacking kii paths, I leave it to the kii validator to look at those
  refill Health=1

  state WestHollow.UpperDrainLeverPulled:
    moki:
      Combat=BombSlug, Bow=1
      Combat=BombSlug, DoubleJump, Dash OR Glide
      Launch
    gorlek: Bow=1 OR DoubleJump OR Dash OR Glide OR Sword  # bait the bombslug
    kii: Hammer OR Sentry=2
    unsafe: Shuriken=1 OR SentrySwap=1 OR BlazeSwap=1 OR FlashSwap OR PauseHover

  conn WestHollow.Entrance: free
  conn WestHollow.InFrontPurpleDoorEnemyPaths:
    moki: Combat=BombSlug OR DoubleJump OR Dash OR Glide OR Launch
    gorlek: free  # bait the bombslug

anchor WestHollow.InFrontPurpleDoor at -181, -4240:  # In front of the purple door, before the TP
# Paths using the slime originate from WestHollow.InFrontPurpleDoorEnemyPaths because it doesn't appear if you spawned at this anchor
  state WestHollow.PurpleDoorOpen:  # Be carefull it's not redundant with paths from Entrance
    kii, Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Dash, Sword OR Shuriken=1
      DoubleJump, Sword OR Sentry=2
      Sword, Shuriken=1
    unsafe: Bow=1  # Drop shot
      # Bow=1, DoubleJump, Shuriken=1
      # Bow=1, Sword, Hammer

  conn WestHollow.MokiByTwillen:
    moki: Launch OR Bash  # the slug
    gorlek:
      DoubleJump, TripleJump
      SentryJump=1
    kii:
      Sword, DoubleJump OR Dash OR Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # pogo the slime
      DoubleJump, Hammer
    unsafe:
      Sword  # pogo the slime
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR GlideJump OR BlazeSwap=1
      GrenadeJump
  conn WestHollow.MokiByTwillen:  # Make sure it's not redundant with WestHollow.InFrontPurpleDoorEnemyPaths->WestHollow.Entrance->WestHollow.MokiByTwillen
    moki:
      Bow=1, Combat=Slug OR Bash
      Bash, Grenade=1
      Launch
    gorlek:
      Bow=1
      DoubleJump, Dash
      SentryJump=1
    kii:
      Dash, Hammer OR Damage=10
      DoubleJump, Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Damage=10, Spear=1 OR Blaze=1
    unsafe:
      Dash OR GlideJump OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
      Damage=10, DoubleJump OR PauseHover
  conn WestHollow.Entrance:  # check for redundancies with MokiByTwillen. Slime don't spawn when strating at this anchor
    moki:
      Combat=2xSlug, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained OR DoubleJump OR Dash OR Glide
      Bash, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained OR DoubleJump OR Dash OR Glide
    gorlek: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained OR DoubleJump OR Dash OR Glide OR Sword OR Damage=20  # since UpperDrainLeverPulled solves this path on its own, using the dirty water is sound here
    kii: Hammer OR Sentry=2
    unsafe: Shuriken=1 OR Blaze=3
  conn WestHollow.HollowDrainMiddle:
    moki: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained
    unsafe:
      #Dash swim
      Damage=60
      WaterDash, Damage=20
  conn EastHollow.Teleporter:
    moki: WestHollow.PurpleDoorOpen

anchor WestHollow.InFrontPurpleDoorEnemyPaths at -181, -4240:  # Variant of WestHollow.InFrontPurpleDoorEnemyPaths which are using the slime
  nospawn

  conn WestHollow.InFrontPurpleDoor: free
  conn WestHollow.MokiByTwillen:
    kii: Bash
  conn WestHollow.HollowDrainMiddle:
    unsafe:  # Mid-air regen down swim. Use the slime because in hard you need to pre-damaged on its projectile instead of the spikes in order to fullfill the path
      Regenerate, Damage=40
      WaterDash, Regenerate, Damage=20

anchor WestHollow.HollowDrainMiddle at -197, -4275:  # At the crystal below the purple eye
  # this anchor doesn't assume drained water because it's usable for weird dirty water swim paths
  tprestriction:
    moki: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained  # Protecting moki players from having to figure out that you can tp underwater the hard way
    gorlek: free
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained

  state WestHollow.UpperTongueExtended:  # this tongue stays extended permanently, so it can be a state. If you're able to retract it, you are also able to extend it again
    moki: Bow=1, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained

  conn WestHollow.RockPuzzle:  # having the tongue extended can be a negative, so strictly speaking these paths would have to work with the tongue extended since a header could set the tongue. We choose to assume a header will never do this instead.
    moki, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      WestHollow.UpperTongueExtended, Bow=1, DoubleJump OR Dash  # Retract the tongue with bow
      DoubleJump, Dash
      Glide OR Launch
    gorlek, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      WestHollow.UpperTongueExtended, Bow=1, Sword OR Hammer  # Retract the tongue with bow
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Sword OR Hammer
      Damage=20  # dboost on the water if it's there and on the spikes if not
    kii, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Sword OR Blaze=6 OR Sentry=3
      WestHollow.UpperTongueExtended, Bow=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Retrat the tongue with bow
      Hammer, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Dash  # Either coyote dash or a wall jump at the spikes. Not in kii because the spikes dissuade from doing the coyote dash
      DoubleJump OR Hammer OR Shuriken=2 OR Blaze=4 OR Sentry=2  # friendly spike on the very edge
      Bash, Grenade=1  # https://youtu.be/JTR1UHwFPoM
      PauseHover OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
      # Dirty water swim are irrelevant. You could solve the rock puzzle which let you get WestHollow.FarLeftEX but it have to be solvable without the water as well if you don't want the path to be softlockable.
      # You can't cross the bridge above WestHollow.RockPuzzleEX, making the pickup non-accesible without WestHollow.UpperDrainLeverPulled
      # You can't pull the WestHollow.FullyDrained lever when its underwater.
      # Damage=80
      # WaterDash, Damage=20
  conn WestHollow.SubmergedPlatform:  # Dirty water swim don't use that anchor for anything ; the only relevant one goes directly to WestHollow.HollowDrainLower
    moki: WestHollow.FullyDrained
  conn WestHollow.HollowDrainLower:
    unsafe:
      Damage=60  # Would be only 40 if you didn't pull the lever but it have to work in either state of the water
      WaterDash, Damage=20 # Can do it damageless if you didn't pull the lever
  conn WestHollow.Entrance:
    moki, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=1
    gorlek, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Sword OR Hammer  # Hammer is a bit particular; you can use upslash and horizontal slashes instead
    kii, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained: Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
        BlazeSwap=1 OR GrenadeJump OR PauseHover
      # Dirty upswim can't be solved with just damage because draining the water would then lead to solftlockable paths
      Damage=40, Launch OR DoubleJump OR Dash OR Sword OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
      Damage=60 OR WaterDash:
        Glide OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR BlazeSwap=1 OR GrenadeJump OR PauseHover
        Bash, Grenade=1

anchor WestHollow.RockPuzzle at -249, -4275:  # At the right ledge of the rock puzzle room
  tprestriction:
    moki: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained
    gorlek: free
  refill Checkpoint
  refill Health=1
  refill Energy=3:
    moki: BreakCrystal, DoubleJump OR Dash OR Bash OR Glide OR Launch
    gorlek: BreakCrystal
  refill Energy=1:  # This crystal belongs to SubmergedPlatform, but you can grab it with Magnet in cases where you can't reach that anchor.
    unsafe, Magnet, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Sentry=1 OR Spear=1 OR Bow=1 OR Grenade=1  # Using Spear results in a net loss of energy. Whatever.
      Sword, Hammer OR Sentry=2 OR DoubleJump OR Dash OR Launch OR Damage=20 OR PauseHover

  state WestHollow.RockPuzzleSolved:  # You can get the puzzle into some weird constellations, but teleporting out works in the worst cases
    moki, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Combat=Skeeto, Bow=4, DoubleJump OR Dash OR Glide
      Bow=4, Bash OR Launch
    gorlek, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Bow=1, SentryJump=1 OR Launch  # Get up to the rock and push it to use only one Bow shot
      Bow=1, Bash, Grenade=1  # Get up to the rock and push it to use only one Bow shot
    kii:
      WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
        Bow=4  # use the pole on the left in order to reach the floating platform
        Bow=1, DoubleJump, TripleJump, Hammer OR Spear=1 # start from the suspended platform then walljump on the ledge bellow the upper frog statue
        Bow=1, DoubleJump, TripleJump, Dash  # From the ledge above the left frog statue. Either coyote dash (but you can get a down dash) or mid air dash then tjump (dash first to avoid bonking on the ceiling)
      WestHollow.FullyDrained, Bow=1, Bash  # FullyDrained spawns slimes on the way to WestHollow.RockPuzzleEX. Bash one near the energy cristal and bash it twice to reach the rock
    unsafe, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Bow=2  # https://youtu.be/hZ4rYt_N-aU
      Bow=1, DoubleJump, Sword  # Pogo the skeeto. It's hard to bait it at the right position.
      Bow=1, Bash  # bait the skeeto
      Bow=1, DoubleJump, TripleJump
  state WestHollow.UpperTongueExtended:
    unsafe: Bow=1  # TP to avoid touching the water

  pickup WestHollow.RockPuzzleEX:
    moki: WestHollow.FullyDrained
    unsafe:
      WestHollow.UpperDrainLeverPulled, Damage=40
      WestHollow.UpperDrainLeverPulled, WaterDash, Damage=20

  conn WestHollow.FarLeftRoom:
    moki, WestHollow.RockPuzzleSolved, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Combat=Skeeto+Slug, Bow=1, DoubleJump OR Dash
      Bash OR Launch  # bashing off the skeeto
    gorlek, WestHollow.RockPuzzleSolved, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Combat=Skeeto+Slug, Bow=1, Glide OR Sword
      SentryJump=1
      DoubleJump, Combat=Slug OR Damage=10  # Jump to the left wall and wrap around to the top
    kii, WestHollow.RockPuzzleSolved, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Bow=1, Dash OR Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump
      Sword  # Pogo the skeeto
    unsafe, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained:
      Launch  # https://youtu.be/guXiDCKM18I
      WestHollow.RockPuzzleSolved, Hammer OR Spear=1 OR GrenadeJump OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap  # Jump to the left wall and wrap around to the top
      WestHollow.RockPuzzleSolved, Bow=1, PauseHover
  conn WestHollow.HollowDrainMiddle:
  # If FullyDrained, this connection originates from SubmergedPlatform instead
  # WestHollow.UpperTongueExtended is a HUGE negative for this connection and you can't retract it unless you have access to SubmergedPlatform
    gorlek, WestHollow.UpperDrainLeverPulled:
      Damage=20, Launch  # dboost in dirty water to pass under the upper tongue. If fully drained, solve by going to SubmergedPlatform
      Damage=20, DoubleJump, TripleJump  # if tongue is extended, dboost in dirty water. Else, wjump on the frog statue
    kii, WestHollow.UpperDrainLeverPulled:
      Damage=20, DoubleJump, Hammer OR Spear=2 # wjump on the frog statue if the tongue is retracted, dboost in the water otherwise
      Damage=20, DoubleJump, Spear=1, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10  # More energy efficient than 2 spears
    unsafe:
      WestHollow.UpperDrainLeverPulled, Damage=20, DoubleJump, Sword  # sword combo from the platform->djump->upslash to get a wjump from the frog statue. A bit too precise for kii.
      WestHollow.UpperDrainLeverPulled, Damage=20, DoubleJump, Spear=1  # precise djump from the ledge above the frog statue to avoid the dboost
      WestHollow.UpperDrainLeverPulled, DoubleJump, TripleJump OR Dash  # https://youtu.be/-Ww33y641DY
      WestHollow.FullyDrained, WestHollow.UpperTongueRetracted, Bash  # Assuming this is bashing enemies from the rock puzzle room so it indeed need to originate from here despite using the fully drained state?
      Damage=90:  # Dirty water paths need to also work without the water. dboost on the exploding slime to take a tiny bit less damage
      #Removing dboosts from sub-paths because the damage from the water will cover for all possible dboosts when the water is gone
        Launch
        DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Spear=1
      Damage=20, WaterDash: # If you die in the water just a bit after using wdash, you'll preserve a bit of its speed when respawning
        Launch
        DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Spear=1
  conn WestHollow.SubmergedPlatform:
    moki: WestHollow.FullyDrained
  conn WestHollow.HollowDrainLower:
    unsafe:
      Damage=80
      WaterDash, Damage=40  # Possible with only 30 damage without draining the water at all but that would softlock if you drain the upper part
  conn WestHollow.Entrance:
    unsafe:
      WestHollow.FullyDrained, Bash  # Place an enemy on HollowDrainMiddle and Bash off of it. There are multiple ways to do this, and none of them are fun. The Skeeto on the left is probably the most cooperative. This kinda looks possible from HollowDrainLower as well, but the Skeetos don't seem to have enough of an attention span to make it work.

anchor WestHollow.FarLeftRoom at -357, -4284:  # ledge below and to the right of second drain lever
  tprestriction:
    moki: WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained
    gorlek: free
  refill Energy=3:  # fast respawning crystal
    moki: BreakCrystal, WestHollow.UpperDrainLeverPulled OR WestHollow.FullyDrained
  # energy crystal below not considered because it doesn't seem relevant for anything

  state WestHollow.FullyDrained:
    moki, WestHollow.UpperDrainLeverPulled:
      Bow=2, DoubleJump OR Dash OR Glide
      Launch
    gorlek, WestHollow.UpperDrainLeverPulled:
      Bow=1, SentryJump=1
      Bow=1, DoubleJump, Sword OR Hammer  # DoubleJump and upslash to get on the wall to the right
      Bow=1, Bash, Grenade=1
      Bow=2, Sword OR Hammer
      DoubleJump, TripleJump, Damage=10  # Jump off the eye to the left
      DoubleJump, Damage=10, Dash
      Damage=20, WaterDash, DoubleJump OR Dash OR Glide OR Sword OR Hammer  # these paths aren't meaningful anymore if the water is gone, so this does not softlock
    kii, WestHollow.UpperDrainLeverPulled:
      Bow=2, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bow=1, DoubleJump, Spear=1 OR Flash=1 OR Sentry=1
      WaterDash, Damage=20, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, Damage=10, Hammer
      DoubleJump, TripleJump
    unsafe, WestHollow.UpperDrainLeverPulled:
      Bow=2  # precise walljump to get a wjump of the 2nd frog statue (and not just its tongue)
      Dash, DoubleJump OR Hammer OR Spear=1
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR PauseHover  # precise bash grenade to wall jump on the right wall. Other option to jump to the lever
      Dash, Damage=10, Glide OR Sword OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1

  pickup WestHollow.FarLeftEX:
    moki, WestHollow.FullyDrained:
      Bash OR Launch
      Bow=1, DoubleJump, Dash
    gorlek, WestHollow.FullyDrained:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=10
      Bow=1, Dash OR DoubleJump  # there are more options, this was the most lenient
      SentryJump=1
    kii, WestHollow.FullyDrained:
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bow=1, Glide OR Sword OR Hammer
      Bow=1, Sentry=2, Shuriken=1 OR Flash=1 OR Sentry=1  # Spear is less energy efficient than using a 3rd sentry
    unsafe:
      # dirty water paths need to work both with and without water to avoid a softlock. Using WestHollow.UpperDrainLeverPulled for the water damage reference since it's the most restrictive of the 3 possible states
      WestHollow.FullyDrained OR Damage=50:
        Bash OR Launch OR DoubleJump
        Bow=1, Dash OR DoubleJump OR Glide OR Hammer OR Shuriken=3 OR Sentry=3
        Sword  # Pogo the shot of the slug
        HammerSJump=1 OR HammerJump OR GrenadeJump
      WaterDash, Damage=30:
        Bash OR Launch OR DoubleJump
        Bow=1, Dash OR DoubleJump OR Glide OR Hammer OR Shuriken=3 OR Sentry=3
        Sword  # Pogo the shot of the slug
        HammerSJump=1 OR HammerJump OR GrenadeJump

  # backwards connection blocked by the door

# checkpoint at -356, -4306

anchor WestHollow.SubmergedPlatform at -215, -4288:  # the platform below HollowDrainMiddle, submerged until WestHollow.FullyDrained
  tprestriction:
    moki: WestHollow.FullyDrained
    gorlek: free
  refill Energy=1:
    moki: WestHollow.FullyDrained, BreakCrystal

  state WestHollow.UpperTongueExtended:
    moki, WestHollow.FullyDrained: Combat=BombSlug, Bow=1  # camera won't show the frog statue unless you kill the slug
    unsafe: Bow=1  #Snipe
  state WestHollow.UpperTongueRetracted:  # This tongue can be a negative for the HollowDrainMiddle connection so we need a state for retracting it to prevent softlocks. Unlike when coming from above, you can screw yourself here without any stupid headers by extending the tongue and blocking your line of sight to retract it again, so we choose to write paths for this scenario
    moki, WestHollow.FullyDrained: WestHollow.LowerTongueExtended, Combat=BombSlug, Bow=1
    gorlek, WestHollow.FullyDrained: WestHollow.LowerTongueExtended, Bow=1
  state WestHollow.LowerTongueExtended:
    moki, WestHollow.FullyDrained: Combat=BombSlug, Bow=1  # need to kill the slug in order to aim the frog statue
    unsafe, WestHollow.FullyDrained: Bow=1  # waiting long enough on the left of the energy crystal will zoom out the camera and allow to autoaim the statue

  conn WestHollow.HollowDrainMiddle:
    moki, WestHollow.FullyDrained:
      Launch  # Works regardless of the tongue states
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, DoubleJump, Dash
      WestHollow.UpperTongueRetracted, Bash, Grenade=1, DoubleJump OR Dash OR Glide
    gorlek, WestHollow.FullyDrained:
      DoubleJump, TripleJump  # if the the tongue is retracted, wjump on the frog statue. else, jump on the tongue directly
      WestHollow.UpperTongueRetracted, Bash, Grenade=1
      WestHollow.UpperTongueRetracted, SentryJump=1
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, DoubleJump
    kii, WestHollow.FullyDrained:
      DoubleJump, Hammer OR WestHollow.UpperTongueExtended  # Grab the pole and jump on the frog statue or extend the tongue and jump on it
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, Dash
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, Hammer, Glide OR Sword OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, Sword, Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, Glide, Shuriken=2 OR Flash=2 OR Sentry=2
      WestHollow.UpperTongueExtended, WestHollow.LowerTongueExtended, Glide, Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, WestHollow.FullyDrained:
      DoubleJump, Spear=1 OR Sword
      GlideJump, DoubleJump  # the platform is a bit higher near the crystal 'even if it's broken)
      HammerJump OR FlashSwap OR BlazeSwap=1 OR SentrySwap=1 # land on the narrow ledge next to the spikes
      Bash, Grenade=2  # the placement of the grenade is different depending on how the tongues are oriented, but it's always doable.
      WestHollow.UpperTongueExtended, Dash OR Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1 OR GlideJump
  conn WestHollow.RockPuzzle:
    moki, WestHollow.FullyDrained: DoubleJump OR Dash  # Launch redundant with going to HollowDrainMiddle first
    gorlek, WestHollow.FullyDrained:
      SwordSJump=1  # sword sjump works fine with the upper tongue extended
      WestHollow.UpperTongueRetracted, HammerSJump=1
      Damage=10
    kii, WestHollow.FullyDrained:
      Hammer OR Shuriken=1
      Glide, Sword OR Flash=1 OR Sentry=1
    unsafe: WestHollow.FullyDrained, Sword OR Flash=1 OR Sentry=1 OR FlashSwap OR BlazeSwap=1 OR GlideJump OR GrenadeJump OR PauseHover
  conn WestHollow.AboveJumppad:
    moki, WestHollow.FullyDrained: WestHollow.LowerTongueExtended OR Launch OR Glide OR DoubleJump OR Dash
    gorlek: WestHollow.FullyDrained

anchor WestHollow.AboveJumppad at -207, -4304:  # At the ledge above the jumppad at the bottom of the drain sequence
  tprestriction:
    moki: WestHollow.FullyDrained  # It's possible to tp from there before pulling the first lever, but that would make that spawn softlockable
    gorlek: free

  state WestHollow.LowerTongueExtended:
    moki: WestHollow.FullyDrained, Bow=1
  state WestHollow.LowerTongueRetracted:  # fairly easy when doing a walljump from the right wall but it's pretty precise if aiming from the left platform hence why the state isn't in moki
    gorlek, WestHollow.FullyDrained: Bow=1, Combat=Slug OR Bash OR Damage=10
    unsafe, WestHollow.FullyDrained: Bow=1

  pickup WestHollow.HiddenEC:
    moki: WestHollow.FullyDrained, BreakWall=10

  conn WestHollow.HollowDrainLower:
    moki: WestHollow.FullyDrained
  conn WestHollow.SubmergedPlatform:  # Underwater in both water states. Opting to not use it for dirty swims, since it doesn't have a checkpoint.
  # Slime doesn't spawn if you started at this anchor but you can go under Lupo then return here for free
    moki, WestHollow.FullyDrained:
      Launch
      WestHollow.LowerTongueExtended, DoubleJump, Dash
    gorlek, WestHollow.FullyDrained:
      WestHollow.LowerTongueExtended, DoubleJump
    kii, WestHollow.FullyDrained:
      Bash, Grenade=1, WestHollow.LowerTongueRetracted  # Precise grenade angle
      WestHollow.LowerTongueExtended, Dash, Hammer OR Flash=1 OR Sentry=1
      WestHollow.LowerTongueExtended, Bash, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10  # Bash the slime to reach the tongue
    unsafe, WestHollow.FullyDrained:
      DoubleJump, TripleJump  # https://youtu.be/6BwlBv2Y4yM
      WestHollow.LowerTongueExtended, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Dash OR Bash OR GlideJump OR Damage=10 OR PauseHover  # this is extremely difficult and not fun if you can't fight the enemies. There's a small safe spot on the left of the spikes under the tongue that is useful for a lot of these paths. If you've already destroyed the rock wall, you'll have to jump on the tongue as it's extending, or do an extremely precise wall jump from below it. The tongue saves its state, so you can shoot it once to close it and then leave to refill energy. The Bash path requires you to get a slime onto the tongue and then lure a Skeeto up to follow.
      WestHollow.LowerTongueExtended, Glide, Flash=1 OR Sentry=1
      GrenadeJump, DoubleJump OR Dash OR PauseHover  # Grenade Jump from next to the spikes
      SentryJump=1 OR HammerJump
      DoubleJump, Damage=10, Hammer OR GlideJump  # climb onto the frog

anchor WestHollow.HollowDrainLower at -216, -4329:  # Next to the jumppad left of Lupo
  refill Checkpoint

  pickup WestHollow.QuickshotShard:  # middle water state can softlock this, so you have to be able to fully lower the water.
    moki, WestHollow.FullyDrained:  # DoubleJump is for lenience on the bowshot
      DoubleJump, Bow=1, Dash, Combat=2xSkeeto OR Bash
      DoubleJump, Bow=1, Launch
    gorlek, WestHollow.FullyDrained: Bow=1, Dash OR Launch
    kii, WestHollow.FullyDrained: Bow=1, WaterDash
    unsafe, WestHollow.FullyDrained: Bow=1  # bait the first crusher, use it as an elevator to the eye then bait it again and jump from it to the left
  pickup WestHollow.SwimEC:
    moki: Water
    unsafe:
      Damage=105  # 10 from slug's projectile, 80 from water, 5 from fish, 10 from spikes
      Bash, Damage=70  # 10 from slug's projectile, 60 from water
      WaterDash, Damage=50  # 10 from slug's projectile, 40 from water
  pickup WestHollow.LupoMap:
    moki, SpiritLight=150:  # All the path options here include a way to get past the enemy
      DoubleJump, Dash
      Bash  # bash off the slug
      Launch
    gorlek, SpiritLight=150:  # All the path options here include a way to get past the enemy
      DoubleJump, TripleJump OR Sword OR Hammer  # all have alternate paths from the right or from below
      SentryJump=1
    kii, SpiritLight=150:
      Sword  # Pogo the slug
      DoubleJump, Glide, Shuriken=1 OR Sentry=1 OR Flash=1  # possible without glide but added it to the path in case you bonk on the ceiling after jumping from the pole
      Dash, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, SpiritLight=150:
      DoubleJump, Spear=1 OR Flash=1 OR Sentry=1 OR PauseHover
      Dash, Spear=1 OR PauseHover
      BlazeSwap=1 OR SentrySwap=1 OR FlashSwap OR GlideJump OR GrenadeJump OR HammerJump

  conn WestHollow.TrialApproach:  # middle water state can softlock this, so you have to be able to fully lower the water.
    moki, WestHollow.FullyDrained:
      Combat=Slug+2xSkeeto, DoubleJump, Dash OR Glide
      Combat=Slug+2xSkeeto+Hornbug, Dash, Glide
      Bash, Damage=10, DoubleJump OR Dash OR Glide  # bash off the skeetos
      Water, WaterDash, Combat=Slug, Combat=Hornbug OR DoubleJump
      Water, WaterDash, Bash
      Launch
    gorlek, WestHollow.FullyDrained:
      Combat=Slug+2xSkeeto, DoubleJump OR Dash OR Glide OR Sword
      Bash  # bash off the skeetos
      SentryJump=1
    kii, WestHollow.FullyDrained:
      Hammer
      Combat=Slug+2xSkeeto, Sentry=2
    unsafe:
      WestHollow.FullyDrained, Shuriken=2 OR Blaze=3 OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
  conn WestHollow.PolesPound:
    moki: Combat=SneezeSlug OR DoubleJump OR Bash OR Launch
    gorlek: Dash
    kii: free
  conn WestHollow.AboveJumppad:
    moki: Combat=Slug OR Bash
    kii: Damage=10
  conn WestHollow.HollowDrainMiddle:  # paths which go directly because they need the checkpoint at HollowDrainMiddle for dirty swimming purposes
    unsafe:
      # Dirty Swims. All of the following contain duplicates of other paths for the purposes of softlock prevention. Middle state swim deals the most damage, so calculate damage according to that.
      Damage=90, HammerJump OR SwordSJump=1 OR HammerSJump=1 OR Launch  # Use the spikes to gain IFrames.
      Damage=90, Bow=1, Bash, Grenade=1  # The tongue saves its state incorrectly if you die while it is extending, so shoot it, die, swim back up, and then climb on it.
      Damage=90, Bow=1, Dash OR GrenadeJump OR PauseHover
      Damage=90, Bow=1, Shuriken=1, Blaze OR Spear=1 OR Glide
      Damage=90, BlazeSwap=4 OR FlashSwap
      Damage=90, DoubleJump, Bash, TripleJump OR Glide
      Damage=40, WaterDash, HammerJump OR SwordSJump=1 OR HammerSJump=1 OR Launch  # This is doable with just Water Dash, but that could cause softlocks.
      Damage=40, WaterDash, Bow=1, Bash, Grenade=1
      Damage=40, WaterDash, Bow=1, Dash OR GrenadeJump OR PauseHover
      Damage=40, WaterDash, Bow=1, Shuriken=1, Blaze OR Spear=1 OR Glide
      Damage=40, WaterDash, BlazeSwap=4 OR FlashSwap
      Damage=40, WaterDash, DoubleJump, Bash, TripleJump OR Glide
  conn WestHollow.RockPuzzle:  # Dirty Swim paths, since they can't use AboveJumppad or SubmergedPlatform. All of these paths assume that both tongues are out, just in case; there may be room for improvement.
    # for future pathfinders, I'm not sure the extended tongues have to be considered here? You cannot extend the tongues while they are inside water, if you manage to lower the water into extended tongues it seems you're past this point already and headers setting the tongues has not been considered in other places. Would need to think about what warps do to this though
    unsafe:
      Damage=90, Launch  # Use the spikes to gain IFrames.
      Damage=90, Dash, HammerJump OR SwordSJump=1 OR HammerSJump=1  # the sentry jump paths actually just use the sentries for movement, but sentry jumps are needed to prevent softlocks.  In the initial water state, dash onto SubmergedPlatform before swimming.
      Damage=40, WaterDash, HammerJump OR SwordSJump=1 OR HammerSJump=1 OR Launch  # the sentry jump paths don't actually use the sentries, but sentry jumps are needed to prevent softlocks.
      Damage=60, Bow=1, WaterDash

anchor WestHollow.TrialApproach at -155, -4298:  # after getting past the beetle, at the bottom of the shaft next to trial start
  refill Checkpoint

  conn WestHollow.TrialStart:
    moki:
      Combat=Slug, DoubleJump, Dash OR Glide
      DoubleJump, Bash  # bash off the slug
      Launch
    gorlek:
      Combat=Slug, DoubleJump OR Dash
      Bash, DoubleJump OR Dash
      Damage=10, Sword OR Hammer  # Sword or hammer solve combat requirements and easier movement
      Damage=10, Glide, Combat=Slug OR Bash
    kii:
      Sword
      Hammer, Bash OR Shuriken=1
      Glide, Bash
      Glide, Combat=Slug, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10:  # To cross the spike pit
        Combat=Slug, Damage=10, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
        Combat=Slug, Shuriken=4 OR Flash=4 OR Sentry=4
    unsafe:
      Bash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10 OR BlazeSwap=1 OR PauseHover # https://youtu.be/HP9uSoPhWUo
      Glide OR Spear=1  # https://youtu.be/g5qAXK3oz6k
  conn WestHollow.HollowDrainLower:  # middle water state can softlock this, so you have to be able to fully lower the water.
    moki: WestHollow.FullyDrained

anchor WestHollow.TrialStart at -120, -4260:  # At the Spirit Trial start
  refill Checkpoint

  pickup WestHollow.TrialHC: free
  pickup WestHollow.SpiritTrial:  # middle water state can softlock this, so you have to be able to fully lower the water.
    moki: WestHollow.TrialActivation, WestHollow.FullyDrained, DoubleJump, Dash
    gorlek: WestHollow.TrialActivation, WestHollow.FullyDrained, Dash
    unsafe: WestHollow.TrialActivation, WestHollow.FullyDrained  # Need a good corner boost in order to avoid the last pound https://youtu.be/oNV8tD0h_LQ

  conn WestHollow.TrialApproach: free

# checkpoint at -124, -4377

anchor WestHollow.PolesPound at -123, -4377:  # Checkpoint at the right of the pound on the way to dash
  refill Checkpoint

  pickup WestHollow.BelowLupoEX:
    moki:  # All the path options here include a way to get past the enemies
      DoubleJump, Dash
      Launch
    gorlek:  # All the path options here include a way to get past the enemies
      DoubleJump, TripleJump OR Sword OR Hammer
    kii:
      DoubleJump, Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump
      Damage=10, SwordSJump=1
      Hammer  # upswing to get onto the right side of the spikes (you can touch them)
      Dash  # max jump without hitting the spike hitbox, dash to the small ledge

  conn WestHollow.DashApproach:
    moki: DoubleJump OR Bash OR Launch OR Glide OR Dash
    gorlek: free
  conn WestHollow.HollowDrainLower:
    moki:
      Combat=Slug, DoubleJump OR Dash
      Bash, DoubleJump OR Dash
      Launch
    gorlek:
      Sword
      WaterDash, Damage=30, Combat=Slug, Hammer OR Glide  # Dboost in the water then waterdash
      WaterDash, Water, Damage=10, Combat=Slug, Hammer OR Glide
    kii:
      Hammer
      Combat=Slug, Shuriken=3 OR Sentry=4  # 2 sentries to reach the pole without a dboost
      Bash, Shuriken=3 OR Sentry=4
      Glide, Bash OR Combat=Slug:
        Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Damage=10, Spear=1
      WaterDash, Bash, Damage=30
      WaterDash, Water, Bash, Damage=10
      WaterDash, Combat=Slug, Damage=30, Shuriken=2 OR Flash=2 OR Sentry=2
      WaterDash, Water, Combat=Slug, Damage=10, Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      DoubleJump OR Dash OR PauseHover OR GlideJump OR BlazeSwap=2 OR SentrySwap=2 OR FlashSwap  # avoiding slugs is hard and might take patience
      Damage=10, Glide OR Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=20, Spear=2 OR Blaze=2
      WaterDash, Damage=10, Bash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

anchor WestHollow.DashApproach at -111, -4429:  # To the left of the lever door
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state WestHollow.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: DoubleJump OR Dash
    gorlek: Glide
    kii: free
  state WestHollow.DoorLever:  # The door blocking Dash area
  # Ennemies only spawn if you have Dash (except for the beetle which you can't use in a path because it never respawns)
    moki:
      Combat=Skeeto+Mantis+2xLizard+Hornbug, DoubleJump OR Dash
      Bash, DoubleJump OR Dash OR Grenade=1
      Launch
    gorlek: DoubleJump OR Dash OR Glide OR Sword OR HammerSJump=1
    kii: Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free

  conn WestHollow.HollowDrainLower:
  # Skeeto only spawns if you have Dash.
  # Mantis doesn't spawn if you spawned at this anchor but the trial end point is far enough to make it spawns
    moki:
      DoubleJump, Dash
      Bash, Grenade=2, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      SentryJump=3  # Possible with 2 SentryJumps
      DoubleJump, TripleJump OR Sword
      Bash, Grenade=2, Sword OR Hammer
    kii:
      DoubleJump, Glide OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # bash the mantis
      Dash, Sword OR Hammer OR Shuriken=4 OR Flash=4 OR Sentry=4  # From the starting point, both coyote dash and jumping then dashing works.
    unsafe:
      Dash  # avoiding slugs is hard and might take patience
      Sword
      Bash, PauseHover
      DoubleJump, Damage=10 OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Jump into the first spike wall or glide over it and then avoid the slugs
  conn WestHollow.DashArea:
    moki: WestHollow.DoorLever

anchor WestHollow.DashArea at -88, -4423:  # To the right of the lever door
  refill Checkpoint

  pickup WestHollow.DashTree: free

  conn WestHollow.DashApproach:
    moki: WestHollow.DoorLever
  conn WestHollow.DashCrushers:
    moki: Dash OR Launch
    unsafe: free
  conn WestHollow.AboveDashSemisolid:  # Paths going above the tree. Path passing through the crushers originate from DashCrushers. Make sure they aren't redundant.
    gorlek: SentryJump=1  # Launch would be redundant with going the long way around
    kii:
      Bash  # Bash the slug twice
      DoubleJump, TripleJump  # Jump from where the door was. Can wall jump from it if it's still closed
      WestHollow.DoorLever, DoubleJump, Sword  # Lure and pogo the mantis. Doesn't spawn if you spawned here but going under the slime is far enough to make it spawns.

anchor WestHollow.DashCrushers at -23, -4443:  # To the right of the crushers at dash tree
  refill Checkpoint

  pickup WestHollow.CrusherEX:
    moki: Dash
    gorlek: free
  pickup WestHollow.DashTree:
    moki: Dash OR Launch
    unsafe: free

  conn WestHollow.DashArea:  # Make sure it's not redundant with AboveDashTree->DashArea
    moki: Dash, Bash, Grenade=1
    gorlek: Dash, SentryJump=1
    unsafe: HammerSJump=1 OR BlazeSwap=2 OR SentrySwap=2
  conn WestHollow.DashRoomTopRight:
    moki:
      DoubleJump, Dash
      Launch
    gorlek:
      DoubleJump, TripleJump OR Sword
      Bash, Grenade=1, Dash, Glide OR Sword OR Hammer  # around the right
      Bash:  # to reach the right ledge
        SentryJump=1, Dash
        SwordSJump=1, Damage=10
        HammerSJump=1, DoubleJump
      Combat=Mantis+Lizard, SentryJump=1:  # to reach the right ledge
        SentryJump=1, Dash
        SwordSJump=1, Damage=10
        HammerSJump=1, DoubleJump
    kii:
      Bash, Grenade=2  # Bash the mantis in order to reach your grenade from higher. Bash grenade from the hanging log.
      Bash, Grenade=1, Dash, Shuriken=1 OR Flash=1 OR Damage=10  # Bash grenade from the mantis spawn position. Other energy weapons cost the same amount of energy than 2 grenades
      DoubleJump, Glide OR Hammer
      DoubleJump, Bash, Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      DoubleJump, Bash, Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Damage=10, Shuriken=3 OR Flash=3 OR Sentry=3
      DoubleJump, Shuriken=4 OR Flash=4 OR Sentry=4
      Dash, Sword OR Hammer OR Shuriken=4 OR Flash=4 OR Sentry=4
      Dash, Damage=10, Shuriken=3 OR Flash=3 OR Sentry=3
    unsafe:
      Dash  # Coyote dash to the mantis spawwn position then coyote dash again from the frinedly spikes
      DoubleJump  # Wjump on the wall on the physic object under the spikes. Might be a ceiling jump?
      Sword  # https://youtu.be/FHBXBf1NP9A
      Bash, Grenade=1  # using the enemies to bash onto the hanging log
      BlazeSwap=3 OR SentrySwap=3 OR FlashSwap

anchor WestHollow.DashRoomTopRight at -21, -4411:  # Top right of dash tree room
  refill Checkpoint

  pickup WestHollow.DashRightEX:
    moki:
      DoubleJump, Dash, Combat=WeakSlug OR Bash
      Launch
    gorlek:
      DoubleJump, Sword
      DoubleJump, Bash, TripleJump OR Glide
      DoubleJump, Combat=WeakSlug, TripleJump OR Glide
    kii:
      DoubleJump, Hammer
      DoubleJump, Combat=WeakSlug, Shuriken=1 OR Flash=1 OR Sentry=1
      Dash, Combat=WeakSlug, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump  # Bash glide of the slime. There are position where it's annoying to do but there is enough alternative to make that path work
    unsafe:
      Bash OR DoubleJump OR Dash OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
      Glide, Combat=WeakSlug, Sentry=2

  conn WestHollow.DashCrushers:
    moki: Bash OR Glide OR Launch OR DoubleJump OR Dash
    gorlek: Sword OR Hammer
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=10
    unsafe: free
  conn WestHollow.AboveDashSemisolid:
    moki:
      Glide, Combat=Hornbug+Skeeto OR Bash
      DoubleJump, Dash OR Glide
      Launch
    gorlek:
      DoubleJump OR Dash
      Bash, Sword OR Damage=10
      Combat=Hornbug, Glide OR Sword
    kii: Glide OR Sword OR Blaze=3 OR Sentry=2 OR Damage=20  # you can get a bit stuck in the spikes depending on where you land in those
    unsafe: Bash OR Hammer OR Shuriken=2 OR Damage=10 OR PauseHover OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap

anchor WestHollow.AboveDashSemisolid at -81, -4411:  # the semisolid near WestHollow.AboveDashEX
  pickup WestHollow.AboveDashEX: free

  conn WestHollow.DashArea: free
  conn WestHollow.DashRoomTopRight:  # check for redundancies with DashArea
    kii: DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # start jumping from the ledge right next to the spikes
    unsafe: WestHollow.DoorLever, Bash  # Bash the slime on the log above, use the mantis to go there too. Precise bash angle to send the slime in the spikes and bash it again after it dies. Also, the skeeto can come in the spikes area, making that path waaaaay easier

region EastHollow:
  moki: Danger=20
  gorlek: free
  kii: free
  unsafe: free

anchor EastHollow.Teleporter at -150, -4238:  # the teleporter
  # before writing any paths that use the (left) mantis or the skeeto, please remember they only spawn when the player has bash
  refill Full

  state EastHollow.VoiceDoorOpen:
    moki: EastHollow.ForestsVoice
  state NonGladesTeleporter: free

  pickup EastHollow.HornBeetleFightEX:  # for future pathfinders: these paths should probably lead through VoiceDoorPlatform?
    kii:
      Bash  # baiting the skeeto can be annoying
    unsafe:
      HammerJump
      DoubleJump, Sentry=3  # Use Sentry hops to boost the height
      GrenadeJump
      EastHollow.BeetleDefeated, DoubleJump, Dash, Spear=2  # extend your jump momentum with spear
      EastHollow.BeetleDefeated, DoubleJump, Sentry=4  # Djump+3 sentries from the vine, ceiling jump + sentry to access to the pickup

  conn Teleporters: free
  conn BeetleFight:
    moki: Combat=Skeeto+Mantis
    gorlek: free  # the enemies only spawn if you have Bash, which allows to handle them
  conn EastHollow.AfterBeetleFight:  # check for redundancies with VoiceDoorPlatform when not using the BeetleDefeated state
    # the enemies in the arena only spawn if you have Bash, which allows you to avoid them
    moki: EastHollow.BeetleDefeated, DoubleJump OR Bash OR Launch
    gorlek:
      EastHollow.BeetleDefeated OR Launch
      SentryJump=1, DoubleJump OR Dash OR Glide  # Go down to the pit, do SentryJump and the use Sword or Hammer to get to the rope
    unsafe: WaveDash, DoubleJump  # wavedash off the teleporter
  conn EastHollow.VoiceDoorPlatform:
    # for paths where the beetle is still alive, going from here is more advantageous than going from the right side
    # so paths not using EastHollow.BeetleDefeated originate primarily from here, other paths preferrably use the connection to EastHollow.AfterBeetleFight
    gorlek:
      Bash, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      SentryJump=1, DoubleJump, TripleJump
    kii:
      Bash
    unsafe:
      SwordJump, TripleJump
      HammerJump
      EastHollow.BeetleDefeated, DoubleJump, Dash, Spear=2  # extend your jump momentum with spear
      EastHollow.BeetleDefeated, DoubleJump, Sentry=3  # Djump+3 sentries from the vine
  conn WestHollow.InFrontPurpleDoorEnemyPaths:
    moki: WestHollow.PurpleDoorOpen

anchor BeetleFight at -81, -4243:
  nospawn
  refill Full

  state EastHollow.BeetleDefeated:  # Mantis and skeeto don't respawn when dying in the fight
    moki: Boss=250, Regenerate, Damage=45, Dash  # It isn't too difficult to avoid the beetle's attacks without Dash, but this is what the base game taught.
    gorlek: Boss=250, Regenerate, Damage=35, DoubleJump OR Launch
    unsafe: Boss=250

# please split the VoiceDoorPlatform and MapMoki paths like this: everything to the right of the VoiceDoor is for VoiceDoorPlatform. everything to the left of it belongs to MapMoki
anchor EastHollow.VoiceDoorPlatform at -96, -4222:  # right to the voice door
  state EastHollow.VoiceDoorOpen:
    moki: EastHollow.ForestsVoice

  # paths need to be completable with both door states if the state is not a requirement
  pickup EastHollow.HornBeetleFightEX:
    moki:
      DoubleJump, Dash, Bash
      Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump
    kii:
      DoubleJump, Hammer  # not too precise
    unsafe:
      SwordJump OR GrenadeJump
      DoubleJump, Sentry=2  # Use Sentry hops to boost the height
      EastHollow.BeetleDefeated, DoubleJump, Spear=1
      EastHollow.BeetleDefeated, DoubleJump, Sentry=1  # ceiling jump + sentry to access to the pickup

  conn EastHollow.MapMoki:
    moki: EastHollow.VoiceDoorOpen
  conn EastHollow.Teleporter:
    moki: DoubleJump OR Dash OR Glide OR Bash OR Launch
    gorlek: free
  conn EastHollow.AfterBeetleFight:  # make sure it's not redundant with ->teleporter->afterbeetlefight
    moki, EastHollow.BeetleDefeated: Glide
    gorlek:
      Bash, DoubleJump OR Dash OR Glide OR Sword
      DoubleJump, TripleJump
      DoubleJump, Dash, Glide OR Sword OR Hammer
    kii:
      Bash  # need to bait the skeeto all the way on the right which can be annoying
      Dash, DoubleJump
    unsafe:
      HammerJump

anchor EastHollow.MapMoki at -106, -4221:  # after crossing the voicelocked door above beetle fight
  refill Checkpoint

  # the VoiceDoorOpen state cannot be gained from this side, the cutscene that opens the door if you have the Voice doesn't trigger here
  quest EastHollow.HandToHandMap: free

  pickup EastHollow.GladesApproachOre:
    moki: Bash, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Bash
    kii:
      Deflector, Sword, Launch
      Deflector, Sword, DoubleJump, TripleJump OR Hammer OR Spear=1 OR Damage=10  # from the right wall or take a dboost in the left spikes
    unsafe:
      Deflector, Hammer, Launch OR DoubleJump

  conn EastHollow.VoiceDoorPlatform:
    moki: EastHollow.VoiceDoorOpen
  conn EastHollow.OutsideGlades:
    moki:
      DoubleJump, Bash
      Launch
    gorlek:
      Bash, Grenade=1, Dash
      Bash, SentryJump=1, Dash
      Bash, Damage=10
    kii:
      DoubleJump, TripleJump OR Spear=2 OR Damage=20
      DoubleJump, Damage=10, Hammer OR Spear=1  # either take a dboost to reach the first pole or climb from the right wall and take a dboost to refresh hammer's up slash
      Bash, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Blaze=3 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Grenade=1  # land near the second pole, throw a grenade, jump on the pole and immediatly jump to the grenade. Avoiding spikes damage is a bit hard.
      GrenadeJump  # gjump to grab the pole then extend pole momentum to reach the ledge above the mortar and do the same from the second pole
      DoubleJump, Hammer, Deflector  # break the wall to GladesApproachOre so you can refresh your upslash without taking a dboost
      DoubleJump, Damage=10, Sentry=1
      DoubleJump, Sword, Damage=10  # climb the left wall, pogo the mortar
      Damage=20, Hammer  # reset hammer upswings in the spikes
      DoubleJump, Dash  # right wall and some clean movement
      Hammer, Dash, Damage=10  # the 2 above together

anchor EastHollow.OutsideGlades at -152, -4164:  # Outside Grom's Wall
  state GladesTown.GromsWall:
    moki: Bash
    unsafe:
      Deflector, Sword OR Hammer  # too precise for kii
      GrenadeRedirect=1 OR SentryRedirect=1

  conn GladesTown.Teleporter:
    moki: GladesTown.GromsWall
  conn EastHollow.MapMoki: free

anchor EastHollow.AfterBeetleFight at -41, -4231:  # At the breakable floor to Bash tree
  # before writing any paths that use the (right) mantis, please remember it only spawns when the player has grapple
  # before writing any paths that use the (left) mantis or the skeeto, please remember they only spawn when the player has bash
  refill Checkpoint

  state EastHollow.VoiceDoorOpen:
    moki: EastHollow.ForestsVoice

  pickup EastHollow.SpikeLanternEX:
    moki: Bash, DoubleJump OR Launch  # there's a couple small awkward things adding up if you do this without Double Jump
    gorlek:
      Bash, Grenade=1 OR SentryJump=1
      EastHollow.BeetleDefeated, Bash, Dash OR Glide OR Sword
      SentryJump=1, DoubleJump, Damage=10, TripleJump OR Dash OR Glide OR Sword
      Launch, DoubleJump OR Dash OR Damage=10
    kii:
      Launch  # not in gorlek due to visibility problems of the walls you need to launch to
      DoubleJump, TripleJump, Dash
      Grapple, DoubleJump, Sword, Dash  # pogo the mantis
      Grapple, Bash  # Go to the right to make the mantis spawn if it's not here
      Bash, Dash  # use the mortar projectile
    unsafe:
      Grapple, DoubleJump, Sword  # pogo the mantis; too precise for kii without Dash
      DoubleJump, SentryJump=1 OR Dash
      Bash  # use the mortar projectile
      SentryJump=2  # dodge the spikes with the weapon you use to sjump
  pickup EastHollow.SecretRoofEX:
    moki:
      Bash OR Launch
      Grapple, DoubleJump, Dash OR Glide
    gorlek:
      Grapple, DoubleJump, TripleJump OR Sword OR Hammer
      Grapple, Dash
      Grapple, SentryJump=1  # use the weapon to scare the mortar away
      SentryJump=1, DoubleJump, TripleJump
      SentryJump=2
    kii:
      Grapple, DoubleJump
      Grapple, Hammer, Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Dash
    unsafe:
      Grapple, Shuriken=2
      HammerJump
      DoubleJump, SentryJump=1
      DoubleJump, TripleJump
  pickup EastHollow.MortarEX:
    moki:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek: Bash
    kii:
      DoubleJump, TripleJump, Dash, Sword OR Hammer OR Spear=1 OR Damage=10  # refresh dash on ceiling. Pogo the mortar or dboost on the left wall to get to the pickup
      Grapple, DoubleJump, TripleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1  # Grapple, tjump, upslash, one horizontal attack, energy weapon
    unsafe:
      DoubleJump, TripleJump, Dash  # using the walls and ceilings
      DoubleJump, TripleJump, Hammer  # friendly spikes after the grappl section. Tjump+hammer upslash from there
      SwordJump, TripleJump  # same as above
      # DoubleJump, TripleJump, Dash, Flash=1 OR Sentry=1  # Go just under the pickup, tjump from here+sentry/flash to reach the wall above the spikes
      SentryJump=2, Grapple
      SentryJump=3  # pogo on the last mortar
      SentryJump=4
      # SentryJump=3, DoubleJump
      # Grapple, Dash, DoubleJump, TripleJump

  conn BeetleFight: free
  conn EastHollow.AboveBash: free
  conn EastHollow.Teleporter:  # check for redundancies with VoiceDoorPlatform when using the BeetleDefeated state
    moki, EastHollow.BeetleDefeated:
      DoubleJump, Dash
      Bash, Grenade=1
      Glide
    gorlek:
      Bash, Glide
      DoubleJump, TripleJump, Glide
      DoubleJump, TripleJump, Dash, Bash OR Sword
      SentryJump=1, Glide, DoubleJump OR Dash
      Launch
      EastHollow.BeetleDefeated:
        DoubleJump, TripleJump OR Sword OR Hammer
        Dash, Sword OR Hammer
        Bash OR SentryJump=1
    kii:
      Grapple, Bash  # grapple not for use, but to spawn enemy
      DoubleJump, Bash  # Bashglide
      Grapple, DoubleJump, Sword, Glide
      DoubleJump, Sword, Spear=1  # djump+spear to reach the tp from the beetle arena
      DoubleJump, Hammer, Glide OR Sword OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, TripleJump
      SwordJump
      # DoubleJump, Sword, Shuriken=1
  conn EastHollow.VoiceDoorPlatform:
    # for paths where the beetle has to be defeated, going from here is more advantageous than going from the teleporter
    # so paths using EastHollow.BeetleDefeated originate primarily from here, other paths preferrably use the connection to EastHollow.Teleporter
    moki, EastHollow.BeetleDefeated:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek: EastHollow.BeetleDefeated, DoubleJump, TripleJump, Dash OR Glide OR Sword
    kii:
      Grapple, DoubleJump, Sword, Dash  # Pogo the mantis
      EastHollow.BeetleDefeated, DoubleJump, TripleJump, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
  conn EastHollow.Kwolok:
    moki:
      Bash, DoubleJump OR Dash OR Glide OR Launch
      Launch, DoubleJump, Dash OR Glide
      Launch, Dash, Glide
    gorlek:
      Bash OR Launch
      DoubleJump, TripleJump, Damage=10, Grapple OR SentryJump=1  # use the weapon to hover
    kii:
      DoubleJump, TripleJump, Dash
      DoubleJump, Grapple, Dash OR Glide OR Sword OR Hammer OR Sentry=3
      DoubleJump, Grapple, Sentry=2, Damage=10
      Grapple, Glide, Dash
      Grapple, Glide, Sentry=3, Damage=10
    unsafe:
      Grapple, Dash, Damage=10
      DoubleJump, Grapple, Shuriken=3
      DoubleJump, TripleJump
      DoubleJump, Dash, Damage=10, SentryJump=1
      SentryJump=3, Glide

# checkpoint at 21, -4220

anchor EastHollow.AboveBash at -10, -4244:  # Under the breakable floor after the beetle arena
  state EastHollow.DepthsLever:
    moki: Bash, DoubleJump OR Dash OR Glide OR Launch  # just Bash is treacherous
    gorlek: Bash
    kii: Deflector, Sword OR Hammer
    unsafe:
      Combat=SneezeSlug, SentryRedirect=1 OR GrenadeRedirect=1
      Launch  # launch at touch the breakable ceiling when the slug shoots so it shoots its pojectile at the ceiling
      Hammer, DoubleJump OR Dash  # Hammer onto the jumppad when the slug is shooting. DJ or Dash to stay at the ceiling longer

  pickup EastHollow.BashEC:
    moki:
      Bash, DoubleJump, Dash
      Bash, Grenade=1
      Launch
    gorlek:
      Bash, DoubleJump
      DoubleJump, TripleJump, Dash
      SwordSJump=1
      HammerSJump=1, DoubleJump OR Dash OR Glide OR Bash
    kii:
      Bash, Dash
      DoubleJump, TripleJump OR Hammer OR Spear=1
      DoubleJump, Dash, Sword OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      HammerSJump=1
      DoubleJump, Dash
      Bash
      Sword, Shuriken=1, Dash OR Shuriken=1  # shuriken pogo. Probably a lot more possibilities for the condition, such as double jump
      # Bash, Glide

  conn EastHollow.BashTreeCheckpoint:
    moki:
      Combat=2xSneezeSlug, DoubleJump OR Dash
      Bash, DoubleJump OR Dash  # just Bash is treacherous
      Glide OR Launch
    gorlek: DoubleJump OR Dash OR Bash OR Damage=10
    kii: free
  conn EastHollow.AboveDepths:
    moki, EastHollow.DepthsLever:
      Combat=2xSneezeSlug, DoubleJump OR Dash
      Bash, DoubleJump OR Dash  # just Bash is treacherous
      Glide OR Launch
    gorlek: EastHollow.DepthsLever, DoubleJump OR Dash OR Bash OR Sword OR Hammer OR Damage=10
    kii: EastHollow.DepthsLever
  conn EastHollow.AfterBeetleFight:  # Mortar break the ceiling for you
    # If you don't collect bash's tree, the camera is stuck. These paths ignore this issue.
    moki: Launch OR Bash
    gorlek:
      SentryJump=1
      DoubleJump, TripleJump
    kii: DoubleJump
    unsafe:
      Sword, Shuriken=1  # shuriken pogo from the right wall (that you reach with sword upslash)

anchor EastHollow.BashTreeCheckpoint at -7, -4325:  # Checkpoint at Bash tree
  refill Checkpoint

  pickup EastHollow.BashTree: free
  pickup EastHollow.BashEX:
    moki:
      DoubleJump, Bash
      Launch
    gorlek:
      Bash, Grenade=1, Dash OR Glide OR Sword OR Hammer
      SentryJump=1, DoubleJump, TripleJump
    kii:
      Bash, Grenade=1 OR Sword OR Hammer OR Glide OR Dash OR Flash=1 OR Sentry=1  # you can bash to the wall without any extra abilities
      DoubleJump, TripleJump
      DoubleJump, Dash, Hammer OR Sentry=2 OR Spear=2
    unsafe:
      SentryJump=1, DoubleJump OR Dash
      DoubleJump, Dash OR Hammer

  conn EastHollow.AboveBash:
    moki:
      Launch, Bash OR Hammer OR Spear=1
      Bash, Dash OR DoubleJump OR Glide
    gorlek:
      Launch  # The mortar will break the ceiling for you
      Bash, Sword
      Bash, Grenade=1, Damage=10  # Bash the slug to reach the first lantern, dboost in the spikes, grenade bash from the ledge
    kii:
      Bash, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10
      Bash, Grenade=1  # Make the slug near the door shoot at you. Bash the projectile to reach your grenade
    unsafe:
      Bash  # Bash the lantern next to the door and bait the slug to shoot at you so you can bash its projectile
      DoubleJump, TripleJump, Sword, Deflector  # sick moves
      DoubleJump, TripleJump, Dash, Sword, Spear=1  # even sicker moves

anchor EastHollow.Kwolok at 177, -4215:  # Between Ku and Kwolok
  refill Checkpoint

  quest EastHollow.ForestsVoice: free
  quest EastHollow.KwolokAmuletQuest:
    moki: EastPools.KwolokAmuletQI, WestPools.ForestsStrength

  state GladesTown.TuleySpawned:
    moki: InnerWellspring.WaterEscape

  pickup EastHollow.RightKwolokEX:
    moki: Bash OR Launch
    gorlek: SentryJump=1
    kii:
      DoubleJump, Sword, TripleJump OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # pogo the mortar
      Dash, DoubleJump, TripleJump, Hammer, Sentry=1 OR Flash=1  # Coyote Dash from high point left; Dash, Dash, DoubleJump, TripleJump, HammerUpswing, Sentry/Flash  (you end up on the left wall)
    unsafe:
      DoubleJump, Sword  # Pogo the mortar
      DoubleJump, Sword, Shuriken=1  # too precise for kii
  pickup EastHollow.SilentSwimEC:
    moki: Combat=Balloon, Water, WaterDash OR Launch
    gorlek:
      Water, WaterDash OR Launch
      Combat=Balloon, Water, DoubleJump, TripleJump, Damage=10
      Water, DoubleJump, TripleJump, Damage=20
    kii:  # Balloon will go for a swim on its own as long as you aggro it
      Water, DoubleJump, TripleJump, Damage=10
      Water, DoubleJump, Hammer, Damage=20
    unsafe:
      Water, Damage=10, DoubleJump OR SentryJump=1
      Water, DoubleJump, Hammer, Damage=10  # one extra dboost for kii
      Water, Bash, Damage=20  # Theorically possible with less damage but I don't want to check https://youtu.be/DsYMP004WTs

  pickup EastHollow.KwolokSwimOre:
    moki: Water, Bash OR Damage=10  # enemy in the way
    gorlek: Water
  pickup EastHollow.KwolokSwimLeftEX:
    moki: Water, WaterDash OR Launch
    gorlek: Water, DoubleJump, TripleJump  # Do a wrap around from the right wall
    kii:
      Water, Bash  # Bash the fish
      Water, DoubleJump, Hammer OR Spear=1  # Djump from the right wall, upswing for extra height. Use left ledge to regain upswing
    unsafe:
      Water, DoubleJump  # At left wall, with quick jumps sliding up the wall you can keepp the dj
      Water, DoubleJump, Sword  # bait the fish and pogo it
      # Water, DoubleJump, Flash=1 OR Sentry=1  # Ability to gain a bit more height. Standig on the left ledge to regain upswing after fail.
  pickup EastHollow.KwolokSwimRightEX:
    moki: Water
  pickup EastHollow.SecretRoofEX:  # this path can't get over the big spike wall from the left anchor
    gorlek: DoubleJump, TripleJump, Dash
    kii: DoubleJump, Dash OR TripleJump OR Sword OR Hammer OR Shuriken=1 OR Sentry=1
    unsafe: Dash

  conn EastHollow.AfterBeetleFight:
    moki:  # since the ability bottleneck is right at the start, most paths to the pickups on the way are covered in this connection
      Bash, DoubleJump OR Dash OR Glide
      DoubleJump, Dash OR Glide
      Dash, Glide, Damage=10
      Launch
    gorlek:
      Bash, Damage=10 OR Sword OR Hammer
      DoubleJump OR Dash OR Glide OR Sword
      Hammer, Damage=10
    kii:
      Hammer OR Sentry=3 OR Damage=20
      Bash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=10, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Sentry=2, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1
    unsafe:
      Bash OR Shuriken=2 OR Damage=10  # friendly spikes
  conn WoodsEntry.ShriekMeet:
    moki, Combat=Balloon:
      Water, Grapple, DoubleJump, Dash OR Glide
      Water, Grapple, Dash, Glide
      Water, Launch
    gorlek, Combat=Balloon:
      Water, Grapple, DoubleJump, TripleJump OR Sword OR Hammer
      Water, Grapple, Dash  # Eiher jump from the Grapple point and the Dash or use double Dash
      Water, WaterDash, DoubleJump, TripleJump
      Water, WaterDash, DoubleJump, Dash, Damage=10  # Take boost on the left side
      # @validator The path above could be using Dash OR Glide OR Sword OR Hammer instead of just Dash
    kii:
      # Repeat each moki/gorlek path without Combat=Balloon since you can just bait it into taking a swim
      Water, Launch
      Water, Grapple, Dash
      Water, Grapple, DoubleJump, Glide OR TripleJump OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, WaterDash, DoubleJump, TripleJump OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Water, WaterDash, DoubleJump, Damage=10, Dash OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      # Completely new paths
      Water, Grapple, Sword
      Water, Grapple, Hammer, Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      Water, Grapple, Glide, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, WaterDash, Bash
      Water, WaterDash, Sword, Damage=10
      Water, WaterDash, Dash, Damage=10, Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, WaterDash, Hammer, Damage=10, Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      Water, WaterDash, Glide, Damage=10, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Water, Grapple, Sentry=3
      Water, Grapple, Shuriken=2, Combat=Balloon OR Damage=20
      Water, Grapple, DoubleJump  # Cancel grapple with djump
      Water, DoubleJump, TripleJump
      Water, WaterDash, Dash, Damage=10  # coyote jump from the ledge under the grappable plant
      Water, WaterDash, Sword  # Pogo the projectile
      Water, SwordSJump=1  # probably doable with hammer as well, but it's much harder
      # Dirty Swims, probably incomplete. Stand in shallow water on the side of the first air pocket to regen. Teleport out after breaking the wall.
      WaterDash, Damage=60, Damage=110, Launch
      WaterDash, Damage=60, Damage=110, Grapple, Sentry=3 OR DoubleJump OR Dash
      WaterDash, Damage=60, Damage=110, DoubleJump, TripleJump
      WaterDash, Damage=60, Damage=110, SwordSJump=1
      WaterDash, Damage=60, Damage=110, Damage=20, Grapple, Sword  # extra damage from the balloon, regen spot below the grapple plant
      # Water, Grapple, SwordSJump=1  # standing on the ledge below grapple plant. Holding right during SJump. Swordcombo to go right. Lure balloon into water first
      # Water, Grapple, SwordSJump=1, DoubleJump OR Glide  # standing on the ledge below grapple plant. Holding right during SJump
# checkpoint at -8, -4327

anchor EastHollow.AboveDepths at 47, -4302:  # To the right of the lever door blocking Depths access
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state EastHollow.DepthsOpen:
    moki: Glide

  pickup EastHollow.BashHC:
    moki: Bash OR Launch
    gorlek:
      SentryJump=2, DoubleJump, TripleJump
      SentryJump=3
    kii: DoubleJump, TripleJump, Hammer, Spear=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, TripleJump, Hammer  # Hammer upswing to gain mor hight
  pickup EastHollow.SplinterShard: free
  pickup EastHollow.DepthsExteriorEX:
    moki: Glide, Launch  # ...what even is intended here?
    gorlek:
      Bash, Grenade=1, Launch
      SentryJump=1, Launch
      Launch, DoubleJump OR Dash  # Jump to the left wall and then go to right or you can go from the ledge next to the entry if you have DoubleJump
      Bash, Grenade=1, DoubleJump, TripleJump
    kii:
      Launch
      Bash, Grenade=1, DoubleJump  # Bait the mantis
    unsafe:
      Glide, DoubleJump, TripleJump
      Bash, Grenade=1  # Bait the mantis

  conn UpperDepths.Entry:
    moki: EastHollow.DepthsOpen
  conn EastHollow.BashTreeCheckpoint:
    moki, EastHollow.DepthsLever: Combat=SneezeSlug OR DoubleJump OR Bash OR Launch
    gorlek, EastHollow.DepthsLever: Damage=5
    kii: EastHollow.DepthsLever
  conn EastHollow.AboveBash:  # Make sure it's not redundant with paths from EastHollow.BashTreeCheckpoint
    gorlek, EastHollow.DepthsLever:
      SwordSJump=5, Dash OR Glide  # The mortar will break the ceiling for you
      SwordSJump=4, DoubleJump  # The mortar will break the ceiling for you

anchor GladesTown.Teleporter at -307, -4153:  # The glades teleporter
  refill Full

  state GladesTown.BuildHuts:
    moki: Ore=15
  state GladesTown.RoofsOverHeads:
    moki: GladesTown.BuildHuts, Ore=21
  state GladesTown.OnwardsAndUpwards:
    moki: GladesTown.RoofsOverHeads, Ore=29
  state GladesTown.ClearThorns:
    moki: Ore=23
  state GladesTown.CaveEntrance:
    moki: GladesTown.ClearThorns, Ore=29
  # decoration not accounted for

  quest GladesTown.RebuildTheGlades:
    moki: Ore=40  # Eiko told me not to modify this so orishrug ~Cosmic

  pickup GladesTown.ArcingShard:
    moki, GladesTown.ClearThorns:
      Bash, Grenade=1
      Launch
      TuleyShop.Lightcatchers, Bash, DoubleJump OR Dash OR Glide
    gorlek, GladesTown.ClearThorns:
      SentryJump=1, DoubleJump, TripleJump
      TuleyShop.Lightcatchers, Bash
    kii, GladesTown.ClearThorns:
      DoubleJump, TripleJump, Glide OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, GladesTown.ClearThorns:
      GrenadeJump
      DoubleJump, TripleJump OR Dash
  pickup GladesTown.LupoSwimMiddleEX:
    moki: Water, WaterDash OR Launch
    gorlek: Water, DoubleJump
    unsafe:
      Water OR Damage=60 # just wall jump between both walls
      WaterDash, Damage=40
  pickup GladesTown.LupoSwimLeftEX:
    moki, GladesTown.ClearThorns: Water, WaterDash OR Launch
    gorlek, GladesTown.ClearThorns: Water, DoubleJump, TripleJump
    kii, GladesTown.ClearThorns:
      Water, DoubleJump, Hammer  # wjump+djump+hammer. Possible from both walls
    unsafe, GladesTown.ClearThorns:
      Bash, Grenade=1, Water OR Damage=100  # The grenade has to be launched from the very edge of the platform
      GrenadeJump, Water OR Damage=100
      DoubleJump, Water OR Damage=100
      WaterDash, Damage=40
  # Disabled for now since seed_core applies a fix by default
  # pickup GladesTown.CaveBurrowEX:
  # unsafe: NonGladesTeleporter  # From anywhere else, TP to Glades. Then when your screen is fully white TP somewhere else.

  conn Teleporters: free
  conn GladesTown.TwillenHome: free
  conn GladesTown.UpperWest:
    moki:
      Launch, DoubleJump OR Dash OR Glide
      TuleyShop.BlueMoon, Grapple:
        Bash, Grenade=1
        Launch
        TuleyShop.Lightcatchers, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Launch
      TuleyShop.BlueMoon, Grapple:
        SentryJump=1
        TuleyShop.Lightcatchers, Bash
    unsafe:
      SentryJump=2  # from directly below the bridge
      TuleyShop.Lightcatchers, Bash, Grenade=1, Grapple  # grenadebash
      DoubleJump, TripleJump  # hardcore parkour
      GladesTown.ClearThorns, DoubleJump, Dash  # hardcore parkour 2
  conn GladesTown.BelowBountyShard:  # paths using the right platforms may want to go through AboveOpher first
    moki:
      Launch
      TuleyShop.Lightcatchers, Bash, Grenade=1
      TuleyShop.Lightcatchers, TuleyShop.StickyGrass, Bash, Grapple
    gorlek:
      DoubleJump, TripleJump
      TuleyShop.Lightcatchers, Bash, SentryJump=1
    kii:
      TuleyShop.StickyGrass, Grapple, DoubleJump, Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # get on the platform above the tp then djump+other option to rech the wall above
      Bash, Grenade=1, DoubleJump, Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # same as above but with bashnade
      Bash, Grenade=2, Dash  # throw your grenade at like 45 and dash to catch it
      TuleyShop.StickyGrass, Grapple, Bash, Grenade=1, Dash
    unsafe:
      DoubleJump, Sword  # equip sword on slot 3 so you can upslash
      Bash, Grenade=2
      #Bash, Grenade=2, Glide OR Sword OR DoubleJump
      GrenadeJump, DoubleJump OR Dash OR Sword OR Hammer
      SwordSJump=1  # high sjump to reach the wall on the left of the bridge then wall jump and upslash+downslash
      TuleyShop.StickyGrass, Grapple, DoubleJump  # ceiling jump
  conn GladesTown.AboveOpher:  # paths using the platform left above the coals may want to go to GladesTown.LeftAboveCoals first
    moki:
      Launch OR TuleyShop.SpringPlants
      Flap, Glide
      Bash, Grenade=1
    gorlek:
      SentryJump=1
      DoubleJump, TripleJump  # still works with the second huts there
    kii:
      DoubleJump, Glide OR Dash OR Sword OR Hammer OR Sentry=2  # from where Tuley is. Building the second house makes it harder but still possible
      Dash, Hammer  # coyote dash form where Tuley to the wall, then upslash+dash to reach the platform. Building the second house makes it way harder
    unsafe:
      Grenade=1, Sword  # Grenade Pogos. I'm pretty sure this is impossible once you build the second house but I won't remove the path because I wasn't the one writting it and it's unsafe
      GrenadeJump
      WaveDash  # wavedash from where Tuley is. If the second house is built, you have to jump out of your wavedash.
      Dash, GlideJump  # coyote dash form where Tuley. Building the second house makes it way harder
      Dash, Burrow  # I'm pretty sure this is impossible once you build the second house but I won't remove the path because I wasn't the one writting it and it's unsafe
  conn GladesTown.LeftAboveCoals:  # check for redundancies with AboveOpher
    moki:
      TuleyShop.BlueMoon, Grapple, DoubleJump
      TuleyShop.BlueMoon, TuleyShop.Lightcatchers, Grapple, Bash
    gorlek: TuleyShop.BlueMoon, Grapple
  conn GladesTown.LupoHouse:
    moki: Burrow OR Water
    unsafe:
      Damage=160
      WaterDash, Damage=80
  conn OpherShop: free
  conn Tokk: free
  conn TuleyShop:
    moki, GladesTown.TuleySpawned:
      DoubleJump OR Launch OR TuleyShop.SpringPlants
      Flap, Glide
      Bash, Grenade=1
    gorlek, GladesTown.TuleySpawned: SentryJump=1 OR Burrow OR Dash
    kii, GladesTown.TuleySpawned: Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, GladesTown.TuleySpawned: GrenadeJump OR GlideJump
  conn EastHollow.OutsideGlades:
    moki: GladesTown.GromsWall

# checkpoint at -297, -4139

anchor GladesTown.TwillenHome at -414, -4160:  # At Twillen in Glades
  refill Checkpoint

  quest GladesTown.HandToHandLantern:
    moki: LowerReach.HandToHandHat
  quest GladesTown.FamilyReunionKey:
    moki: GladesTown.BuildHuts

  pickup GladesTown.LowerOre:
    moki, Hammer OR Spear=1:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=1
    gorlek:
      Hammer  # hammer float
      Spear=1, Sword OR Damage=10  # sword float
    kii: Spear=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Spear=1  # tricky jump over the coals damageless
  pickup GladesTown.AboveCaveEX:
    moki: GladesTown.ClearThorns
  pickup GladesTown.KeyMokiHutEX:
    moki: GladesTown.BuildHuts, WoodsEntry.DollQI
  pickup GladesTown.DamageTree:
    moki: TuleyShop.LastTree

  conn TwillenShop: free
  conn GladesTown.AcornMoki:
    moki: GladesTown.ClearThorns
  conn GladesTown.West:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
      TuleyShop.StickyGrass, Grapple
    gorlek:
      SentryJump=1
      TuleyShop.SpringPlants, Sword OR Hammer  # upslash or uphammer
      TuleyShop.Lightcatchers, Bash
    kii: Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: free
  conn GladesTown.Teleporter:
    moki:
      Bash, Grenade=1
      GladesTown.ClearThorns OR DoubleJump OR Launch
    gorlek: SentryJump=1
    kii: Sword OR Hammer OR Spear=1 OR Damage=20
    unsafe: Dash OR Damage=10 OR GlideJump OR GrenadeJump

anchor GladesTown.West at -430, -4135:  # Path exiting the village, above Twillen
  refill Checkpoint

  quest GladesTown.HandToHandCanteen:
    moki: EastPools.HandToHandSpyglass

  pickup GladesTown.UpperOre:
    moki:
      Bash, Grenade=1, Launch
      Launch, DoubleJump  # different ways to solve this, should be fine...
      TuleyShop.StickyGrass:
        Grapple OR Launch
        Bash, Grenade=1, DoubleJump, Dash OR Glide
        Bash, Grenade=1, Dash, Glide
        TuleyShop.Lightcatchers, Bash, DoubleJump, Dash
        TuleyShop.Lightcatchers, Bash, Glide
      GladesTown.BuildHuts:  # paths using the right hut's platform may prefer to go to MotayHut
        DoubleJump, Bash, Grenade=2
        TuleyShop.StickyGrass:
          DoubleJump, Bash, Grenade=1
          TuleyShop.Lightcatchers, Bash, DoubleJump OR Dash
        TuleyShop.Lightcatchers, Bash, Grenade=1
    gorlek:
      Launch
      TuleyShop.Lightcatchers, Bash, DoubleJump, TripleJump
      TuleyShop.StickyGrass:
        Bash, Grenade=1, DoubleJump OR Glide  # glide somehow still a bit precise even though you just hold right
        SentryJump=1, DoubleJump OR Glide  # glide somehow still a bit precise even though you just hold right
        SentryJump=1, Dash
        DoubleJump, TripleJump, Hammer  # upswing to the moss
        TuleyShop.Lightcatchers, Bash, Grenade=1 OR SentryJump=1  # can still do this with the huts up
        TuleyShop.Lightcatchers, Bash, DoubleJump  # wrap around
      GladesTown.BuildHuts:  # paths using the right hut's platform may prefer to go to MotayHut
        Bash, Grenade=2
        SentryJump=2, DoubleJump
        TuleyShop.Lightcatchers, Bash, SentryJump=1
        TuleyShop.StickyGrass:
          Bash, Grenade=1, Dash OR Glide OR Sword  # hammer mildly inconsistent
          SwordSJump=1  # hammer mildly inconsistent
          TuleyShop.Lightcatchers, Bash
    kii:
      TuleyShop.Lightcatchers, Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1
      TuleyShop.StickyGrass:
        DoubleJump, TripleJump
        Bash, Grenade=1, Dash
        Bash, Grenade=1, Sword, Spear=1 OR Shuriken=1 OR Sentry=1 OR Flash=1
        TuleyShop.Lightcatchers, Bash, Sword, Spear=1 OR Shuriken=1 OR Sentry=1 OR Flash=1
        TuleyShop.Lightcatchers, Bash, Hammer, Flash  # Possible with other energy weapons but you need to be careful about not damaging the plant
    unsafe:
      SentryJump=2  # Midairs
      GladesTown.BuildHuts:  # paths using the right hut's platform may prefer to go to MotayHut
        Bash  # use both slimes
        DoubleJump, TripleJump, GlideJump
      TuleyShop.Lightcatchers, Bash, Grenade=1
      DoubleJump, TripleJump, Dash OR Glide  # using the ceiling from the left
      TuleyShop.StickyGrass, TuleyShop.Lightcatchers, Bash, Hammer OR Sword
      TuleyShop.StickyGrass, Bash, Grenade=1, Sword

  conn GladesTown.MotayHut:
    moki, GladesTown.BuildHuts:
      DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
      Grapple, TuleyShop.StickyGrass OR TuleyShop.BlueMoon
      TuleyShop.Lightcatchers, Bash
    gorlek, GladesTown.BuildHuts:
      SentryJump=1
      DoubleJump, TripleJump OR Sword OR Hammer
    kii, GladesTown.BuildHuts:
      DoubleJump, Shuriken=1 OR Sentry=2
      Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Hammer, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, GladesTown.BuildHuts:
      GrenadeJump
      Bash  # slime lure
      TuleyShop.SpringPlants, Hammer, Dash  # uphammer bounce
      Dash  # late coyote
      Sword  # high jump, full combo, upslash and then downslash (all while holding right)
      # Dash, Glide OR Sword OR Hammer
      Hammer, Glide, Blaze=1 OR Spear=1
  conn WestGlades.PastTown:
    moki:
      Bash, DoubleJump OR Dash
      Launch
    gorlek:
      Bash, Glide
      Bash, Damage=10, Sword
      Combat=2xWeakSlug, DoubleJump, TripleJump, Dash OR Glide  # the spikes here are awkward to escape from
      Combat=2xWeakSlug, DoubleJump, Dash, Glide
      Sword, DoubleJump, TripleJump OR Dash
    kii:
      Bash, Sword OR Hammer
      Bash, Damage=10, Shuriken=2 OR Flash=2 OR Sentry=2
      Dash, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
      Combat=2xWeakSlug, DoubleJump, TripleJump OR Dash
      Sword, DoubleJump, Damage=10
      Combat=2xWeakSlug, DoubleJump, Damage=20, Blaze=1 OR Damage=10
      Combat=2xWeakSlug, DoubleJump, Damage=10, Damage=10, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Combat=2xWeakSlug, DoubleJump, Damage=10, Glide OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Combat=2xWeakSlug, DoubleJump, Glide, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
      Combat=2xWeakSlug, DoubleJump, Damage=20
      SwordSJump=1, Damage=10
      HammerSJump=1, Damage=20
      Dash, Hammer
      #Dash, Sword, Damage=30  # damage depending on how often you fail the last jump (10 is minimum)
      Damage=10, Bash OR Sword
      DoubleJump, Damage=10, TripleJump OR Dash  # damage for avoiding slimes
  conn GladesTown.TwillenHome: free
  conn GladesTown.Teleporter:
    moki:
      TuleyShop.Lightcatchers, Bash, Glide
      TuleyShop.BlueMoon, Grapple
      TuleyShop.StickyGrass, Grapple, Glide
    gorlek: TuleyShop.Lightcatchers, Bash, Dash, Sword OR Hammer
    kii:
      #GladesTown.BuildHuts, Dash, Sword  # Redundant with TwillenHome -> Teleporter
      GladesTown.BuildHuts, Dash, Glide
      #GladesTown.BuildHuts, Sword, Glide, Shuriken=1 OR Flash=1 OR Sentry=1  # Redundant with TwillenHome -> Teleporter
  conn GladesTown.UpperWest:  # paths that use the huts may want to go to MotayHut first; check for redundancies with Teleporter
    moki:
      TuleyShop.StickyGrass, Launch
      TuleyShop.Lightcatchers, Bash:
        DoubleJump, Dash OR Glide
        Launch
        TuleyShop.StickyGrass, Grapple, DoubleJump
      TuleyShop.BlueMoon, Grapple, DoubleJump OR Dash OR Glide  # extra abilities because it's harder if the huts are there
    gorlek:
      # Launch already connects over the teleporter
      TuleyShop.Lightcatchers, Bash:
        DoubleJump, TripleJump OR Sword OR Hammer
        Dash, Glide OR Sword OR Hammer
        SentryJump=1, DoubleJump OR Dash
        TuleyShop.StickyGrass, Grapple, Dash
      TuleyShop.BlueMoon, Grapple, Sword OR Hammer
      TuleyShop.StickyGrass:
        DoubleJump, TripleJump, Hammer, Dash OR Glide  # upswing to the moss
        Grapple, DoubleJump, TripleJump, Dash OR Glide
    kii:
      TuleyShop.Lightcatchers, Bash:
        Glide
        Flash=1, DoubleJump OR Dash  # Would be possible with other weapons but the second plant can be destroyed
        TuleyShop.StickyGrass, Grapple, Flash=1 OR Sentry=1 OR Shuriken=1
      TuleyShop.BlueMoon, Grapple
      TuleyShop.StickyGrass:
        DoubleJump, TripleJump, Glide OR Dash OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # condition for reaching the bridge
        Grapple, DoubleJump, Dash, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Grenade=2, DoubleJump, Sword  # Midair Grenade Pogo
      TuleyShop.Lightcatchers, Bash  # Use the slimes to reach the plant above Motay then bash glide to the bridge
      TuleyShop.StickyGrass:
        DoubleJump, TripleJump
        Grapple, DoubleJump, Dash, Glide

anchor GladesTown.MotayHut at -182, -4589:  # Inside the house hovering above Motay
  # IMPORTANT this anchor is INSIDE the hut. It may only be accessed if the player has the BuildHuts state
  # however we still allow the player to spawn inside the unbuilt hut because that's fun
  # if you want to use the platform outside, use the BuildHuts state. Paths without it have to assume there is no platform
  refill Checkpoint:
    unsafe: GladesTown.BuildHuts  # Exit the house for a checkpoint

  pickup GladesTown.MotayHutEX: free
  pickup GladesTown.UpperOre:
    moki, GladesTown.BuildHuts:
      Bash, Grenade=2
      Launch
    gorlek, GladesTown.BuildHuts:
      TuleyShop.StickyGrass, TuleyShop.Lightcatchers, Bash, Glide  # holding right works
      SentryJump=2
      TuleyShop.StickyGrass, SentryJump=1
    kii, GladesTown.BuildHuts, TuleyShop.BlueMoon, Grapple, Bash, Grenade=1:  # grapple the right plant to reach the house above
      DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Dash, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      TuleyShop.StickyGrass, GrenadeJump  # you can Grenadejump as you exit the unbuilt house and grab the moss
      GladesTown.BuildHuts:
        GrenadeJump
        TuleyShop.BlueMoon, Grapple, DoubleJump, TripleJump
        TuleyShop.BlueMoon, Grapple, Bash, Grenade=1, Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR PauseHover  # grapple the right plant to reach the house above
        TuleyShop.BlueMoon, Grapple, Bash, Grenade=1, DoubleJump  # grapple the right plant to reach the house above

  conn GladesTown.West: free
  conn GladesTown.UpperWest:
    moki, GladesTown.BuildHuts:
      Bash, Grenade=2, Dash  # 1 extra grenade if you hit the Lightcatcher
      Launch
      TuleyShop.Lightcatchers, Bash, DoubleJump
    gorlek, GladesTown.BuildHuts:
      Bash, Grenade=1
      SentryJump=1, DoubleJump, TripleJump OR Dash
      TuleyShop.Lightcatchers, Bash, Dash
    unsafe, GladesTown.BuildHuts:
      GrenadeJump, DoubleJump OR Dash  # Midair Grenade Jump with auto-cancel  # dash is much harder
      SwordSJump=1, Dash
      TuleyShop.Lightcatchers, Bash, Glide OR Sword OR Hammer

anchor GladesTown.UpperWest at -357, -4126:  # Where Mokk lives
  refill Checkpoint:
    unsafe: GladesTown.OnwardsAndUpwards  # Enter the house for a checkpoint

  pickup GladesTown.ArcingShard:
    moki, GladesTown.ClearThorns:
      DoubleJump OR Dash OR Glide OR Launch
      TuleyShop.Lightcatchers, Bash  # somehow I don't think this path is very relevant
      TuleyShop.BlueMoon, Grapple
    gorlek: GladesTown.ClearThorns, Sword OR Hammer
    kii, GladesTown.ClearThorns: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  pickup GladesTown.BraveMokiHutEX:
    moki: GladesTown.OnwardsAndUpwards, DoubleJump OR Launch
    gorlek: GladesTown.OnwardsAndUpwards, SentryJump=1
    kii, GladesTown.OnwardsAndUpwards:
      Bash, Grenade=1  # drop through the floor before throwing your grenade
      Hammer
    unsafe, GladesTown.OnwardsAndUpwards:
      Sword OR Spear=1 # upslash+downslash
      GrenadeJump
  pickup GladesTown.UpperLeftEX:
    moki:
      Bash, Grenade=1
      Launch
      DoubleJump, Grapple, TuleyShop.StickyGrass OR TuleyShop.BlueMoon
    gorlek:
      SentryJump=1
      DoubleJump, TripleJump
      TuleyShop.StickyGrass, Grapple, Dash, Sword OR Hammer
    kii:
      TuleyShop.StickyGrass, Grapple, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 # Jump from the branch on the right of the grass
      TuleyShop.BlueMoon, Grapple, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: free  # https://youtu.be/3rxIf0qIUNc
      #DoubleJump
      #Sword, Grenade=1 OR Shuriken=2  # pogo
      #TuleyShop.BlueMoon, Grapple
  pickup GladesTown.AboveGromHC:
    moki:
      DoubleJump, Bash, Grenade=1
      Launch
      TuleyShop.StickyGrass, Grapple
      TuleyShop.BlueMoon, Grapple, Dash OR DoubleJump OR Glide
    gorlek:
      DoubleJump, SentryJump=1
      DoubleJump, TripleJump
      TuleyShop.BlueMoon, Grapple
    kii: Bash, Grenade=1, Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # grenade bash under GladesTown.UpperLeftEX
    unsafe:
      DoubleJump
      Bash, Grenade=1
      SentryJump=1
      Sword, Grenade=1 OR Shuriken=2  # pogo

  conn GladesTown.MotayHut:  # check for redundancies with GladesTown.West
    moki, GladesTown.BuildHuts:
      DoubleJump OR Dash OR Glide
      TuleyShop.BlueMoon, Grapple
    gorlek, GladesTown.BuildHuts: Sword OR Hammer  # Weapon Float
    kii, GladesTown.BuildHuts: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  conn GladesTown.West:  # Make sure it's not redundant with going to GladesTown.TwillenHome first
    moki:
      Dash OR Glide
      TuleyShop.BlueMoon, Grapple
    gorlek: Sword OR Hammer
  conn GladesTown.TwillenHome: free
  conn GladesTown.Teleporter:
    moki:
      Dash OR Glide
      TuleyShop.Lightcatchers, Bash
      TuleyShop.BlueMoon, Grapple
    gorlek: Sword OR Hammer
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free

anchor GladesTown.AcornMoki at -347, -4182:  # At the moki near the cave
  refill Checkpoint:
    unsafe: GladesTown.CaveEntrance  # Enter the cave for a refill
  refill Energy=4:
    moki: GladesTown.CaveEntrance, BreakCrystal

  quest GladesTown.AcornQI:
    moki, GladesTown.CaveEntrance:
      Flash, Water, Glide
      Flash, Water, DoubleJump, Dash
      Flash, Bash, Grenade=1
      Flash, Launch
    gorlek, GladesTown.CaveEntrance:
      Flash:
        Water, DoubleJump OR Dash OR Sword OR Hammer
        SentryJump=1
      Bow=4:  # bow refills light
        Launch
        Bash, Grenade=1
        SentryJump=1
    kii, GladesTown.CaveEntrance:
      Flash:
        DoubleJump, TripleJump
        Water, Shuriken=2 OR Blaze=3 OR Sentry=2
        Water, Damage=10, Shuriken=1 OR Blaze=1 OR Sentry=1 OR Spear=1
        Damage=32, Glide OR DoubleJump OR Dash OR Sword OR Hammer OR Shuriken=2 OR Blaze=3 OR Sentry=2  # That partcular water only deals 4 damage per tic
        WaterDash, Damage=16, Glide OR DoubleJump OR Dash OR Sword OR Hammer OR Shuriken=2 OR Blaze=3 OR Sentry=2
        WaterDash, Damage=26, Shuriken=1 OR Blaze=1 OR Sentry=1 OR Spear=1
        Damage=42, Shuriken=1 OR Blaze=1 OR Sentry=1 OR Spear=1
        Water, Damage=10, Damage=10
        Damage=10, Damage=42
        WaterDash, Damage=10, Damage=26
      Bow=4, DoubleJump, TripleJump
    unsafe, GladesTown.CaveEntrance:
      Flash:
        Water # use Flash for mobility as well
        GrenadeJump
      Bow=2:
        Launch
        Bash, Grenade=1
        SentryJump=1
        GrenadeJump
        DoubleJump, TripleJump  # off the left wall
        Water, WaterDash, Damage=10 OR DoubleJump OR Glide
      # Grenade=4  # grenade jumps and light refills, very nasty strat
      DoubleJump, TripleJump, Grenade=2, Water OR Damage=10  # light refills, NO GRENADE JUMPS, Small Dirty Water Dboost
      DoubleJump, TripleJump, Grenade=1, Sword, Water OR Damage=10
  quest GladesTown.MokiAcornQuest:
    moki: GladesTown.AcornQI

  pickup GladesTown.AboveCaveEX:
    moki:
      Launch OR DoubleJump
      Bash, Grenade=1
      TuleyShop.SpringPlants, Damage=10  # can avoid the dboost but just in case
    gorlek:
      SentryJump=1, Damage=10 OR GladesTown.ClearThorns
      Hammer, Dash
      TuleyShop.SpringPlants
    kii: Hammer, Glide OR Sword OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Dash
  pickup GladesTown.CaveBurrowEX:
    moki: Burrow, DoubleJump OR Launch
    gorlek: Burrow  # Burrow Dash out of the sand

  conn GladesTown.Teleporter:  # only useful for GladesDone
    moki, GladesTown.ClearThorns:
      Launch OR DoubleJump
      Bash, Grenade=1, Dash  # can't see the exit from the ground so accounting for landing near GladesTown.AboveCaveEX
      TuleyShop.SpringPlants
    gorlek, GladesTown.ClearThorns:
      Bash, Grenade=1
      Hammer, Dash
      SentryJump=1
    kii, GladesTown.ClearThorns: Hammer, Glide OR Sword OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, GladesTown.ClearThorns: Dash

anchor GladesTown.BelowBountyShard at -247, -4121:  # Bridge bellow the bounty shard
  pickup GladesTown.AboveTpEX: free
  pickup GladesTown.BountyShard:
    moki:
      Launch
      Bash, Grenade=1 OR TuleyShop.Lightcatchers
      TuleyShop.StickyGrass, Grapple, DoubleJump OR Dash OR Glide
    gorlek:
      DoubleJump, TripleJump
      SentryJump=1
      TuleyShop.StickyGrass, DoubleJump OR Grapple
    kii:
      DoubleJump, Hammer OR Spear=1 OR Sentry=1 OR Flash=1
    unsafe:
      DoubleJump
      GrenadeJump

  conn GladesTown.Teleporter: free
  conn GladesTown.LeftAboveCoals:
    moki:
      Glide
      DoubleJump, Dash
      TuleyShop.Lightcatchers, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      DoubleJump OR Dash OR Glide  # Sword is possible but TuleyShop.Lightcatchers makes is awkward
      TuleyShop.Lightcatchers, Bash
    kii: Sword OR Hammer OR Sentry=2 OR Blaze=4

anchor GladesTown.LeftAboveCoals at -239, -4136:  # On the platform hovering to the left above the coals near Opher
  pickup GladesTown.UpdraftCeilingEX:
    moki:
      DoubleJump OR Launch
      Flap, Glide  # activate the updraft below
      TuleyShop.Lightcatchers, Bash, Glide OR Dash
      TuleyShop.SpringPlants, Dash OR Glide
    gorlek:
      Hammer OR SentryJump=1
      TuleyShop.Lightcatchers, Bash
      TuleyShop.SpringPlants, Sword
    kii:
      Dash OR Spear=1  # coyote dash or spear under the pickup
      Bash, Grenade=1
      TuleyShop.SpringPlants, Sentry=3
    unsafe:
      Sword OR GrenadeJump OR GlideJump
      TuleyShop.SpringPlants, PauseHover

  conn GladesTown.Teleporter: free
  conn GladesTown.BelowBountyShard:  # check for redundancies with Teleporter
    moki: TuleyShop.Lightcatchers, Bash, DoubleJump
    gorlek:
      TuleyShop.Lightcatchers, Bash, Glide
      TuleyShop.Lightcatchers, Bash, Dash, Sword OR Hammer
    kii: TuleyShop.Lightcatchers, Bash, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      TuleyShop.Lightcatchers, Bash
      TuleyShop.SpringPlants, WaveDash  # https://youtu.be/3PvuIK07M1E  haha nice path
  conn GladesTown.AboveOpher:
    moki: DoubleJump
    gorlek: Dash OR Glide
    kii: Sword OR Hammer OR Sentry=1 OR Shuriken=1 OR Flash=1 OR Spear=1
    unsafe: Blaze=1

anchor GladesTown.AboveOpher at -212, -4133:  # On the platform above Opher
  refill Checkpoint:
    unsafe: GladesTown.RoofsOverHeads  # Enter the house for a checkpoint

  conn GladesTown.LeftAboveCoals: free
  conn GladesTown.PlayfulMoki:
    moki:
      Launch
      Flap, Glide  # Activate the updraft below
      TuleyShop.Lightcatchers, Bash
      TuleyShop.SpringPlants, DoubleJump
      GladesTown.RoofsOverHeads, Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump
      TuleyShop.SpringPlants, Hammer OR Sword
      SentryJump=1
    kii:
      Bash, Grenade=1
      TuleyShop.SpringPlants, Spear=1 OR Flash=1 OR Sentry=1
    unsafe:
      SwordJump OR GrenadeJump
      TuleyShop.SpringPlants, Grenade=1 OR GrenadeCancel  # increased height bounce
  conn TuleyShop:  # check for redundancies with Teleporter
    moki, GladesTown.TuleySpawned:
      Glide
      GladesTown.RoofsOverHeads, Dash
    gorlek: GladesTown.TuleySpawned, Dash, Sword OR Hammer
    kii: GladesTown.TuleySpawned, Blaze=2 OR Sentry=1 OR Flash=1 OR Shuriken=1
    unsafe: GladesTown.TuleySpawned, Spear=2
    # seed paths tbd if ever necessary

anchor GladesTown.PlayfulMoki at -210, -4122:  # At the Moki who would rather play
  conn GladesTown.HoleHut:
    moki:
      TuleyShop.SpringPlants OR DoubleJump OR Launch
      Bash, Grenade=1
      TuleyShop.BlueMoon, Grapple, Dash OR Glide
    gorlek:
      Hammer OR SwordSJump=1
      TuleyShop.BlueMoon, Grapple
    unsafe: Sword OR Dash OR Spear=1 OR Flash=1 OR Sentry=1 OR GlideJump
  conn GladesTown.AboveOpher: free
  conn TuleyShop:  # check for redundancies with AboveOpher and Teleporter
    moki: GladesTown.TuleySpawned, Dash
    gorlek: GladesTown.TuleySpawned, Sword OR Hammer
    kii: GladesTown.TuleySpawned, Blaze=1 OR Spear=1
    # seed paths tbd if ever necessary

anchor GladesTown.LupoHouse at -207, -4161:  # At the entrance of Lupo's house
  pickup GladesTown.LupoSoupEX: free
  pickup LupoShop.HCMapIcon:
    moki: SpiritLight=1200
  pickup LupoShop.ECMapIcon:
    moki: SpiritLight=1200
  pickup LupoShop.ShardMapIcon:
    moki: SpiritLight=1200
  pickup GladesTown.LupoSwimHC:
    moki: Water, Burrow
  pickup GladesTown.LupoSwimMiddleEX:  # dirty swim only, clean water paths are redundant with going to GladesTown.Teleporter first
    unsafe:
      Damage=100 # just wall jump between both walls
      WaterDash, Damage=40

  conn GladesTown.Teleporter:
    moki: Water OR Burrow
    unsafe:
      Damage=180
      WaterDash, Damage=60

anchor GladesTown.HoleHut at -214, -4111:  # The ledge below Hole Hut
  pickup GladesTown.BelowHoleHutEX: free
  pickup GladesTown.UpdraftCeilingEX:
    gorlek: Dash OR Glide
    kii: Sword

  conn GladesTown.HoleHutEntrance:
    moki, GladesTown.RoofsOverHeads:
      Bash, Grenade=1
      TuleyShop.SpringPlants OR DoubleJump OR Dash OR Launch
    gorlek, GladesTown.RoofsOverHeads: Glide OR Sword OR HammerSJump=1
    kii, GladesTown.RoofsOverHeads: Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, GladesTown.RoofsOverHeads: GrenadeJump
  conn LowerReach.VeralHome:
  # Sword, Dash, Glide, DoubleJump, Lightcatchers Bash, Grenade, Hammer, Blaze, Shuriken, Sentry, and Flash can all individually get you from branch to reachpath
    moki:
      Launch, DoubleJump OR Dash OR Glide  # Can go either to the right wall or through the semisolid branch
      Launch, Grapple, TuleyShop.BlueMoon OR TuleyShop.StickyGrass
      TuleyShop.SpringPlants, Launch
      TuleyShop.BlueMoon, Grapple, DoubleJump OR Dash
      TuleyShop.StickyGrass, Grapple, DoubleJump OR Dash
      TuleyShop.Lightcatchers, TuleyShop.BlueMoon, Bash, Grapple
      TuleyShop.Lightcatchers, TuleyShop.StickyGrass, Bash, Grapple, Glide
    gorlek:
      Launch
      DoubleJump, TripleJump
      SentryJump=1  # Weapon Float, works from a standing sjump on the ledge
      TuleyShop.BlueMoon, Grapple, Glide OR Sword OR Hammer
      TuleyShop.StickyGrass, Grapple, Glide OR Sword
    kii:
      DoubleJump, Hammer
      TuleyShop.BlueMoon, Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      TuleyShop.StickyGrass, Grapple, Hammer OR Shuriken=3 OR Flash=3 OR Sentry=3
      TuleyShop.SpringPlants, TuleyShop.StickyGrass, Grapple, Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      GrenadeJump
      TuleyShop.BlueMoon, Grapple, Blaze=1
      TuleyShop.SpringPlants, Hammer  # Uphammer Bounce
      TuleyShop.StickyGrass, Grapple, Sword OR Hammer OR Blaze=1 OR Shuriken=1 OR Sentry=1 OR Flash
      DoubleJump, Glide
  conn GladesTown.PlayfulMoki: free

anchor GladesTown.HoleHutEntrance at -229, -4094:  # At the door of the 2 pickup house
  refill Checkpoint:
    unsafe: GladesTown.RoofsOverHeads  # Enter the house for a checkpoint

  pickup GladesTown.HoleHutEX:
    moki: GladesTown.RoofsOverHeads
  pickup GladesTown.HoleHutEC:
    moki: GladesTown.RoofsOverHeads

  conn GladesTown.HoleHut: free

region WestGlades:
  moki: Danger=20
  gorlek: free
  kii: free
  unsafe: free

anchor WestGlades.PastTown at -545, -4113:  # The right edge of the lower pool in WestGlades
  refill Checkpoint
  refill Energy=3:
    # paths using energy or health AFTER grabbing the refill would be invalid here because they would misrepresent the resulting health or energy
    moki, BreakCrystal:
      DoubleJump, Dash OR Glide
      Launch
    gorlek, Bow=1 OR Grenade=1:
      Water  # break the crystal from afar and jump into the water to get the energy
      Glide  # break the crystal from afar and use glide to collect the energy midair
      DoubleJump, TripleJump  # break the crystal from afar and use triple jump to collect the energy midair
    kii:
      Bow=1 OR Shuriken=1 OR Grenade=1:
        Water OR DoubleJump OR Dash OR Glide OR Hammer OR Sword
      Water OR Glide:
        Sword
        Hammer, DoubleJump OR Dash

  state GladesTown.GromsWall:
    unsafe: Bash, Launch  # https://www.youtube.com/watch?v=edSpqN0b4UY

  pickup WestGlades.GrappleEX:
    moki:
      Grapple OR Launch
      Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump
      Bash, DoubleJump, Dash
      SentryJump=1
    kii:
      Bash, Dash OR DoubleJump OR Sword
      Bash, Glide, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, WaterDash, Water, Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, WaterDash, Damage=20, Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump, Hammer
    unsafe:
      Sword  # https://youtu.be/S9-y-ZoP7sQ
      DoubleJump  # https://youtu.be/Sh6buQ1hfCc
      Bash, Bow=1  # Bow to aggro the tentacle (by hitting its mouth)
      Bash, Water OR Hammer OR Damage=40 OR GlideJump OR PauseHover
      Bash, Damage=20, WaterDash OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      GlideJump, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      GrenadeJump OR BlazeSwap=1 OR SentrySwap=1 OR FlashSwap
  pickup WestGlades.AbovePlantEX:
    moki:
      Bash, DoubleJump, Dash OR Glide
      Bash, Dash, Glide
      Water, Bash
      Launch
    gorlek:
      Bash, DoubleJump OR Dash OR Grenade=1
      Bash, WaterDash, Water OR Damage=20
      Bash, SentryJump=1, Glide
      SentryJump=1, Combat=Tentacle, DoubleJump OR Dash OR Water
      SentryJump=1, Combat=Tentacle, WaterDash, Damage=20
      SentryJump=2, Glide, Combat=Tentacle
    kii:
      Bash, Sword OR Hammer
      Bash, Glide, Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20
      DoubleJump, TripleJump, Sword  # reset jumps with sword
      Combat=Tentacle, DoubleJump, TripleJump, Hammer OR Spear=1
    unsafe:
      Bash, GlideJump OR Bow=1  # Glide jump OR Bow to aggro the tentacle (by hitting its mouth)
      DoubleJump, Sword  # Pogo the projectile to pass above the tentacle
      Combat=Tentacle, SwordSJump=1
      Combat=Tentacle, GlideJump, DoubleJump
      Combat=Tentacle, DoubleJump, Spear=2  # extend jumps momentum with spears
      # DiveLaunch, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Flap OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  pickup WestGlades.LowerPoolEX:
    moki: Water
    kii:
      Damage=80
      WaterDash, Damage=40
      Damage=60, Launch OR DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
    unsafe:
      Damage=60, Bash, Bow=1  # aggro the tentacule
      Damage=60, Flash=1 OR Sentry=1

  conn WestGlades.LowerPool:
    moki:
      Water OR Launch
      Combat=Tentacle, DoubleJump, Dash OR Glide
      Bash, DoubleJump, Dash OR Glide
    gorlek:
      Bash, DoubleJump OR Dash OR Grenade=1
      DoubleJump, Damage=10 OR Combat=Tentacle
      Dash, Damage=10 OR Combat=Tentacle
      WaterDash, Damage=20, Bash
      SentryJump=1, Glide, Bash OR Damage=10 OR Combat=Tentacle
    kii:
      Damage=80, Damage=40
      WaterDash, Damage=20, Combat=Tentacle, Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      WaterDash, Damage=20, Damage=10, Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      Bash OR Combat=Tentacle OR Damage=10:
        Sword OR Hammer
        Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Glide, Damage=20
      DoubleJump, TripleJump, Sword  # Reset jumps on first tentacle
    unsafe:
      Bash
      DoubleJump, Sword  # Pogo the projectile to pass above the tentacle
  conn WestGlades.Center:  # Make sure it's not redundant with PastTown->LowerPool->Center
    unsafe:
      SwordSJump=2, Damage=20  # defeating the enemy and sword floating
      DoubleJump, TripleJump, Dash, Water OR Combat=Tentacle
  conn GladesTown.West:
    moki:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Bash
      DoubleJump, TripleJump OR Dash
      DoubleJump, Glide, Damage=10
      SwordSJump=1
      HammerSJump=1, DoubleJump OR Dash OR Glide OR Damage=10
    kii:  # dboosts because of friendly spikes
      Sword, DoubleJump
      Sword, Dash, Spear=1 OR Shuriken=1 OR Damage=10
      Hammer, Damage=10, DoubleJump OR Dash
      Hammer, Glide, Damage=10, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      HammerSJump=1
      DoubleJump, Glide  # verified damageless
      Glide  # GlideJump
      # kii paths without the friendly spikes dboosts
      Sword, Dash
      Hammer, DoubleJump OR Dash
      Hammer, Glide, Shuriken=1 OR Flash=1 OR Sentry=1

anchor WestGlades.LowerPool at -642, -4112:  # The left edge of the lower pool in WestGlades
  pickup WestGlades.LeftOre:
    moki: Grapple, DoubleJump OR Dash OR Glide OR Launch
    gorlek:
      Grapple, Sword OR Hammer
      DoubleJump, TripleJump, Dash, Glide, Damage=10
      Bash, Grenade=1, DoubleJump, TripleJump
      Launch
    kii:
      DoubleJump, TripleJump, Bash OR Damage=20  # With Bash, use a tentacle projectile
      DoubleJump, TripleJump, Damage=10, Dash OR Glide OR Sword OR Hammer
      DoubleJump, Damage=30, Dash OR Sword OR Hammer OR Shuriken=2 OR Flash=2 OR Sentry=2
      Grapple, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, DoubleJump
      Grapple, Spear=1 OR Blaze=1 OR Damage=20
      Bash, Glide, SwordSJump=1
      DoubleJump, TripleJump, Glide OR Sword OR Hammer OR Damage=10 OR Shuriken=2 OR Sentry=2
      GrenadeJump, DoubleJump OR Dash OR SentryJump=1 OR Damage=10
      SentryJump=2
  pickup WestGlades.SwimEC:
    moki: Water
    kii:
      Damage=140
      WaterDash, Damage=60
  pickup WestGlades.LowerPoolEX:  # Only dirty swims. Clean Water is solving through the PastTown connection
    kii:
      Damage=60, DoubleJump OR Dash OR Glide OR Launch OR Bash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      WaterDash, Damage=40

  conn WestGlades.Center:
    moki:
      Bash, DoubleJump
      Launch
    gorlek:
      Bash, Dash OR Glide OR Sword OR Hammer
      Grapple, DoubleJump, TripleJump, Dash, Glide OR Sword
      SentryJump=1, DoubleJump
    kii:
      Bash, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10
      Grapple, DoubleJump, TripleJump, Dash OR Sword
      Grapple, DoubleJump, TripleJump, Glide, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash
      SwordSJump=2, Damage=20  # defeating the enemy and sword floating
      DoubleJump, TripleJump, Grapple, Hammer  # Upswing at the end of the glide
      Grapple, DoubleJump, TripleJump, Glide, Spear=1  # too hard for kii
      WaterDash, DoubleJump  # I'm so sorry to whoever have to do it in a real seed https://youtu.be/DI62eNkF18Y
  conn WestGlades.PastTown:
    moki:
      Water OR Launch
      Combat=Tentacle, DoubleJump OR Dash OR Glide
      Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Bash
      Combat=Tentacle, Sword OR Hammer
      Damage=10, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    kii:
      Combat=Tentacle OR Damage=10:
        Damage=40 OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
        Damage=20, WaterDash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

anchor WestGlades.Center at -612, -4083:  # At the middle room connecting upper and lower Glades
  refill Checkpoint

  pickup WestGlades.LeftOre:  # be sure it's not redundant with the paths from LowerPool
    kii:
      Glide, DoubleJump, TripleJump
      Glide, DoubleJump, Damage=10, Dash OR Sword OR Hammer OR Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      Glide, Damage=10, SwordSJump=1
      Glide, DoubleJump, Spear=2, Damage=10
  pickup WestGlades.RightOre:
    moki:
      Bash, DoubleJump OR Dash
      Launch
    gorlek:
      Bash, Glide OR Sword OR Hammer OR Grenade=1
      SentryJump=1, Dash
    kii:
      Bash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      Combat=Tentacle, Damage=10:
        DoubleJump, Damage=20, Sentry=1 OR Flash=1 OR Shuriken=1 OR Spear=1 OR Blaze=1
        DoubleJump, Damage=10, TripleJump OR Dash OR Sword OR Hammer OR Sentry=2 OR Flash=2 OR Shuriken=2 OR Spear=2 OR Blaze=2
        Damage=40, Dash, Sword OR Hammer OR Sentry=1 OR Flash=1 OR Shuriken=1
    unsafe:
      DoubleJump, Sword, Damage=10
      SentryJump=1  # pogo on tentacle
      Bash, Damage=10
  pickup WestGlades.LowerPoolEX:  # This path is strictly because of energy/health management
    kii:
      Damage=60

  conn WestGlades.Upper:
    moki:
      Bash, DoubleJump OR Dash OR Glide OR Grenade=1
      Launch
    gorlek:
      Bash
      SentryJump=1, DoubleJump
    kii, Combat=Tentacle, Damage=20:
      DoubleJump, Dash OR Sword
      DoubleJump, TripleJump, Flash=1 OR Sentry=1 OR Shuriken=1
      DoubleJump, Hammer, Flash=1 OR Sentry=1 OR Shuriken=1
      Dash, Hammer, Flash=1 OR Sentry=1 OR Shuriken=1
      Damage=30, Dash, Sword
  conn WestGlades.LowerPool:
    moki: Water OR Launch OR DoubleJump OR Dash OR Glide OR Bash
    gorlek: Sword OR Hammer
    kii: free
  conn WestGlades.PastTown:  # This connection is strictly because of energy/health management
    kii:
      Damage=10 OR Combat=Tentacle:
        Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20

anchor WestGlades.Upper at -618, -4054:  # At the sign that gives you directions to Wellspring, Reach, and Pools
  refill Checkpoint
  refill Health=1

  state LowerReach.BearSneezed:
    moki: Flap

  pickup WestGlades.UpperPoolEX:
    moki: Water
    unsafe:
      Damage=180
      WaterDash, Damage=80
  pickup WestGlades.RightOre:  # Be carefull it's not redundant with paths from WestGlades.Center
    moki:
      Glide, DoubleJump OR Dash
      DoubleJump, Dash
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Sword OR Hammer
      Glide, Combat=Tentacle, SentryJump=1
    kii:
      Sword OR Dash OR Sentry=6
      DoubleJump, Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      Glide, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Hammer, Combat=Tentacle, Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      Bash OR GlideJump
      Glide, Spear=1 OR Blaze=1  # too difficult for kii
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

  conn WestGlades.Center: free
  conn LowerReach.Entry:
    moki: LowerReach.BearSneezed
  conn WestGlades.MillApproach:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Bash OR Launch
      Water, WaterDash
    gorlek:
      Grapple  # grapple up to the second hook and drop down
      DoubleJump, TripleJump, Dash OR Glide OR Sword
      WaterDash, Damage=20
      SentryJump=1
    kii:
      Dash, DoubleJump, Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Spear=1
      Dash, Hammer, Shuriken=1
    unsafe:
      GrenadeJump
      Dash, DoubleJump

anchor WestGlades.MillApproach at -705, -4065:  # At the ledge of the room opening up to Wellspring. The loading here is not very smart so we place the coordinates a bit left of the autosave
  refill Checkpoint
  refill Health=1

  pickup OuterWellspring.SwimOre:
    moki, Water: Grapple OR WaterDash OR Launch
    gorlek, Water:
      Bash, Grenade=1  # stand on the spinny wheel and bash-grenade up
      SentryJump=1  # ooooor use a SentryJump
      DoubleJump, TripleJump  # ooooor just some regular jumps!
      DoubleJump, Sword OR Hammer  # oooooooooooor double jump then upslash
    kii, Water: DoubleJump, Spear=1 OR Flash=1 OR Sentry=1
    unsafe:
      Water, DoubleJump  # or just be a madman
      Water, GlideJump
      Water, Bash  # https://youtu.be/nk874rtFxUo

  conn WestGlades.ShrineArea:
    moki:
      Grapple, DoubleJump
      Grapple, Dash, Glide
      Bash, Grenade=1, DoubleJump
      Launch, Bash, Grenade=1
      Launch, DoubleJump OR Grapple
    gorlek:
      Grapple, Dash OR Glide OR Sword
      SentryJump=1, DoubleJump, TripleJump
      Launch
    kii:
      Grapple, Hammer OR Shuriken=1 OR Sentry=2
      Bash, Grenade=1  # Bash the mortar so you can reach your grenade from higher
    unsafe:
      Grapple, BlazeSwap=1 OR SentrySwap=1
      Bash
      DoubleJump, TripleJump, Sword OR Hammer
      SentryJump=1
      GrenadeJump, DoubleJump
      BlazeSwap=3 OR SentrySwap=3 OR FlashSwap
  conn WestGlades.Upper:
    moki:  # realizing the semisolid not considered for moki
      Bash, DoubleJump OR Dash OR Glide OR Grenade=1
      Grapple, DoubleJump OR Dash OR Glide
      DoubleJump, Dash, Glide
      Launch
      Water, WaterDash
    gorlek:
      Water OR DoubleJump OR Dash OR Glide OR Sword OR Damage=20  # wall jump through the semisolid
      Hammer, Bash OR Grapple
    kii:
      Bash OR Hammer OR Sentry=2
      Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Spear=2
    unsafe:
      GrenadeJump, Sentry=1 OR Flash=1 OR Blaze=1 OR Shuriken=1  # GrenadeJump
  conn OuterWellspring.EntranceDoor:
    moki:
      Launch OR Water
      DoubleJump, Grapple
      DoubleJump, Dash OR Glide
      Dash, Glide
    gorlek:
      DoubleJump OR Dash
      Damage=20, Glide OR Sword
      Bash, Grenade=1, Glide OR Sword OR Damage=20
      Bash, Grenade=2
      SentryJump=2 OR SwordSJump=1  # Air stall with hammer or sword
      HammerSJump=1, Glide OR Damage=20
    kii:
      Sword
      Damage=20, Hammer OR Sentry=2 OR Damage=20
      Bash, Grenade=1, Hammer OR Sentry=2
      Hammer, Glide OR Grapple OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Grapple OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Grenade=1, Grapple  # requires holding up
      Sentry=5  # may be kii
      Glide
      GrenadeJump, Hammer
  conn OuterWellspring.RightWallMidpoint:  # Make sure it's not redundant with paths from OuterWellspring.AboveEntranceDoor
    kii:
      Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, Bash, Grenade=1
  conn PoolsApproach.MillPathCheckpoint:
    moki, Water:
      Damage=15, Grapple, DoubleJump, Dash OR Glide  # you can make this path harder on yourself by not using the wall, but really the fail case is you taking 15 damage
      Grapple, WaterDash OR Launch
      Launch, DoubleJump, Dash
      Launch, Glide
    gorlek, Water:  # hopefully didn't go too far for gorlek?
      Grapple, DoubleJump OR Dash OR Bash OR Damage=15  # non-damage variants pretty risky
      WaterDash OR Bash:
        DoubleJump, TripleJump
        Dash OR Glide OR Sword OR Damage=15
      Launch, DoubleJump OR Dash OR Bash OR WaterDash OR Sword OR Hammer OR Damage=15
    kii, Water:
      WaterDash, Bash
      WaterDash, DoubleJump OR Hammer OR Sentry=2
      Bash, DoubleJump OR Hammer OR Sentry=2
      Launch, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Water, Launch
      Water, Bash, Hammer OR DoubleJump
      Water, Grapple, Sword
      Water, WaterDash, DoubleJump
      Water, Sword, DoubleJump OR Dash OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Pogo the tentacle's projectile

anchor WestGlades.ShrineArea at -664, -4026:
  refill Checkpoint

  pickup WestGlades.ShrineHC:
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek:
      Grapple, DoubleJump, TripleJump
      SentryJump=1
    kii:
      Bash  # Use the enemies from the shrine
      DoubleJump, TripleJump
      Grapple, DoubleJump, Hammer OR Sword OR Sentry=2
    unsafe:
      Grapple, DoubleJump, Shuriken=2
      Grapple, Hammer, Dash  # upswing after grapple plant, regaining dash when dashing into the corner/ceiling
      Grapple, Glide, PauseHover
      GlideJump, PauseHover  # Climb the right wall and then glide across.
      GrenadeJump, DoubleJump
      GrenadeJump, PauseHover, Dash OR Glide  # Grenade Jump from the shrine to maximize height, float left.
      HammerJump  # Upswing then Hammer Jump.
      DoubleJump, GlideJump  # Climb the right wall and then glide across.
      SentrySwap=2 OR BlazeSwap=2 OR FlashSwap
      Hammer, DoubleJump, SentrySwap=1 OR BlazeSwap=1
      Hammer, DoubleJump, Glide  # Climb the right wall and then glide across.

  conn GladesShrine: free
  conn WestGlades.MillApproach: free

anchor GladesShrine at -635, -4020:
  nospawn
  refill Full

  state WestGlades.CombatShrineCompleted:
    moki, Regenerate, Combat=2xCrab+Bee+3xEnergyRefill+Hornbug+2xTentacle+3xEnergyRefill+2xSpinCrab+2xBee+3xEnergyRefill+2xMantis+Tentacle+SpinCrab:
      Damage=65  # the crabs are terrifying!
      Damage=55, DoubleJump OR Dash  # these can help
      Damage=30, Launch  # if you're op, nothing's terrifying
    unsafe: Combat=2xCrab+Bee+3xEnergyRefill+Hornbug+2xTentacle+3xEnergyRefill+2xSpinCrab+2xBee+3xEnergyRefill+2xMantis+Tentacle+SpinCrab

  pickup WestGlades.CombatShrine:
    moki: WestGlades.CombatShrineCompleted

region OuterWellspring:
  moki: Danger=25
  gorlek: free
  kii: free
  unsafe: free

anchor OuterWellspring.EntranceDoor at -856, -4058:  # Outside the door where you enter the first room
  refill Checkpoint
  refill Health=1:
    gorlek: Combat=Slug
    kii: free  # barely out of sight, also past an enemy...
  refill Energy=3:
    unsafe: BreakCrystal  # pretty far to the left

  # ommited a lot of paths in moki including most bash-related paths because of how complex this place is to navigate (as in, more paths were omitted than were taken into moki...)

  state OuterWellspring.EntranceDoorOpen:  # This state normaly origin from OuterWellspring.Basement. This path is a bit specific because it can break the corruption but can't reach the anchor
    kii: BreakWall=16, Water, Damage=15, Bow OR Spear OR Shuriken OR Grenade OR Blaze  # dboost on the wheel above OuterWellspring.BasementEC and use a ranged weapon to break the corruption
  state OuterWellspring.FallingWheel:
    unsafe: BreakWall=16, Bow  # Master Sniper
  state OuterWellspring.LifeHarvestWallBroken:
    moki, BreakWall=20:
      DoubleJump, Bash OR Combat=Slug+Mantis
      Launch
    gorlek, BreakWall=20:
      DoubleJump OR Bash OR Dash OR Combat=Slug+Mantis
    kii: BreakWall=20

  pickup OuterWellspring.EntranceRoofEX:
    moki:
      DoubleJump, Grapple, Dash OR Glide
      Grapple, Launch
    gorlek:
      Grapple, DoubleJump, TripleJump
      Grapple, Dash, Hammer  # upswing into the pickup
      Launch, Bash, Grenade=1  # other launch paths are covered from the anchor above
    kii:
      Grapple, DoubleJump
      Grapple, Dash, Sword OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Grapple, Dash OR Sword
      Bash, Glide  # bash the mantis upwards and buffer glide (over and over and over)
      Bash, DoubleJump  # bash the mantis upwards and djump immediately after (over and over and over)
      SentryJump=2
      GrenadeJump, DoubleJump, TripleJump OR Dash OR PauseHover  # Use the wheel on the left.
  pickup OuterWellspring.WheelEX:
    moki: OuterWellspring.EntranceDoorOpen
  pickup OuterWellspring.BasementEC:
    moki: OuterWellspring.EntranceDoorOpen  # casual strat I guess?
    gorlek: Damage=15, DoubleJump OR Dash OR Grapple OR Glide OR Sword OR Hammer  # go around the moss wheel
    kii:
      Damage=35
      Damage=15, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Energy right after the damage boost
    unsafe:
      # Damage=15  # either jump into the spikes a bit to the left and hold left+down to get back on the moss wheel or walljump off spiked wheel
      Damage=10  # let the bee hit you and use the iframes to pass through the spikes
  pickup OuterWellspring.SwimEX:
    moki: Water
    unsafe:
      Damage=80
      WaterDash, Damage=40
      Bash, Damage=60

  conn OuterWellspring.LifeHarvestEntry:
    moki, OuterWellspring.LifeHarvestWallBroken:
      DoubleJump, Bash OR Combat=Slug+Mantis
      Launch
    gorlek, OuterWellspring.LifeHarvestWallBroken:
      DoubleJump OR Bash OR Dash OR Combat=Slug+Mantis
    kii: OuterWellspring.LifeHarvestWallBroken
  conn InnerWellspring.EntranceDoor:
    moki: OuterWellspring.EntranceDoorOpen
  conn OuterWellspring.Basement:
    moki:
      DoubleJump, Dash OR Glide
      Dash, Glide
      Grapple, Bash, DoubleJump OR Dash
      Grapple, Glide
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Sword OR Hammer OR Damage=15
      Grapple, Sword
      Grapple, Damage=15, DoubleJump OR Hammer
      Bash, DoubleJump OR Dash OR Glide OR Sword  # different ways to solve using the many bash targets around
      SwordSJump=1
      HammerSJump=1, Damage=15
    kii:
      Dash OR Bash # refresh dash on ceiling after the wheel
      Glide, Hammer OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=15
      Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=15  # full combo to reach the pole, second requirement for the jump from the wheel
      Hammer, Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15  # Upswing before the wheel, jump on the left of the wheel and energy + hover
      Grapple, Hammer OR Blaze=4 OR Sentry=2 OR Damage=15  # jump from the wheel, stall in the air then grapple the wheel on the left before hitting the spikes
      Water, Damage=15, WaterDash OR Hammer  # dboost on the wheel above OuterWellspring.BasementEC. You can land on the platform without any skills but there's a weird collision so adding another skill
      Damage=55, WaterDash
      Damage=95, Hammer
    unsafe:
      # Glide, Spear=1
      # DoubleJump, Spear=1
      Glide OR Sword OR Shuriken=5
      Grapple, Shuriken=2
      Water, Damage=15  # dboost on the wheel above OuterWellspring.BasementEC
      Damage=95  # dboost on the wheel above OuterWellspring.BasementEC
      Damage=75, Hammer # dboost on the wheel above OuterWellspring.BasementEC
  conn OuterWellspring.AboveEntranceDoor:
    moki: DoubleJump, Grapple  # save all the other ways for gorlek...
    gorlek:
      Grapple  # Grapple up using the right hanging plant
      Launch  # Launch up using left side (possible with either wheel state)
      SentryJump=1, DoubleJump, TripleJump  # Sentry Jump up to the wheel on the left side of entrance door, then jump across and use sword or hammer stall to finish
      Bash, Grenade=2, DoubleJump OR Dash  # Go up the left side; works for either wheel state
      Bash, Grenade=1, Damage=15, DoubleJump OR Dash  # As above but damage boost to get to the pole
      Bash, Grenade=3, Glide OR Damage=15  # As above but Glide needs an extra bashnade in case the wheel is down
    kii:
      Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Use the slime on the way to the basement to reach the slime on the wooden platform. Launch a grenade straight up, bash the slime to reach it.
      Bash, DoubleJump, TripleJump  # Bait the mantis on the wheel, bash it upwards and bash it again to grab the other wheel
      DoubleJump, TripleJump, Sword  # Climb the left wall. Sword to prevent softlock after breaking the wall towards the shard.
      OuterWellspring.FallingWheel, Bash OR Damage=15:  # Damage depends on where you land in the spikes
        DoubleJump OR Dash OR Sword OR Hammer
        Glide, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      OuterWellspring.FallingWheel, DoubleJump, Sword  # Reset djump by hitting the bee
      OuterWellspring.FallingWheel, DoubleJump, TripleJump, Glide OR Dash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      OuterWellspring.FallingWheel, DoubleJump, Dash, Glide OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      OuterWellspring.FallingWheel, Dash, Hammer, Glide
    unsafe:
      DoubleJump, TripleJump, Hammer  # Climb the left wall. Hammer to prevent softlock after breaking the wall towards the shard. You have to upslash before jumping
      Bash  # https://youtu.be/IhPJ6NdIu8I
      # Bash, Grenade=1, Spear=1 OR Blaze=1  # Use the slime on the way to the basement to reach the slime on the wooden platform. Launch a grenade straight up, bash the slime to reach it.
      # SentryJump=1, Bash, Grenade=1  # Throw the greande, sentry jump to it, then bash off it, on right side (do a small lure on bottom slime to get to platform)
      SentryJump=1, Damage=15, Dash OR Glide  # Slightly different methods needed for hammer vs sentry, hammer is similar to above, sword goes left side
      SwordSJump=2
      HammerSJump=2, Dash OR Glide OR Damage=15
      OuterWellspring.FallingWheel, GlideJump, Damage=10
      OuterWellspring.FallingWheel, Damage=15, Shuriken=5 OR Sentry=5
      OuterWellspring.FallingWheel, Dash, Sword  # sword hover then dash to pass the spikes
      OuterWellspring.FallingWheel, DoubleJump, TripleJump, Spear=1 OR Blaze=2
      OuterWellspring.FallingWheel, DoubleJump, Dash, Blaze=2
      OuterWellspring.FallingWheel, Dash, Hammer, Shuriken=1  # Upswing, shuriken, dash, hover
      GrenadeJump, DoubleJump, TripleJump
  conn OuterWellspring.WestDoor:  # going directly up the left wall
    gorlek:
      Bash, Grenade=2, DoubleJump, Dash OR Glide
      Bash, Grenade=3, DoubleJump
      Launch
    kii:
      Grapple
      Bash, DoubleJump, Grenade=2
      DoubleJump, TripleJump, Sword
    unsafe:
      # Bash, DoubleJump, TripleJump  # Bash the mantis from the wooden platformn, then climb
      DoubleJump, Bash OR OuterWellspring.FallingWheel
  conn WestGlades.MillApproach:
    moki:
      DoubleJump, Dash, Glide
      Bash, Grenade=1, DoubleJump, Dash OR Glide
      Bash, Grenade=1, Dash, Glide
      Bash, Grenade=2, DoubleJump OR Dash OR Glide
      Water OR Launch
    gorlek:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword
      DoubleJump, Hammer, Damage=20
      Glide, Damage=20
      SwordSJump=2
      HammerSJump=1, Glide
      HammerSJump=2, DoubleJump OR Dash OR Glide OR Damage=20
      Bash, Grenade=1, Glide
      Bash, Grenade=2, Sword OR Damage=20
    kii:
      Damage=20, Bash OR DoubleJump OR Dash OR Sword OR Hammer OR Sentry=2 OR Damage=20
      Hammer, DoubleJump OR Dash
      Dash, Glide, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Glide  # Bash glide from the slime on the wooden platform
    unsafe:
      Dash, Glide OR Sword
      Bash  # https://youtu.be/oKrKsmUBt54

anchor OuterWellspring.LifeHarvestEntry at -978, -4042:  # Checkpoint before the LifeHarvest Shard
  state OuterWellspring.LifeHarvestLeverPulled:
    moki:
      DoubleJump, Bash
      Launch
    gorlek:
      Bash, Dash
      DoubleJump
    kii:
      Glide OR Sword OR Hammer OR Dash OR Sentry=4 OR Shuriken=2
      Water, Sentry=2 OR Shuriken=1
      Damage=20, Sentry=2 OR Shuriken=1
  state OuterWellspring.LifeHarvestWallBroken:
    gorlek: ShurikenBreak=20
    unsafe: SentryBreak=20

  pickup OuterWellspring.LifeHarvestShard:
    moki:
      OuterWellspring.LifeHarvestLeverPulled, DoubleJump, Bash
      Launch
    gorlek:
      Bash, Grenade=1  # this would be in moki if the camera didnt put ori right at the top of the screen, making it hard to aim/catch the grenade
      OuterWellspring.LifeHarvestLeverPulled, SentryJump=1, DoubleJump OR Dash OR Glide OR Damage=15
      OuterWellspring.LifeHarvestLeverPulled, Bash, Dash  # other options are somewhere on the border between difficulties
    kii, OuterWellspring.LifeHarvestLeverPulled, Bash:
      Glide OR Sword OR Hammer OR Sentry=4 OR Shuriken=2
      Water, Sentry=2 OR Shuriken=1
      Damage=20, Sentry=2 OR Shuriken=1
    unsafe:
      OuterWellspring.LifeHarvestWallBroken, Bash  # https://youtu.be/Lnv5ggGH69s
      DoubleJump, TripleJump OR GlideJump
      SwordJump OR HammerJump OR GlideHammerJump OR FlashSwap OR GrenadeJump  # HammerJump w/o DoubleJump possible
      Sword, Shuriken=2  # Double Shuriken pogo
      #Sentry=1, Regenerate, Dash  # RegenSentryDash

  conn OuterWellspring.EntranceDoor:
    moki, OuterWellspring.LifeHarvestWallBroken:
      Launch OR Bash OR Combat=Mantis+Slug
    gorlek, OuterWellspring.LifeHarvestWallBroken:
      DoubleJump OR Dash
    kii: OuterWellspring.LifeHarvestWallBroken

anchor OuterWellspring.Basement at -939, -4114:  # Next to the corruption opening the entrance
  state OuterWellspring.EntranceDoorOpen:
    moki: BreakWall=16

  pickup OuterWellspring.BasementEC:
    moki: Water
    gorlek: Bash, DoubleJump, TripleJump, Grapple
    kii:
      Damage=80
      Damage=40, WaterDash OR DoubleJump OR Dash
      Bash, Damage=20, DoubleJump OR Glide  # Bash glide
      Bash, Grapple, Damage=20, Dash OR Sword
      Dash, Grapple, Damage=20, DoubleJump OR Glide OR Sword OR Hammer
      Bash, Grapple, Glide
      Bash, DoubleJump, TripleJump, Grapple OR Glide OR Dash
      Bash, DoubleJump, TripleJump, Sword # Pogo the second fish
      Bash, DoubleJump, TripleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Damage=20
      Dash, Grapple, Damage=20
      Dash, Grapple, DoubleJump, Sword
      Bash, DoubleJump, Glide OR Sword
      Bash, DoubleJump, TripleJump, Hammer OR Shuriken=1

  conn OuterWellspring.EntranceDoor:
    moki:
      Launch, OuterWellspring.EntranceDoorOpen OR DoubleJump OR Dash OR Glide OR Bash OR Grapple
      OuterWellspring.EntranceDoorOpen, Bash, DoubleJump, Grapple OR Glide
      # Use the wheel above BasementEC
      OuterWellspring.EntranceDoorOpen, Water, Grapple, Combat=WeakSlug OR Bash
      OuterWellspring.EntranceDoorOpen, Water, WaterDash, Combat=WeakSlug OR Bash
    gorlek:
      Launch, Sword OR Hammer OR Damage=15
      OuterWellspring.EntranceDoorOpen, Grapple, DoubleJump, TripleJump OR Dash  # Pass inside the wheel with the SL container
      OuterWellspring.EntranceDoorOpen, Bash, DoubleJump, TripleJump, Dash OR Sword OR Hammer  # if the bee is near using hammer might get you hit, but then you can also use Bash on the bee
      OuterWellspring.EntranceDoorOpen, Bash, DoubleJump, Dash, Sword OR Hammer
      OuterWellspring.EntranceDoorOpen, Bash, Damage=15, DoubleJump # Can be done without damage by bashing the bee but it can just decide to hit spikes
      OuterWellspring.EntranceDoorOpen, Bash, Damage=15, Dash, Glide
      SwordSJump=1, DoubleJump, TripleJump, Grapple OR Bash  # redundant with simpler hammer paths
      HammerSJump=1, DoubleJump, Grapple OR Bash
      HammerSJump=1, DoubleJump, Damage=15, Dash
      HammerSJump=1, DoubleJump, Damage=15, Glide, Sword
      SentryJump=1, DoubleJump, TripleJump, Dash, Glide
      SentryJump=1, DoubleJump, TripleJump, Damage=15
      # technically there might be bashgrenade paths here because currently logically one grenade does not break the corruption but I'd rather make one grenade break the corruption logically than write bashgrenade paths here
    kii:
      Launch
      DoubleJump, TripleJump, Grapple, Combat=2xWeakSlug
      DoubleJump, TripleJump, Bash, Grenade=1
      OuterWellspring.EntranceDoorOpen, Grapple, Combat=WeakSlug OR DoubleJump OR Dash
      OuterWellspring.EntranceDoorOpen, Bash, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      OuterWellspring.EntranceDoorOpen, Water, Bash  # Bash the fish to grab the wheel above Basement EC
      OuterWellspring.EntranceDoorOpen, WaterDash, Combat=WeakSlug, Water OR Damage=20:
        Damage=15, DoubleJump OR Dash OR Sword OR Hammer
        DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
        Dash, Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
        Glide, Hammer
    unsafe:
      Grapple, DoubleJump, Combat=WeakSlug OR Bash
      Damage=15, Water, WaterDash OR Bash OR SwordSJump=1  # Use the wheel above BasementEC. walljump after the damage to regrab the wheel and use the iframes to pass the spikes.
      OuterWellspring.EntranceDoorOpen, Bash OR Grapple
      OuterWellspring.EntranceDoorOpen, SwordSJump=1, Water OR Damage=60
      OuterWellspring.EntranceDoorOpen, WaterDash, Combat=WeakSlug, Damage=15, Water OR Damage=20  # Jump from the small ground on the wheels opening
      OuterWellspring.EntranceDoorOpen, WaterDash, Combat=WeakSlug, Blaze=2, Water OR Damage=20

anchor OuterWellspring.AboveEntranceDoor at -837, -4026:  # at the crystal above the entrance door
  refill Energy=3:
    moki: BreakCrystal

  pickup OuterWellspring.EntranceRoofEX:
    moki: DoubleJump, Launch, Dash OR Glide
    gorlek: Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    unsafe: Launch
  pickup OuterWellspring.RightWallEC:  # Be carefull it's not redundant with AboveEntranceDoor->EastDoor->RightWallEC
    gorlek: BreakWall=20, DoubleJump, TripleJump, Damage=15  # go above the wheel to the right, damage not mandatory
    kii: BreakWall=20, DoubleJump, TripleJump

  conn OuterWellspring.EastDoor:  # going to the right
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Launch
    gorlek: Grapple, DoubleJump, TripleJump OR Sword OR Hammer
    kii:  # Grapple paths are covered by AboveEntranceDoor->RightWallMidpoint->TrialApproach->EastDoor
      DoubleJump, TripleJump, Bash
    unsafe:
      Bash, Grenade=2
      Bash, DoubleJump
      SentryJump=1, DoubleJump, Damage=15, Dash OR Glide
      SentryJump=1, Bash, Grenade=1, DoubleJump
      SentryJump=2, Bash, Grenade=1, Glide, Dash
  conn OuterWellspring.WestDoor:  # going to the left
    moki:
      Grapple, DoubleJump, Dash
      Grapple, Glide
    gorlek:
      Grapple, DoubleJump OR Dash OR Glide OR Sword OR HammerSJump=1 OR Damage=15  # depending on the spikes you hit, you may take 10 or 15 damage oriShrug
      Grapple, Bash, Grenade=1
      DoubleJump, TripleJump  # climb the far left wall
      Bash, Grenade=1, DoubleJump, Dash, Glide
      Bash, Grenade=2, DoubleJump, Dash OR Glide
      Bash, Grenade=3, DoubleJump
    kii:
      Grapple, Hammer OR Blaze=4 OR Sentry=2
    unsafe:
      # Bash, Grenade=1, DoubleJump
      Grapple, Shuriken=2
      DoubleJump, Bash OR Dash
  conn OuterWellspring.RightWallMidpoint:
    moki: Grapple
    gorlek:
      DoubleJump, Bash OR Glide
      DoubleJump, TripleJump, Damage=15  # go above the wheel to the right, damage not mandatory
      DoubleJump, Dash, Sword
      Bash, Grenade=1, Glide
      Bash, Grenade=2, Dash OR Sword
      SentryJump=2, Glide
      SwordSJump=2, DoubleJump OR Dash
      SentryJump=1, Dash, Glide
    kii:
      Bash, Grenade=1
      DoubleJump, TripleJump
      DoubleJump, Sword, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Spear=1
      DoubleJump, Dash, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, Bash OR Glide OR Sword OR Blaze=6 OR Sentry=4  # Drop from the wheel above the wooden platform
    unsafe:
      Glide
      DoubleJump, Hammer, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Dash, Hammer, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # Drop from the wheel above the wooden platform
      Sword, Shuriken=1  # Pogo the energy cristal to grab the wheel
  conn WestGlades.MillApproach:  # check for redundancies with EntranceDoor and RightWallMidpoint
    gorlek: Glide
  conn OuterWellspring.EntranceDoor: free

anchor OuterWellspring.WestDoor at -892, -3992:  # Outside the door where you exit the first room
  refill Checkpoint

  # the wheel is only a shortcut, at least in moki doesn't open up anything new
  state OuterWellspring.WestDoorBlueMoonFree:
    moki: BreakWall=3, Launch
    gorlek, BreakWall=3, Bow OR Spear OR Shuriken OR Grenade OR Blaze OR Grapple:  # // TODO account for this kind of syntax
      Bash, Grenade=1
      SentryJump=1
    kii, BreakWall=3:
      Bash, Grenade=1
      DoubleJump, TripleJump, Grapple  # grapple the plant on the left  then tjump to the right to be in range of the plnt inside the corruption
    unsafe, BreakWall=3:
      Bow
      DoubleJump, Grapple  # grapple the plant on the left, hold up to make it appear on screen

  pickup OuterWellspring.HiddenHC:
    moki, OuterWellspring.WestDoorBlueMoonFree:
      Grapple, DoubleJump, Dash OR Glide
      Grapple, Dash, Glide
      Grapple, Launch
    gorlek:
      OuterWellspring.WestDoorBlueMoonFree:
        Grapple, DoubleJump, TripleJump OR Damage=15
        Grapple, Damage=15, Dash OR Glide
      Grapple, Launch
      Grapple, Bash, Grenade=1, DoubleJump, TripleJump OR Glide OR Damage=15
      Grapple, Bash, Grenade=1, Damage=15, Dash OR Glide
      Grapple, SentryJump=1, DoubleJump, TripleJump OR Glide OR Damage=15
      Grapple, SentryJump=1, Damage=15, Dash OR Glide
      Bash, Grenade=1, Launch
      SentryJump=1, Launch
    kii:
      Grapple, DoubleJump, TripleJump
      Grapple, Bash, Grenade=1:
        DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Hammer, DoubleJump OR Dash OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15
      Grapple, OuterWellspring.WestDoorBlueMoonFree:
        DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Hammer, DoubleJump OR Dash OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15
    unsafe:
      Grapple, DoubleJump  # grapple the plant on the left, hold up to make it appear on screen
      Grapple, OuterWellspring.WestDoorBlueMoonFree, Dash OR Sword
      Grapple, OuterWellspring.WestDoorBlueMoonFree, Damage=15, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Grapple, Bash, Grenade=1, Damage=15, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, Bash, Grenade=1, Dash OR Glide OR Sword OR Sentry=2
      Bash, Grenade=1, SentryJump=1, DoubleJump, TripleJump

  # this tokk disappears after the needle quest
  conn InnerWellspring.WestDoor:
    moki: InnerWellspring.MiddleDoorsOpen
  conn OuterWellspring.EastDoor:  # Grapple / Launch paths are redundant with WestDoor->AboveEntranceDoor->EastDoor
    moki: Bash, Grenade=1, DoubleJump, Dash OR Glide
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump OR Sword OR Hammer
      SentryJump=1, DoubleJump
    kii:
      Bash, Grenade=1, DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Hammer, Damage=15, Shuriken=1 OR Flash=1 OR Sentry=1  # Damage boost to keep upslash for after the pole
      Bash, Grenade=1, Hammer, Shuriken=2
    unsafe: Bash, Grenade=1, Dash OR DoubleJump  # on the pole, stick to the wheel. You should get a nice curve when jumping, letting you reach the platform with your mobility option
  conn OuterWellspring.AboveEntranceDoor:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      DoubleJump, Dash, Glide
      Launch
    kii:
      Grapple  # Fall from the left
      Damage=30  # hold right, dboost on the wheel then on the spikes bellow. Should only require Damage=25 but damage depend on where you land in the spikes.
    unsafe: free  # tap right to avoid the dboost on the wheel then grab the pole while falling
  conn OuterWellspring.EntranceDoor: free

anchor OuterWellspring.EastDoor at -814, -3973:  # Outside the door leading to the spin puzzle
  refill Checkpoint

  state OuterWellspring.WestDoorBlueMoonFree:
    moki, BreakWall=3, Bow OR Spear OR Grenade:
      DoubleJump OR Dash OR Glide
      Bash, Grenade=1
      InnerWellspring.TopDoorOpen, Grapple
    gorlek: BreakWall=3  # each weapon has its way of dealing with the spikes below

  quest OuterWellspring.TheLostCompass:
    moki: InnerWellspring.NeedleQI

  pickup OuterWellspring.RightWallEC:
    moki, BreakWall=20:
      DoubleJump, Dash
      Glide OR Launch
      Grapple, DoubleJump OR Dash
      Grapple, Bash, Grenade=1
    gorlek, BreakWall=20:
      DoubleJump, TripleJump OR Sword
      Grapple, Sword OR Hammer
      Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer
      Bash, Grenade=2
    kii, BreakWall=20:
      Dash, Damage=15  # Coyote dash then dash again to grab the whell on the right
      DoubleJump, Bash OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # With energy weapon, grab the wheel on the right.
      Grapple, Shuriken=1 OR Blaze=2 OR Sentry=2
      Bash, Grenade=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe, BreakWall=20:
      Dash
      DoubleJump, Shuriken=1 OR Blaze=1
      Bash, Grenade=1, Damage=15

  conn InnerWellspring.EastDoor:
    moki: InnerWellspring.MiddleDoorsOpen
  conn OuterWellspring.AboveWestDoor:
    moki:
      InnerWellspring.TopDoorOpen, Grapple OR Launch
      InnerWellspring.TopDoorOpen, Bash, Grenade=1, DoubleJump
      Bash, Grenade=1, Launch
    gorlek:
      InnerWellspring.TopDoorOpen:
        SwordSJump=1
        HammerSJump=1, DoubleJump OR Dash OR Glide OR Damage=10
        Bash, Grenade=1, Dash OR Glide OR Sword
        Bash, Grenade=1, Hammer, Damage=10
      Bash, Grenade=1, DoubleJump, TripleJump
      Bash, Grenade=1, Grapple
    kii:
      InnerWellspring.TopDoorOpen, Bash, Grenade=1, Hammer OR Blaze=4 OR Sentry=2
      DoubleJump, Grapple
    unsafe:
      InnerWellspring.TopDoorOpen, Bash, Grenade=1, Damage=25
      InnerWellspring.TopDoorOpen, Bash, Grenade=1, Damage=15, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # These aren't kii because it's easy to get stuck in those spikes
      Grapple, Damage=15
  conn OuterWellspring.WestDoor:
    moki: DoubleJump OR Dash OR Launch
    gorlek: Glide OR Sword OR Hammer
    unsafe: free
  conn OuterWellspring.TrialApproach:
    moki: Grapple OR Launch
    gorlek:
      DoubleJump, Glide
      DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Damage=15  # Damage depends on where you land in the spikes, some deal only 10
      DoubleJump, TripleJump, Bash, Grenade=1
      DoubleJump, Dash, Sword OR Hammer OR Damage=15  # Damage depends on where you land in the spikes
      DoubleJump, Dash, Bash, Grenade=1
      SentryJump=2  # follow up the second sentryjump with a weapon hover
      Bash, Grenade=2, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    kii:
      DoubleJump, Dash OR Sword
      DoubleJump, TripleJump, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Dash, Damage=15, Glide OR Sword OR Hammer OR Sentry=2 OR Damage=15  # Coyote dash then dash again to grab the whell on the right
      DoubleJump, Damage=15, Hammer OR Spear=2 OR Flash=2 OR Sentry=2  # Djump+your other movement option to grab the wheel. Using 2 energy weapons because dependaing on where you land in the spikes, the knockbak might make you fall
      Bash, Grenade=1, Damage=15, Dash OR Glide OR Sword
      Bash, Grenade=1, Damage=30, Sentry=3
      Bash, Grenade=2
    unsafe:
      DoubleJump, Damage=15, Shuriken=1, Spear=1 OR Flash=1 OR Sentry=1  # Same as the Kii path, but more energy efficient
      Dash  # There's a little friendly spike area on the very edge of the platform
      GlideJump
      DoubleJump, TripleJump OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # There's a little friendly spike area on the very edge of the platform
      Bash, Grenade=1, Sentry=2, Damage=10
  conn OuterWellspring.RightWallMidpoint:
    moki: DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek:
      Sword OR Hammer
      Bash, Grenade=1
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Damage=15
  conn OuterWellspring.AboveEntranceDoor: free
  conn WestGlades.MillApproach:  # check for redundancies with RightWallMidpoint and AboveEntranceDoor
    gorlek: Damage=20

anchor OuterWellspring.AboveWestDoor at -866, -3949:  # on the platform arcing over west door
  refill Energy=3:
    moki: BreakCrystal

  pickup OuterWellspring.HiddenHC:
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Grapple, Dash, Glide
      Launch, DoubleJump OR Dash OR Grapple OR Glide
    gorlek:
      Grapple, DoubleJump, TripleJump OR Damage=15
      Grapple, Damage=15, Dash OR Glide
      DoubleJump, TripleJump, Dash, Glide OR Sword
      DoubleJump, TripleJump, Glide, Damage=15
      Launch, Sword OR Damage=15
    kii:
      Grapple, Hammer, DoubleJump OR Dash OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15
      Grapple, DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Grapple, Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Sword  # horizontal sword combo first then tjump then upslash
      DoubleJump, TripleJump, Dash, Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=15
      DoubleJump, TripleJump, Glide, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Hammer, Shuriken=1 OR Damage=15
      Bash, Grenade=1, DoubleJump, TripleJump
    unsafe:
      Grapple, DoubleJump OR Dash OR Sword
      Grapple, Damage=15, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump OR Dash
      Bash, Grenade=1, DoubleJump OR Dash  # wall jump on the small wall at the edge of where the pickup is
      Launch

  conn OuterWellspring.TopDoor:
    moki:
      Grapple OR Launch
      Bash, Grenade=1
    gorlek:
      Bash OR SentryJump=1
      InnerWellspring.TopDoorOpen, DoubleJump
    kii:
      InnerWellspring.TopDoorOpen, Dash, Sword OR Hammer
      InnerWellspring.TopDoorOpen, Spear=1
    unsafe:
      InnerWellspring.TopDoorOpen, Sword OR Dash # Pogo the energy cristal or dash ramp
  conn OuterWellspring.WestDoor:
    moki: Combat=Miner OR DoubleJump OR Dash OR Grapple OR Glide OR Launch
    gorlek: Sword OR Hammer OR Damage=15
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  conn OuterWellspring.EastDoor:  # paths with top door open seem rather pointless?
    moki:
      DoubleJump, Dash
      Glide
    gorlek:
      Damage=15, DoubleJump OR Dash OR Sword OR Hammer
      DoubleJump, TripleJump
      Dash, Sword OR Hammer
    kii:
      Dash OR Sword OR Hammer OR Blaze=4 OR Sentry=3
      Damage=15, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Blaze=3 OR Sentry=2
  conn OuterWellspring.AboveEntranceDoor: free

anchor OuterWellspring.TopDoor at -836, -3927:  # Outside the door leading to the teleporter
  state OuterWellspring.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: Grapple, DoubleJump, Dash OR Glide
    gorlek: Grapple, Dash, Glide
    kii: Grapple, Glide

  pickup OuterWellspring.UltraGrappleShard:
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek:
      SentryJump=1, DoubleJump OR Dash OR Glide  # generous extra abilities
      Grapple, DoubleJump, TripleJump OR Sword
      Grapple, Dash, Sword
    kii:
      Grapple, Glide
      Grapple, Dash, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, DoubleJump, Hammer OR Sentry=2
      Grapple, Sword, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # With spear: hover, spear, upslash
      Grapple, Hammer, Sentry=2  # upslash, two swings, sentries
    unsafe:
      Grapple, DoubleJump, Damage=15, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # Not kii because it's hard to exit the spikes
      Grapple, Blaze=1, Dash OR Sword
      Grapple, DoubleJump, Shuriken=2  # at the end, shuriken then djump then shuriken again
      SentryJump=1  # use the weapon for movement
      GrenadeJump, DoubleJump OR Dash OR PauseHover
  conn InnerWellspring.Teleporter:
    moki: InnerWellspring.TopDoorOpen
  conn OuterWellspring.EastDoor: free
  conn OuterWellspring.AboveWestDoor: free

# checkpoint at -973, -3949
# checkpoint at -969, -3910
# checkpoint at -902, -3895

anchor OuterWellspring.RightWallMidpoint at -746, -4019:  # Next to OuterWellspring.RightWallOre
  pickup OuterWellspring.RightWallOre: free

  conn WestGlades.MillApproach:
    moki: Grapple OR Glide  # Others are redundant with EntranceDoor
    gorlek:
      Sword OR Damage=20
      HammerSJump=1, DoubleJump OR Dash
      Bash, Grenade=1, DoubleJump OR Dash OR Sword
    kii:
      DoubleJump OR Dash OR Hammer OR Blaze=2 OR Sentry=2
      Bash, Grenade=1
  conn OuterWellspring.EntranceDoor:
    moki: Water OR Glide OR Launch  # Grapple paths are redundant with AboveEntranceDoor
    gorlek:
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Dash, Sword OR Hammer
      Damage=20 OR SentryJump=1
      Bash, Grenade=1
    kii: DoubleJump OR Dash OR Hammer OR Shuriken=1 OR Blaze=2 OR Sentry=2
  conn OuterWellspring.AboveEntranceDoor:
    moki:
      Grapple, DoubleJump OR Dash OR Glide OR Launch
      Launch, DoubleJump OR Dash OR Glide
    gorlek:  # Launch is redundant with EntranceDoor
      Grapple
      Bash, Grenade=1, Glide
      Bash, Grenade=1, DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Bash, Grenade=1, Dash, Sword OR Hammer
      SentryJump=1, Glide
      SwordSJump=1, DoubleJump, TripleJump OR Dash  # Weapon hover
      HammerSJump=1, DoubleJump, TripleJump, Dash  # Weapon hover
    kii:
      DoubleJump, TripleJump, Dash OR Sword
      DoubleJump, TripleJump, Glide, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1  # Bash grenade to reach the bee then bash glide from the bee to the platform with a slime
    unsafe: DoubleJump, TripleJump, Hammer
  conn OuterWellspring.EastDoor:  # Most paths from this anchor should be redundant with going to AboveEntranceDoor then EastDoor
    kii: Bash, Grenade=2  # Bash grenade to reach the bee then bash glide from the bee to the platform with a slime
  conn OuterWellspring.TrialApproach:  # no moki path because the camera makes the connection hard to see
    gorlek: Grapple, Combat=Bee OR Bash  # Launch is redundant with EntranceDoor -> AboveEntranceDoor -> EastDoor
    kii:
      Grapple
      Bash, Grenade=3  # Bash grenade to reach the bee then bash glide from the bee to the platform with a slime
      Bash, Grenade=2, Damage=15, DoubleJump OR Dash OR Glide OR Sword
      Bash, Grenade=2, Damage=30, Sentry=3
    unsafe:
      Bash, Grenade=2, Damage=15, Shuriken=1, Sentry=2  # Same as above but more energy efficient

anchor OuterWellspring.TrialApproach at -727, -3961:  # at the ledge going towards the trial room
  refill Checkpoint

  pickup OuterWellspring.RightWallEX:
    moki:
      Grapple, DoubleJump, Dash OR Glide
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      Grapple, DoubleJump, TripleJump
      SentryJump=1, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, Dash OR Glide
    kii:
      Grapple, DoubleJump OR Dash OR Glide OR Sword
      Bash, Grenade=1 OR DoubleJump OR Sword OR Hammer  # wall jump on the wall next to the SL container. Without grenade, use the beetle
    unsafe:
      Grapple  # https://youtu.be/vI511KFMZWI
  pickup OuterWellspring.RightWallEC:
    moki, BreakWall=20:
      DoubleJump, Dash
      Glide OR Launch
      Grapple, DoubleJump OR Dash
    gorlek, BreakWall=20: DoubleJump OR Dash OR Sword OR Hammer
    kii, BreakWall=20:
      Spear=2 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Damage=15, Spear=1 OR Blaze=1
      Damage=15, Bash  #land in the spikes to jump on the wheel then bash glide of the bee
    unsafe, BreakWall=20: Bash OR Spear=1 OR Blaze=1  # land on the friendly spikes, at the very edge of the spikes

  conn OuterWellspring.TrialRoom:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Grapple
      SentryJump=1
      Bash, Grenade=1
    kii:
      Bash  # Bash the beetle
      DoubleJump, TripleJump
  conn OuterWellspring.EastDoor:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Grapple OR Glide
      Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer
      DoubleJump, TripleJump OR Dash OR Sword
      DoubleJump, Hammer, Damage=15
      SentryJump=1, DoubleJump OR Dash
    kii:
      Bash, Grenade=1
      DoubleJump, Hammer OR Sentry=2 OR Damage=15
      Dash, Sword OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=15
      Damage=15, Sentry=2
    unsafe: DoubleJump OR Dash
  conn OuterWellspring.AboveEntranceDoor:
    moki: DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek:
      Sword OR Hammer
      Bash, Grenade=1
      SentryJump=1
      Damage=15
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free
  conn OuterWellspring.RightWallMidpoint:
    moki: DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek: free

anchor OuterWellspring.TrialRoom at -684, -3947:  # checkpoint on the way to trial start
  refill Checkpoint
  refill Health=1
  refill Energy=1:
    moki: BreakCrystal

  conn OuterWellspring.TrialStart:
    moki:
      Grapple, DoubleJump
      Launch
    gorlek: DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer
    kii: Dash OR Glide OR Sword OR Sentry=3
    unsafe: DoubleJump OR Shuriken=2 OR Sentry=2
  conn OuterWellspring.TrialApproach: free

anchor OuterWellspring.TrialStart at -665, -3937:
  refill Checkpoint

  pickup OuterWellspring.TrialOre: free
  pickup OuterWellspring.SpiritTrial:
    moki: OuterWellspring.TrialActivation, DoubleJump, Dash, Grapple
    gorlek: OuterWellspring.TrialActivation, Dash, Grapple, Glide
    kii: OuterWellspring.TrialActivation, Grapple, Glide

  conn OuterWellspring.TrialRoom:
    moki:
      DoubleJump, Dash OR Glide
      Grapple, Glide
      Launch
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Sword OR Hammer
      Glide
      Grapple, DoubleJump OR Dash OR Sword OR Hammer
    kii:
      Dash OR Sword
      Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Damage=30 OR DoubleJump

region InnerWellspring:
  moki: Danger=25
  gorlek: free
  kii: free
  unsafe: free

anchor InnerWellspring.EntranceDoor at -1263, -3952:  # Inside the door where you enter the first room
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state InnerWellspring.ThreeWheels:
    moki: BreakWall=3

  pickup InnerWellspring.ThreeWheelsEX:
    moki:
      Bash, Grenade=1
      Launch
      InnerWellspring.ThreeWheels
    gorlek:
      SentryJump=1
    kii:
      DoubleJump, TripleJump, Hammer
    unsafe:
      DoubleJump, TripleJump
      GrenadeJump
  pickup InnerWellspring.WaterSwitchEX:
    moki: Water, WaterDash
    unsafe: WaterDash, Damage=40, Damage=60

  conn OuterWellspring.EntranceDoor: free
  conn InnerWellspring.ThornShardArea:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      InnerWellspring.ThreeWheels, DoubleJump OR Dash OR Glide
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      Grapple, Sword OR Hammer
      InnerWellspring.ThreeWheels, Sword OR Hammer
      SentryJump=1  # sentry jump on right side, then use sword/hammer to reach platform
      DoubleJump, TripleJump
    kii:
      Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Bash grenade up right side, climb on the first wheel to reach yourgrenade (whih isn't gorlek), jump to left side vines, use abilities to reach platform
    unsafe: Bash, Grenade=1  # On the left, bash grenade on the first rotating wheel, jump on the second one and reach your grenade from there
  conn InnerWellspring.DrainRoom:
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      InnerWellspring.ThreeWheels, Grapple
      InnerWellspring.ThreeWheels, Bash, Grenade=1
    gorlek:
      Sword OR Hammer
      Bash, Grenade=1, Damage=15
      InnerWellspring.ThreeWheels, Damage=15
    kii:
      Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Damage=15, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # possible damageless but InnerWellspring.ThreeWheels makes it way harder
      InnerWellspring.ThreeWheels, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Shuriken=2 OR Blaze=3 OR Flash=2 OR Sentry=2
    unsafe:
      Bash, Grenade=1
      InnerWellspring.ThreeWheels
  conn InnerWellspring.ShortcutLever:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      DoubleJump, TripleJump, Damage=15  # bit tricky
      Grapple, Damage=15  # bit tricky
      Grapple, Sword OR Hammer
    kii: Grapple
    unsafe:
      InnerWellspring.ThreeWheels, Damage=30, DoubleJump
      InnerWellspring.ThreeWheels, Damage=45, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      InnerWellspring.ThreeWheels, Damage=60, Spear=1 OR Blaze=1

# checkpoint at -1336, -3943

anchor InnerWellspring.ThornShardArea at -1317, -3933:  # on top of the wall at the left of the entrance
  refill Checkpoint

  pickup InnerWellspring.ThornShard: free
  pickup InnerWellspring.ThornEX:  # Having Clean Water change the position of the grapplable plant. Make sure it solves with both states?
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Launch
    gorlek:
      DoubleJump, TripleJump, Damage=15
      SentryJump=1, DoubleJump, TripleJump, Dash OR Glide
      SentryJump=1, Damage=15, DoubleJump, Dash OR Glide OR TripleJump
      SentryJump=1, Damage=15, Dash, Glide
      Grapple, Damage=15, DoubleJump OR Dash OR Glide OR Sword
      Grapple, DoubleJump, TripleJump OR Sword OR Hammer
      Grapple, Dash, Glide OR Sword OR Hammer
    kii:
      Bash, Grenade=1, Dash OR DoubleJump OR Glide
      Grapple, Dash OR DoubleJump  # with djump, walljump on the wall above the grappable plant
      Grapple, Sword, Glide OR Hammer OR Spear=1 OR Shuriken=1
      Grapple, Hammer, Shuriken=1 OR Sentry=2 OR Damage=15
      Dash, DoubleJump, TripleJump OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2 OR Damage=15
      Dash, Damage=15, Sword OR Hammer  # With hammer, do only two slashes
      Dash, Glide, Damage=15, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Grenade=1, Shuriken=1 OR Flash=1 OR Sentry=1  # Use energy to reach the grenade
      Dash, DoubleJump, Sentry=1 OR Flash=1
      SwordSJump=1, Damage=15
      Grapple, Sword
      Dash, Damage=15, Glide OR Shuriken=2 OR Sentry=2

  conn InnerWellspring.EntranceDoor: free
  conn InnerWellspring.ShortcutLever:  # for fully respawn. Make sure it's not redundant with paths from EntranceDoor
    unsafe:
      Damage=30, DoubleJump
      Damage=45, Dash OR Sword OR Hammer OR Shuriken=3 OR Flash=3 OR Sentry=3
      Damage=60, Spear=3

anchor InnerWellspring.ShortcutLever at -1264, -3907:  # At the lever on top of the entrance door
  state InnerWellspring.ShortCutWheel: free

  # InnerWellspring.ShortcutWheelEX paths are redundant with InnerWellspring.WestDoor

  conn InnerWellspring.EntranceDoor:
    moki: Grapple OR Launch OR DoubleJump
    gorlek: free
  conn InnerWellspring.WestDoor:
    moki, InnerWellspring.ShortCutWheel:
      DoubleJump, Dash OR Glide
      Dash, Glide
      Launch
    gorlek, InnerWellspring.ShortCutWheel:
      DoubleJump OR Dash  # pretty tight
      Damage=15, Glide OR Sword OR Hammer
    kii, InnerWellspring.ShortCutWheel:
      Sword OR Damage=15
      Hammer, Glide OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, InnerWellspring.ShortCutWheel:
      Glide OR Hammer OR Sentry=2 OR Shuriken=2  # friendly spikes when you slide off the wheel
  conn InnerWellspring.ThornShardArea:  # Make sure it's not redundant with going to InnerWellspring.EntranceDoor first
    gorlek: DoubleJump OR Dash OR Glide OR Sword OR Hammer
    kii: Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
    unsafe: free  # grab the right moss for an easier jump onto the left one the

anchor InnerWellspring.DrainRoom at -1167, -3946:  # Left of the water you can drain
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state InnerWellspring.DrainRoomBottomWheel:  # @validator I added that state for DrainAreaExit->DrainRoom connection. Previous difficulty didn't deemed pathfinding that state was worth it so I'm not pathfinding it for kii either
    moki: InnerWellspring.ThreeWheels, BreakWall=16

  conn InnerWellspring.EntranceDoor:
    moki:
      DoubleJump OR Dash OR Grapple OR Glide OR Launch
      Bash, Grenade=1
    gorlek: free
  conn InnerWellspring.DrainRoomCenter:
    moki:
      DoubleJump, Glide
      Grapple OR Launch
      Glide, Bash, Grenade=2
      InnerWellspring.DrainRoomBottomWheel, DoubleJump
      InnerWellspring.DrainRoomBottomWheel, Dash, Bash, Grenade=1
      Water, DoubleJump  # if you drained the water, you can use the bottom of the wheel instead
      Water, WaterDash, Dash, Bash, Grenade=1  # if you drained the water, you can use the bottom of the wheel instead
    gorlek:
      # if you have a weapon here, you can break the three wheels free. Redundant paths without the three wheels state were removed.
      DoubleJump, TripleJump OR Dash OR Sword
      Dash, Glide
      Glide, Damage=15
      Bash, Grenade=1, DoubleJump OR Glide
      SentryJump=1, Glide
      InnerWellspring.DrainRoomBottomWheel:
        Dash
        Damage=15, Sword OR Hammer
        Bash, Grenade=1, Sword OR Hammer
        SentryJump=1
      InnerWellspring.DrainLever:
        DoubleJump
        Dash, Sword OR Hammer
      Water, Dash  # if you drained the water, you can use the bottom of the wheel instead
      Water, Bash, Grenade=4  # if you drained the water, you can use the bottom of the wheel instead
    kii:
      DoubleJump, Blaze=5 OR Sentry=3
      Dash, Blaze=3 OR Sentry=2
      Glide, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      InnerWellspring.DrainRoomBottomWheel, Sword OR Hammer OR Shuriken=4
      Damage=20, DoubleJump OR Dash  # dboost in dirty water after the wheel. If you drained the water, you can use the bottom of the wheel instead
      Damage=60, Bash, Grenade=3  # dboost in dirty water. If you drained the water, you can go bellow the wheel instead
      WaterDash, Damage=40, Bash, Grenade=3  # dboost in dirty water. If you drained the water, you can use the bottom of the wheel instead (use an extra grenade on the small floor below the wheel)
      InnerWellspring.DrainLever:
        Dash
        Bash, Grenade=3
      # if you have a non-energy weapon here, you can break the three wheels free. Redundant paths without the three wheels state were removed.
      # Sword, InnerWellspring.DrainLever OR Dash OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      # Hammer, DoubleJump OR Dash OR Sentry=3
      # Hammer, InnerWellspring.DrainLever, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump  # climb the right wall
      Glide
      Sword, Spear=1 OR Blaze=1
      Shuriken=2, Dash OR Hammer
      Damage=15, Dash OR Sword
      WaterDash, Bash, Grenade=3, BreakWall=10, Water OR Damage=20  # if you drained the water, you can go through through the drained room instead
      WaterDash, Bash, Grenade=2, Damage=15, BreakWall=10, Water OR Damage=20  # if you drained the water, you can go through through the drained room instead
      InnerWellspring.DrainRoomBottomWheel, Shuriken=3 OR Blaze=5 OR Flash=3 OR Sentry=3
      InnerWellspring.DrainRoomBottomWheel, Bash, Grenade=2  # not hard, but grenades can vanish on rotating objects sometimes
      InnerWellspring.DrainLever, Sword OR Shuriken=3
  conn InnerWellspring.DrainAreaEntrance:
    moki: InnerWellspring.DrainLever, DoubleJump OR Dash OR Grapple OR Glide OR Launch
    gorlek, InnerWellspring.DrainLever:
      Sword OR Hammer OR Damage=15
      Bash, Grenade=1
    kii: InnerWellspring.DrainLever
  conn InnerWellspring.DrainAreaExit:
    gorlek, ShurikenBreak=10:
      # if you have a weapon here, you can break the three wheels free. Redundant paths without the three wheels state were removed.
      # cross the gap going over
      Grapple OR Glide OR Launch
      DoubleJump, TripleJump
      Bash, Grenade=1, DoubleJump, Dash
      InnerWellspring.DrainLever:  # use the bottom of the wheel, don't have to free it
        DoubleJump OR Dash
        Bash, Grenade=2
      InnerWellspring.DrainRoomBottomWheel, DoubleJump OR Dash OR Sword OR Hammer  # DrainRoomBottomWheel state is free enough that alternatives don't seem worth noting
      Water, DoubleJump OR Dash  # if you drained the water, you can use the bottom of the wheel instead
      Water, Bash, Grenade=1, Damage=15  # if you drained the water, you can go through through the drained room instead
      Water, Bash, Grenade=2  # if you drained the water, you can go through through the drained room instead
    kii, ShurikenBreak=10:
      DoubleJump, Blaze=4 OR Sentry=3
      Dash, Blaze=3 OR Sentry=2
      InnerWellspring.DrainRoomBottomWheel, Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=20, DoubleJump OR Dash  # dboost in dirty water. If you drained the water, you can use the bottom of the wheel instead
      Damage=60, Bash, Grenade=1  # dboost in dirty water. If you drained the water, you can use the bellow the wheel instead
      WaterDash, Damage=40, DoubleJump OR Dash  # dboost in dirty water. If you drained the water, you can use the bottom of the wheel instead
      WaterDash, Damage=40, Bash, Grenade=1  # dboost in dirty water. If you drained the water, you can use the bottom of the wheel instead
      InnerWellspring.DrainLever:
        Damage=45
        Bash, Grenade=1
      # if you have a non-energy weapon here, you can break the three wheels free. Redundant paths without the three wheels state were removed.
      # Sword, InnerWellspring.DrainLever OR Dash OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      # Hammer, DoubleJump OR Dash OR Sentry=3
      # Hammer, InnerWellspring.DrainLever, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, ShurikenBreak=10:
      DoubleJump
      Dash, Damage=15  # cross the gap going over
      InnerWellspring.DrainRoomBottomWheel, Bash, Grenade=2  # not hard, but grenades can vanish on rotating objects sometimes
      InnerWellspring.DrainLever, Sword OR Shuriken=2

anchor InnerWellspring.DrainAreaEntrance at -1128, -3968:  # On the wall after dropping through the gate draining the water
  pickup InnerWellspring.DrainHC:
    moki:
      Water OR DoubleJump OR Grapple OR Launch  # bit of a weird pickup
      Bash, Grenade=1  # seems fine
    gorlek: Dash OR Bash OR Glide OR Damage=20
    kii: Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: free

  conn InnerWellspring.DrainAreaEX:
    moki:  # the skeetos just want to be bashed here
      DoubleJump, Water OR Bash
      Dash, Bash, Grenade=1
      Water, Bash, Grenade=1, Grapple OR Glide
      Launch
    gorlek:  # Dealing with the enemies can be tricky, so the paths use bash or djump
      DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=20
      Bash, Dash, Sword OR Hammer
      Bash, Grenade=1, Water OR Damage=20
      Bash, SentryJump=1, Water OR Damage=20
    kii:
      Dash, Hammer OR Sword
      Dash, Bash, Spear=1 OR Flash=1 OR Sentry=1  # use energy weapon to reach the wall at the left of the lever
      Dash, Water, Combat=2xWeakSlug, WaterDash OR Spear=1 OR Flash=1 OR Sentry=1
      Dash, Damage=20, Combat=2xWeakSlug, Spear=1 OR Flash=1 OR Sentry=1
      Dash, Damage=20, Damage=20, Combat=2xWeakSlug, WaterDash
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Sword
      Water, WaterDash, Sword, Glide OR Dash
      Water, WaterDash, Hammer
    unsafe:
      Dash, Combat=2xWeakSlug
      Water, WaterDash, GlideJump  # glide jump from the wheel to the sl container
      Bash, Grenade=1, Shuriken=1

anchor InnerWellspring.DrainAreaEX at -1064, -3961:  # At DrainEX
  pickup InnerWellspring.DrainEX: free
  pickup InnerWellspring.DrainHC:
    moki: Water OR Launch
    gorlek:
      DoubleJump, TripleJump
      DoubleJump, Dash, Sword
      Bash, DoubleJump OR Dash  # luring the skeetos with other abilities seems tricky
    kii:
      Damage=40, Bash OR Damage=20
      Damage=20, Damage=20, Shuriken=1 OR Flash=1 OR Sentry=1  # use energy weapon between the two floating logs
      Damage=20, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      WaterDash, Damage=20, Bash OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20
      Dash, DoubleJump OR Sword OR Hammer
    unsafe:
      Dash, Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=20, Damage=20, Spear=1
      DoubleJump
      WaterDash, Damage=20

  conn InnerWellspring.DrainAreaExit:
    moki, BreakWall=10:
      DoubleJump OR Dash OR Launch
      Bash, Grenade=1
    gorlek, BreakWall=10: Glide OR Sword
    kii, BreakWall=10: Bash OR Hammer OR Shuriken=2 OR Sentry=2  # no flash here because you can't diasble flash while holding the pole
    unsafe, BreakWall=10: Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1

anchor InnerWellspring.DrainAreaExit at -1093, -3950:  # At the checkpoint in the breakable wall.
# This anchor assumes that the wall is already broken.
  nospawn
  refill Checkpoint

  conn InnerWellspring.DrainAreaEX: free
  conn InnerWellspring.DrainRoomCenter:
    moki:
      DoubleJump OR Launch
      Dash, Bash, Grenade=1
      Bash, Grenade=2
    gorlek:
      Dash
      Glide, Grapple OR SentryJump=1 OR Damage=15
      Sword, Grapple OR SentryJump=1 OR Damage=15
      Bash, Grenade=1, Grapple OR Glide OR Sword OR Damage=15
      SentryJump=1, Grapple OR Damage=15
      SentryJump=2
    kii:
      Sword OR Hammer OR Spear=3 OR Shuriken=3 OR Sentry=3  # No flash path because you can't cancel it while on the pole
      Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Bait the skeeto
    unsafe:
      Spear=2 OR Shuriken=2 OR Blaze=3 OR Flash=2 OR Sentry=2
      Bash  # Bait the skeeto
  conn InnerWellspring.DrainRoom:  # Make sure it's not redundant with DrainAreaExit->DrainRoomCenter->DrainRoom
    moki:
      Dash, Glide, Water OR InnerWellspring.DrainRoomBottomWheel
    gorlek:
      InnerWellspring.DrainRoomBottomWheel, Glide, Sword
      Glide, Water OR Damage=20
      Water, Sword
      Water, Dash, Damage=15
      Water, Grapple, Damage=15, Hammer
    kii:
      InnerWellspring.DrainRoomBottomWheel:
        Sentry=4
        Glide, Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
        Bash, Grenade=2
        Bash, Grenade=1, Damage=20  # dboost in dirty water. If you drained the water, dboost in spikes instead.
      InnerWellspring.DrainLever:
        Damage=15, Spear=1 OR Shuriken=1 OR Blaze=3 OR Flash=1 OR Sentry=1 OR Damage=15
        Bash, Grenade=2
        Bash, Grenade=1, Damage=15
      Bash, Grenade=1, Damage=80  # dboost in dirty water. If you drained the water, you can dboost in the spikes instead
      WaterDash, Damage=40, Spear=1 OR Shuriken=1 OR Blaze=3 OR Flash=1 OR Sentry=1  # dboost in dirty water. If you drained the water, dboost in spikes instead
      WaterDash, Damage=40, Bash, Grenade=1  # dboost in dirty water. If you drained the water, you can use the bottom of the wheel instead
    unsafe:
      InnerWellspring.DrainLever, Damage=15, Grapple OR Blaze=2  # Grapple is awkward if the wheel is spinning snce you need to jump blindly and you might have jumped before the wheel can be grappled
      InnerWellspring.DrainRoomBottomWheel, Glide

# checkpoint at the anchor below, just hard to reach

anchor InnerWellspring.DrainRoomCenter at -1116, -3924:  # Standing on the wheel in the center of the room
  state InnerWellspring.DrainRoomTopWheel:  # breaking the top wheel free; has a state because it can be used to connect from top right to top left
    moki:
      BreakWall=16, Bow OR Grenade OR Spear
      Launch, BreakWall=16
    gorlek: BreakWall=16

  conn InnerWellspring.DrainRoom:
    moki:
      DoubleJump, Dash
      Grapple OR Glide OR Launch
    gorlek:
      DoubleJump OR Dash OR Sword
      Hammer, Damage=20  # dboost in water
      Hammer, Water, Damage=15
    kii:
      Hammer OR Blaze=3 OR Sentry=2 OR Damage=40  # dboost in Water. Can dboost in spikes if water is drained
      Damage=20, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # dboost in Water. Can dboost in spikes if water is drained
      Bash, Grenade=1
      InnerWellspring.DrainLever, Damage=15  # grab the pole on the right to reach the bottom of the spinning wheel
      InnerWellspring.DrainRoomBottomWheel, Damage=20  # grab the pole on the right to reach the spinning wheel. dboost in water
      InnerWellspring.DrainLever, InnerWellspring.DrainRoomBottomWheel, Shuriken=1  # grab the pole on the right to reach the spinning wheel.
    unsafe: Damage=20  # dboost in water
  conn InnerWellspring.DrainAreaEntrance:
    moki: InnerWellspring.DrainLever
  conn InnerWellspring.DrainAreaExit:
    gorlek: ShurikenBreak=10
  conn InnerWellspring.DrainRoomTop:
    moki: InnerWellspring.DrainRoomTopWheel OR Grapple OR Launch
    gorlek:
      DoubleJump OR Dash
      Bash, Grenade=1
    unsafe: Shuriken=1 OR Flash=1 OR Sentry=1

anchor InnerWellspring.DrainRoomTop at -1086, -3908:  # At the right ledge on top of the drain room
  refill Checkpoint
  refill Health=1

  pickup InnerWellspring.LaserOre:
    moki:
      DoubleJump, Dash OR Glide
      Dash, Glide, Combat=Miner OR Bash
      Launch
    gorlek:
      DoubleJump OR Dash OR Sword
      Glide, Combat=Miner OR Bash
    kii: Combat=Miner, Shuriken=2 OR Blaze=4 OR Sentry=3
    unsafe:
      Glide OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=3 OR Sentry=2 OR Damage=15  # bait the gorlek into falling on the left so you don't have to fight it
      Bash, Grenade=1  # there's a safe spot on the left of the laser, where you can charge your grenade safely

  conn InnerWellspring.DrainRoomCenter: free
  conn InnerWellspring.BelowDrainLever:
    moki:
      DoubleJump, Dash OR Glide
      InnerWellspring.DrainRoomTopWheel, Grapple
      Launch
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer OR Damage=15
      Dash, Glide OR Sword OR Hammer OR Damage=15
      Grapple, SentryJump=1
      Bash, Grenade=1, DoubleJump OR Dash OR Grapple
      SwordSJump=1, Glide
      InnerWellspring.DrainRoomTopWheel, Bash, Grenade=1
      InnerWellspring.DrainRoomTopWheel, SentryJump=1
    kii:
      DoubleJump OR Dash
      Grapple, Glide OR Sword OR Hammer OR Shuriken=1
      Bash, Grenade=1, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Grapple
      # Grapple, Flash=1 OR Sentry=1
      Bash, Grenade=1

anchor InnerWellspring.BelowDrainLever at -1153, -3895:  # In the first room below the drain lever
  refill Checkpoint

  state InnerWellspring.DrainLever:
    moki:
      Bash, Grenade=1  # not softlockable: UpperCorruption solves this
      InnerWellspring.UpperCorruption, DoubleJump
      Launch
    gorlek:
      InnerWellspring.UpperCorruption OR SentryJump=1
    kii:
      DoubleJump, TripleJump, Damage=15  # Damage boost on the left
    unsafe: GrenadeJump

  pickup InnerWellspring.LeverEC:
    moki:
      Bash, Grenade=2  # not softlockable: UpperCorruption solves this
      Bash, Grenade=1, Grapple, DoubleJump OR Dash OR Glide  # not softlockable: UpperCorruption solves this
      InnerWellspring.UpperCorruption, DoubleJump, Bash, Grenade=1
      InnerWellspring.UpperCorruption, DoubleJump, Grapple
      Launch
    gorlek:
      DoubleJump, TripleJump, Bash, Grenade=1
      DoubleJump, TripleJump, InnerWellspring.UpperCorruption OR SentryJump=1
      Bash, Grenade=1, Grapple
      SentryJump=2
      SentryJump=1, Grapple
      InnerWellspring.UpperCorruption, Bash, Grenade=1
      InnerWellspring.UpperCorruption, Grapple OR SentryJump=1
    kii:
      DoubleJump, TripleJump, Damage=15  # Damage boost on the left
    unsafe:
      GrenadeJump

  conn InnerWellspring.AbovePole:
    moki:
      DoubleJump, Dash OR Glide
      Launch
    gorlek:
      Damage=15
      DoubleJump, TripleJump OR Sword OR Hammer
    kii:
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, Sword OR Hammer OR Shuriken=1 OR Spear=1  # Weapon, then dash
    unsafe: free  # lovely friendly spikes
  conn InnerWellspring.WestDoor:
    moki:
      DoubleJump, Bash, Grenade=1
      InnerWellspring.UpperCorruption OR Launch
    gorlek:
      DoubleJump, TripleJump, Damage=15
      Bash, Grenade=1
      SwordSJump=1, DoubleJump
      HammerSJump=1, DoubleJump, Glide
      SentryJump=2
    unsafe:
      Grenade=2
      SentryJump=1, Damage=15
      DoubleJump, Damage=30
  conn InnerWellspring.DrainRoomTop:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: free
  conn InnerWellspring.DrainRoomCenter: free

anchor InnerWellspring.AbovePole at -1164, -3874:  # Under InnerWellspring.UpperCorruption
  state InnerWellspring.UpperCorruption:  # the fourth corruption you see on your way
    moki: BreakWall=16

  pickup InnerWellspring.LupoEX: free

  conn InnerWellspring.BelowDrainLever:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: free

anchor InnerWellspring.WestDoor at -1216, -3897:  # Inside the door where you exit the first room
  refill Checkpoint
  refill Health=2
  refill Energy=3:
    moki: BreakCrystal

  state InnerWellspring.MiddleDoorsOpen:
    moki:
      Grapple
      Bash, Grenade=1, Launch
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump
      SentryJump=1, DoubleJump, TripleJump  # solvable through wraparound if you don't sjump well
      Launch
    kii:
      Bash, DoubleJump, TripleJump  # bait the mantis. Need to bash it when used its third jump.
      Bash, Grenade=1  # bait the mantis, bash it in order to bash your grenade from higher up
    unsafe:
      Hammer, DoubleJump, TripleJump
      SentryJump=1

  pickup InnerWellspring.ShortcutWheelEX:
    moki: InnerWellspring.ShortCutWheel
  pickup InnerWellspring.LupoMap:
    moki, SpiritLight=150:
      Grapple, DoubleJump OR Dash OR Glide
      Bash  # bash the skeeto
      InnerWellspring.UpperCorruption
    gorlek, SpiritLight=150:
      Grapple
      SwordSJump=1  # hammer locking your movement makes this awkward
    kii, SpiritLight=150:
      DoubleJump, Sword  # pogo the skeeto
      DoubleJump, TripleJump, Hammer OR Spear=1
    unsafe, SpiritLight=150: DoubleJump  # kind of easy
  pickup InnerWellspring.GrappleTreeEX:
    moki:
      DoubleJump, Grapple
      Bash, Grenade=2
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Grapple
      Launch
    gorlek:
      Bash, Grenade=1
      DoubleJump, TripleJump OR Hammer
      SentryJump=1
      Grapple, Dash
    kii:
      Grapple, Sword OR Hammer OR Shuriken=1
      DoubleJump, Sword OR Spear=1
    unsafe:
      Grapple, Sentry=2
      Grenade=1
  pickup InnerWellspring.GrappleTree:
    moki:
      DoubleJump OR Dash OR Glide OR Grapple OR Launch
      Bash, Grenade=1  # jumper would be a lure
    gorlek: Bash OR Sword OR Hammer
    kii: free

  conn OuterWellspring.WestDoor:
    moki: InnerWellspring.MiddleDoorsOpen
  conn InnerWellspring.BelowDrainLever: free

anchor InnerWellspring.EastDoor at -1190, -3733:  # Inside the door leading to the spin puzzle
  refill Checkpoint
  refill Health=1
  refill Energy=4:
    moki: BreakCrystal

  state InnerWellspring.SpinArena:  # finishing the arena
    moki: Combat=2xLizard+3xMantis+Miner, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Combat=2xLizard+3xMantis+Miner  # different ways to solve
    # technically opening the spinning room clears this fight automatically as well, but that doesn't lead to anything logically
  state InnerWellspring.SpinningRoomOpen:  # Breaking the corruption which opens the spinning room
    moki: InnerWellspring.SpinArena, BreakWall=16, DoubleJump OR Dash OR Glide OR Launch
    gorlek: InnerWellspring.SpinArena, BreakWall=16
  # It's possible to solve InnerWellspring.TopDoorOpen from there with ChargedBlaze but logic doesn't have any keyword for it

  quest InnerWellspring.HandToHandHerbs:
    moki: GladesTown.HandToHandPouch

  pickup InnerWellspring.AboveSpinArenaEX:
    moki:
      Grapple, DoubleJump OR Dash
      Launch
    gorlek:
      Grapple, Sword OR HammerSJump=1
      DoubleJump, TripleJump, SentryJump=1 OR Damage=15
      ShurikenBreak=10, Combat=Tentacle OR Bash
    kii:
      Grapple, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15
      DoubleJump, TripleJump
    unsafe: DoubleJump

  conn OuterWellspring.EastDoor: free
  conn InnerWellspring.SpinPuzzle:
    moki: InnerWellspring.SpinningRoomOpen
  conn InnerWellspring.TopSecondRoom:
    moki, InnerWellspring.TopDoorOpen:
      Grapple, DoubleJump OR Launch
      Bash, Grenade=1, DoubleJump OR Launch
      Launch, DoubleJump
    gorlek, InnerWellspring.TopDoorOpen:
      Bash, Grenade=1
      Grapple OR Launch
    kii, InnerWellspring.TopDoorOpen:
      DoubleJump, TripleJump, Hammer OR Spear=1
    unsafe, InnerWellspring.TopDoorOpen: DoubleJump, TripleJump, Flash=1 OR Sentry=1

anchor InnerWellspring.SpinPuzzle at -1193, -3806:  # After the door blocking the spin puzzle
  # Having water changes the lasers in the spin puzzle room to the right. Using this is only logically expected in kii and above
  refill Checkpoint

  state InnerWellspring.SpinPuzzleSolved:
    moki:
      Grapple, DoubleJump OR Dash
      Grapple, Bash, Grenade=1
      Launch
    gorlek: Grapple, Glide OR Sword OR Hammer
    kii:
      Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Water, DoubleJump OR Grapple OR Dash OR Hammer OR Damage=30
      Water, Bash, Grenade=1
      Water, Damage=15, Sword
      DoubleJump, TripleJump, Damage=15  # Damage boost on the left in 2nd part
    unsafe:
      Grapple
      DoubleJump, TripleJump
      Water, Spear=1 OR SentryJump=1 OR Damage=15

  pickup InnerWellspring.RotateRoomEX:  # after pulling two of the three levers, this pickup is blocked off. Due to that, fully solving the puzzle is the only non-softlockable solution for this pickup
    moki: InnerWellspring.SpinPuzzleSolved
  pickup InnerWellspring.RotateRoomOre:  # blocked off until you fully solve the puzzle
    moki: InnerWellspring.SpinPuzzleSolved

  conn InnerWellspring.PastSpinPuzzle:  # while there are abilitysets to get through the spinning room regardless of state, they are more expensive than just solving the puzzle
    moki: InnerWellspring.SpinPuzzleSolved, Grapple OR Launch
    gorlek: InnerWellspring.SpinPuzzleSolved, Water  # gorlek is fun
    kii: InnerWellspring.SpinPuzzleSolved, DoubleJump, TripleJump, Damage=15
    unsafe:
      InnerWellspring.SpinPuzzleSolved, Dash, Damage=15
      InnerWellspring.SpinPuzzleSolved, DoubleJump, TripleJump OR Damage=15
  conn InnerWellspring.EastDoor:
    moki, InnerWellspring.SpinningRoomOpen:
      Grapple OR Launch
      Bash, Grenade=1
    gorlek, InnerWellspring.SpinningRoomOpen:
      DoubleJump, TripleJump OR Dash  # wall jump on the arena wall in order to reach the pole
      SentryJump=1
    kii, InnerWellspring.SpinningRoomOpen:
      DoubleJump
      Dash, Hammer  # wall jump on the arena wall in order to reach the pole
    unsafe: InnerWellspring.SpinningRoomOpen  # precise wall jump to get on the pole

anchor InnerWellspring.PastSpinPuzzle at -1101, -3778:  # Right after exiting the spin puzzle room
  # Having water changes the lasers in the spin puzzle room to the left. Using this is only logically expected in kii and above
  refill Checkpoint

  state InnerWellspring.SpinPuzzleSolved:
    kii, Water:  # Water is required because lasers are blocking your way if you pulled at least one lever and return to the anchor before solving the puzzle
      Grapple OR Launch
      DoubleJump OR Dash OR Hammer OR Damage=30
      Bash, Grenade=1
      Damage=15, Sword
    unsafe:
      Water, Spear=1 OR SentryJump=1 OR Damage=15

  conn InnerWellspring.GrappleThroughZigZagSpikes:  # the miner on the way is in an unusually rude position, so just using Combat=Miner might not always represent the difficulty of killing him
    moki:
      Launch
      Grapple, Combat=Miner, DoubleJump OR Dash OR Glide
      Grapple, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Grapple, Combat=Miner OR Bash
      DoubleJump, TripleJump, SentryJump=1, Bash
      DoubleJump, SentryJump=2, Bash
      SentryJump=3, Bash
    kii:
      Grapple, Damage=10
      DoubleJump, Damage=15, Combat=Miner OR Bash OR Damage=10  # wjump of the right wall to grab the first wheel then dboost at the first laser
    unsafe:  # You can bait the Miner to make them fall into spikes
      DoubleJump OR Grapple OR Hammer OR Sentry=2
      Sword, Sentry=1
  conn InnerWellspring.SpinPuzzle:
    moki, InnerWellspring.SpinPuzzleSolved:
      DoubleJump OR Glide OR Launch
      Grapple, Dash
    gorlek, InnerWellspring.SpinPuzzleSolved: Dash OR Sword OR Hammer OR Damage=15
    kii, InnerWellspring.SpinPuzzleSolved:
      Water, Damage=15
      Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: InnerWellspring.SpinPuzzleSolved OR Water  # yep, water works for all four states of the room. Cool, huh?

anchor InnerWellspring.GrappleThroughZigZagSpikes at -1100, -3725:  # after the two rotating wheel on the way to the top of the room
  # dealing with the miner is represented in the connections from both directions to this anchor. When spawning on this anchor, the miner is not an issue
  refill Checkpoint

  conn InnerWellspring.TopSecondRoom:
    moki:
      Grapple, DoubleJump, Dash OR Glide
      Grapple, Dash, Glide
      Grapple, Launch
    gorlek:
      Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      Water, Grapple, Damage=15
      Launch, DoubleJump, TripleJump
      Launch, Damage=15, DoubleJump OR Dash OR Glide
      Water, WaterDash, Launch, DoubleJump
    kii:
      Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=15
      Launch, DoubleJump, Dash OR Glide OR Sword OR Hammer OR Sentry=3
      WaterDash, Launch, Water OR Damage=20
    unsafe:
      Launch  # https://youtu.be/wbz2cLfuFOk
  conn InnerWellspring.PastSpinPuzzle:  # Camera doesn't show the lower wheel when you are on the top one, making it difficult to rely on them in lower difficulties
    moki:
      Glide, Combat=2xSlug, DoubleJump OR Launch
      Glide, Bash, DoubleJump OR Launch
    gorlek: Glide, DoubleJump OR Launch
    kii:
      Grapple OR Damage=35  # Possible without any damage but this account for the worst case scenario of dbosting on both the laser and the spikes
    unsafe: free

anchor InnerWellspring.TopSecondRoom at -1141, -3698:  # Next to the corruption which oppen the third room
  state InnerWellspring.TopDoorOpen:
    moki: BreakWall=16

  quest InnerWellspring.NeedleQI:
    moki: InnerWellspring.TopDoorOpen

  conn InnerWellspring.EastDoor:
    moki: InnerWellspring.TopDoorOpen
  conn InnerWellspring.GrappleThroughZigZagSpikes:
    moki:
      Combat=Miner OR Bash:
        Glide, Water OR DoubleJump OR Dash OR Grapple OR Launch
        Grapple, DoubleJump, Dash
      Launch, Water
    gorlek:
      Combat=Miner OR Bash:
        Glide
        Grapple, DoubleJump, TripleJump OR Sword OR Hammer OR Damage=20
        Grapple, Dash, Sword OR Damage=20
        Water, DoubleJump, TripleJump OR Dash OR Sword OR Hammer
        Water, Dash, Sword OR Hammer
        Damage=20, DoubleJump, TripleJump, Dash OR Sword
      Launch, Grapple OR Damage=20
      Launch, DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Launch, Dash, Sword OR Hammer
    kii:
      Glide, Damage=10  # Damage boost the miner
      Water, Damage=10, DoubleJump OR Dash OR Sword OR Hammer
      Damage=75, Combat=Miner OR Bash
      Damage=85
      Water, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1:
        Combat=Miner OR Bash OR Damage=10
      Damage=60, Combat=Miner, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=60, Bash, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=70, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Launch, DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      Launch  # There is a small ledge on the ceiling to reset launch

anchor InnerWellspring.Teleporter at -1308, -3675:  # At the teleporter
  refill Full

  state NonGladesTeleporter: free

  quest InnerWellspring.BlueMoonSeed:
    moki:
      DoubleJump, Dash
      Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump OR Glide OR Sword OR Hammer
      SentryJump=1
    kii:
      Dash, Hammer
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # double jump can solve it by itself but the branch you are jumping from can be a bit janky
    unsafe: Dash OR DoubleJump OR FlashSwap

  pickup InnerWellspring.LibraryEX: free
  pickup InnerWellspring.AboveTpEX:
    moki:
      DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump  # Can be done with just double jump but the first jump is precise
      SentryJump=1
    kii:
      DoubleJump, Sword OR Sentry=3
      Dash, Sword OR Sentry=2
    unsafe:
      DoubleJump, Hammer  # uses the wall to the left of tp
      Dash, Hammer  # path from the right, tight combos to reach the platform
      Shuriken=2, DoubleJump OR Dash OR Glide
      FlashSwap
  pickup InnerWellspring.SwimOre:
    moki: Water
    unsafe:  # Enemies aren't here if you don't have Clean Water
      Damage=80
      WaterDash, Damage=40

  conn Teleporters: free
  conn OuterWellspring.TopDoor: free
  conn OpherShop: free
  conn InnerWellspring.EscapeSequence:
    moki:
      DoubleJump, Dash, Grapple
      Bash, Grenade=1, Grapple
      Bash, Grenade=1, DoubleJump, Dash
      Bash, Grenade=2
      Launch
    gorlek:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump
      SentryJump=1, DoubleJump OR Grapple
      SentryJump=2
    kii:
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, Hammer, Grapple
    unsafe:
      Dash OR DoubleJump OR SentryJump=1
      FlashSwap OR BlazeSwap=2 OR SentrySwap=2 # Jump from the top of the stairs and climb the left wall.
      BlazeSwap=1 OR SentrySwap=1:
        Sword OR Hammer OR Shuriken=1 OR Spear=1 OR Glide OR Flash=1 OR PauseHover # Yep, difficult Blaze/Sentry swap and then Flash hop. Why not.
      GrenadeJump

# checkpoint at -1249, -3641

anchor InnerWellspring.EscapeSequence at -1240, -3642:
  nospawn
  refill Full

  quest InnerWellspring.WaterEscape:
    moki:
      Bash, Grapple, DoubleJump, Dash OR Glide
      Bash, Grapple, Dash, Glide
      Grapple, Launch
    gorlek:
      Grapple, DoubleJump, Dash  # bit spicy
      Bash, Grapple, DoubleJump OR Dash OR Glide
      Launch, Dash OR Glide OR Damage=15  # Assumes at least one damage is taken in the final grapple section, probably possible without
    kii:
      Launch, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1  # condition for the final grapple section
      Grapple, Dash OR Glide  # final wheel is pretty hard, you need to avoid touching it as much as possible (which could be viewed as area specific knowledge?)
      Grapple, DoubleJump, TripleJump OR Sword OR Hammer OR Shuriken=2 OR Blaze=3 OR Flash=2 OR Sentry=2  # condition for before and after the falling wheel. 1 blaze before and 2 after the wheel.
      Grapple, Bash, Sword
      Grapple, Bash, WaterDash:
        Water, Sentry=2 OR Damage=15  # two sentries to avoid the spikes before the falling wheel
        Damage=95
        Damage=60, Sentry=2  # two sentries before the falling wheel
        Damage=40, Sentry=3  # same as above + either one at the 2nd jump or between the two rotating wheels
        Damage=20, Sentry=4  # same as above but use both options
      Grapple, Bash, Sentry=6  # same as above but use 2 sentries to make the first jump
    unsafe:
      Launch
      Grapple, Bash, WaterDash, Damage=80
      Grapple, Bash, Hammer
      Grapple, DoubleJump
      FlashSwap
      # Same as Kii paths, but use two different energy weapons for energy management, since flash and shuriken cost less enegy than sentry
      Grapple, Bash, WaterDash, Damage=40, Sentry=2, Shuriken=1 OR Flash=1  # same as above + either one at the 2nd jump or between the two rotating wheels
      Grapple, Bash, WaterDash, Damage=20, Sentry=2, Shuriken=2 OR Flash=2  # same as above but use both options
      Grapple, Bash, Sentry=4, Shuriken=2 OR Flash=2  # same as above but use 2 sentries to make the first jump

  pickup InnerWellspring.EscapeRevisitEX:
    moki: InnerWellspring.WaterEscape

region WoodsEntry:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WoodsEntry.ShriekMeet at 391, -4198:  # The ledge after swimming through the Hollow connection
  refill Checkpoint

  pickup WoodsEntry.LedgeOre:
    gorlek: Launch
    kii: Bash, Grenade=1, DoubleJump, TripleJump OR Hammer

  conn WoodsEntry.FirstMud:
    moki: Combat=Balloon, Combat=Tentacle OR Bash OR Launch
    gorlek: Combat=Tentacle OR Bash OR Launch OR Damage=10
  conn EastHollow.Kwolok:
    gorlek: Water, Bash, Damage=10  # bit hard but important for random spawn
    kii: Water, Spear=1
    unsafe:
      Water, Bash # walljump to cancel bash momentum https://youtu.be/cj7xfa6M8Bc
      Water, Sword, Deflector
      Water, GrenadeRedirect=1 OR SentryRedirect=1  # https://youtu.be/AIHaUnHRTF0


anchor WoodsEntry.FirstMud at 478, -4205:  # In front of the first instant death mud
  refill Checkpoint

  pickup WoodsEntry.MudPitEX:
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=2
    gorlek:
      Bash, Grenade=1
      SentryJump=1
    kii: free

  conn WoodsEntry.BelowTeleporter:
    moki:
      Combat=Balloon, Bash, DoubleJump OR Dash OR Glide
      Combat=Balloon, Launch, DoubleJump OR Dash OR Glide
    gorlek: DoubleJump OR Dash OR Glide OR Launch  # getting hit by the balloon doesn't matter since you get autosaved and respawn
    kii:
      Sword OR Shuriken=3  # Careful with sword because it can break bubbles
      Bash, Hammer OR Sentry=2  # Use the tentacle at the end
    unsafe: Hammer
  conn WoodsEntry.ShriekMeet:
    moki: Combat=Balloon, Combat=Tentacle OR Bash OR Launch
    gorlek: Combat=Tentacle OR Bash OR Launch OR Damage=10
  conn WoodsEntry.Teleporter:  # Paths that go up directly and aren't redundant with BelowTeleporter
    unsafe: Bash  # Use the tentacle

# checkpoint at 525, -4205

anchor WoodsEntry.BelowTeleporter at 591, -4198:  # Read the name
  refill Checkpoint

  conn WoodsEntry.FirstMud:  # check for redundancies with Teleporter
    moki: Combat=Balloon, Bash, DoubleJump, Dash OR Glide
    gorlek: DoubleJump, TripleJump OR Dash OR Glide  # If you struggle with the tentacle and die, it'll despawn
    kii:
      DoubleJump, Sword OR Hammer
      Dash, Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1  # You can use a dash refresh on the ceiling for more lenience. Or instead of grabbing the hanging log you can go below and aim for the bubble.
    unsafe: Glide, Sword OR Hammer  # Jump on the first bubble, glide then up slash near the 2nd bubble (not too close, you can pop the bubble with an upslash)
  conn WoodsEntry.Teleporter:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Grapple, Sword
      Grapple, Hammer, Bash, Damage=15  # Bash because the plant can be a bit awkward
      Bash, Grenade=1, Sword OR Damage=15
      SwordSJump=1
      HammerSJump=1, Bash, Damage=15  # again mildly awkward
    kii:
      Grapple, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=15
      Grapple, Sentry=2, Damage=15
      Grapple, Sentry=4
      DoubleJump, TripleJump, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Bash, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Sentry=2 OR Damage=15  # Use the tentacle, note that it despawns if you die and respawn on this anchor
    unsafe:
      DoubleJump, TripleJump
      Bash
      DoubleJump, Hammer  # Double jump to the right wall, upslash to start climbing it (?)
  conn WoodsEntry.TwoKeystoneRoom:
    moki: Combat=2xBalloon, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Combat=2xBalloon, Sword OR Hammer
    kii:
      Combat=2xBalloon, Shuriken=3 OR Sentry=3 OR Spear=3
      Combat=2xBalloon, Bash, Grenade=1, Flash=2
      Combat=2xBalloon, Bash, Grenade=2, Spear=1
      Damage=20, Damage=20, DoubleJump OR Glide  # tank the balloons
      Launch  # by refreshing on the ceiling you can maneuver around the balloons
    unsafe: Sentry=2 OR Blaze=2

anchor WoodsEntry.Teleporter at 611, -4162:  # At the West Woods Teleporter
  refill Full

  state NonGladesTeleporter: free

  quest WoodsEntry.LastTreeBranch: free
  quest WoodsEntry.DollQI:
    moki: GladesTown.FamilyReunionKey
  quest WoodsEntry.TreeSeed:
    moki: TuleyShop.LastTreeBranchRejected

  pickup WoodsEntry.TpEX: free
  pickup WoodsEntry.LeafPileEX:
    moki: Flap
  pickup WoodsEntry.LedgeOre:
    moki:
      Glide, DoubleJump OR Launch
      Bash, Grenade=1, Glide OR Launch
      DoubleJump, Dash, Launch
    gorlek:
      Glide, Dash
      DoubleJump, TripleJump, Dash, Sword OR Hammer
      SentryJump=1, DoubleJump, Dash  # Dash after the apex of the sjump then sword's full combo + up slash
      Bash, Grenade=1, DoubleJump, TripleJump OR Sword OR Hammer
      Bash, Grenade=1, Dash
      # launch paths from gorlek onwards are redundant with walking below it and launching up
    kii:
      Glide, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      DoubleJump, TripleJump, Dash, Shuriken=1 OR Sentry=2 OR Flash=1
      DoubleJump, TripleJump, Sword, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      DoubleJump, TripleJump, Hammer, Shuriken=1 OR Sentry=2
      DoubleJump, Dash, Sword, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      DoubleJump, Dash, Hammer, Shuriken=1 OR Sentry=2
      Bash, Grenade=1, DoubleJump OR Sword
      Bash, Grenade=1, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      Glide  # No Glide jump, just start from the higher ground
      DoubleJump, Sword

  conn Teleporters: free
  conn WoodsEntry.ShriekMeet:
    gorlek: free
  conn WoodsEntry.FirstMud: free
  conn WoodsEntry.BelowTeleporter: free

anchor WoodsEntry.TwoKeystoneRoom at 672, -4183:  # In front of the keystone door
  refill Checkpoint
  refill Energy=3:
    moki: WoodsEntry.KeystoneDoor, BreakCrystal

  state WoodsEntry.KeystoneDoor:
    moki: Keystone=2

  pickup WoodsEntry.LowerKS:
    moki: DoubleJump OR Dash OR Glide  # Launch is awful
    gorlek: Launch OR Sword OR Hammer  # different ways to solve
    kii: free  # It's possible to get back to safety but also you can just teleport out
  pickup WoodsEntry.UpperKS:
    moki: DoubleJump OR Launch
    gorlek:
      Hammer, Dash
      Bash, Grenade=1
    unsafe: Sword OR Hammer

  conn WoodsMain.AfterKuMeet:
    moki: WoodsEntry.KeystoneDoor, Combat=2xSkeeto+Tentacle OR Bash OR Launch
    gorlek: WoodsEntry.KeystoneDoor, Damage=10
  conn WoodsEntry.BelowTeleporter:
    moki: Combat=2xBalloon, DoubleJump OR Glide OR Launch
    gorlek: DoubleJump OR Dash OR Glide OR Sword
    kii: Launch OR Hammer OR Shuriken=1 OR Sentry=2  # If you struggle and die, the first balloon will despawm
    unsafe: Sentry=1 OR Flash=1

region WoodsMain:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WoodsMain.AfterKuMeet at 856, -4192:  # At the upper ledge opening up to the room after finding Ku
  refill Checkpoint

  state WoodsEntry.KeystoneDoor:
    moki: Keystone=2, Combat=2xSkeeto+Tentacle OR Bash OR Launch
    gorlek: Keystone=2, Damage=10

  pickup WoodsMain.LowerKS:
    kii:
      Bash, DoubleJump, TripleJump OR Glide  # using Tentacle's projectiles (stalling with glide)
      Launch
    unsafe:
      Sword, Deflector, DoubleJump, TripleJump OR Glide  # pogo/slash the projectiles
      DoubleJump, Bash  # Using the Skeeto from the left

  conn WoodsMain.BelowFourKeystoneRoom:
    moki:
      DoubleJump, Dash
      Bash OR Glide OR Launch  # bash uses the enemy
    gorlek:
      DoubleJump, Sword  # many others work, but this lines up so beautifully oriGlow
      Dash, Sword OR Hammer
      SwordSJump=1  # sjump then full sword combo
      Combat=Tentacle, DoubleJump, TripleJump
    kii:
      Dash  # coyote dash
      Sentry=3
      Sword, Damage=10  # Sword hover->pogo->upslash. Damage can de avoided but you'll most likely get hit.
      Combat=Tentacle, Sword
      Combat=Tentacle, Hammer, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Combat=Tentacle, DoubleJump, Hammer
      Combat=Tentacle, DoubleJump, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Sword  # Pogo the projectiles
      Hammer, DoubleJump  # upslash to protect yourself from projectiles then double jump
      Combat=Tentacle, DoubleJump, Spear=1 OR Blaze=1
  conn WoodsEntry.TwoKeystoneRoom:
    moki: WoodsEntry.KeystoneDoor, Combat=2xSkeeto+Tentacle OR Bash OR Launch
    gorlek: WoodsEntry.KeystoneDoor, Damage=10
  conn WoodsMain.FourKeystoneRoom:
    kii, WoodsMain.KSRoomYellowBarrierBroken:
      Bash, Damage=15, DoubleJump, TripleJump OR Glide  # using Tentacle's projectiles (stalling with glide)
      Launch, Damage=15 OR DoubleJump OR Bash OR Dash
    unsafe, WoodsMain.KSRoomYellowBarrierBroken:
      Sword, Deflector, DoubleJump, TripleJump OR Glide  # pogo/slash the projectiles
      DoubleJump, Bash, Damage=15  # Using the Skeeto from the left

anchor WoodsMain.BelowFourKeystoneRoom at 951, -4210:  # At the first leaf pile after meeting Ku
  pickup WoodsMain.LowerLeafPileEX:
    moki: Flap
  pickup WoodsMain.BehindWallOre:
    kii: Flap, Glide  # Lure the balloon

  conn WoodsMain.FourKeystoneRoom:
    moki: Combat=2xBalloon, Flap, Glide
    gorlek: Flap, Glide  # Flap kills these
  conn WoodsMain.WallOreLedge:
    moki, Combat=2xBalloon:
      Bash, Grenade=3, DoubleJump  # different ways to solve
      Bash, Grenade=1, DoubleJump, Dash, Glide  # different ways to solve
      Launch
    gorlek:
      Combat=2xBalloon, DoubleJump, TripleJump, Dash OR Bash OR Glide OR Sword OR Hammer OR Damage=15
      Combat=Balloon, SentryJump=1, DoubleJump, TripleJump
      SwordSJump=1, DoubleJump, Bash  # bash the plant above and sword hover
      Damage=20, Bash, Grenade=2, DoubleJump OR Dash OR Glide
      Damage=20, Launch
    kii:
      DoubleJump, Sword, Combat=Balloon OR Damage=20  # Pogo the first balloon
      DoubleJump, Combat=2xBalloon, Damage=15, Glide OR Dash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Damage=35, TripleJump OR Dash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, Sword  # Pogo the first balloon, avoid the second one and kill it with a pogo
      DoubleJump, HammerSJump=1  # DoubleJump + full sword combo + up slash from the breakable wall to reach the left platform
      DoubleJump, TripleJump, Combat=2xBalloon OR Damage=20
      DoubleJump, Dash
      Launch  # use launch invincibility to avoid dboost from balloons
  conn WoodsMain.AfterKuMeet:
    moki:
      Bash, Grenade=2, Damage=10  # uses the enemy
      Bash, Grenade=1, Damage=10, DoubleJump OR Dash  # uses the enemy
      Launch, DoubleJump OR Dash OR Bash OR Glide  # bash uses the enemy
    gorlek:
      Bash, DoubleJump, TripleJump
      Bash, Grenade=1 OR SentryJump=1
      Launch, Sword OR Hammer
    kii:
      DoubleJump, Bash
      DoubleJump, Sword  # Keep hitting the tentacle with sword to reset your double jump
      Combat=Tentacle, DoubleJump, TripleJump, Dash OR Glide OR Hammer OR Sentry=2
      Combat=Tentacle, DoubleJump, Dash, Glide OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash
      Combat=Tentacle, DoubleJump, Dash, Spear=1
      Combat=Tentacle, DoubleJump, TripleJump, Shuriken=2

anchor WoodsMain.WallOreLedge at 982, -4175:  # Next to hidden ore, without the wall being broken - paths would be complicated otherwise
  pickup WoodsMain.BehindWallOre:
    moki: BreakWall=20
  pickup WoodsMain.BelowKeystonesEX:  # Paths that can get to the pickup but can't go to FourKeystoneRoom
    moki:
      Glide, DoubleJump
      Bash, DoubleJump OR Dash OR Glide OR Launch
    gorlek:
      Glide, Dash OR Sword OR Hammer  # for the weapons, glide below and use the up attack
    kii:
      Glide, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      # BreakWall=20, Dash  # Breakwall so you have more space for a coyote dash. Reset dash on the left wall
      Dash  # Coyote dash. Reset dash on the left wall
  pickup WoodsMain.LowerKS:  # All paths that aren't breaking the yellow wall
    gorlek:
      Launch  # launch on the wall near WoodsMain.BelowKeystonesEX then launch again
      Glide, Bash  # glide above the tentacle and bash its projectiles to reach the floating platform
      Glide, DoubleJump, TripleJump  # glide and triple jump to reach the floating platform
      Glide, Dash, DoubleJump, Sword OR Hammer  # glide, dash when just bellow the pickup, double jump and up slash to reach the floating platform
    kii:
      Bash, DoubleJump, TripleJump
      Glide, DoubleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1  # glide under the pickup then djump-> upslash -> energy to get on the floasting platform (with sentry or flash you can get onto the ks platform instead)

  conn WoodsMain.BelowFourKeystoneRoom: free
  conn WoodsMain.FourKeystoneRoom:
    moki:
      DoubleJump, Dash, Glide
      Launch
    gorlek:
      DoubleJump, TripleJump OR Dash
      Bash, Grenade=1, Dash  # Shoot a grenade from the breakable wall. Dash to reach the grenade and bash it to get on the left platform
    kii:
      Bash, Grenade=1, DoubleJump
      DoubleJump, Sword OR Hammer OR Shuriken=1  # with sword, breaking the wall makes it way easier than jumping from the small ledge.
    unsafe: DoubleJump, Flash=1 OR Sentry=1
  conn WoodsMain.AfterKuMeet:  # paths gliding to the left, either from above or below
    gorlek:
      Glide, DoubleJump, TripleJump
      Glide, SentryJump=1

# checkpoint at 906, -4136

anchor WoodsMain.FourKeystoneRoom at 944, -4137:  # In front of the four keystone door
  refill Checkpoint

  state WoodsMain.KeystoneDoor:
    moki: Keystone=4
  state WoodsMain.KSRoomYellowBarrierBroken:  # Flap being the casual way of breaking the yellow barrier
    moki:  # getting assisting abilities to deal with Skeetos and positioning of Balloon
      Combat=3xSkeeto, Flap, DoubleJump OR Glide
      Bash, Flap, DoubleJump OR Glide
    gorlek: Flap, Combat=3xSkeeto OR Bash
    kii: Flap OR Combat=Balloon OR Damage=20  # killing balloon at the right time or letting it explode inside of you
    unsafe: free  # master balloon baiter

  pickup WoodsMain.MiddleLeafPileEX:
    moki: Flap
  pickup WoodsMain.RightKS:
    moki:
      Glide OR Launch
      Bash, Grenade=1
    gorlek:
      Bash  # so many skeeto friends oriGlow
      SentryJump=1
      DoubleJump, TripleJump
    kii: DoubleJump, Sword  # bait a skeeto and pogo it (is one way of doing it)
    unsafe: DoubleJump  # Climb the left wall to get on the right wall, let ori slide slowly then double jump and quickly turn around to catch the other side of the wall
  pickup WoodsMain.UpperKS:
    moki, BreakWall=3:
      Glide OR Launch
      Bash, Grenade=1, DoubleJump OR Dash
    gorlek:
      Flap, Glide  # lure the balloon
      BreakWall=3, DoubleJump, TripleJump
      BreakWall=3, Combat=3xSkeeto, SwordSJump=1
      BreakWall=3, Combat=3xSkeeto, HammerSJump=1, DoubleJump OR Dash
      BreakWall=3, Bash, Grenade=1 OR DoubleJump OR Dash
    kii:
      BreakWall=3, DoubleJump OR Bash
      BreakWall=3, Sword, Dash  # Pogo the skeetos
      Combat=Balloon, Glide OR DoubleJump OR Bash  # kill the balloon near the bulb
      Damage=20, Glide OR DoubleJump OR Bash  # lure the balloon
    unsafe:
      Hammer, Combat=Balloon  # seems like there is a micro ledge on the wall bellow the pickup which reset your upslash
      BreakWall=3, SentryJump=1  # start your double jump from the higher floor near the spikes / bash the mosquitos / sjump from the platform next to the door to reach the platformtform above the door, sjump from there and sword combo + up slash
  pickup WoodsMain.LeftKS:
    moki: Combat=Balloon, Glide
    gorlek, Combat=Balloon:
      Damage=15, DoubleJump, TripleJump OR Dash
      Launch
    kii:
      DoubleJump, Combat=Balloon, Damage=15
      DoubleJump, Damage=20
      Bash, Dash, Combat=Balloon  # bait the skeetos
    unsafe:
      DoubleJump, TripleJump  # tjump on the wall above
  pickup WoodsMain.LowerKS:  # All path reaching that pickup without breaking the yellow wall are from WallOreLedge
    moki, WoodsMain.KSRoomYellowBarrierBroken:
      Glide OR Launch
      DoubleJump, Dash
      Bash, DoubleJump OR Dash
    gorlek, WoodsMain.KSRoomYellowBarrierBroken:
      DoubleJump OR Dash OR Sword
      Hammer, Bash
    kii, WoodsMain.KSRoomYellowBarrierBroken:
      Bash  # baiting 1 or 2 Skeetos
      Spear=3 OR Shuriken=3 OR Sentry=3 OR Blaze=4 OR Flash=3 OR Sentry=3
      Damage=15, Spear=2 OR Shuriken=2 OR Sentry=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      Damage=25, Spear=1 OR Shuriken=1 OR Sentry=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe, WoodsMain.KSRoomYellowBarrierBroken:
      # Bash, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=15 # was in kii but only Bash is kii aswell
      Spear=2 OR Sentry=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      Damage=15, Spear=1 OR Shuriken=1 OR Sentry=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      # fiendly spikes and slide from the ceiling to the platform
      Shuriken=1 OR Damage=15
  pickup WoodsMain.BelowKeystonesEX:  # Make sure it's not redundant with WallOreLedge->BelowKeystonesEX
    gorlek:
      Launch
      DoubleJump, TripleJump OR Dash
    kii:
      Bash
      DoubleJump, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Sword, Damage=15  # Pogo the plant
      Dash  # reset dash on the wall
    unsafe:
      DoubleJump  # get a wall jump after dropping down

  conn WoodsMain.GiantSkull:
    moki: WoodsMain.KeystoneDoor
  conn WoodsMain.WallOreLedge:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: Sword OR Hammer
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: Bash OR Grenade=1 OR Bow=1
  conn WoodsMain.BelowFourKeystoneRoom: free

anchor WoodsMain.GiantSkull at 957, -4138:  # Behind the four keystone room door
  refill Checkpoint

  state WoodsMain.KeystoneDoor:
    moki: Keystone=4

  pickup WoodsMain.UpperLeafPileEX:
    moki: Flap
  pickup WoodsMain.BehindDoorRoofEX:
    moki, Combat=Balloon:
      Bash OR Launch
      DoubleJump, Dash, Glide
    gorlek, Combat=Balloon:
      SentryJump=1
      DoubleJump, Glide, TripleJump OR Sword OR Hammer
    kii:
      # Moki/gorlek paths ignoring the balloon
      Bash OR Launch
      Glide, DoubleJump, Dash OR TripleJump OR Sword OR Hammer
      # New paths
      DoubleJump, TripleJump, Sword  # Pogo the balloon
      Glide, DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Glide, Dash, Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Glide, Dash, Sword  # pogo the plant
    unsafe:
      Glide, DoubleJump  # need a really precise vertical boost from the wind
      Glide, Dash, Spear=1 OR Blaze=1

  conn WoodsMain.BalloonLure:
    moki: Combat=Balloon, Bash, DoubleJump OR Dash OR Glide OR Launch  # bash for the rude placement of the tentacle
    gorlek, Combat=Balloon:
      Bash, Sword
      Bash, HammerSJump=1
    kii:
      # Moki/gorlek paths ignoring the balloon
      Bash, DoubleJump OR Dash OR Glide OR Sword
      # new paths
      Bash, Hammer OR Shuriken=1 OR Damage=15
      Launch OR Glide
      Combat=Tentacle, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    unsafe:
      Bash
      Combat=Tentacle, Damage=15
  conn WoodsMain.FourKeystoneRoom:
    moki: WoodsMain.KeystoneDoor

anchor WoodsMain.BalloonLure at 1056, -4144:  # At the bottom of the shaft you lure a balloon through to break a yellow wall - mostly exists for the lure specifically since paths for it would otherwise be awkward
  refill Checkpoint

  state WoodsMain.BalloonLureBlobDestroyed:
    moki: BreakWall=3, Glide
    gorlek: BreakWall=3, Launch
    kii:
      Combat=Balloon, Glide OR Launch
      Damage=20, Glide OR Launch
      DoubleJump, BreakWall=3
      DoubleJump, Damage=20, TripleJump OR Dash
    unsafe:
      DoubleJump, Combat=Balloon, Dash OR TripleJump
      Launch  # Use launch invulnerability to protect you from balloon's explosions
  state WoodsMain.BalloonLureYellowBarrierBroken:
    moki: WoodsMain.BalloonLureBlobDestroyed, Flap, Glide
    gorlek: WoodsMain.BalloonLureBlobDestroyed, Flap, Launch
    kii, WoodsMain.BalloonLureBlobDestroyed:
      Combat=Balloon, Glide OR Launch
      Damage=20, Glide OR Launch
      DoubleJump, TripleJump, Flap OR Damage=20 OR Combat=Balloon
    unsafe, WoodsMain.BalloonLureBlobDestroyed:
      Launch  # Use launch invulnerability to protect you from balloon's explosions
      DoubleJump, Dash, Bash, Grenade=1  # Bait the enemy by jumping and imediately dashing against the left wall, double wall off the wall to  get to the edge near the spikes and bash grenade. Launch the grenade near the right edge and bash it to get to the left edge. If you are too slow, the enemy will die from the explosion after your bash

  # WoodsMain.YellowWallEX now accessible with conn BelowHiddenOre: pickup WoodsMain.YellowWallEX

  conn WoodsMain.BelowHiddenOre:
    moki: WoodsMain.BalloonLureBlobDestroyed, Glide
    gorlek: WoodsMain.BalloonLureBlobDestroyed, Launch
    kii, WoodsMain.BalloonLureBlobDestroyed:
      DoubleJump, TripleJump, Combat=Balloon OR Damage=20  # Don't need the balloon for anything but he's really annoying to avoid
      DoubleJump, Dash, Sword  # pogo the balloon
    unsafe, WoodsMain.BalloonLureBlobDestroyed:
      DoubleJump, TripleJump
      DoubleJump, Sword  # pogo the balloon
      DoubleJump, Bash, Grenade=1  # land on the ledge near the spikes bellow the breakable wall
      DoubleJump, SentryJump=1  # land on the ledge near the spikes bellow the breakable wall
      Dash, Bash, Grenade=2
      Bash, Grenade=3  # bash grenade to get on the skull, bash a tentacle projectile and the bashable plant to get to the blowing enemy level, 2nd bash grenade to get near the spikes and last one to reach the connection
      SentryJump=3  # jump + sword combo to reach the skull, sword combo to reach the tentacle. use your sjumps to get to the connection
  conn WoodsMain.GiantSkull:
    moki:
      Glide OR Launch
      DoubleJump, Dash
    gorlek:
      DoubleJump, TripleJump OR Sword
      Bash, DoubleJump OR Dash
    kii:
      Dash
      DoubleJump, Hammer OR Sentry=1 OR Flash=1 OR Shuriken=1 OR Damage=15
      Bash, Hammer OR Shuriken=1 OR Sentry=2
      Grenade=1, Bash

anchor WoodsMain.BelowHiddenOre at 1038, -4101:  # Below and to the right of the hidden ore, close to the yellow wall
  state WoodsMain.BalloonLureBlobDestroyed:
    moki:
      Sword OR Hammer
      BreakWall=3, Grenade OR Blaze
    unsafe: ShurikenBreak=3 OR Sentry=1

  pickup WoodsMain.HiddenOre:
    moki: Flap, Glide
    gorlek:
      DoubleJump, TripleJump, Bash, Damage=15  # can either use the plant or the skeeto
    kii:
      DoubleJump, Bash, Damage=15  # bash the plant and the skeeto, wall jump on the right wall, Damage for slower reaction times to tp anywhere/just jumping back to safety
      Launch  # Launch straight up from the right side of the fire pit to touch the ceiling, go a bit to the left, launch again on the right wall, wall jump and launch to the pickup. Launch again to return to safety
    unsafe:
      SwordSJump=1  # Sjump onto the wall, use the sword for movement. It looks possible with Hammer, but I can't get it to work.
      HammerSJump=2  # Sword sjump paths are redundant with the above
      HammerSJump=1, Shuriken=1 OR BlazeSwap=1 OR DoubleJump OR Dash OR Glide OR Damage=15 OR PauseHover  # Sjump from a micro ledge at very edge of the fire pit. The damage path requires jumping onto the left wall and climbing up. This is doable with sjump+sentry, but why would you do that when you could just sjump twice?
      SwordJump, TripleJump, Damage=15  # Double jump onto the wall, then double sword jump into the spikes.
      DoubleJump, GrenadeJump  # Micro ledge at the right edge of the fire pit, micro ledge at the right edge of the spikes. Use both.
      Bash  # The skeeto is uncooperative, but it's doable.
      BlazeSwap=6 OR FlashSwap  # Probably room for improvement, I'm not good at swaps
      HammerJump  # This can be done without Triple Jump, but it's really difficult:
        # 1. Jump to the right from the micro ledge on the fire pit, and do an extended hammer jump. You need to reach the small climable wall on the ceiling, next to the spikes above the corruption.
        # 2. Wall jump to the left, and do an extended hammer jump onto the micro ledge next to the spikes in the hidden area. Do the hammer jump late so that you don't hit the ceiling.
        # 3. Hammer jump onto the wall, and hammer jump again to reach the ore. Teleport out.
        # 4. Take a vacation in Luma Pools. You deserve it.
  pickup WoodsMain.YellowWallEX:
    moki: WoodsMain.BalloonLureYellowBarrierBroken

  conn WoodsMain.PetrifiedHowl:
    moki: Glide
    gorlek: Launch  # launch on the wall just bellow the ceiling's spikes, wall jump and lauch again to get to the right wall after the ceiling's spikes
    kii:
      DoubleJump, Damage=45
      DoubleJump, Damage=15, TripleJump OR Bash  # With bash, bait the skeeto
    unsafe:
      DoubleJump, Damage=30
      DoubleJump, Damage=15, Shuriken=2 OR Flash=2 OR Sentry=2
  conn WoodsMain.BalloonLure:
    moki: WoodsMain.BalloonLureBlobDestroyed, Combat=Tentacle OR Bash
    unsafe: WoodsMain.BalloonLureBlobDestroyed

anchor WoodsMain.PetrifiedHowl at 910, -4071:  # At silenced Howl
  refill Checkpoint
  refill Health=1

  pickup WoodsMain.PetrifiedHowlEX: free

  conn WoodsMain.AboveHowl:
    moki: Launch, DoubleJump OR Dash OR Bash OR Glide  # if you don't think of going straight up, these can also carry you through the way around
    gorlek:
      Launch
      Bash, Grenade=1  # it's a checkpoint, you have retries to figure it out
      SentryJump=1, DoubleJump, TripleJump
      SentryJump=1, DoubleJump, Dash
    kii: DoubleJump, Bash  # Bash the tentacle projectile
    unsafe:
      Bash
      DoubleJump, TripleJump
  conn WoodsMain.BrokenOwl:  # Be carefull that it's not redundant with the AboveHowl connection
    moki: BreakWall=3, Bash, Glide
    gorlek:
      BreakWall=3, Glide, Damage=10  # just easy to catch a projectile
      BreakWall=3, DoubleJump, Bash, Damage=15  # different ways to solve
      Bash, DoubleJump, TripleJump
      Dash, DoubleJump, TripleJump, Damage=10  # just easy to catch a projectile
    kii:
      BreakWall=3, Glide
      DoubleJump, Sword  # pogo the tentacles
      Dash, DoubleJump, TripleJump
  conn WoodsMain.BelowHiddenOre:
    moki:
      Glide
      Launch, DoubleJump OR Dash
    gorlek:
      DoubleJump OR Dash OR Launch  # just holding right works so nicely
    kii:
      Sword OR Hammer OR Sentry=3
      Blaze=3, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=15, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=15, Damage=15, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free  # Friendly spikes truly are the best friends of rando players

# checkpoint at 824, -4068

anchor WoodsMain.BrokenOwl at 848, -4058:  # At the collapsing petrified Owl
  refill Checkpoint

  conn WoodsMain.AboveHowl:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=2
    gorlek:
      Dash, Damage=15
      Bash OR SentryJump=1
    kii:
      Damage=15, Hammer OR Sword
    unsafe:
      Dash OR Sword OR Damage=15  # With sword, pogo the skeeto

  conn WoodsMain.TrialStart:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek: Bash OR Hammer OR SwordSJump=1
    kii: Sword  # Pogo a skeeto
    unsafe: free  # just die/reload

anchor WoodsMain.TrialStart at 820, -4047:  # At the start of the trial
  refill Checkpoint:  # refill by starting the trial
    unsafe: WoodsMain.TrialActivation

  pickup WoodsMain.SpiritTrial:
    moki: WoodsMain.TrialActivation, DoubleJump, Dash, Bash, Grapple, Burrow

  conn WoodsMain.BrokenOwl: free
  conn WoodsMain.MidwayTrial:
    moki:
      DoubleJump, Bash, Grapple, Dash OR Glide
      Launch, Grapple, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Launch, DoubleJump OR Dash OR Glide
      DoubleJump, Bash, Grapple
    kii:
      Launch
      DoubleJump, TripleJump, Grapple OR Damage=15
    unsafe:
      Hammer, DoubleJump, Grapple  # either djump+upslash to get a walljump just under the checkpoint or upslash+one slash to land on the branch
      Sword, DoubleJump, Grapple  # upslash+downslash to pass through the semi solid branch at the checkpoint
  conn WoodsMain.AboveHowl:  # make sure it's not redundant with ->BrokenOwl->AboveHowl
    gorlek: Grapple, Glide
    kii: Grapple, Sentry=3 OR Blaze=5
    unsafe: Grapple, Shuriken=3

anchor WoodsMain.MidwayTrial at 873, -3980:  # At the checkpoint under the first sand bag
  # This anchor is purely to make WoodsMain.TrialStart->WoodsMain.OverflowShard less painful to pathfind
  refill Checkpoint

  conn WoodsMain.TrialEnd:
    moki:
      DoubleJump, Bash, Burrow, Dash OR Glide
      Launch, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Launch, DoubleJump OR Dash OR Bash OR Glide
      Launch, Damage=15, Sword OR Hammer OR Burrow
      DoubleJump, Bash, Burrow, TripleJump OR Sword
      DoubleJump, Bash, Burrow, Hammer, Damage=15
      DoubleJump, Bash, Grenade=2, Damage=15, TripleJump OR Dash OR Glide OR Sword  # You can either damage boost at the first sand ball or grenade bash from below
    kii:
      Launch
      DoubleJump, Bash, Burrow OR Grenade=2
      DoubleJump, Burrow, Damage=45
    unsafe:
      DoubleJump, TripleJump, Damage=30
  conn WoodsMain.BeforeLog:  # check for redundancies with AboveHowl
    gorlek: Glide  # Jump and hold right while gliding
    kii: Dash  # coyote + normal dash
    unsafe: Burrow, Damage=15
  conn WoodsMain.OrangeTree:
    gorlek:
      Burrow, Glide  # Burrow and hold right while gliding
      Burrow, DoubleJump, TripleJump  # get to the most right sandball, burrow through it and go right
    kii:
      Burrow, DoubleJump OR Dash  # get to the most right sandball, burrow through it and go right
  conn WoodsMain.AboveHowl:
    gorlek: free  # Jump and hold right
  conn WoodsMain.TrialStart:  # check for redundancies with AboveHowl -> BrokenOwl
    gorlek: Dash OR Glide
    kii: free

anchor WoodsMain.TrialEnd at 868, -3952:  # Below the trial end pedestal
  refill Checkpoint

  state WoodsMain.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: DoubleJump, Dash
    kii: DoubleJump, Glide

  pickup WoodsMain.OverflowShard:
    moki:
      DoubleJump, Dash OR Glide
      Launch
    gorlek: DoubleJump OR Dash OR Glide
    kii:
      Sentry=2
      Sword, Sentry=1 OR Shuriken=1 OR Flash=1
      Hammer, Sentry=1 OR Shuriken=1 OR Flash=1

  conn WoodsMain.MidwayTrial:
    gorlek: Glide
  conn WoodsMain.AboveHowl:
    gorlek: DoubleJump OR Bash OR Sword OR Hammer
  conn WoodsMain.BeforeLog:  # check for redundancies with AboveHowl and MidwayTrial
    moki: DoubleJump, Dash OR Bash OR Glide
    gorlek: Dash
    kii: Sentry=2 OR Shuriken=1
  conn WoodsMain.OrangeTree:  # make sure it's not redundant with ->BeforeLog->OrangeTree
    gorlek:
      Glide
      Burrow, DoubleJump, TripleJump OR Dash OR Sword OR Hammer
    kii:
      Burrow, DoubleJump OR Dash OR Sentry=5
    unsafe:
      Burrow, Shuriken=4  # not in kii cause you use 2 shurikens in a row
      Burrow, Sword

anchor WoodsMain.AboveHowl at 916, -4046:  # At the semisolid above silenced Howl
  pickup WoodsMain.HiddenEX: free

  conn WoodsMain.PetrifiedHowl: free
  conn WoodsMain.BrokenOwl: free
  conn WoodsMain.BeforeLog:
    moki:
      Combat=Balloon, DoubleJump
      Combat=Balloon, Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, Dash OR Damage=20
      Bash, Grenade=1, Dash OR Damage=20
      SentryJump=1, Combat=Balloon OR Dash OR Damage=20
    kii:
      DoubleJump OR Launch
      Bash
      Hammer, Glide OR Dash OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      SentryJump=1
      Sword  # pogo the skeeto twice (enemy behaviour not easily readable, therefore not kii)
      Hammer, Spear=1 OR Blaze=1

anchor WoodsMain.BeforeLog at 967, -4008:  # where you go inside of the log (where shriek chases you and ku)
  refill Checkpoint:  # at 980, -4015
    moki: Combat=Balloon
    gorlek: Dash OR Damage=20
    kii: free

  state WoodsMain.LogBlobDestroyed:
    moki: Combat=Balloon, BreakWall=3
    gorlek: BreakWall=3
    kii: Combat=Balloon OR Damage=20
    unsafe: free  # tp anywhere while blob wants to explode inside of you

  conn WoodsMain.Teleporter:
    moki: WoodsMain.LogBlobDestroyed, Combat=3xBalloon
    gorlek: WoodsMain.LogBlobDestroyed, Combat=Balloon OR Damage=20
    kii: WoodsMain.LogBlobDestroyed
  conn WoodsMain.AboveHowl: free
  conn WoodsMain.OrangeTree:
    gorlek:
      Launch
      DoubleJump, Bash, Grenade=1
      DoubleJump, SentryJump=2  # one extra to let the player figure out where to sjump
    unsafe:
      Bash, Grenade=1  # too precise
      SentryJump=1

anchor WoodsMain.Teleporter at 1083, -4052:  # At the East Woods Teleporter
  refill Full

  state NonGladesTeleporter: free
  state WoodsMain.LogBlobDestroyed:  # these can break the corruption from behind
    gorlek: Sword OR Hammer OR Grenade=1 OR Blaze=1 OR Sentry=1
    unsafe:
      ShurikenBreak=3
      DoubleJump, Glide, Damage=20  # use the balloon

  conn Teleporters: free
  conn WoodsMain.AbovePit:  # So far, this also cover the OrangeTree connection
    moki:
      Glide
      DoubleJump, Bash, Launch  # :)
    gorlek: Launch, Damage=15
    kii:
      Launch
      DoubleJump, TripleJump, Damage=60
      DoubleJump, TripleJump, Bash, Damage=30
    unsafe:
      DoubleJump, TripleJump, Damage=45
      DoubleJump, TripleJump, Bash, Damage=15
      DoubleJump, Damage=45, Dash OR Shuriken=2
      DoubleJump, Damage=15, TripleJump OR Bash
  conn WoodsMain.BeforeLog:  # moki paths are solved with the Teleporter->AbovePit->OrangeTree connection. Make sure this isn't redundant with Teleporter->OrangeTree->BeforeLog
    gorlek, WoodsMain.LogBlobDestroyed:
      DoubleJump, Combat=2xBalloon, Hammer OR Sword OR TripleJump
      SentryJump=1, Combat=2xBalloon OR Dash
      Bash, Grenade=1, Combat=2xBalloon OR Dash
      Launch
    kii, WoodsMain.LogBlobDestroyed:
      Combat=Balloon, DoubleJump, Sword OR Hammer OR TripleJump OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # only need to kill the first balloon
      Damage=20, DoubleJump, Sword OR Hammer OR TripleJump OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # dboost on the first balloon to kill it
      DoubleJump, Dash
    unsafe, WoodsMain.LogBlobDestroyed:
      DoubleJump

anchor WoodsMain.OrangeTree at 1030, -4010:  # At the right of the tree above the teleporter
  conn WoodsMain.AbovePit:
    moki: Bash OR Glide OR Launch
    gorlek:
      DoubleJump
      Dash
    kii: Sword  # Pogo the plant
    unsafe: Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
  conn WoodsMain.BeforeLog:
    moki:
      Launch
    gorlek:
      SentryJump=1, DoubleJump
      DoubleJump, Bash, Grenade=1
    kii: Bash
  conn WoodsMain.Teleporter:  # make sure it's not redundant with ->AbovePit->Teleporter and also make sure that it is necessary, since you can only get to BeforeLog or AbovePit with this, which both already have their respective connections from this anchor
    kii:
      Sentry=3
      Damage=15, Sentry=1 OR Shuriken=1

# checkpoint at the anchor below, could split another anchor off for the crystal and move it over

anchor WoodsMain.AbovePit at 1234, -3985:  # To the left of the pit before feeding grounds
  refill Energy=3:  # the crystal in the pit
    unsafe: BreakCrystal, Bash, DoubleJump OR Dash OR Glide OR Launch  # technically just Bash

  conn WoodsMain.Teleporter:  # a dead end in moki
    gorlek: DoubleJump OR Dash OR Glide OR Launch OR Sword OR Damage=15
    kii:
      Hammer OR Shuriken=2 OR Blaze=4 OR Flash=2 OR Sentry=2 OR Damage=15
      Bash, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
  conn WoodsMain.OrangeTree:
    moki: Bash OR Glide OR Launch
    gorlek:
      DoubleJump, Dash OR TripleJump OR Damage=15
      Dash, Damage=15
    kii:
      Damage=45
      Sword  # Pogo the plant
      Damage=30, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Hammer, DoubleJump OR Dash
    unsafe:
      Damage=30
  conn WoodsMain.FeedingGrounds:
    moki:
      DoubleJump, Dash OR Bash
      Glide OR Launch
      Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer
      Dash, Bash OR Sword OR Hammer
      Bash, Sword OR Hammer
    kii:
      Dash OR DoubleJump OR Hammer OR Blaze=4 OR Sentry=2
      Bash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  conn WoodsShrine:  # Make sure this isn't redundant with AbovePit->FeedingGrounds->WoodsShrine
    gorlek: Damage=15, DoubleJump OR Dash
    kii:
      Blaze=4 OR Sentry=2
      Damage=15, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe: free

anchor WoodsMain.FeedingGrounds at 1292, -3993:  # At the left entrance to feeding grounds
  refill Checkpoint

  # having the initial escape completed is a negative, not a positive. The paths going through it are the connections to Wastes.
  # if you complete the initial escape, rocks fall and block most of the connection paths to WestTP. This is equally true for the base game though and solved by the fact that if you complete the escape, you unlock the teleporter, making these paths not softlockable

  conn WoodsShrine:
    moki:
      Glide OR Launch
      DoubleJump, Dash
    gorlek: Damage=15, DoubleJump OR Dash
    kii:
      DoubleJump OR Dash OR Sword OR Hammer OR Blaze=4 OR Sentry=2
      Damage=15, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free
  conn LowerWastes.WestTP:  # every path needs to be possible while having Seir
    moki:
      Grapple, Glide, DoubleJump OR Dash OR Launch  # this solves with Seir as well
      WindtornRuins.Seir:  # these wouldn't solve without Seir
        DoubleJump, Bash, Grenade=1, Grapple
        Grapple, Glide
        Burrow
        Launch
    gorlek:
      Launch
      Burrow  # If doing cat and mouse, burrow below first to reset shriek aggression then burrow to the TP
      Glide, DoubleJump, TripleJump
      Glide, Grapple, DoubleJump OR Dash
      Grapple, SentryJump=1, DoubleJump
      WindtornRuins.Seir:  # these wouldn't solve without Seir
        SentryJump=1, DoubleJump, TripleJump  # tjump+up slash to reach the grappable surface
        Bash, Grenade=1, Grapple
        Bash, Grenade=2, Dash  # Dash to get in bash range on the 2nd grenade to get on the grappable surface
        Glide, Bash, Grenade=1, Dash  # ^ but it's only one grenade because of glide
        Bash, Grenade=1, DoubleJump, TripleJump, Dash OR Sword OR Hammer
    kii:
      Glide, Dash, DoubleJump, Sword OR Hammer
      Glide, DoubleJump, Hammer, Flash=1 OR Sentry=1
      Bash, Grenade=1, Dash, DoubleJump, Sword OR Hammer
      Bash, Grenade=1, DoubleJump, Hammer, Flash=1 OR Sentry=1
      Bash, Grenade=1, DoubleJump, TripleJump  # if you are doing the escape, use the hiding spot. if you have seir, use a bashnade
      WindtornRuins.Seir:  # these wouldn't solve without Seir
        Glide, Bash, Grenade=1, DoubleJump OR Dash
        Bash, Grenade=2, DoubleJump
    unsafe:
      DoubleJump, TripleJump, Damage=30  # damage for when you get seir
      DoubleJump, Bash, Grenade=1
      Glide, DoubleJump, Hammer, Shuriken=1  # not in kii because it is very easy to knock away your safe spot with the shuriken
      Bash, Grenade=1, DoubleJump, Hammer, Shuriken=1  # not in kii because it is very easy to knock away your safe spot with the shuriken
      DoubleJump, GrenadeJump
  conn WoodsMain.AbovePit:
    moki:
      DoubleJump, Bash
      Launch
    gorlek:
      Bash, Grenade=1, Dash OR Glide OR Sword OR Hammer
      SentryJump=1, DoubleJump OR Dash OR Glide
    kii:
      Bash, Grenade=1
      Dash, DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1
    unsafe:
      Dash, DoubleJump, TripleJump, Shuriken=1  # too precise for kii
      DoubleJump, TripleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1  # too precise for kii
      DoubleJump  # fall then good old glide skip

anchor WoodsShrine at 1361, -4068:
  nospawn
  refill Full

  state WoodsMain.CombatShrineCompleted:
    moki, Regenerate, Combat=Hornbug+Lizard+3xSkeeto+4xEnergyRefill+2xCrystalMiner+Bat+4xEnergyRefill+9xBalloon+4xEnergyRefill+4xMantis+Bat:  # this one has it all -_-
      Damage=80
      Damage=65, DoubleJump OR Dash
      Damage=50, Launch
    unsafe: Combat=Hornbug+Lizard+3xSkeeto+4xEnergyRefill+2xCrystalMiner+Bat+4xEnergyRefill+9xBalloon+4xEnergyRefill+4xMantis+Bat

  pickup WoodsMain.ShrineEX: free
  pickup WoodsMain.CombatShrine:
    moki: WoodsMain.CombatShrineCompleted

region LowerReach:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor LowerReach.Entry at -390, -4025:  # Behind Baur
  refill Checkpoint
  refill Health=1

  state LowerReach.BearSneezed:
    moki: Flap
  state LowerReach.ThawBaurFurnace:
    moki, LowerReach.BearSneezed, LowerReach.BearBridgeBroken:
      Bash, Flap
      Grenade=1
  state LowerReach.FreezeBaurFurnace:
    moki: LowerReach.BearSneezed, LowerReach.BearBridgeBroken, Flap

  pickup LowerReach.BelowBaurEX:
    moki, LowerReach.BearSneezed, LowerReach.BearBridgeBroken:
      DoubleJump, Dash, Bash, Flap
      Bash, Grenade=1
      Launch
    gorlek, LowerReach.BearSneezed, LowerReach.BearBridgeBroken:
      DoubleJump, TripleJump, Dash
      SentryJump=1
    kii, LowerReach.BearSneezed, LowerReach.BearBridgeBroken:
      Bash
      DoubleJump, TripleJump, Hammer OR Shuriken=1
      DoubleJump, TripleJump, Glide, Sword OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      DoubleJump, Dash, Hammer
    unsafe, LowerReach.BearSneezed, LowerReach.BearBridgeBroken:
      DoubleJump, TripleJump, Sword OR Sentry=1 OR Flash=1 OR Spear=1
      DoubleJump, Dash, Sword OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      GrenadeJump

  conn LowerReach.AboveEntry:
    moki:
      DoubleJump, Launch  # Can't rely on the sleeping bear to be there
      Bash, DoubleJump OR Launch OR Grenade=1
    gorlek:
      Bash, Dash
      Launch  # a little tight but totally doable. Jump up before launching.
      Bash, Glide, Damage=20
      SentryJump=1, DoubleJump OR Bash
    kii:
      Bash, Damage=20, Hammer OR Sentry=3
    unsafe:
      SentryJump=1
      #Bash, Damage=20, Sword OR Shuriken=2 OR Sentry=2 OR Flash=2
      Bash  # can be done damageless, but damage is likely. Keep jumping at the right wall until you go over it and bash the first latern at just the right angle to reach the second
      DoubleJump, TripleJump, Sentry=3, Damage=20  # https://youtu.be/EhC4SRe4UA0
      DoubleJump, TripleJump, Sword
      HammerJump, Damage=20
  conn LowerReach.Icefall:
    unsafe: DoubleJump, TripleJump, Hammer  # climb the left wall. Yes this is horrible after doing the escape
  conn WestGlades.Upper:
    moki: LowerReach.BearSneezed

anchor LowerReach.AboveEntry at -401, -4000:  # On the platform above Baur inside the tree trunk
  refill Checkpoint

  state LowerReach.Lever:
    moki:
      Launch
      LowerReach.ThawBaurFurnace, DoubleJump
    gorlek:
      LowerReach.ThawBaurFurnace, Dash
    kii:
      DoubleJump, TripleJump, Damage=20, Sword OR Hammer
      Bash, Grenade=1, LowerReach.ThawBaurFurnace OR DoubleJump OR Dash OR Sword OR Hammer OR Shuriken=2 OR Sentry=2 OR Flash=2
      LowerReach.ThawBaurFurnace, Sword OR Sentry=2
      LowerReach.ThawBaurFurnace, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
      LowerReach.ThawBaurFurnace, Glide, Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      # LowerReach.ThawBaurFurnace, Glide, Spear=1
      LowerReach.ThawBaurFurnace, Hammer OR Glide OR Sentry=2
      Bash, Grenade=1, Glide OR Spear=2  # Use the plant as a platform
      SentryJump=1  # you actually want a weaker jump to land on top of the plant, a strong one will send you sailing over it. Weapon stalls from there
      Bash, Sword OR Hammer OR DoubleJump OR Dash OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Damage=20  # be careful the slightly moving spike platform isn't at the top when going over
      DoubleJump, TripleJump, Sword OR Hammer  # you first need to get on the plant on the left
      Dash, DoubleJump, Damage=20, Hammer OR Sword  # djump+upslash+ dash in the spikes, grab the plant then djump + upslash to reach the left wall. Sword much harder, need to get a ramp

  pickup LowerReach.AboveBaurLowerEX:
    moki:
      Launch
      LowerReach.FreezeBaurFurnace, Bash, Grenade=1  # seemed a bit hectic without cooling the furnace
      DoubleJump, Bash, LowerReach.ThawBaurFurnace OR Grenade=1  # use a grenadebash if you can't use the tongue plant
    gorlek:
      LowerReach.ThawBaurFurnace, Bash, Dash OR DoubleJump OR Glide  # have fun with the snaptraps
      Bash, Grenade=1 OR SentryJump=1
      SentryJump=2
    kii:
      DoubleJump, TripleJump  # Climbing frozen tongue with TripleJump, tjump from the left wall into the xp
      LowerReach.ThawBaurFurnace, Bash, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2 OR Spear=1
      LowerReach.ThawBaurFurnace, DoubleJump, Dash, Sword  # Either use the left wall or pogo the mortar
    unsafe:
      SentryJump=1, DoubleJump  # sjump, climb the left wall then djump + up slash + weapon stall to reach the xp
      Bash  # jump repeatedly under the left side of the snaptrap to aggro the spitter. yes, really.
      DoubleJump, Dash  # From the left of the frozen tongue, dash ramp+doublejump+dash. Jump off the tongue asap, djump+dash. Climb the left wall then djump + dash
      LowerReach.ThawBaurFurnace, Sword, Hammer, Sentry=2, Damage=20  # pogo the mortar, climb the left wall then sentry+hammer upslash (you'll get a dboost there). Land on the ledge then jump, hammer upslash, sword hover+sentry at the end
      LowerReach.ThawBaurFurnace, DoubleJump, Dash OR Sword OR Hammer OR Sentry=2
      LowerReach.ThawBaurFurnace, Dash, Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1  # pogo the mortar once to go to the left wall and a second time to climb the wall. upslash+dash+energy from there
  pickup LowerReach.AboveBaurUpperEX:
    moki, LowerReach.ThawBaurFurnace:
      Launch
      DoubleJump, Dash, Bash
    gorlek:
      Launch
      LowerReach.ThawBaurFurnace, DoubleJump, Bash
    kii, LowerReach.ThawBaurFurnace:
      DoubleJump, TripleJump
      DoubleJump, Dash, Sword  # Either use the left wall or pogo the mortar
    unsafe:
      DoubleJump, TripleJump  # I hope you'll hate that path as much as I do so it can stay in unsafe for ever
      LowerReach.ThawBaurFurnace:
        DoubleJump, Dash OR Sword OR Hammer
        SentryJump=2, DoubleJump OR Damage=20  # First jump into the spikes near the shooter, can use lower jump to snaptrap - wall - weapon stall to spikes, then sentry up from spikes to the tongue plant
        SwordSJump=2  # Pogo the shooter to make it to the left wall, move a bit away from it then sjump+upslash to reach the tongue
        SentryJump=1, Dash  # up slash + dash to reach the left wall. Move a bit away from it, sjump to reach the tongue
        Bash  # Look up below and to the left of the snap plant. Then, bash the mortar -> its projectile in succession to get up
        Dash, Sword, Hammer OR Shuriken=2 OR Flash=2 OR Sentry=2  # pogo the mortar once to go to the left wall and a second time to climb the wall. upslash+dash+energy from there

  conn LowerReach.Icefall:
    moki: LowerReach.ThawBaurFurnace OR DoubleJump OR Launch
    gorlek: Dash
    kii:
      Bash, Grenade=1
      Sword OR Hammer OR Shuriken=2 OR Sentry=2  # with hammer/sword: upslash before grabing the frozen tongue, jump out of it then weapon stall
    unsafe:
      Bash  # jump to aggro the spitter and catch high up on the frozen tongue, then jump off quickly
  conn LowerReach.CentralEnemyPaths:
    moki, LowerReach.Lever:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek, LowerReach.Lever:
      Bash, Sword OR Hammer
      DoubleJump, TripleJump OR Dash OR Glide
      Dash, Glide
    kii, LowerReach.Lever:
      Bash, Shuriken=1 OR Sentry=2 OR Blaze=3 OR Damage=20
      DoubleJump, Sword OR Hammer OR Sentry=2 OR Damage=20
      Dash, Sword OR Hammer
      Dash, Damage=20, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Glide, Hammer OR Spear=1 OR Damage=20
      Sword, Shuriken=1 OR Sentry=2 OR Damage=20
      Hammer, Damage=20, Shuriken=1
    unsafe, LowerReach.Lever:
      Bash, Sentry=1 OR Flash=1
      #Hammer, Damage=20, Spear=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Hammer, Damage=20
      Glide, Sword OR Sentry=1 OR Shuriken=1 OR Flash=1
      Dash, Shuriken=1 OR Sentry=2 OR Damage=20 # Dash on the small wall from the branch where the lantern is attached, dash again then stall with sentry/shuriken
  conn LowerReach.Entry: free

anchor LowerReach.Icefall at -448, -3999:  # Where you drop the rock on Baur's nose
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state LowerReach.BearBridgeBroken:
    moki: LowerReach.BearSneezed  # the bear blocks the rock
  state LowerReach.LeftFurnace:
    moki:
      Grenade=1, Bash, DoubleJump OR Dash OR Glide
      Grenade=1, Combat=Nest, Grapple, DoubleJump OR Dash
      Grenade=1, Launch, Combat=Nest OR Bash
    gorlek:
      Grenade=1, Bash
      Grenade=1, Combat=Nest, Grapple, Glide OR Sword
      Grenade=1, Damage=10, Grapple, DoubleJump OR Dash OR Glide OR Sword  # Grapple past the enemies, might get hit
      Grenade=1, DoubleJump, TripleJump
      Grenade=1, Combat=Nest, SentryJump=1
      Grenade=1, Launch
    kii:
      Grenade=1, Damage=20, Combat=Nest OR DoubleJump  # Damage boost on the spikes on the frozen waterfall
      Grenade=1, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      Grenade=1, DoubleJump
      Grenade=1, Grapple, Spear=1

  pickup LowerReach.IcefallOre:
    moki, LowerReach.LeftFurnace:
      Bash, Grapple, DoubleJump OR Dash OR Glide  # bash the enemies
      Bash, Launch
      Combat=Nest, Grapple, DoubleJump OR Dash
    gorlek, LowerReach.LeftFurnace:
      Bash, DoubleJump OR Dash OR Grapple OR Glide
      Combat=Nest, Grapple, Glide OR Sword
      Damage=10, Grapple, DoubleJump OR Dash OR Glide OR Sword
      Water, WaterDash, DoubleJump, TripleJump
      Water, Launch
    kii, LowerReach.LeftFurnace:
      Bash OR Launch
      Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Water, WaterDash, DoubleJump, Hammer
      Damage=20, WaterDash, DoubleJump, TripleJump OR Hammer
      DoubleJump, TripleJump, Sword  # Using the skeetos is by far the easiest way, but not mandatory
      Combat=Nest, DoubleJump, TripleJump, Dash OR Shuriken=2 OR Sentry=3  # go from the second snaptrap
      Combat=Nest, DoubleJump, TripleJump, Glide, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1 OR Water OR Damage=20
      Combat=Nest, Water, DoubleJump, TripleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Combat=Nest, Damage=20, DoubleJump, TripleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Combat=Nest, Hammer, DoubleJump, TripleJump OR Dash  # Upswing for lenience
    unsafe, LowerReach.LeftFurnace:
      # DoubleJump, Glide, Sword  # pogo the fish, land on the snaptrap. from the second snaptrap, glide+djump+upslash
      DoubleJump, Sword  # reset your djump by hitting the nest with sword
      DoubleJump, Dash, Combat=Nest, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=40  # bait the second snaptrap, dash ramp on the snaptrap then dash+djump.
      DoubleJump, TripleJump, Combat=Nest, GlideJump OR Water OR Damage=20
      Combat=Nest, SwordSJump=1, DoubleJump, TripleJump  # running sjump +tjump+upslash
      Combat=Nest, HammerSJump=1, DoubleJump, TripleJump, Dash
  pickup LowerReach.IcefallEX:
    moki, LowerReach.LeftFurnace:
      DoubleJump, Bash  # bash the enemies
      DoubleJump, Water, WaterDash  # swim past the enemies
      DoubleJump, Combat=Nest, Grapple  # kill the enemies
      Launch, Combat=Nest OR Bash
      Launch, Water, WaterDash
    gorlek, LowerReach.LeftFurnace:
      DoubleJump, TripleJump, Water OR Damage=20
      DoubleJump, TripleJump, Dash, Combat=Nest
      DoubleJump, WaterDash, Damage=20
      DoubleJump, Grapple, Damage=10  # Grapple past the enemies, might get hit
      Launch
    kii, LowerReach.LeftFurnace:
      DoubleJump, Grapple
      DoubleJump, TripleJump, Dash OR Shuriken=1 OR Sentry=2
      DoubleJump, TripleJump, Glide, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      DoubleJump, TripleJump, Combat=Nest, Hammer
      DoubleJump, Combat=Nest, Dash, Hammer
      DoubleJump, Sword, TripleJump OR Dash  # Pogo a fish or use the skeetos
      DoubleJump, Damage=40  # dboost in poisonous water and spikes to reach snaptrap
      DoubleJump, Water, Damage=20  # dboost in spikes to reach the snaptraps
      Hammer, Bash
      Hammer, Grapple, Combat=Nest OR Dash
      Hammer, WaterDash, Damage=20 OR Water
    unsafe, LowerReach.LeftFurnace:
      Combat=Nest, SwordSJump=1, DoubleJump OR Dash OR Glide
      Combat=Nest, SentryJump=1, Glide, Dash OR DoubleJump
      Combat=Nest, SentryJump=1, Dash, DoubleJump
      Grapple, Damage=20, Dash OR Glide OR Sword OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # dboost to get the pickup
      Grapple, Spear=1, Dash OR Glide OR Sword OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # Spear to reach the pickup
      Grapple, Spear=3
      Grapple, Dash OR Glide:
        Blaze=1 OR Sentry=1 OR Flash=1  # bait the snaptrap, jump of it so it returns to its highest point then jump again+energy to reach the pickup
      Bash
      Grapple, Sword
      Sword, Water OR Dash OR Damage=20  # Pogo a fish
      Water, WaterDash, Damage=20 OR Hammer
      WaterDash, Damage=20, Sword OR Hammer OR Spear=1 OR Damage=20
      Water, WaterDash, Flash=1 OR Sentry=1 OR Spear=1
      DoubleJump, Damage=20, Hammer OR Spear=1  # dboost in poisonous water, djump+upslash/spear to walljump of the left side of the snaptrap

  conn LowerReach.AboveEntry:
    moki: LowerReach.ThawBaurFurnace OR DoubleJump OR Launch
    gorlek: Dash
    kii: Glide OR Sword OR Hammer OR Sentry=3  # From the same height as the water
    unsafe: Bash  # Bait a skeeto
  conn LowerReach.Entry: free

anchor LowerReach.CentralEnemyPaths at -335, -4009:  # Enemy path counterpart for LowerReach.Central
  nospawn
  # these are exclusively non-redundant paths relying on the slug enemy that despawns if you spawn on this anchor
  # since checkpoint-despawning enemies are generally not gorlek, paths are only kii and upwards
  refill Checkpoint

  pickup LowerReach.AboveDoorEX:
    kii:
      Bash
      DoubleJump, Sword
  pickup LowerReach.LupoMap:
    kii: SpiritLight=150, Bash

  conn LowerReach.Central: free  # connection to non-enemy reliant paths
  conn LowerReach.OutsideTPRoom:
    kii:
      Bash, Hammer OR Spear=1
      Sword, DoubleJump, TripleJump, Spear=1
      LowerReach.ThawCentralFurnace, Bash, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
    unsafe: Sword, DoubleJump, Hammer
  conn LowerReach.Entry:
    unsafe: LowerReach.Lever, Bash  # bash the slime near the spikes then bash glide to the lantern

anchor LowerReach.Central at -335, -4009:  # After the lever door
  # the slug despawns if you spawn on this anchor, paths using it have to be in the LowerReach.CentralEnemyPaths counterpart
  # check paths for redundancies with going to a neighbouring anchor and then to the EnemyPaths counterpart, in particular with SecondSoup

  pickup LowerReach.AboveDoorEX:  # check for redundancies with OutsideTPRoom
    moki:
      Launch
      LowerReach.ThawCentralFurnace, DoubleJump, Dash, Hammer OR Spear=1
    gorlek:
      Bash, Grenade=1
      SentryJump=1
      LowerReach.Lever, DoubleJump, TripleJump
    kii:
      LowerReach.Lever, DoubleJump, Sword OR Hammer OR Spear=1
      LowerReach.ThawCentralFurnace, DoubleJump, Glide, Hammer
      LowerReach.ThawCentralFurnace, DoubleJump, Glide, Spear=1, Shuriken=1 OR Sentry=1 OR Flash=1
      LowerReach.ThawCentralFurnace, DoubleJump, Glide, Spear=2
      LowerReach.ThawCentralFurnace, DoubleJump, Sentry=2, Hammer OR Spear=1
      LowerReach.ThawCentralFurnace, Dash, Hammer
    unsafe:
      DoubleJump, TripleJump
      Sword, Hammer, Flash=1 OR Sentry=1 OR Spear=1
      Grenade=1  # GrenadeJump=1
      Dash, DoubleJump, Sentry=1 OR Blaze=1 OR Spear=1 OR Flash=1 OR Shuriken=1  # Dash ramp from the ramp near the spikes otw to Lupo
      LowerReach.ThawCentralFurnace, Sword, Dash, Spear=1
      LowerReach.ThawCentralFurnace, Sword, Hammer, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # hammer upslash+sword full combo+energy weapon
  pickup LowerReach.LupoMap:
    moki, SpiritLight=150:
      Launch
      DoubleJump, Dash
      LowerReach.ThawCentralFurnace, Bash, Grenade=1, DoubleJump OR Dash OR Glide
    gorlek, SpiritLight=150:
      DoubleJump, TripleJump
      SentryJump=1  # from the snaptrap
      LowerReach.ThawCentralFurnace, Bash, Grenade=1  # just land on the little wall first
    kii, SpiritLight=150:
      DoubleJump, Sword OR Hammer
      DoubleJump, Glide, Shuriken=1 OR Flash=1 OR Sentry=1 OR Spear=1
      DoubleJump, Sentry=2
      Dash, Hammer
      LowerReach.Lever, DoubleJump, Glide, Hammer OR Spear=1  # from LowerReach.AboveDoorEX
    unsafe, SpiritLight=150:
      Dash, Sword
      Grenade=1  # GrenadeJump=1
      DoubleJump, Shuriken=1
  pickup LowerReach.TPLeftEX:  # Check for redundancies with OutsideTPRoom
    moki: LowerReach.ThawCentralFurnace, DoubleJump, Dash
    gorlek:
      Bash, Grenade=2, Spear=1
      LowerReach.Lever, DoubleJump, TripleJump, Hammer OR Spear=1  # finish with an upswing
      SwordSJump=2, Spear=1
      HammerSJump=3
    kii:
      LowerReach.Lever, Hammer, DoubleJump, Glide OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1 OR Damage=20
      LowerReach.Lever, Spear=1, DoubleJump, Dash
      LowerReach.ThawCentralFurnace, DoubleJump, Glide, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      LowerReach.ThawCentralFurnace, DoubleJump, Sentry=5
      LowerReach.ThawCentralFurnace, DoubleJump, Sentry=2, Damage=20
      LowerReach.ThawCentralFurnace, LowerReach.Lever, DoubleJump, Spear=2, Damage=20  # from LowerReach.AboveDoorEX
    unsafe:
      LowerReach.Lever, DoubleJump, Sword, Spear=1  # Pogo the mortar projectile once it hit the snaptrap
      Grenade=2, Hammer OR Spear=1  # GrenadeJump=2, Hammer OR Spear=1
      LowerReach.ThawCentralFurnace, Dash, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      LowerReach.ThawCentralFurnace, Bash
      LowerReach.ThawCentralFurnace, LowerReach.Lever, DoubleJump, Glide

  conn LowerReach.SecondSoup: free
  conn LowerReach.BelowLupo:
    kii:
      DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Sentry=2 OR Blaze=3
      Damage=10, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2
  conn LowerReach.OutsideTPRoom:
    moki:
      Launch
      LowerReach.ThawCentralFurnace, DoubleJump, Dash, Bash
      LowerReach.ThawCentralFurnace, Bash, Grenade=1
    gorlek:
      Hammer OR Spear=1:  # go up through the breakable ceiling
        Bash, Grenade=1, DoubleJump OR Dash OR Damage=20
        Bash, Grenade=2
        LowerReach.Lever, DoubleJump, TripleJump, Bash
      SwordSJump=3, Spear=1
      SwordSJump=4, Hammer
      HammerSJump=3
      LowerReach.ThawCentralFurnace, DoubleJump, TripleJump OR Dash
    kii:
      Hammer OR Spear=1:  # go up through the breakable ceiling
        DoubleJump, TripleJump, Dash
        Bash, Grenade=1
      LowerReach.Lever, Hammer, DoubleJump, TripleJump OR Dash
      LowerReach.Lever, Spear=1, DoubleJump, TripleJump
      LowerReach.ThawCentralFurnace, DoubleJump, Sword OR Hammer
      LowerReach.ThawCentralFurnace, DoubleJump, Glide, Shuriken=2
      LowerReach.ThawCentralFurnace, Dash, Bash, Hammer
    unsafe:
      Grenade=2, DoubleJump, Hammer OR Spear=1  # GrenadeJump=2, DoubleJump, Hammer OR Spear=1
      LowerReach.ThawCentralFurnace, SentryJump=2
      LowerReach.ThawCentralFurnace, Dash, Sword  # coyote dash->up slash->dash->weapon stall to grab the tongue. pass through the tongue ennemy from the right with downslashes
      LowerReach.ThawCentralFurnace, Dash, Hammer  # Stand on the tongue plant
  conn LowerReach.Entry:
    moki, LowerReach.Lever:
      DoubleJump, Dash OR Glide
      Launch
    gorlek, LowerReach.Lever: DoubleJump OR Dash OR Damage=20
    kii, LowerReach.Lever:
      Hammer OR Shuriken=1
      Glide, Sword
    unsafe, LowerReach.Lever:
      Sword
      Glide, Spear=1 OR Flash=1 OR Sentry=1
  conn LowerReach.AboveEntry:  # check for redundancies with LowerReach.Entry
    gorlek: LowerReach.Lever, DoubleJump, TripleJump, Dash, Sword
    kii: LowerReach.Lever, DoubleJump, TripleJump, Dash OR Sword

anchor LowerReach.OutsideTPRoom at -311, -3970:  # To the left of the teleporter room
  refill Checkpoint
  refill Full:  # use the teleporter
    moki: Grenade=1
    gorlek: SentryBurn=1
  refill Health=1
  refill Energy=3:
    moki: BreakCrystal

  pickup LowerReach.AboveDoorEX:
    moki: Bash OR Hammer OR Spear=1
    unsafe:
      SentryRedirect=1 OR GrenadeRedirect=1
  pickup LowerReach.LupoMap:
    moki: SpiritLight=150, DoubleJump OR Dash OR Glide OR Launch
    gorlek: SpiritLight=150  # not too hard to do damageless, slide down the tongue plant and land on the little wall
  pickup LowerReach.TPLeftEX:
    moki:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Glide OR SentryJump=1
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer
      Dash, Sword OR Hammer
      Bash, Sword OR Hammer
    kii:
      DoubleJump OR Dash OR Sword OR Hammer
      Bash, Grenade=1  # can be done from the ledge next to breakable floor
    unsafe:
      PauseHover
      GrenadeJump
      Bash OR Sentry=2
  pickup LowerReach.HiddenOre:
    moki:
      Launch
      LowerReach.ThawCentralFurnace, DoubleJump, Bash, Dash OR Glide OR Grenade=1
    gorlek:
      LowerReach.ThawCentralFurnace, DoubleJump, Bash OR SentryJump=1
    kii:
      Sword, DoubleJump, TripleJump  # pogo the mortar
      LowerReach.ThawCentralFurnace, Bash, Grenade=1  # bash the mortar so you can reach your grenade from higher
      LowerReach.ThawCentralFurnace, Bash, Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1  # stand near to the mortar, bash it then its projectile to reach the snaptrap. Use your option once it opens again.
    unsafe:
      Bash, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1  # jump on the tongue, let ori slide down then double jump again and go for the right wall; difficulty varies depending on the method of limiting framerate
      DoubleJump, Damage=20, TripleJump OR Sword  # jump onto the spikes then up to the snaptrap. Jump on the tongue, let ori slide down then double jump again and go for the right wall
      SentryJump=1
      Bash, Glide  # bash mortar and stack 2 projectiles, bash one upwards and bash both for enough height
      DoubleJump, TripleJump  # Jump from the snap traps on the way to tokk
      HammerJump
      GlideHammerJump  # between tokk and this anchor, store your glidejump and use it to the left of the tongue  # or do 2 GlideHammerJumps directly underneath the pickup (one form teh ground and one from the snaptrap)
      # LowerReach.ThawCentralFurnace, Bash, Blaze=1
      LowerReach.ThawCentralFurnace, Bash  # stand beside the spitter, bash off it once it shoots, then again off the projectile

  conn LowerReach.SecondSoup: free
  conn LowerReach.CentralEnemyPaths:
    moki: DoubleJump OR Dash OR Bash OR Glide OR Launch OR Hammer OR Spear=1
    gorlek: free
  conn LowerReach.Teleporter:
    moki: Grenade=1
    gorlek: SentryBurn=1
  conn LowerReach.BelowTokk:
    moki:
      DoubleJump, Dash, Bash
      Launch
    gorlek:
      DoubleJump, TripleJump, Bash OR SentryJump=1
      Bash, Grenade=1, DoubleJump
      SentryJump=1, DoubleJump, TripleJump
      LowerReach.FreezeCentralFurnace, SwordSJump=1, DoubleJump
      LowerReach.FreezeCentralFurnace, Bash, DoubleJump, Glide OR Sword
    kii:
      DoubleJump, TripleJump  # Jump from the higher ground
      Bash, DoubleJump OR Dash
      LowerReach.FreezeCentralFurnace, Bash, Sword OR Hammer
    unsafe:
      DoubleJump, Damage=40
      # Bash, Grenade=1
      Bash
      # !!!never tested for this connection, moved from 'conn UpperReach.KeystoneRoom'!!!
      # SentryJump=1, DoubleJump, LowerReach.ThawCentralFurnace  # djump+dash from the frozen snaptrap / bait the last snaptrap and double jump + use weapon to stall in the air
      # HammerSJump=1, DoubleJump, Glide  # double jump+upslash from the plant to get near the burrow section, climb it then glide to the right

anchor LowerReach.BelowTokk at -296, -3944:
  refill Checkpoint

  conn LowerReach.OutsideTPRoom: free
  conn UpperReach.KeystoneRoom:
    moki:
      DoubleJump, Dash, Bash  # bash the mantis
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump OR Dash
      Bash, DoubleJump OR Dash OR Glide OR Sword  # bash the mantis
      SentryJump=1, DoubleJump
      SentryJump=2
    kii:
      Sword  # Pogo the mantis
      Hammer, DoubleJump OR Dash
      Bash, Hammer OR Sentry=2  # Bash the mantis, use the other things to get to the mantis
      Combat=Mantis, DoubleJump, Sentry=2
      Combat=Mantis, DoubleJump, Glide, Shuriken=1 OR Sentry=1 OR Flash=1
      LowerReach.ThawCentralFurnace, Combat=Mantis, DoubleJump, Glide, Spear=1
      LowerReach.ThawCentralFurnace, Combat=Mantis, Dash, Shuriken=1 OR Sentry=1 OR Flash=1  # coyote dash from the snaptrap
    unsafe:
      LowerReach.ThawCentralFurnace, Combat=Mantis, Dash, Spear=1 OR Blaze=1
  conn UpperReach.BurrowArea:
    moki:
      Burrow, DoubleJump, Dash, Bash  # bash the mantis
      Burrow, DoubleJump, Bash, Grenade=1
      Burrow, Launch
    gorlek:
      Burrow, DoubleJump, TripleJump
      Burrow, Bash, DoubleJump OR Dash OR Glide OR Sword  # bash the mantis
      Burrow, SentryJump=1, DoubleJump
      Burrow, SentryJump=2
    kii:
      Burrow, Sword  # Pogo the mantis
      Burrow, Bash, Hammer OR Sentry=2
      Burrow, LowerReach.ThawCentralFurnace, DoubleJump, Dash OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Burrow, LowerReach.ThawCentralFurnace, Dash, Hammer
    unsafe:
      Burrow, DoubleJump, Hammer OR Spear=1  # Hammer early to avoid the fake autotarget near the wall
      Burrow, DoubleJump, Damage=20
      Burrow, LowerReach.ThawCentralFurnace, Combat=Mantis, Dash, Spear=1

anchor LowerReach.Teleporter at -259, -3962:
  refill Full

  state NonGladesTeleporter: free

  conn Teleporters: free
  conn LowerReach.OutsideTPRoom:
    moki: Grenade=1
    gorlek: SentryBurn=1
  conn LowerReach.EastEnemyPaths:
    moki: LowerReach.TPLantern

# checkpoint at -296, -3944

anchor LowerReach.SecondSoup at -316, -4037:  # Next to the soup below the teleporter
  state LowerReach.ThawCentralFurnace:
    moki: Flap, Bash, Combat=ShieldMiner, DoubleJump, Dash
    gorlek: Flap, Bash, Combat=ShieldMiner
    unsafe: Flap, Bash
  state LowerReach.WindLantern:
    unsafe: Flap, Bash, Dash OR Launch

  pickup LowerReach.MeltIceEX:
    moki: Grenade=1
    gorlek:
      Bash, Flap
      SentryBurn=1
  pickup LowerReach.BurrowEX:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow  # TP out
  pickup LowerReach.BelowLupoEX:
    unsafe: Flap, Bash, DoubleJump OR Dash OR Glide OR Sword OR Damage=20

  conn LowerReach.CentralEnemyPaths:
    moki:
      DoubleJump, Bash, Flap OR Grenade=1
      DoubleJump, Burrow
      Launch
    gorlek:
      DoubleJump, TripleJump
      Dash, Bash, Flap OR Grenade=1
      SentryJump=1
    kii:
      DoubleJump, Bash OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Burrow, Dash, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
      Bash, Grenade=1, Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1  # Bash the Shield Miner before bashing your grenade
      Bash, Flap, Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
    unsafe:
      Dash, Sword  # Pogo the ShieldMiner
      Burrow, Dash
      Burrow, Sentry=4  # 1 sentry to reach the left wall + 2 to reach the snaptrap + 1 to reach the checkpoint
      Bash, Flap OR Grenade=1  # Bash the ShieldMiner before bashing your grenade or soup's projectile
      DoubleJump
  conn LowerReach.BelowLupo:
    moki: Combat=ShieldMiner OR Bash OR Burrow OR Launch
    gorlek:
      DoubleJump, TripleJump
      SentryJump=1
    kii:
      Damage=10
      DoubleJump, Dash OR Glide OR Sword OR Shuriken=1 OR Sentry=1 OR Flash=1
      Dash, Glide OR Sword OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
    unsafe: free  # jump over the ShieldMiner from the soup

anchor LowerReach.BelowLupo at -278, -4031:  # On the platform left of the central furnace
  state LowerReach.ThawCentralFurnace:
    moki: Grenade=1
  state LowerReach.FreezeCentralFurnace:
    moki: Flap  # this path can assume that the furnace is heated, requiring less skills than the connection

  pickup LowerReach.BelowLupoEX:
    moki:
      DoubleJump, Bash, Grenade=1
      Launch
      LowerReach.ThawCentralFurnace, DoubleJump OR Dash
    gorlek:
      Bash, Grenade=1, Damage=20
      SentryJump=1, DoubleJump OR Dash OR Damage=20  # sjump from the frozen plant
      LowerReach.ThawCentralFurnace, Sword OR Damage=20
    kii:
      Bash, Grenade=1, Sword OR Hammer OR Shuriken=1
      LowerReach.ThawCentralFurnace, Glide OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      Bash, Grenade=1
      SentryJump=1  # sjump from the frozen plant then upslash

  conn LowerReach.SecondSoup:
    moki: Combat=ShieldMiner OR Bash OR Launch
    gorlek: DoubleJump OR SentryJump=1
    kii: Dash OR Damage=10
  conn LowerReach.CentralFurnacePedestal:
    moki: LowerReach.ThawCentralFurnace OR DoubleJump OR Dash OR Glide
    gorlek: free

anchor LowerReach.CentralFurnacePedestal at -256, -4035:  # The furnace left of the wind channel connecting to east reach
  refill Checkpoint
  refill Energy=3:
    moki:
      BreakCrystal, Bash OR Launch
      Hammer, DoubleJump OR Dash
      Combat=ShieldMiner, Sword, DoubleJump OR Dash
      Combat=ShieldMiner, Bow=1
    gorlek: Combat=ShieldMiner, Grenade=1 OR Shuriken=1

  state LowerReach.ThawCentralFurnace:
    moki: Grenade=1
  state LowerReach.FreezeCentralFurnace:
    moki: Flap

  conn LowerReach.BelowLupo:
    moki:
      DoubleJump OR Dash OR Glide OR Launch
      Bash, Grenade=1
    gorlek: Sword OR Hammer OR Damage=20
    kii: free
  conn LowerReach.WindChannel:
    moki: Combat=ShieldMiner OR Bash OR Launch
    gorlek:
      Glide OR SentryJump=1
      DoubleJump, TripleJump OR Dash
    kii: DoubleJump OR Dash OR Damage=10
    unsafe: free

anchor LowerReach.WindChannel at -223, -4043:  # At the lantern opening the wind channel
  refill Checkpoint

  state LowerReach.WindLantern:
    moki: Grenade=1
    gorlek: SentryBurn=1, Launch OR SentryJump=1  # may require a little luck to get the sentry close enough
    unsafe: SentryBurn=1, DoubleJump OR Bash OR Hammer

  pickup LowerReach.BreakWallEX:
    moki: BreakWall=20
  pickup LowerReach.WindBottomEX:
    moki: LowerReach.WindLantern, Glide
    gorlek: LowerReach.WindLantern, DoubleJump OR Hammer OR Damage=20
    kii: LowerReach.WindLantern, Dash OR Sword OR Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe: LowerReach.WindLantern
  pickup LowerReach.WindHiddenEX:
    moki: LowerReach.WindLantern, Glide
    gorlek:
      Launch, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=20
      Launch, Damage=20, Dash, Glide OR Sword OR Hammer
    kii:
      DoubleJump, TripleJump, Damage=60, Hammer OR Spear=1  # Condition in case the wall is broken
      DoubleJump, TripleJump, Damage=60, Bash, Grenade=1  # Condition in case the wall is broken
      Launch, Dash OR Damage=40
      Launch, DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
    unsafe:
      Launch  # TP out
      DoubleJump, TripleJump, Damage=20, Sword OR Hammer OR Bash  # tjump + upslash/bash the gorlek to climb the right wall, tjump to the left spiky wall, iframe to wjump and tjump again to wjump from the wall just above and tjump again to the ice wall<
      SentryJump=1, Damage=20, DoubleJump OR Dash OR PauseHover  # sjump onto the spikes under the safe wall, sword combo + ability to reach the pickup, tp out
      SentryJump=1, Damage=20, Damage=20  # None of the spikes deal damage after you've already landed in them, so they are all valid points for Regenerate.
      HammerJump  # Smooth right wall -> microwall under left ledge 2 -> side of left ledge 2 -> smooth left wall -> xp -> TP out
      GrenadeJump, DoubleJump
      GrenadeJump, Damage=20, Damage=20  # Damage boost on left ledge 1, wall jump on left ledge 2, damage boost on right ledge 3. Be careful not to get yeeted on that last one. None of the spikes deal damage after you've already landed in them, so they are all valid points for Regenerate.

  conn LowerReach.CentralFurnacePedestal:
    moki: Combat=ShieldMiner OR Bash OR Launch
    gorlek: DoubleJump, TripleJump
  conn LowerReach.SoupMoki:
    moki: LowerReach.WindLantern, Glide  # grenade to light the lantern
    gorlek: Launch, DoubleJump OR Damage=20
    kii: Launch, Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
    unsafe:
      Launch
      DoubleJump, TripleJump, Damage=40, Sword OR Hammer OR Bash
      SentryJump=2, Damage=20
      HammerJump  # Take the path used for the xp, and end with a really tight extended hammer jump around the spikes onto the ledge where the moki is.
      GrenadeJump, DoubleJump  # Like the HammerJump path, but harder. Go right at the top.
      GrenadeJump, Damage=20, Damage=20, Damage=20  # Smooth right wall -> left ledge 1 -> side of left ledge 2 -> right ledge 2 -> left ledge 3. None of the spikes deal damage after you've already landed in them, so they are all valid points for Regenerate.

anchor LowerReach.SoupMoki at -240, -3989:  # Below the reach teleporter, where you hand delicious marshclam soup to a moki (or alternatively extuingish his fireplace...)
  refill Energy=4:
    moki: BreakCrystal, DoubleJump OR Dash OR Glide OR Launch
    gorlek:
      Sword OR Hammer
      Bash, Grenade=1
    kii: BreakCrystal, Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=20

  quest LowerReach.HandToHandHat:
    moki: LowerReach.HandToHandSoup

  pickup LowerReach.WindHiddenEX:
    gorlek:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=20
      Glide, Dash OR Launch OR Damage=20
      Damage=20, Dash OR Sword OR Hammer OR Launch
      Launch, Dash
    kii:
      Glide OR Launch OR Damage=20
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Dash, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
    unsafe:
      DoubleJump OR Dash OR Sword OR Flash=1 OR Sentry=1 OR Shuriken=1
      Bash, Grenade=1

  conn LowerReach.WindChannel:
    moki: Glide
    gorlek: DoubleJump OR Dash OR Launch OR Sword OR Hammer OR Damage=20
    kii: Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
    unsafe: free
  conn LowerReach.EastEnemyPaths:
    moki:
      Bash, Grenade=1, DoubleJump, Dash
      Launch
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump
      Bash, Grenade=1, Damage=20, DoubleJump, Glide OR Sword
      SentryJump=1, DoubleJump, TripleJump OR Dash
      SentryJump=1, Damage=20, DoubleJump, Glide OR Sword
    kii:
      Bash, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Bash, Dash, Sword OR Hammer
      LowerReach.FreezeCentralFurnace, Bash, Grenade=1 OR DoubleJump OR Dash
      LowerReach.FreezeCentralFurnace, Bash, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      SentryJump=1
      Bash, Hammer, Spear=1
      Bash, Glide, Spear=1 OR Shuriken=1 OR Sentry=1
      DoubleJump, TripleJump, Dash  # climb the wall near the moki, dash then triple jump to the wall to reset your jumps and dash + triple jump to reach the plant.
      SwordJump, TripleJump  # pogo the fire, triple jump + upslash to reach the wall to reset your jumps then sword jump to the plant
  conn LowerReach.SnowballEnemyPaths:  # check for redundancies with LowerReach.East
    kii: LowerReach.FreezeCentralFurnace, Bash, Grenade=1

anchor LowerReach.EastEnemyPaths at -223, -3967:  # Enemy path counterpart for LowerReach.East
  nospawn
  # these are exclusively non-redundant paths relying on the slug enemy that despawns if you spawn on this anchor
  # since checkpoint-despawning enemies are generally not gorlek, paths are only kii and upwards
  refill Full:  # use the teleporter
    moki: LowerReach.TPLantern

  conn LowerReach.East: free
  conn LowerReach.SnowballEnemyPaths:
    kii: DoubleJump, TripleJump, Bash

anchor LowerReach.East at -223, -3966:  # To the right side outside the teleporter
  # the slug despawns if you spawn on this anchor, paths using it have to be in the LowerReach.EastEnemyPaths counterpart

  state LowerReach.TPLantern:  # Most paths redundant with Snowball
    kii: Grenade=1  # Climb up from the closed door

  conn LowerReach.Teleporter:
    moki: LowerReach.TPLantern
  conn LowerReach.SnowballEnemyPaths:
    moki:
      Bash, Grenade=2, DoubleJump, Dash OR Glide  # The first Grenade may hit the enemy
      Launch
    gorlek:
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      SentryJump=1, DoubleJump, TripleJump, Grenade=1 OR Spear=1  # drop the slime for leniency
      SentryJump=1, DoubleJump, Dash, Grenade=1 OR Spear=1  # drop the slime for leniency
    kii:
      Bash, Grenade=1
      DoubleJump, TripleJump, Combat=WeakSlug, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
      DoubleJump, TripleJump, Bash, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
    unsafe:
      SentryJump=1
      DoubleJump, TripleJump
  conn LowerReach.SoupMoki: free

anchor LowerReach.SnowballEnemyPaths at -182, -3968:  # Enemy path counterpart for LowerReach.Snowball
  nospawn
  # these are exclusively non-redundant paths relying on the slug enemy that despawns if you spawn on this anchor
  # since checkpoint-despawning enemies are generally not gorlek, paths are only kii and upwards
  refill Checkpoint

  state LowerReach.TPLantern:
    kii: SentryBurn=1, Bash

  conn LowerReach.Snowball: free
  conn LowerReach.EastEnemyPaths:
    kii: Bash

anchor LowerReach.Snowball at -182, -3968:  # At the ledge above the snowball ice wall
  # the slug despawns if you spawn on this anchor, paths using it have to be in the LowerReach.SnowballEnemyPaths counterpart
  state LowerReach.TPLantern:
    moki: Grenade=1, Combat=WeakSlug OR Bash
    gorlek:
      Grenade=1
      SentryBurn=1, SentryJump=1
      SentryBurn=1, DoubleJump, TripleJump
      SentryBurn=1, Launch
    kii:
      SentryBurn=1, DoubleJump, Hammer  # djump+upslash+sentry
    unsafe:
      SentryBurn=1, DoubleJump, Sword  # The slime won't respawn if you activated the checkpoint
  state LowerReach.RolledSnowball:
    moki: Grenade=1, Combat=Mantis OR Bash
    gorlek:  # Sentry to melt the ice
      SentryBurn=1, Launch
      SentryBurn=1, DoubleJump, TripleJump, Glide
    kii:
      SentryBurn=1, Bash, DoubleJump OR Glide OR Hammer
      SentryBurn=1, Bash, Dash, Damage=20
      SentryBurn=1, DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Sentry=2 OR Damage=20  # Jump from the branch above the ice, triple jump to get close enough, sentry to melt the ice then return to safety
    unsafe:
      SentryBurn=1, Damage=20, SentryJump=1  # Jump in the spikes (won't damage Ori afterwards), sjump then sentry to melt the ice + sword combo to return to safety
      SentryBurn=1, DoubleJump, TripleJump, Shuriken=1 OR Blaze=1

  pickup LowerReach.SnowballHC:
    moki: LowerReach.RolledSnowball, Burrow, DoubleJump OR Dash OR Glide OR Launch OR Damage=20
    gorlek: LowerReach.RolledSnowball, Burrow  # Dash in the snow before exiting the burrow section to get momentum

  conn LowerReach.SnowballEnemyPaths:  # respawn the enemy if needed by leaving the area
    kii: LowerReach.ThawCentralFurnace OR DoubleJump
  conn LowerReach.EastEnemyPaths:
    moki:
      Combat=WeakSlug, DoubleJump OR Dash OR Glide
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Bash, Grenade=1
      Sword OR Hammer
    kii:
      DoubleJump OR Dash OR Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
  conn LowerReach.SoupMoki: free
  conn LowerReach.PastSnowball:
    moki, LowerReach.RolledSnowball:
      DoubleJump OR Glide OR Launch
      Bash, Grenade=1, Dash
      Bash, Grenade=2
    gorlek: LowerReach.RolledSnowball, Dash OR Sword OR Hammer OR Damage=20  # Bash the running ennemy to avoid the damage boost
    kii: LowerReach.RolledSnowball, Bash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: LowerReach.RolledSnowball

anchor LowerReach.PastSnowball at -99, -3982:  # At the bashnade pedestal after rolling the snowball
  refill Checkpoint
  refill Energy=4:  # fast respawning crystal
    moki: BreakCrystal

  pickup LowerReach.RoofLeftEX:  # Have to solve after LowerReach.RolledSnowball
    moki:  # intended path omitted in moki
      Launch, DoubleJump, Dash OR Glide
      Bash, Grenade=1, Launch
    gorlek:
      LowerReach.FreezeEastFurnace, Bash, Grenade=2, DoubleJump, Dash, Glide  # intended path?
      Launch, DoubleJump  # Easier from under the snaptrap
    kii:
      Launch
      Bash, Grenade=2, DoubleJump, Dash
      LowerReach.ThawEastFurnace, Bash, Grenade=2, DoubleJump, Glide OR TripleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, TripleJump, Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      SwordSJump=1, DoubleJump, TripleJump
      Bash, Grenade=2, DoubleJump, TripleJump OR Dash OR Glide
      SentryJump=1, DoubleJump, Dash
      SentryJump=2
      GrenadeJump, DoubleJump  # grenade wall jump off of the microwall under the spikes
      HammerJump
      BlazeSwap=6 OR FlashSwap  # might be doable with less somehow, blaze swaps are hard

  conn LowerReach.IceCavern:
    moki:
      Bash, Grenade=1
      Launch
    gorlek: SentryJump=1
  conn LowerReach.EastFurnace:
    gorlek: ShurikenBreak=20
  conn LowerReach.SnowballEnemyPaths:
    moki, LowerReach.RolledSnowball:
      LowerReach.ThawCentralFurnace, Combat=Lizard OR Bash
      Launch
    gorlek, LowerReach.RolledSnowball: DoubleJump
    kii, LowerReach.RolledSnowball:
      LowerReach.ThawCentralFurnace
      Dash, Hammer OR Spear=1
    unsafe, LowerReach.RolledSnowball:
      Hammer
      Bash  # use the lizard

anchor LowerReach.IceCavern at -85, -3966:  # On the snaptrap facing upwards at the entrance to the spiky ice cavern after the snowball
  pickup LowerReach.RoofRightEX:
    moki: Launch
    gorlek:
      SwordSJump=1, DoubleJump OR Dash
      LowerReach.FreezeEastFurnace, Bash, Grenade=1
      LowerReach.FreezeEastFurnace, HammerSJump=1, DoubleJump OR Dash
    unsafe: HammerJump

  conn LowerReach.PastSnowball: free
  conn LowerReach.HalfwayIceCavern:
    moki:
      DoubleJump, Dash, Glide
      Launch
    gorlek:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword
      DoubleJump, Hammer, Damage=20
      SwordSJump=1, DoubleJump OR Dash
      SwordSJump=2
      LowerReach.FreezeEastFurnace, Bash, Grenade=1, DoubleJump OR Dash
      LowerReach.FreezeEastFurnace, Bash, Grenade=2
      LowerReach.FreezeEastFurnace, HammerSJump=1, DoubleJump OR Dash
      LowerReach.FreezeEastFurnace, HammerSJump=2
    kii:
      Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer OR Glide OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Sword OR Hammer OR Sentry=2
      DoubleJump, Damage=20, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Spear=1
      Dash, Sword OR Hammer OR Sentry=3
      LowerReach.ThawEastFurnace, DoubleJump, Shuriken=1
      LowerReach.ThawEastFurnace, DoubleJump, Blaze=1, Damage=20
      LowerReach.ThawEastFurnace, Dash, Glide OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
    unsafe:
      DoubleJump, Damage=20
      Dash, Sentry=1 OR Flash=1 OR LowerReach.ThawEastFurnace  # Need to walljump on the wall above the 2nd plant then dash, get a reset by touching the ceilin and dash a second time

anchor LowerReach.HalfwayIceCavern at -44, -3955:  # On the snaptrap halfway through the spiky ice cavern
# Going through that ice cavern in order to activate LowerReach.EastDoorLantern or going to LowerReach.SwimmingPool is horrible to find paths for, especially when using sjumps/bashnades
# That anchor is just so pathfinder have an easier time pathfinding the horrible paths through that icy cavern.

  state LowerReach.EastDoorLantern:
    moki:
      Grenade=1, DoubleJump, Dash, Glide
      Grenade=1, Launch
    gorlek:
      DoubleJump, Grenade=1, Sword OR Hammer OR Glide OR Dash OR TripleJump
      SwordSJump=1, Grenade=1
      SentryBurn=1, Launch OR DoubleJump
    kii:
      Bash, Grenade=3
      Bash, Grenade=2, Dash OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=20
      Grenade=1, DoubleJump OR Glide OR Sword OR Hammer
    unsafe:
      Bash, Grenade=2
      SentryJump=2, Grenade=1, Dash  # Need to use up slashes
      SentryBurn=1, SwordSJump=2

  conn LowerReach.SwimmingPool:
    moki:
      Glide, DoubleJump OR Dash
      Launch
    gorlek: Glide OR DoubleJump OR Dash OR Sword OR Hammer OR Damage=20
    kii:
      Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, Grenade=1
  conn LowerReach.IceCavern:
    moki:
      Launch
      DoubleJump, Dash OR Glide
    gorlek:
      DoubleJump
      SwordSJump=1
      LowerReach.FreezeEastFurnace, Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=20
      LowerReach.FreezeEastFurnace, HammerSJump=1  # use weapon to hover as well
    kii:
      Hammer OR Damage=20
      Bash, Grenade=1
      Glide, Dash OR Sword OR Shuriken=1 OR Spear=1 OR Flash=1 OR Sentry=1
      LowerReach.ThawEastFurnace, Glide OR Dash OR Sword OR Shuriken=1 OR Blaze=3 OR Sentry=2
    unsafe:
      Sword OR GlideJump
      Dash  # if frozen, dash ramp from the left of the snaptrap

anchor LowerReach.SwimmingPool at -44, -4001:  # At the platform in the freezable water
  refill Energy=4:
    moki: BreakCrystal, LowerReach.FreezeEastFurnace OR Water

  pickup LowerReach.FractureShard:
    moki: LowerReach.ThawEastFurnace, Water

  conn LowerReach.ArenaArea:
    moki, LowerReach.EastDoorLantern:
      LowerReach.FreezeEastFurnace, Bash, Grenade=1
      Launch, LowerReach.FreezeEastFurnace OR DoubleJump OR Dash OR Glide
    gorlek, LowerReach.EastDoorLantern:
      Launch  # Launch into the ceiling then into the wall near the energy cristal and again to the platform
      SentryJump=1, LowerReach.FreezeEastFurnace
      SwordSJump=1, Water
      SwordSJump=2, DoubleJump, Glide
      LowerReach.ThawEastFurnace, WaterDash, Water, DoubleJump  # Wall jump from the right wall
    kii, LowerReach.EastDoorLantern:
      Bash, Grenade=1, Damage=40  # bash the fish and worm to go faster and avoid taking one more dboost
      Bash, Grenade=1, Damage=20, WaterDash OR DoubleJump OR Dash OR Sword
      Bash, Grenade=1, Sword, DoubleJump OR Dash  # pogo the worm
      Bash, Grenade=1, DoubleJump, Dash, TripleJump OR Glide OR Hammer OR Sentry=2
      Bash, Grenade=2, Dash OR Glide OR DoubleJump OR Sword OR Sentry=2 OR Damage=20
      LowerReach.ThawEastFurnace, Bash, Water  # bash the fish under the door
      LowerReach.ThawEastFurnace, Bash, WaterDash, Damage=20, Damage=40
      LowerReach.ThawEastFurnace, WaterDash, Water, Hammer OR Spear=1  # Wall jump from the right wall
      LowerReach.ThawEastFurnace, WaterDash, Damage=20, Damage=20, Hammer OR Spear=1
      LowerReach.ThawEastFurnace, DoubleJump, TripleJump, Hammer, Water OR Dash OR Glide OR Sword OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20  # tjump+ hammer upslash from the closed snaptrap to walljump on the left wall
      LowerReach.ThawEastFurnace, DoubleJump, TripleJump, Spear=1, Water OR Dash OR Glide OR Sword OR Sentry=3 OR Damage=20  # tjump+spear from the closed snaptrap to walljump on the left wall
    unsafe, LowerReach.EastDoorLantern:
      Bash, Grenade=2, Shuriken=1
      SwordSJump=1, DoubleJump, TripleJump OR Dash OR Glide  # double jump from the platform, refill dash/jumps by slashing the energy cristal then sjump on the plant
      SwordSJump=2, DoubleJump OR Glide OR Dash
      HammerJump
  conn LowerReach.EastFurnace:
    moki:
      Bash, Grenade=1
      Launch
    gorlek:
      DoubleJump, TripleJump  # Climb the left wall then jump to the right wall before double jumping again to the platform
      SwordSJump=1
      HammerSJump=1, Dash OR DoubleJump OR LowerReach.FreezeEastFurnace
      LowerReach.ThawEastFurnace, WaterDash, DoubleJump, Water, Sword OR Hammer
      LowerReach.ThawEastFurnace, WaterDash, DoubleJump, Damage=20, Sword OR Hammer
    kii:
      DoubleJump  # Precise wall jump on the left wall then wjump on the right wall
      LowerReach.ThawEastFurnace, Bash, WaterDash, Water OR Damage=40
      LowerReach.ThawEastFurnace, Bash, Water  # Bash the fish
    unsafe: LowerReach.ThawEastFurnace, Bash, Damage=100  # Bash the fish
  conn LowerReach.HalfwayIceCavern:
    kii:
      Bash, Grenade=1, DoubleJump, TripleJump
      LowerReach.ThawEastFurnace, DoubleJump, TripleJump, Sword  # Pogo the worm to reach the right wall
      LowerReach.ThawEastFurnace, DoubleJump, TripleJump, WaterDash, Water OR Damage=20
    unsafe:
      Launch
      DoubleJump, TripleJump OR Dash  # https://youtu.be/V_Gzv4W34nU
      LowerReach.ThawEastFurnace, DoubleJump, Sword  # pogo the worm then slash the crystal to climb the wall
      SwordJump  # https://youtu.be/v-ICBnUhDuQ

anchor LowerReach.EastFurnace at -61, -3987:  # At the furnace above the swimming pool
  refill Checkpoint

  state LowerReach.ThawEastFurnace:
    moki: Grenade=1
  state LowerReach.FreezeEastFurnace:
    moki: Flap

  conn LowerReach.PastSnowball:
    moki: BreakWall=20
  conn LowerReach.SwimmingPool: free

anchor LowerReach.ArenaArea at 44, -3992:  # To the left of the combat arena
  refill Checkpoint
  refill Health=1
  refill Energy=3:
    moki, BreakCrystal:
      DoubleJump, Dash
      Launch

  state LowerReach.ArenaBeaten:
    moki: Regenerate, Damage=40, Combat=3xShieldMiner+Hornbug+2xBee
    unsafe: Combat=3xShieldMiner+Hornbug+2xBee

  conn LowerReach.TrialStart:
    moki: LowerReach.ArenaBeaten
  conn LowerReach.WindSpinners:
    moki, LowerReach.ArenaBeaten: Glide
    gorlek, LowerReach.ArenaBeaten: Launch, DoubleJump OR Dash OR Damage=20
    kii, LowerReach.ArenaBeaten:
      Launch
      DoubleJump, TripleJump
    unsafe, LowerReach.ArenaBeaten:
      FlashSwap
  conn LowerReach.SwimmingPool:
    moki, LowerReach.EastDoorLantern:
      LowerReach.FreezeEastFurnace OR Water
      Launch, DoubleJump, Dash OR Glide
    gorlek, LowerReach.EastDoorLantern:
      DoubleJump, TripleJump, Glide
      DoubleJump, Dash, Glide, Sword
      Damage=20, DoubleJump OR Dash OR Glide OR Sword  # Swim in dirty water
      WaterDash, Damage=20, Hammer
      Launch  # refresh on wall above crystal
    unsafe, LowerReach.EastDoorLantern:
      Sword, DoubleJump OR Dash OR Glide  # Pogo something in the water
      DoubleJump, TripleJump, Dash

# checkpoint at just kidding, placed this mark because the refill logic below kind of sucks

anchor LowerReach.WindSpinners at 73,-3929:  # midway through the wind column above the combat arena
# This anchor is just so ArenaArea->WispsPath is easier to pathfind for
  conn LowerReach.WispPathCheckpoint:
    moki:
      Glide, Grapple OR Launch
      Glide, DoubleJump, Bash, Grenade=1
    gorlek:
      Glide, SentryJump=1
      Glide, Bash, Grenade=1
      Glide, DoubleJump, TripleJump OR Dash
      Launch, DoubleJump, TripleJump OR Dash OR Damage=20  # Pass under the first spinner to reach the right wall, climb it and launch to the energy cristal
    kii:
      Launch, Dash OR Sword OR Hammer OR Shuriken=1 OR Damage=20  # Pass under the first spinner and launch to the wall above it
      Glide, DoubleJump, Hammer OR Damage=20
      DoubleJump, TripleJump, Damage=60  # 2 dboosts to reach the right wall, climb it, pass between the two spinners to reach the left wall, climb it and take a third dboost
      DoubleJump, TripleJump, Damage=40, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # pass under the 1st spinner by using tjump, dboost, tjump again and use your other mobility option to reach the right wall, climb it, pass between the two spinners to reach the left wall, climb it and take a second dboost
    unsafe:
      Glide, Dash, Hammer
      Launch, Spear=1 OR Shuriken=1 OR Sentry=1 OR Spear=1 OR Flash=1  # Pass under the first spinner and launch to the wall above it
      DoubleJump, TripleJump, Damage=20
      Bash, Grenade=1, DoubleJump, TripleJump  # Precise grenade throw above the first spinner, pass under the spinner to catch the grenade and bash glide to the right wall
      FlashSwap
      Launch  # There are multiple ways to do this, and all of them look awesome.
  conn LowerReach.ArenaArea:
    moki: Glide, LowerReach.ArenaBeaten
    gorlek: LowerReach.ArenaBeaten

anchor LowerReach.WispPathCheckpoint at 83, -3874:  # At the checkpoint just after the grappable plant
  refill Checkpoint
  refill Health=1:  # Requirements are here so you can return to the checkpoint afterwards
    # paths using energy or health AFTER grabbing the refill would be invalid here because they would misrepresent the resulting health or energy
    moki:
      Grapple OR Launch
      # Bash, Grenade=1  # wasted energy...
    gorlek:
      DoubleJump, TripleJump OR Dash
      # SentryJump=1
    kii:
      DoubleJump, Hammer
      # DoubleJump, Damage=20
    unsafe:
      DoubleJump, Sword OR Hammer
      Dash, Hammer
  refill Energy=4:  # Requirements are here so you can return to the checkpoint afterwards
    # paths using energy or health AFTER grabbing the refill would be invalid here because they would misrepresent the resulting health or energy
    moki:
      DoubleJump, Grapple
      # DoubleJump, Bash, Grenade=1  # wasted energy...
      # Dash, Damage=20, Grapple
      # Dash, Damage=20, Bash, Grenade=1  # wasted energy...
      Launch
    gorlek:
      Grapple, Dash OR Glide OR Sword
      # SentryJump=1
      # Bash, Grenade=1, Dash OR Glide OR Sword
      DoubleJump, TripleJump OR Dash
    kii:
      Hammer, DoubleJump OR Grapple
      # Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      # DoubleJump, Damage=20
    unsafe:
      DoubleJump, Sword
      Dash, Hammer

  conn LowerReach.BridgeWispPath:  # The gorlek isn't here if you respawn at the chekpoint
    moki: Bash, Grenade=3 OR Launch
    gorlek: Launch, Bash OR SentryJump=1 OR Damage=20
    kii:
      Bash, Grenade=2
      Bash, Grenade=1, Glide OR Dash
      Bash, Grenade=1, DoubleJump, TripleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump, TripleJump, Damage=40
    unsafe:
      Bash, Grenade=1, DoubleJump
      Bash, DoubleJump, TripleJump, Damage=20
      Bash, SwordSJump=1
      Bash, HammerSJump=1, Glide OR DoubleJump OR Dash
      FlashSwap
      LaunchSwap
  conn LowerReach.WindSpinners:
    moki: Glide
    gorlek: Launch, Damage=20
    kii: Launch OR DoubleJump OR Dash OR Sword OR Hammer OR Damage=20
    unsafe: free

# checkpoint at 80, -3805

anchor LowerReach.BridgeWispPath at 67, -3808:  # At the bridge checkpoint, next to the wind column
  refill Checkpoint

  conn LowerReach.SnowEscape:
    moki:
      Bash, Grenade=1, Glide, DoubleJump OR Grapple
      Glide, Launch
    gorlek:
      Launch
      Glide, SentryJump=1 OR DoubleJump OR Dash
      Bash, SwordSJump=1, DoubleJump, Dash OR TripleJump  # SentryJump to get on the right wall, use sword to air stall 2nd wind column.
      Bash, SwordSJump=2, Grapple  # SentryJump to get on the right wall at the 1st wind column
      Bash, Grenade=1, Glide
    kii:
      Bash, DoubleJump OR Dash OR Sword OR Hammer
      DoubleJump, TripleJump, Grapple OR Sword OR Hammer  # Climb the left wall then go to the right one. You can kill the slimes with weapons.
      DoubleJump, TripleJump, Sentry=2, Combat=2xWeakSlug  # Climb the left wall then go to the right one
      DoubleJump, TripleJump, Sentry=2, Damage=10, Damage=10  # Climb the left wall then go to the right one. dboost through the slimes.
    unsafe:
      Bash, DoubleJump OR Dash OR Grapple OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Shuriken=2
      FlashSwap
      Launch
  conn LowerReach.WispPathCheckpoint:
    moki:
      Bash
      Combat=WeakSlug, Combat=Miner
    gorlek: free

anchor LowerReach.SnowEscape at 79, -3733:
  nospawn
  refill Full

  quest LowerReach.ForestsMemory:  # currently based on the requirements of getting here to simplify
    moki:
      Dash, Bash, Grapple, Glide, Water OR DoubleJump
      Bash, Glide, Launch
    gorlek:
      Launch, Water OR Glide OR Damage=20
      Dash, Glide, DoubleJump, TripleJump OR Damage=20
      Dash, Glide, Grapple
    kii:
      Launch
      Dash, DoubleJump, TripleJump OR Glide
      DoubleJump, Glide, Bash
      Glide, Grapple, Bash, Water, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Grapple, Bash, Damage=20, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Glide, Sentry=2
      DoubleJump, Glide
      Dash, Glide, Damage=20
      SentryJump=1, DoubleJump, Dash, TripleJump  # Same path than above but the sjump ease it
      SentryJump=2, DoubleJump, Dash  # 1st sjump on a friendly spike and 2nd one on the branch to pass the 1st wind column
      SentryJump=3, Dash, Grapple OR Damage=20
      Dash, SentryJump=4
      FlashSwap  # Dodging the water is scary but totally doable.

  state LowerReach.BearSneezed:  # Same paths as LowerReach.ForestsMemory (when finishing the escape, Baur isn't blocking the Reach entrance anymore)
    moki:
      Dash, Bash, Grapple, Glide, Water OR DoubleJump
      Bash, Glide, Launch
    gorlek:
      Launch, Water OR Glide OR Damage=20
      Dash, Glide, DoubleJump, TripleJump OR Damage=20
      Dash, Glide, Grapple
    kii:
      Launch
      Dash, DoubleJump, TripleJump OR Glide
      DoubleJump, Glide, Bash
      Glide, Grapple, Bash, Water, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Grapple, Bash, Damage=20, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Glide, Sentry=2
      DoubleJump, Glide
      Dash, Glide, Damage=20
      SentryJump=1, DoubleJump, Dash, TripleJump  # Same path than above but the sjump ease it
      SentryJump=2, DoubleJump, Dash  # 1st sjump on a friendly spike and 2nd one on the branch to pass the 1st wind column
      SentryJump=3, Dash, Grapple OR Damage=20
      Dash, SentryJump=4
      FlashSwap  # Dodging the water is scary but totally doable.

  pickup LowerReach.EscapeRevisitEX:
    moki: LowerReach.ForestsMemory

anchor LowerReach.VeralHome at -140, -4096:  # At the soup
  refill Checkpoint

  quest LowerReach.HandToHandSoup:
    moki: InnerWellspring.HandToHandHerbs

  pickup GladesTown.LeafPileEX:
    moki: Flap
  pickup LowerReach.CatalystShard:
    moki:
      Water, Bash, Flap  # seems to be a casual strat the game suggests you to do
      Water, Grenade=1
    kii:
      Damage=80, Grenade=1
      Damage=80, Bash, Flap
      WaterDash, Damage=60, Grenade=1
      WaterDash, Damage=60, Bash, Flap
    unsafe:
      WaterDash, Damage=40, Grenade=1
      WaterDash, Damage=40, Bash, Flap
      #Water, Flap, Sentry=2  # theoretical double redirect, still in testing

  conn GladesTown.HoleHut:
    moki: Dash OR Glide  # check for redundancies with PlayfulMoki
    gorlek: free  # free if you know the whole branch is semisolid, but you probably don't as a moki player
  conn GladesTown.PlayfulMoki: free
  conn TuleyShop:
    moki: GladesTown.TuleySpawned
  conn LowerReach.TownEntry:
    moki:
      Bash, Flap OR Grenade=1  # may need to juggle the soupgrenade once
      Launch
    gorlek:
      DoubleJump, TripleJump, Glide OR Dash OR Sword
      SentryJump=1
    kii: DoubleJump, TripleJump  # climb the wall above the gorlek
    unsafe:
      GrenadeJump, DoubleJump OR Dash OR Sword OR Hammer
      Dash, Glide, Sword  # Needs a ramp on the left side corner of the platform near the cauldron
      #DoubleJump, Glide OR Sword OR Hammer # Jump on the floating platform next to the soup then wall jump from the wall above it
      DoubleJump  # Go on the wall above the Gorlek

anchor LowerReach.TownEntry at -35, -4077:  # Where the wind starts
  conn LowerReach.VeralHome: free
  conn LowerReach.TrialStart:
    moki:
      Glide
    gorlek:
      Launch, DoubleJump, Damage=20
      Launch, Bash, Grenade=1
    kii:
      Launch, Damage=40
      Launch, Damage=20, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Avoid the second dboost
      Bash, Grenade=1, DoubleJump, TripleJump, Dash, Hammer, Damage=20
    unsafe:
      Bash, Grenade=1, DoubleJump, TripleJump, Dash, Hammer OR Damage=20
      Bash, Grenade=1, DoubleJump, TripleJump, Spear=1, Damage=20  # extend your bash with spear
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40
      DoubleJump, TripleJump, Damage=80, Hammer OR Spear=1  # tjump + hammer/spear to reach the wall
      DoubleJump, TripleJump, Dash, Damage=60, Hammer OR Spear=1  # tjump + hammer/spear to reach the wall
      Launch, DoubleJump, Dash OR TripleJump
      Launch, Damage=20  # Launch on the wall at the start of the wind cave

anchor LowerReach.TrialStart at 64, -4045:  # At trial start
  refill Checkpoint

  state LowerReach.KeystoneDoor:
    moki: Keystone=4
  state LowerReach.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: LowerReach.KeystoneDoor

  pickup LowerReach.SpiritTrial:
    moki: LowerReach.TrialActivation, Dash, Glide
    unsafe: LowerReach.TrialActivation, Glide
  pickup LowerReach.RightKS:
    moki:
      Glide
      DoubleJump, Dash, Bash, Grenade=1
      Launch, DoubleJump OR Damage=20
    gorlek:
      Launch
      SentryJump=1, DoubleJump
      Bash, Grenade=1, DoubleJump
    kii:
      Dash, DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Start from the right
      DoubleJump, TripleJump, Hammer, Spear=1  # Start from the left and reach the wall
    unsafe:
      Dash, DoubleJump, TripleJump  # Start from the right
      DoubleJump, TripleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1  # Start from the left and reach the wall
  pickup LowerReach.UpperLeftKS:
    moki: Glide
    kii:  # TP out after taking the pickup
      Launch, DoubleJump, TripleJump, Damage=30  # dboost in the spikes+ dboost on the slime next to the keystone
      DoubleJump, TripleJump, Combat=BombSlug, Damage=80
    unsafe:
      Launch, DoubleJump, TripleJump, Damage=20  # Launch against the walls. When on the wall above LowerReach.VeralHome, first use triple jump then launch, triple jump again to take a damage boost to refresh launch then launch and triple jump again to take the pickup and tp out
      DoubleJump, TripleJump, Combat=BombSlug, Damage=60
  pickup LowerReach.MiddleLeftKS:
    moki: Glide
    kii:  # TP out after taking the pickup
      Launch, Damage=40
      Launch, DoubleJump, Damage=20, TripleJump OR Dash
    unsafe:
      Launch, Damage=20, DoubleJump OR Dash  # Launch against the walls. When on the wall above LowerReach.VeralHome, first use djump/dash then launch, reuse your mobility option, take a damage boost to refresh launch, take the pickup and TP out
      DoubleJump, TripleJump, Damage=40
  pickup LowerReach.BottomLeftKS:
    moki: Glide
    kii:  # TP out after taking the pickup
      Launch, DoubleJump OR Dash OR Sword OR Hammer OR Sentry=3 OR Damage=20  # sentry where the two bomb slug are, walljump launch, 2 sentries
      DoubleJump, TripleJump, Damage=20, Combat=BombSlug, Sword OR Dash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20
    unsafe:
      Launch, Shuriken=1 OR Flash=1 OR Sentry=1  # shuriken/flash/sentry before using launch
      DoubleJump, TripleJump, Sword OR Dash OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=10  # dboost on the flying spikes, which only deal 10 damages
  pickup LowerReach.TrialEX:
    moki: Glide
    kii:
      Launch, Damage=40  # Pass under the two falling slimes
      Launch, Damage=20, DoubleJump OR Dash
      Launch, DoubleJump, TripleJump, Hammer OR Spear=1  # Extra ability to help reaching the pickup
    unsafe:
      Launch, DoubleJump, TripleJump
      GrenadeJump, DoubleJump, TripleJump, Damage=20
      HammerJump, DoubleJump, TripleJump, Damage=20
      FlashSwap  # TODO: calculate blaze swaps

  conn LowerReach.TownEntry:
    moki: Glide
    gorlek:
      Damage=20, Sword OR Dash OR DoubleJump OR Launch  # sword or hammer for weapon stalling
      Bash, Grenade=1, Sword OR Dash OR DoubleJump OR Launch
      Launch, Sword OR Hammer OR Dash OR DoubleJump
      DoubleJump, Sword OR Hammer OR Dash OR TripleJump
      Dash, Sword OR Hammer
      SwordSJump=1
    kii:
      Damage=20, Damage=40
      Hammer, Damage=30  # dboost on the falling slime
      Bash, Grenade=1, Damage=20, Damage=20
      Bash, Grenade=1, Hammer OR Shuriken=2 OR Blaze=4 OR Sentry=3
      Bash, Grenade=1, Damage=20, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Damage=20, Hammer
      Damage=10, Damage=40
      Bash, Grenade=1, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=10
  conn LowerReach.ArenaArea:
    moki: LowerReach.ArenaBeaten, Glide
    unsafe, LowerReach.ArenaBeaten:
      Launch  # Launch Swap
      FlashSwap

region UpperReach:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor UpperReach.BurrowArea at -369, -3917:  # left of the entrance sand wall
  # unsafe paths may be incorrect after moving the anchor
  pickup UpperReach.LifeForceEX:
    moki:
      Burrow, Launch, Bash
    gorlek:
      Launch
      Burrow, Bash, DoubleJump, TripleJump OR Dash OR Glide
      Burrow, DoubleJump, TripleJump, Dash, Glide
    kii:
      Burrow, Bash, DoubleJump OR Dash OR Glide
      Burrow, Bash, Sword
      Burrow, Bash, Sentry=5  # One sentry in order to reach the second crumbling platfom then 2 to reach the lantern and another 2 to get to the EX platform
      Burrow, Sword, Dash, DoubleJump  # "Precise" burrow angle bellow UpperReach.LifeForceEX then full sword combo + movement options
      Burrow, DoubleJump, TripleJump OR Hammer  # precise angle underneath UpperReach.LifeForceEX then land next to the pickup
      Burrow, DoubleJump, Damage=20  # dboost in the spikes under the pickup
      Burrow, DoubleJump, Sentry=1 OR Flash=1  # precise angle underneath UpperReach.LifeForceEX then land next to the pickup
      Burrow, Bash, Grenade=1, Damage=20  # grenade from under the pickup, burrow to reach it then land near the pickup. Damage because of the 2nd sand platform
      Burrow, Dash, Glide  # go to UpperReach.LifeForceShard first
    unsafe:
      Burrow, SwordSJump=2  # Running sjump from under LifeForceEX
      Burrow, SentryJump=1, Glide OR Damage=20  # sjump to enter the burrow section. There is a small safespot in the right spikes below the sand after the bashable plant. Use weapon to stall in the air.
      Burrow, SwordSJump=1, Dash  # Need a precise angle to exit the burrow section under LifeForceEX. Use sword for air stalling.
      Burrow, HammerSJump=1, Dash, Damage=20  # Need a precise angle to exit the burrow section under LifeForceEX. Use sword for air stalling.
      Burrow, Bash, Damage=20, Spear=2 OR Shuriken=2 OR Blaze=2 OR Sentry=2 OR Flash=2
      Burrow, Sword, Sentry=2 OR Flash=2  # Pogo the mantis, before the lantern get a good burrow angle then sentry->sword hover->up slash->sentry to reach the crumbling platform. Same with flash but you have to disable flash during your sword hover so you get a second hop.
      Burrow, DoubleJump, Damage=20  # dboost in the spikes near the mantis to reach the burrow section then precise angle from under UpperReach.LifeForceEX
      Burrow, DoubleJump, Sentry=1 OR Flash=1 OR Shuriken=1  # Precise djump from the frozen muncher. Can make it easier by standing on the right of the muncher first so the left side is a bit higher.
      Burrow, Sword, Damage=20  # Pogo the mantis, precise angle to land into the spikes under UpperReach.LifeForceEX, precise walljump into upslash to land next to the pickup. Blame Wolf who made me realize it was possible
  pickup UpperReach.LifeForceShard:
    moki:
      Burrow, Launch, Bash
    gorlek:
      Launch
      Burrow, Bash, DoubleJump, TripleJump OR Dash OR Glide
      Burrow, DoubleJump, TripleJump, Dash, Glide
    kii:
      Burrow, Bash, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      Burrow, Bash, Sentry=3  # One sentry in order to reach the second crumbling platfom then 2 to reach the lantern
      Burrow, Sword, Dash, DoubleJump  # "Precise" burrow angle bellow UpperReach.LifeForceEX then full sword combo + movement option
      Burrow, DoubleJump, TripleJump OR Hammer  # precise angle underneath UpperReach.LifeForceEX then land next to the pickup, then go to shard
      Burrow, DoubleJump, Damage=20  # dboost in the spikes under the EX pickup, then jump to the Shard
      Burrow, DoubleJump, Sentry=1 OR Flash=1  # precise angle underneath UpperReach.LifeForceEX then land next to the EX pickup, then go to shard
      Burrow, Dash, Glide
    unsafe:
      Burrow, SwordSJump=2  # Running sjump from under LifeForceEX
      Burrow, SentryJump=1, Glide OR Damage=20  # sjump to enter the burrow section. There is a small safespot in the right spikes below the sand after the bashable plant. Use weapon to stall in the air.
      Burrow, SwordSJump=1, Dash  # Need a precise angle to exit the burrow section under LifeForceEX. Use sword for air stalling.
      Burrow, HammerSJump=1, Dash, Damage=20  # Need a precise angle to exit the burrow section under LifeForceEX. Use sword for air stalling.
      Burrow, Bash, Damage=20, Spear=2 OR Shuriken=2 OR Blaze=2 OR Sentry=2 OR Flash=2
      Burrow, Sword, Sentry=2 OR Flash=2  # Pogo the mantis, before the lantern get a good burrow angle then sentry->sword hover->up slash->sentry to reach the crumbling platform. Same with flash but you have to disable flash during your sword hover so you get a second hop.
      Burrow, DoubleJump, Damage=20  # dboost in the spikes near the mantis to reach the burrow section then precise angle from under UpperReach.LifeForceEX
      Burrow, DoubleJump, Sentry=1 OR Flash=1 OR Shuriken=1  # Precise djump from the frozen muncher. Can make it easier by standing on the right of the muncher first so the left side is a bit higher.
      Burrow, Sword, Damage=20  # Pogo the mantis, precise angle to land into the spikes under UpperReach.LifeForceEX, precise walljump into upslash to land next to the pickup. Blame Wolf who made me realize it was possible

  conn LowerReach.BelowTokk:
    moki: Burrow

anchor UpperReach.KeystoneRoom at -256, -3914:  # At the furnace in the four keystone room before Grenade tree
  refill Checkpoint

  # This entire room can be in two mutually exclusive states: Frozen or Thawed.
  # Additionally, you can only change the state if you have access to the furnace.
  # This is important, because you have to avoid writing logic that requires a frozen furnace on its first half and a thawed furnace on its second half.
  # To account for this, anchors in this room have up to three different variants:
  # - Main Variant ("UpperReach.[name]"):
  #     Paths to this anchor have to work with both furnace states! Outgoing connections can use either furnace state.
  # - Frozen Variant ("UpperReach.[name]Frozen):
  #     Paths to this anchor have to use the frozen furnace state! Outgoing connections cannot use the thawed furnace state.
  #     Outgoing anchor connections may only connect to frozen variants, unless they light the furnace, in which case they may connect to thawed variants.
  # - Thawed Variant ("UpperReach.[name]Thawed):
  #     Paths to this anchor have to use the thawed furnace state! Outgoing connections cannot use the frozen furnace state.
  #     Outgoing anchor connections may only connect to thawed variants
  # This would however create countless redundancies, which is why additionally there's a counterpart for each variant:
  # These counterparts may not connect to any other anchors that have variants dependant on the same furnace, unless explicitely to connect into another furnace state.
  # - Main Paths ("UpperReach.[name]Paths"):
  #     All three variants connect to this anchor. Outgoing connections have to work with both furnace states.
  # - Frozen Paths ("UpperReach.[name]FrozenPaths"):
  #     The Main and Frozen variants connect to this anchor. Outgoing connections have to use the frozen furnace state.
  # - Thawed Paths ("UpperReach.[name]ThawedPaths"):
  #     The Main and Thawed variants connect to this anchor. Outgoing connections have to use the thawed furnace state.

  state UpperReach.ThawFurnace:  # mirror of the paths to UpperSoupFrozen, but without the freeze furnace state since that is guaranteed when trying to thaw it
    moki:
      Grenade=1  # this makes grenadebash paths meaningless
      Flap, Bash, DoubleJump OR Launch
    gorlek: Flap, Bash, Sword OR Hammer
    kii: Flap, Bash, Dash OR Glide OR Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe: Flap, Bash, Blaze=1 OR Spear=1
  state UpperReach.FreezeFurnace:  # refreezing the waterfall can be valuable
    moki: Flap

  pickup UpperReach.LowerKS:
    moki:
      UpperReach.ThawFurnace, DoubleJump
      UpperReach.ThawFurnace, Bash, Grenade=1
      UpperReach.ThawFurnace, Water, WaterDash
      Launch
    gorlek:
      UpperReach.ThawFurnace, WaterDash, Damage=20
      UpperReach.ThawFurnace, SentryJump=1
      SentryJump=1, DoubleJump, TripleJump
    kii:
      UpperReach.ThawFurnace, Bash, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2  # bash the gorlek
      UpperReach.ThawFurnace, Hammer OR Sword  # with sword, pogo the gorlek
    unsafe:
      UpperReach.ThawFurnace, Spear=1
      UpperReach.ThawFurnace, Dash, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1
      SentryJump=1  # need a decently high one
  pickup UpperReach.SwimEX:  # dirty water paths using the damage advantage over starting from the right
    kii, UpperReach.ThawFurnace:
      Damage=80, WaterDash
      Damage=120
    unsafe, UpperReach.ThawFurnace:
      Damage=40, WaterDash
      Damage=100

  conn Tokk: free
  conn UpperReach.UpperSoup:  # check for redundancies with OutsideTreeRoom and KeystoneSnapPlant
    moki:
      # these paths go through the hidden area below the soup
      Combat=ShieldMiner, Bash, Grenade=1, DoubleJump
      Launch
      # these paths work with both furnace states (even though sometimes through different routes)
      # paths that go to the right if the furnace is lit
      Water, DoubleJump, Grapple
      Water, DoubleJump, Bash, Grenade=1
      DoubleJump, Dash, Glide, Grapple
      # paths that go above if the furnace is lit
      DoubleJump, Bash, Glide
      DoubleJump, Bash, Grapple, Dash
      Bash, Grenade=1, Dash, Glide
    gorlek:
      # these paths go through the hidden area below the soup
      Bash, Grenade=1, DoubleJump OR Sword OR Hammer
      SentryJump=1, DoubleJump
      # these paths work with both furnace states (even though sometimes through different routes)
      # paths that go to the right if the furnace is lit
      DoubleJump, TripleJump OR Grapple
      DoubleJump, Dash, Water OR Glide OR Sword OR Hammer OR Damage=20
      Dash, Grapple, Glide, Combat=ShieldMiner, Sword OR Hammer
      Dash, Grapple, Glide, Bash, Grenade=1 OR Sword OR Hammer
      Water, Dash, Grapple, Combat=ShieldMiner, Sword OR Hammer
      Water, Dash, Grapple, Bash, Sword OR Hammer
      Water, WaterDash, Dash, Grapple, Sword  # go up to get over the enemy
      Water, WaterDash, Dash, Grapple, Glide, Hammer  # go up to get over the enemy
      Damage=20, Dash, Grapple, Combat=ShieldMiner, Sword OR Hammer
      Damage=20, Dash, Grapple, Bash, Sword OR Hammer
      Bash, Grenade=1, Dash, Water OR Damage=20
      Water, Bash, Grenade=1, Damage=20, Glide OR Sword OR Hammer
      # paths that go above if the furnace is lit
      Bash, DoubleJump, Dash OR Sword OR Hammer OR Damage=20
      Bash, Grenade=1, Glide
      Bash, Water, WaterDash, Glide, Sword OR Hammer
      Bash, Water, WaterDash, Grapple, Sword
      Bash, Damage=20, WaterDash, Glide, Sword OR Hammer
      Bash, Damage=20, WaterDash, Grapple, Sword
      Bash, SentryJump=1, Glide
      Bash, SwordSJump=1, Grapple
      Bash, HammerSJump=1, Grapple, Dash
      Bash, HammerSJump=1, Grapple, Damage=20, Sword
    kii:
      # these paths go through the hidden area below the soup
      Bash, Grenade=1, Dash OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Bash, Grenade=2
      # these paths work with both furnace states (even though sometimes through different routes)
      # paths that go to the right if the furnace is lit
      DoubleJump, Dash OR Sword OR Hammer OR Sentry=4
      Grapple, Dash OR Sword OR Hammer
      Grapple, Glide, Sentry=4
      Grapple, Glide, Sentry=3, Damage=20
      Grapple, Sentry=6
      Water, DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Damage=20, DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Grapple, Sentry=4, Water OR Damage=20
      Grapple, Sentry=3, Damage=20, Water OR Damage=20
      Bash, Grenade=1, Damage=20, Water OR Damage=20
      # paths that go above if the furnace is lit
      Bash, Glide
      Bash, DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1 OR Damage=20
      Bash, WaterDash, Grapple, Shuriken=2, Damage=20, Water OR Damage=20
      Bash, Grapple, Sentry=5
      Bash, Grapple, Damage=20, Shuriken=3
      Bash, Grapple, Damage=40, Shuriken=2
    unsafe:
      SentryJump=1
      DoubleJump, Sword, Hammer  # Pogo the gorlek, wall jump under the hidden passage and djump+hammer upslash. You need to not use any forwards slashes with sword in order to have your hammer upslash available
  conn UpperReach.UpperSoupFrozen:
    moki, UpperReach.FreezeFurnace:
      DoubleJump
      Bash, Grenade=1
    gorlek: UpperReach.FreezeFurnace, Sword OR Hammer
    kii: UpperReach.FreezeFurnace, Dash OR Glide OR Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe: UpperReach.FreezeFurnace, Blaze=1 OR Spear=1
  conn UpperReach.UpperSoupThawed:
    unsafe, UpperReach.ThawFurnace:
      WaterDash, Sword, Water OR Damage=20
      WaterDash, Hammer, Water OR Damage=20
      WaterDash, Dash, Water OR Damage=20  # dive launch
  conn UpperReach.OutsideTreeRoom:  # when changing or adding paths, keep in mind that there are derived paths to UpperSoup
    # The floating platform in the water only spawns if you reload from menu nearby.
    moki, UpperReach.ThawFurnace:
      Water, Combat=ShieldMiner OR DoubleJump OR Bash
      DoubleJump, Dash, Glide
    gorlek, UpperReach.ThawFurnace:
      Water, WaterDash, Glide OR Sword  # go up to get over the enemy
      Damage=20, WaterDash, Combat=ShieldMiner OR DoubleJump OR Bash
      DoubleJump, TripleJump OR Damage=20
      DoubleJump, Dash, Sword OR Hammer
      Combat=ShieldMiner, Damage=20, Dash OR Glide OR Sword OR Hammer
      Bash, Damage=20, Dash OR Glide OR Sword OR Hammer
      Grapple, DoubleJump
      Grapple, Dash, Glide, Combat=ShieldMiner OR Bash
      Grapple, Damage=20, Combat=ShieldMiner OR Bash
    kii, UpperReach.ThawFurnace:
      Water OR Damage=20
      DoubleJump, Dash OR Glide OR Sword OR Hammer OR Sentry=3
      Dash, Sword OR Hammer
      Grapple, Dash OR Glide OR Sword OR Hammer OR Sentry=2
    unsafe, UpperReach.ThawFurnace:
      DoubleJump OR Dash OR Sword OR Hammer OR Glide OR Grapple OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1  # QTM near the waterfall to make a floating platform appear
  conn UpperReach.KeystoneSnapPlant:  # when changing or adding paths, keep in mind that there are derived paths to UpperSoup
    gorlek: Launch
    kii: Bash, DoubleJump, TripleJump
  conn UpperReach.KeystoneSnapPlantThawed:
    moki, UpperReach.ThawFurnace:
      Bash, DoubleJump, Grapple OR Glide
      Bash, Water, WaterDash, Dash, Glide
      Bash, Grenade=1, Dash, Glide
      Bash, Launch
    gorlek, UpperReach.ThawFurnace:
      Bash, DoubleJump
      Bash, WaterDash, Glide, Water OR Damage=20
      Bash, Water, WaterDash, Grapple, Dash OR Sword OR Damage=20
      Bash, Damage=20, WaterDash, Grapple, Dash OR Sword
      Bash, Grenade=1, Glide
      Bash, Grenade=1, Grapple, Dash OR Sword OR Damage=20
      Bash, SentryJump=1, Glide
      Bash, SwordSJump=1, Grapple
      Bash, HammerSJump=1, Grapple, Dash OR Damage=20
    kii, UpperReach.ThawFurnace:
      Bash, Glide  # Bash the gorlek to reach the plant
      Bash, WaterDash, Grapple, Water OR Damage=20
      Bash, Grapple, Dash OR Sword OR Hammer OR Shuriken=2 OR Sentry=2 OR Flash=2
      Bash, Grapple, Damage=20, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2
    unsafe, UpperReach.ThawFurnace:
      Sword, Damage=20
  conn LowerReach.BelowTokk: free

# checkpoint at -369, -3917
# checkpoint at -216, -3895

anchor UpperReach.KeystoneSnapPlant at -231, -3865:  # At the snap plant with MiddleLeftKS in its mouth
  conn UpperReach.KeystoneSnapPlantPaths: free
  conn UpperReach.KeystoneSnapPlantThawedPaths:
    moki: UpperReach.ThawFurnace
  conn UpperReach.UpperSoup:  # mirrored in thawed variant
    moki:
      Glide OR Launch
      DoubleJump, Dash
    gorlek:
      DoubleJump, TripleJump OR Sword OR Hammer OR Damage=20
      Dash, Sword OR Hammer OR Damage=20
      Sword, Damage=20
    kii:
      Sword
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Dash, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Hammer, Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=20
      Sentry=3
      Damage=20, Shuriken=1 OR Sentry=2
    unsafe:
      Damage=40
      Hammer # https://youtu.be/upeQp93EZIo
      Dash # Reset your dash into the ceiling

anchor UpperReach.KeystoneSnapPlantThawed at -231, -3865:
  nospawn

  conn UpperReach.KeystoneSnapPlantPaths: free
  conn UpperReach.KeystoneSnapPlantThawedPaths: free
  conn UpperReach.UpperSoupThawed:  # mirrored in main variant
    moki:
      Glide OR Launch
      DoubleJump, Dash
    gorlek:
      Sword
      DoubleJump, TripleJump OR Hammer OR Damage=20
      Dash, Hammer OR Damage=20
    kii:
      DoubleJump, Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Dash, Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Hammer, Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=20
      Sentry=3
      Damage=20, Shuriken=1 OR Sentry=2
    unsafe:
      Damage=40

anchor UpperReach.KeystoneSnapPlantPaths at -231, -3865:
  nospawn

  pickup UpperReach.MiddleLeftKS: free
  pickup UpperReach.LowerKS:
    gorlek: DoubleJump, TripleJump
    kii: DoubleJump
    unsafe: Sword

  conn UpperReach.KeystoneRoom:  # check for redundancies with UpperSoup
    moki: DoubleJump OR Dash
    gorlek: Hammer OR Damage=20
    kii: Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1

anchor UpperReach.KeystoneSnapPlantThawedPaths at -231, -3865:
  nospawn

  pickup UpperReach.LowerKS:
    moki: Glide
    gorlek:
      Sword
      Dash, Bash OR Grapple OR Damage=10
      Hammer, Bash OR Grapple OR Damage=10
      Dash, Hammer
      Damage=20, Grapple
    kii: Dash OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Blaze=2 OR Damage=20
    unsafe: free

anchor UpperReach.UpperSoup at -215, -3877:  # At the soup
  conn UpperReach.UpperSoupPaths: free
  conn UpperReach.UpperSoupFrozenPaths:
    moki: UpperReach.FreezeFurnace
  conn UpperReach.UpperSoupThawedPaths:
    moki: UpperReach.ThawFurnace

anchor UpperReach.UpperSoupFrozen at -215, -3877:
  nospawn

  conn UpperReach.UpperSoupPaths: free
  conn UpperReach.UpperSoupFrozenPaths: free

anchor UpperReach.UpperSoupThawed at -215, -3877:
  nospawn

  conn UpperReach.UpperSoupPaths: free
  conn UpperReach.UpperSoupThawedPaths: free

anchor UpperReach.UpperSoupPaths at -215, -3877:
  nospawn
  refill Checkpoint
  refill Health=1

  pickup UpperReach.SoupOre: free
  pickup UpperReach.LowerKS:  # check for redundancies with KeystoneSnapPlant
    gorlek: DoubleJump, TripleJump, Glide
    kii:
      DoubleJump, TripleJump
      Flap, Bash  # Use the soup projectile. Bash the gorlek first so you get enough height from it.
      Glide, DoubleJump, Hammer OR Sentry=1 OR Flash=1 OR Shuriken=1
    unsafe:
      DoubleJump, Dash OR Hammer OR Sentry=1
      Sword, Damage=20, Damage=20  # go through the mortar room
  pickup UpperReach.UpperKS:
    moki:
      DoubleJump, Bash
      Launch
    gorlek: Bash
    unsafe: SwordSJump=1, Damage=20, DoubleJump OR Hammer  # dboost in the spike at the right of the enemy and sjump from here
  pickup UpperReach.SwingPoleEX:
    moki:
      DoubleJump
      Bash, Grenade=1
      Launch
    gorlek:
      Bash OR Hammer
      SentryJump=1
    kii: Spear=1
    unsafe:  # Since the cooled state solves by itself, all paths can use the heated state implicitely without any risk of softlocking
      Sword
      Damage=20
      # Dash, Sword, Damage=10  # upslash+dash in the icy part of the pole

  conn UpperReach.KeystoneRoom: free
  conn UpperReach.KeystoneSnapPlant:
    moki: Launch, DoubleJump OR Dash OR Glide
    gorlek: Damage=20, DoubleJump, TripleJump
    kii:
      Damage=20, DoubleJump, Dash OR Sword OR Hammer OR Sentry=2
      Damage=40, DoubleJump OR Dash
      Dash, Hammer, Damage=20
      Dash, Sword, Damage=40
    unsafe:
      DoubleJump, TripleJump
      DoubleJump, Damage=20, Sentry=1 OR Flash=1 OR Shuriken=1
      SwordSJump=1, Damage=20  # start at the soup, need to weapon stall to land further left on the spikes
      Damage=20, Grenade=1, Sword OR Hammer OR DoubleJump OR Dash OR Glide  # GrenadeJump=1 start at the soup, need to land further left on the spikes

anchor UpperReach.UpperSoupFrozenPaths at -215, -3877:
  nospawn
  refill Checkpoint

  pickup UpperReach.UpperKS:
    unsafe: SwordSJump=1, Damage=20  # dboost in the spike at the right of the enemy and sjump from here
  pickup UpperReach.SwingPoleEX:
    kii: Dash OR Glide OR Sword OR Sentry=1 OR Flash=1 OR Shuriken=1
    unsafe: free

  conn UpperReach.UpperSoupThawedPaths:  # light the furnace without dropping down
    unsafe:
      Grenade=1
      Flap, Bash

anchor UpperReach.UpperSoupThawedPaths at -215, -3877:
  nospawn
  refill Checkpoint

  pickup UpperReach.LowerKS:
    moki: Glide
    gorlek:
      Sword
      Dash, Hammer
    kii: Dash OR Sentry=2 OR Blaze=4
    unsafe: Damage=20, Sentry=1 OR Flash=1 OR Shuriken=1 OR Blaze=2
  pickup UpperReach.MiddleRightKS:
    moki:
      DoubleJump
      Bash, Grenade=1
      Launch
    gorlek:
      Bash OR Hammer
      SentryJump=1
    kii: Spear=1
    unsafe:
      Sword
      Damage=20
      # Dash, Sword, Damage=10  # upslash+dash in the icy part of the pole

  conn UpperReach.OutsideTreeRoom: free

anchor UpperReach.OutsideTreeRoom at -169, -3911:  # In front of the keystone door
  refill Checkpoint
  refill Energy=3:
    moki, UpperReach.ThawFurnace, BreakCrystal:
      Water, Grapple, DoubleJump OR Dash OR Glide
      Launch
    gorlek, UpperReach.ThawFurnace:
      BreakCrystal, Grapple, DoubleJump OR Dash
      BreakCrystal, DoubleJump, TripleJump OR Dash
      Water, BreakCrystal, Bow OR Spear
      Water, Grapple, BreakCrystal, Sword OR Hammer
    kii, UpperReach.ThawFurnace:
      Water, BreakCrystal, Grenade

  state UpperReach.KeystoneDoor:
    moki: Keystone=4

  pickup UpperReach.SwimEX:
    moki: UpperReach.ThawFurnace, Water

  conn UpperReach.UpperSoupThawed:
    moki, UpperReach.ThawFurnace:
      Grapple, DoubleJump
      Bash, Grenade=1, DoubleJump
    gorlek, UpperReach.ThawFurnace:
      Grapple, Dash
      DoubleJump, TripleJump OR Dash
      Bash, Grenade=1, Dash
      Bash, Grenade=1, Damage=20, Glide OR Sword OR Hammer
    kii, UpperReach.ThawFurnace:
      DoubleJump, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Grapple, Sword OR Hammer OR Sentry=4
      Grapple, Sentry=3, Damage=20
      Bash, Grenade=1, Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Damage=20
    unsafe: UpperReach.ThawFurnace, DoubleJump, Glide
  conn UpperReach.TreeRoomLedge:
    moki: UpperReach.KeystoneDoor
  # backwards connection can't get through the Icefall

anchor UpperReach.TreeRoomLedge at -136, -3911:  # On the ledge to the left and above the tree
  state UpperReach.KeystoneDoor:
    moki: Keystone=4

  pickup UpperReach.TreeOre:
    moki:
      Bash, Grenade=1, DoubleJump, Dash OR Glide
      Bash, Grenade=1, Dash, Glide
      Launch, DoubleJump OR Dash OR Glide
    gorlek:
      Bash, Grenade=1, Glide
      Bash, Grenade=1, DoubleJump, Sword OR Hammer
      Bash, Grenade=1, Dash, Sword OR Hammer
      Launch, Sword OR Hammer
      Launch, Bash, Grenade=1
      SentryJump=1, DoubleJump, Dash OR Glide
    kii:
      Bash, Grenade=1, Dash OR Sword OR Sentry=3
      Bash, Grenade=1, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1
    unsafe:
      Bash, Grenade=1, Hammer
      SentryJump=1, DoubleJump OR Dash OR Glide
      Launch

  conn UpperReach.TreeRoom: free
  # backwards connection can't get through the Icefall

anchor UpperReach.TreeRoom at -107, -3933:  # At the tree
  refill Checkpoint:  # the hut door saves
    unsafe: free
  refill Energy=4:  # fast respawning crystal
    moki: BreakCrystal

  quest UpperReach.SpringSeed:
    moki: Grenade=1
    gorlek: SentryBurn=1  # Use sentry to light the lantern

  pickup UpperReach.LightBurstTree: free
  pickup UpperReach.WellEX: free
  pickup UpperReach.HiddenEX:
    moki: Grenade=1
    gorlek: SentryBurn=1  # Use sentry to melt the ice
  pickup UpperReach.TreeOre:
    gorlek: Bash, Grenade=1, DoubleJump, TripleJump
    kii:
      Bash, Grenade=1, DoubleJump
      DoubleJump, TripleJump, Dash OR Glide OR Sword OR Hammer OR Sentry=2  # Climb the right wall

  conn UpperReach.TreeRoomLedge:
    moki:
      Bash, Grenade=3
      Launch
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump
      SentryJump=1, Grenade=2
      SentryJump=2, SentryBurn=2
    kii:
      DoubleJump, TripleJump
      Bash, Grenade=2, DoubleJump  # go up to the ore
      Bash, Grenade=1, DoubleJump, Dash OR Glide OR Sword  # go up to the ore
      Bash, Grenade=1, DoubleJump, Hammer, Shuriken=1 OR Sentry=1 OR Flash=1  # go up to the ore

region UpperDepths:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor UpperDepths.Entry at 161, -4340:  # The little standable ground below the entrance
  pickup UpperDepths.EntrySpikesEX:
    moki: Glide
    gorlek: Damage=10
    unsafe: free

  conn UpperDepths.FirstFirefly:
    moki:
      Glide, Combat=2xBombSlug+2xBat+SneezeSlug
      Glide, Combat=2xBombSlug, Bash
    gorlek:
      Glide, Combat=Bat OR Bash
      Combat=2xBombSlug, Damage=30, Bash, DoubleJump OR Dash  # Lots of possibilities here but Bash is the most reliable way to avoid too much damage
    kii:
      Damage=40, Dash OR Sword OR Shuriken=4
      Glide
      Damage=70, Sentry=4 OR Flash=4
  conn EastHollow.AboveDepths:
    moki: EastHollow.DepthsOpen, Glide
    gorlek, EastHollow.DepthsOpen:
      Launch, DoubleJump OR Damage=10
      SentryJump=1, Launch
    kii, EastHollow.DepthsOpen:
      Bash, DoubleJump, TripleJump, Grenade=1, Damage=30
    unsafe, EastHollow.DepthsOpen:
      Launch
      Bash, Grenade=1, DoubleJump, TripleJump
      Bash, Grenade=2, DoubleJump  # wall jump on the right wall, go to the safe spot in the spikes, grenade bash again from here
      SentryJump=2, DoubleJump  # same as above

# checkpoint at 147, -4392

anchor UpperDepths.FirstFirefly at 211, -4391:  # Where the Voice dialogue plays
  refill Checkpoint

  pickup UpperDepths.EntryRoofEX:
    moki:
      Bash, DoubleJump OR Dash
      Grapple, DoubleJump, Dash
      Launch
    gorlek:
      Bash, Grenade=1
      Grapple, DoubleJump, TripleJump OR Glide
      SentryJump=1, Combat=Bat, DoubleJump OR Dash
    kii:
      Bash, Sword OR Hammer OR Shuriken=1
      Bash, Damage=30, Sentry=1 OR Flash=1
      DoubleJump, TripleJump
    unsafe:
      Bash
      SentryJump=1, Combat=Bat, Glide, Damage=30
  pickup UpperDepths.EntryOre:
    moki:
      Combat=Bat, Grapple, DoubleJump
      Bash, DoubleJump OR Grapple
      Launch
    gorlek:
      Grapple, DoubleJump
      Bash OR SentryJump=1
    unsafe:
      DoubleJump, TripleJump
      Hammer, DoubleJump
      Grenade=1
      DoubleJump, Shuriken, Sword, Deflector
  pickup UpperDepths.LeftEntryKS:  # paths breaking the firefly egg; others can go from the anchor below
    moki:
      BreakWall=1, Combat=Spiderling, Grapple, DoubleJump OR Dash OR Glide
      BreakWall=1, Bash, Grapple, DoubleJump OR Dash OR Glide
      BreakWall=1, Launch
      Bow=1, Combat=Spiderling OR DoubleJump OR Bash OR Launch
      Spear=1, Combat=Spiderling OR DoubleJump OR Bash OR Launch
    gorlek:
      BreakWall=1, Grapple
      BreakWall=1, DoubleJump, TripleJump OR Dash OR Glide  # Glide happens to automatically line up with the safe spot, Sword doesn't
      Bow=1 OR Spear=1  # break the firefly egg from a distance
      SwordSJump=1, DoubleJump OR Dash OR Glide  # Go as close to spikes as possible, do SentryJup and the Sword hower + the skill you have
    kii:
      Sword, DoubleJump, Flash=1 OR Shuriken=1 OR Sentry=1
    unsafe:
      Bash  # make friends with the spiderling
      Sword, DoubleJump, Damage=30
  # a higher difficulty can put paths directly to swimec using the firefly egg here

  conn UpperDepths.Entry:
    moki:
      Glide, Combat=2xBombSlug+2xBat+SneezeSlug
      Glide, Combat=2xBombSlug, Bash
    gorlek:
      Glide, Bash, Combat=BombSlug OR Damage=10
      Glide, Combat=BombSlug+Bat
      Glide, Combat=Bat, Damage=10
      Launch, DoubleJump, TripleJump, Dash, Bash, Damage=30
    kii: Glide
  conn UpperDepths.FirstKSRoom: free

anchor UpperDepths.FirstKSRoom at 223, -4420:  # Below the first firefly egg
  refill Checkpoint:  # this checkpoint is easy to walk past
    unsafe: free
  refill Energy=3:  # this crystal is in the darkness
    unsafe: BreakCrystal

  pickup UpperDepths.LeftEntryKS:
    moki: DepthsLight, Combat=Spiderling OR DoubleJump OR Bash OR Launch
    gorlek: DepthsLight
    kii: Bash, Glide, DoubleJump OR Dash # Kite spider to left with bash and then bashglide
  pickup UpperDepths.SwimEC:
    moki:
      Flash=1, Water, Combat=Spiderling OR DoubleJump OR Bash OR Launch
      UpperDepths.ForestsEyes, Water, Combat=Spiderling OR DoubleJump OR Bash OR Launch
    gorlek:
      Water, UpperDepths.ForestsEyes OR Flash=1
      DepthsLight, ShurikenBreak=20, DoubleJump OR Dash OR Bash OR Glide OR Sword OR Hammer OR Damage=30

  conn UpperDepths.FirstFirefly:
    moki:
      Grapple, DoubleJump, Combat=Spiderling+WeakSlug OR Bash
      Launch, DoubleJump OR Grapple
    gorlek:
      Grapple, Combat=WeakSlug, DoubleJump OR Damage=30
      Grapple, Bash, DoubleJump OR Damage=30
      SentryJump=1, DoubleJump, Damage=30, Combat=2xSpiderling OR Bash
      Bash, Grenade=1, DoubleJump, Damage=30  # Possible without dmg if you go and jump from the left wall for additional height
      Launch
  conn UpperDepths.KeydoorLedge:
    moki:
      DoubleJump, Grapple
      Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Grapple
      Launch
    gorlek:
      Grapple, Dash OR Glide OR Sword
      DoubleJump, TripleJump, Dash OR Glide OR Sword
      Bash, Grenade=1
      SwordSJump=1
      HammerSJump=1, DoubleJump OR Dash OR Glide OR Grapple
    kii:
      Grapple, Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1 OR Shuriken=1 OR Hammer
      DoubleJump, TripleJump OR Dash
  conn UpperDepths.RightKeystonePath:  # check for redundancies with KeydoorLedge
    gorlek: Glide, DoubleJump OR Dash
    kii: Bash, Grenade=1, DoubleJump OR Dash

# checkpoint at 136, -4425
# checkpoint at 297, -4376

anchor UpperDepths.KeydoorLedge at 281, -4408:  # In front of the entry keystone door
  refill Checkpoint:
    moki: UpperDepths.EntryKeystoneDoor

  state UpperDepths.LightPuzzle:  # breaking the corruption blocking the light
    moki, UpperDepths.EntryKeystoneDoor, BreakWall=16, BreakWall=16:
      DoubleJump, Bash, Grapple
      Bash, Launch
    gorlek, UpperDepths.EntryKeystoneDoor, BreakWall=16, BreakWall=16:
      DoubleJump, Grapple, Combat=Spiderling+SneezeSlug
      Bash, DoubleJump, TripleJump
      Bash, DoubleJump, Damage=30, Dash OR Glide OR Sword
      Bash, Grenade=2, Combat=Spiderling+SneezeSlug, DoubleJump OR Dash
      Launch, DoubleJump OR Dash OR Glide OR Sword
    kii, UpperDepths.EntryKeystoneDoor, BreakWall=16, BreakWall=16:
      Launch, Damage=30
  state UpperDepths.EntryKeystoneDoor:
    moki: Keystone=2

  conn UpperDepths.FirstKSRoom:
    moki: DoubleJump OR Dash OR Grapple OR Glide OR Launch
    gorlek: Sword OR Hammer OR Damage=30
    kii: Shuriken=1 OR Flash=1 OR Blaze=1 OR Sentry=1 OR Spear=1
    unsafe: free
  conn UpperDepths.RightKeystonePath:
    moki:
      Grapple, DoubleJump OR Dash
      Glide OR Launch
    gorlek:
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer  # With Hammer first do howering, then press DoubleJump
      Grapple, Sword
    kii:
      Dash OR Sword
      Grapple, Hammer OR Sentry=2
      DoubleJump, Sentry=2 OR Shuriken
    unsafe:
      DoubleJump, Sentry=1 OR Flash=1 OR Blaze=3
  conn UpperDepths.BelowHive:  # LightPuzzle spawns another bat above the spikes
    moki, UpperDepths.EntryKeystoneDoor:
      UpperDepths.LightPuzzle, Bash, Glide
      UpperDepths.LightPuzzle OR DepthsLight:
        Launch
        Bash, DoubleJump OR Dash
        Combat=2xBat, DoubleJump OR Dash  # Combat=Bat expects a ranged weapon
    gorlek, UpperDepths.EntryKeystoneDoor:
      UpperDepths.LightPuzzle, Bash
      UpperDepths.LightPuzzle OR DepthsLight:
        Damage=30
        Combat=Bat, DoubleJump OR Dash OR Glide OR Sword  # Combat=Bat expects a ranged weapon
    kii, UpperDepths.EntryKeystoneDoor, UpperDepths.LightPuzzle OR DepthsLight:
      Combat=Bat, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, UpperDepths.EntryKeystoneDoor:
      Bash  # https://youtu.be/6lg7Yl-ehX8
      Damage=10, UpperDepths.LightPuzzle OR DepthsLight  # dboost on a bat's projectile

anchor UpperDepths.RightKeystonePath at 305, -4426:  # at the ledge below the entry keydoor, going towards the keystone
  refill Checkpoint

  pickup UpperDepths.RightEntryKS:
    moki:
      Grapple, DoubleJump
      Launch
    gorlek:
      Grapple
      DoubleJump, TripleJump
      DepthsLight, DoubleJump OR Dash OR Glide OR Sword  # use the poles hanging from the ceiling
      DepthsLight, Bash, Grenade=1
      DepthsLight, SentryJump=1
    kii:
      Bash
      DepthsLight, Hammer OR Shuriken=2 OR Sentry=2 OR Sword
    unsafe:
      DepthsLight, Flash=2

  conn UpperDepths.FirstKSRoom:
    moki:
      Grapple, DoubleJump
      Launch, DoubleJump OR Dash OR Glide
    gorlek:
      Grapple, Dash OR Damage=30
      Grapple, SentryJump=1
      Launch
    kii:
      Dash, Damage=30, DoubleJump OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Sword OR Hammer
      Dash, DoubleJump, TripleJump

anchor UpperDepths.BelowHive at 422, -4402:  # Below the Hive, on top of the tunnel leading downwards
  refill Checkpoint
  refill Full:  # use the teleporter (mirror of connecting to the teleporter and then back here)
    moki:
      BreakWall=1, Grapple, Bow OR Spear
      BreakWall=1, Launch
      DepthsLight, Grapple OR Launch
      DepthsLight, Bash, Grenade=1
    gorlek:
      Grapple, BreakWall=1, Bow OR Spear OR Shuriken OR Grenade
      DoubleJump, TripleJump, BreakWall=1, Bow OR Spear OR Shuriken OR Grenade
      SentryJump=1, Grapple  # use the weapon to break the firefly egg
      SentryJump=1, DoubleJump, TripleJump  # use the weapon to break the firefly egg
      DepthsLight, Damage=30, DoubleJump OR Dash
      DepthsLight, SentryJump=1
  refill Energy=3:
    moki: BreakCrystal, DoubleJump OR Launch

  state UpperDepths.EntryKeystoneDoor:  # mirror of connections to keydoor ledge
    moki: Keystone=2, DepthsLight, DoubleJump OR Dash OR Glide OR Launch
    gorlek, Keystone=2:
      DepthsLight, Sword OR Hammer OR Damage=30
      Dash, Launch
    kii, Keystone=2:
      DepthsLight, Sentry=1 OR Shuriken=1 OR Spear=1
      Flash=1 # if flash is your lightsource as well you need to turn it off and then turn it on again during your jump

  quest UpperDepths.LightcatcherSeed:
    gorlek: ShurikenBreak=20, DepthsLight, DoubleJump OR Dash OR Glide OR Sword
    # kii: ShurikenBreak=20, DepthsLight, Sword OR Sentry=2

  pickup UpperDepths.HiveEX:
    moki: Bash OR Launch  # bash makes paths destroying the hive redundant in moki
    gorlek:
      Combat=Nest, Grapple, DoubleJump  # use sword or hammer from combat to hover
      Combat=Nest, SentryJump=1
    kii:
      DoubleJump, Sword # use sword with double jump to gain height from mosquitos

  conn UpperDepths.KeydoorLedge:  # solving the light puzzle can't meaningfully softlock this since it means you can already access the other side
    moki: UpperDepths.EntryKeystoneDoor, DepthsLight, DoubleJump OR Dash OR Glide OR Launch
    gorlek, UpperDepths.EntryKeystoneDoor:
      DepthsLight, Sword OR Hammer OR Damage=30
      Dash, Launch
    kii, UpperDepths.EntryKeystoneDoor:
      DepthsLight, Sentry=1 OR Shuriken=1 OR Spear=1
      Flash=1 # if flash is your lightsource as well you need to turn it off and then turn it on again during your jump
  conn UpperDepths.Teleporter:
    moki:
      Grapple OR Launch
      DepthsLight, Bash, Grenade=1
    gorlek:
      DoubleJump, TripleJump
      DepthsLight, Damage=30, DoubleJump OR Dash
      DepthsLight, SentryJump=1
    kii:
      DoubleJump
  conn UpperDepths.Central:  # paths using the firefly have to go from the teleporter
    moki: DepthsLight, DoubleJump OR Dash OR Glide OR Launch  # a bit scary...
    gorlek: DepthsLight
  conn UpperDepths.LowerConnection:
    moki: DepthsLight, DoubleJump OR Dash OR Glide OR Launch  # a bit scary...
    gorlek: DepthsLight
  # so far, all connections to morapath going past the seed would be redundant with going to the teleporter first

# checkpoint at 529, -4399

anchor UpperDepths.Teleporter at 513, -4361:  # The spirit well
  refill Full

  state NonGladesTeleporter: free

  pickup UpperDepths.TeleporterEX: free  # just a few steps away in the darkness

  conn Teleporters: free
  conn UpperDepths.BelowHive:
    moki:
      BreakWall=1, Bow OR Spear
      BreakWall=1, Launch
      DepthsLight
    gorlek:
      BreakWall=1, Shuriken OR Grenade
      SentryJump=1  # use the weapon to break the firefly egg
      Dash, Damage=30 OR Launch  # spam and land in the spikes or catch with launch
    kii:
      Dash OR Launch
  conn UpperDepths.Central:  # paths using depthslight already solve connection through the midway anchor
    moki:
      BreakWall=1, Bow, DoubleJump OR Dash OR Glide OR Launch  # a bit scary...
      BreakWall=1, Spear, DoubleJump OR Dash OR Glide OR Launch  # a bit scary...
      BreakWall=1, Launch
    gorlek:
      BreakWall=1, Bow OR Spear OR Shuriken OR Grenade
      SentryJump=1  # use the weapon to break the firefly egg
    kii:
      BreakWall=1, DoubleJump, Damage=30
  conn UpperDepths.OutsideMoraFight:
    gorlek: ShurikenBreak=20

anchor UpperDepths.Central at 464, -4484:  # The firefly egg to the right of the second keystone door
  refill Checkpoint
  refill Energy=3:  # in the dark above
    unsafe: BreakCrystal, Launch

  state UpperDepths.CentralKeystoneDoor:
    moki: Keystone=2

  conn UpperDepths.SecondKSRoom:
    moki:
      Combat=2xSpiderling, BreakWall=1  # combat will provide a weapon, depthslight would be redundant here
      Bash, DepthsLight OR BreakWall=1
    gorlek: free  # don't look behind oriLurk
  conn UpperDepths.LowerConnection:
    moki: UpperDepths.CentralKeystoneDoor
  conn UpperDepths.BelowHive:
    moki: DepthsLight, Launch
    gorlek:
      DepthsLight, Bash, Grenade=1, DoubleJump, TripleJump OR Damage=10
      DepthsLight, SentryJump=1, DoubleJump, TripleJump, Damage=10
    kii:
      DepthsLight, DoubleJump, TripleJump

anchor UpperDepths.SecondKSRoom at 542, -4466:  # The egg of the firefly circling through the keystone room
  refill Checkpoint
  refill Energy=4:
    moki: BreakCrystal
  # a great number of energy crystals on the way through the dark have not been considered (they would probably even out since more anchors would also increase the flash cost)

  pickup UpperDepths.RightHealthKS:
    moki: BreakWall=1 OR DepthsLight
    gorlek: free
  pickup UpperDepths.LeftHealthKS:
    moki:
      BreakWall=1, DoubleJump, Dash OR Glide
      DepthsLight, DoubleJump, Dash OR Glide
      DepthsLight, DoubleJump, Bash, Grenade=1
      Launch, BreakWall=1 OR DepthsLight
    gorlek:
      DoubleJump, TripleJump, BreakWall=1 OR DepthsLight
      Dash, Glide, BreakWall=1 OR DepthsLight
      Sword, DoubleJump OR Dash  # break the firefly egg and hover
      DepthsLight, Bash, Grenade=1
      DepthsLight, SentryJump=1
      Launch
    kii:
      DoubleJump, BreakWall=1 OR DepthsLight
      Dash
      Sword, BreakWall=1 OR DepthsLight
  pickup UpperDepths.KeystoneHC:
    moki:
      BreakWall=1, DoubleJump, Dash, Glide
      DepthsLight, DoubleJump, Dash OR Glide
      Launch, BreakWall=1 OR DepthsLight
    gorlek:
      BreakWall=1, DoubleJump, TripleJump OR Dash OR Glide
      DepthsLight, DoubleJump, TripleJump
      Dash, Launch
    kii:
      DepthsLight, DoubleJump, Sword OR Hammer OR Flash=1 OR Blaze=1 OR Sentry=1 OR Shuriken=1 OR Spear=1
  pickup UpperDepths.BossPathEX:  # saved for later to know redundancies with the new anchor
    moki:
      DepthsLight, DoubleJump, Dash
      DepthsLight, DoubleJump, Bash, Grenade=1
      DepthsLight, Launch
    gorlek:
      DepthsLight, SentryJump=1, DoubleJump
      Launch
    kii:
      DepthsLight, DoubleJump, TripleJump OR Sword  # go around to the right and then jump to the left
    unsafe:
      DepthsLight, DoubleJump, Hammer  # go around to the right and then jump to the left

  conn UpperDepths.Central:
    moki:
      Combat=Spiderling, DepthsLight OR BreakWall=1
      Bash, DepthsLight OR BreakWall=1
    gorlek: DepthsLight OR BreakWall=1 OR Dash OR Bash OR Glide OR Launch OR Sword OR Hammer OR Damage=10  # with DoubleJump it's still quite easy to take damage
    kii: free  # might just wanna stick to damage 10 but I think it's doable
  conn UpperDepths.MoraPath:
    moki:
      DepthsLight, DoubleJump, Grapple, Dash OR Glide
      DepthsLight, Launch
    gorlek:
      DepthsLight, DoubleJump
      DepthsLight, Dash, Damage=30
      DepthsLight, Bash, Grenade=1, Damage=30, Glide OR Sword
      DepthsLight, Bash, Grenade=2
    kii:
      DepthsLight, Damage=60, Sentry=4 OR Sword OR Shuriken=4 OR Hammer
    unsafe:
      DepthsLight, Damage=60, Sentry=3 OR Shuriken=3
      Damage=60, Flash=3
  conn LowerDepths.East:
    gorlek, ShurikenBreak=20: DepthsLight, Combat=Spiderling, Launch OR DoubleJump OR Dash OR Glide OR Bash OR Sword OR Hammer
    # kii, ShurikenBreak=20: DepthsLight, Combat=Spiderling  # jump from the very edge of the platform above the spikes
    unsafe: ShurikenBreak=20  # Avoid the spiderling and use it as a lightsource

anchor UpperDepths.MoraPath at 572, -4431:  # At the safe light during the dark path towards Mora
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  quest UpperDepths.LightcatcherSeed:
    moki:
      DepthsLight, Grapple, DoubleJump, Dash
      DepthsLight, Combat=2xSpiderling, DoubleJump, Dash, Bash, Grenade=1  # clear the floor to bashgrenade
      DepthsLight, Launch
    gorlek:
      DepthsLight, Bash, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
      DepthsLight, Combat=3xSpiderling, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
      DepthsLight, SwordSJump=1  # kill the spiderlings with the weapon
      DepthsLight, HammerSJump=1, DoubleJump OR Dash OR Glide OR Damage=30  # kill the spiderlings with the weapon
      DoubleJump, Dash, Bash, Grapple
      Launch
    kii:
      DepthsLight, Grapple, Damage=30 OR Dash OR Glide OR Sword OR Hammer OR Sentry=2 OR Shuriken=1
      DepthsLight, DoubleJump

  conn UpperDepths.OutsideMoraFight:
    moki:
      DepthsLight, Grapple, DoubleJump, Dash OR Glide
      DepthsLight, Grapple, DoubleJump, Bash, Grenade=1
      DepthsLight, Launch
    gorlek:
      DepthsLight, Grapple, Dash, Damage=30, Glide OR Sword
      DepthsLight, DoubleJump, TripleJump
      DepthsLight, Grapple, Bash, Grenade=1, Dash OR Glide OR Sword
      DepthsLight, Bash, Grenade=2, DoubleJump OR Dash OR Glide OR Sword
      DepthsLight, Bash, Grenade=3
      DepthsLight, Grapple, SwordSJump=1
      DepthsLight, Grapple, HammerSJump=1, DoubleJump OR Dash OR Glide
      DepthsLight, SwordSJump=2
      DepthsLight, HammerSJump=2, DoubleJump OR Dash OR Glide
      DepthsLight, SentryJump=3
      Launch, DoubleJump OR Dash OR Glide
    kii:
      DepthsLight, Grapple, Damage=30, DoubleJump OR Dash OR Glide OR Sword
      DepthsLight, Bash, Damage=30, DoubleJump OR Dash OR Glide OR Sword
  conn UpperDepths.SecondKSRoom:
    moki: DepthsLight
  conn UpperDepths.BelowHive:  # many paths would be redundant with going to the teleporter
    gorlek, BreakWall=20:
      DepthsLight, Bash, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
      DepthsLight, Bash, Grenade=1, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
      DepthsLight, Bash, SwordSJump=1
      DepthsLight, Bash, HammerSJump=1, DoubleJump OR Dash OR Glide OR Damage=30
      DepthsLight, Combat=3xSpiderling, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
      DepthsLight, SentryJump=1, Grapple, Glide OR Damage=30  # kill the spiderlings with the weapon
      DepthsLight, SentryJump=2, Glide OR Damage=30  # kill the spiderlings with the weapon
    kii, BreakWall=20:
      DepthsLight, DoubleJump
      DepthsLight, Grapple, Damage=40 OR Dash OR Glide OR Sword OR Hammer OR Sentry=3 OR Shuriken=2
  # going to the keydoor should always be easier through the bottom path (keystone room) than going past the seed

anchor UpperDepths.OutsideMoraFight at 595, -4376:  # Directly left of Mora's lair
  refill Checkpoint

  conn MoraFirstPhase: free
  conn UpperDepths.Teleporter:
    moki, BreakWall=20:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek: BreakWall=20, Dash OR Sword OR HammerSJump=1
    kii, BreakWall=20:
      Sword OR Hammer OR Sentry=2
    unsafe: BreakWall=20, Glide
  conn UpperDepths.MoraPath:
    moki: DepthsLight, DoubleJump OR Dash OR Glide
    gorlek: free

anchor MoraFirstPhase at 674, -4385:
  nospawn
  refill Full

  conn MoraEscape:
    moki:
      SkipMora1  # Impossible state used to logically support skipping Mora through headers
      Boss=165, Regenerate, Damage=50, Bash, Grapple, DoubleJump OR Dash OR Launch
    kii: Boss=165, Regenerate, Damage=50, DoubleJump OR Dash OR Launch
    unsafe: Boss=165

anchor MoraEscape at 712, -4482:
  nospawn
  refill Checkpoint

  conn MoraSecondPhase:  # Abilities needed for the escape part
    moki: Bash, Grapple, DoubleJump OR Launch
    gorlek:
      Bash, Grapple, Dash
      Bash, Launch
      Launch, DoubleJump, TripleJump
      Launch, SentryJump=1, DoubleJump OR Grapple
    kii:
      Bash, Grapple, Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=1 OR Flash=1 OR Spear=1
      Launch, DoubleJump  # Multiple solutions: refresh your launch on the right ceiling, jump when the ground is moving up or use the right platform before the rock starts falling on it
    unsafe:
      Bash, Grapple
      Launch
      FlashSwap # Yes, it works on hard mode.

anchor MoraSecondPhase at 690, -4386:
  nospawn
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  quest UpperDepths.ForestsEyes:
    moki:
      SkipMora2  # Impossible state used to logically support skipping Mora through headers
      Boss=165, Regenerate, Damage=60, Bash, Flash, DoubleJump OR Dash OR Launch
    kii:
      Boss=165, Regenerate, Damage=60, DepthsLight, Launch
      Boss=165, Regenerate, Damage=60, DepthsLight, Bash, DoubleJump OR Dash
    unsafe: Boss=165

anchor UpperDepths.LowerConnection at 423, -4475:  # The firefly egg to the left of the second keystone door
  refill Checkpoint
  # energy crystal on the way to the trial not considered

  state UpperDepths.CentralKeystoneDoor:
    moki: Keystone=2

  pickup LowerDepths.BelowDoorOre:
    moki: DepthsLight  # It's hidden in a dark area, not hard to reach.
    gorlek: free  # the ore is a light source, lots of time to teleport out
  pickup LowerDepths.LeftEX:
    moki:
      Glide, BreakWall=1 OR DepthsLight
      Launch, BreakWall=1 OR DepthsLight
      DoubleJump, Dash, BreakWall=1 OR DepthsLight
    gorlek:
      Sword  # break the firefly egg and hover
      Hammer, DoubleJump OR Damage=30  # break the firefly egg and hover
      Dash, BreakWall=1 OR DepthsLight
      BreakWall=1, DoubleJump OR Damage=30
      DepthsLight, DoubleJump OR Damage=30
    kii:
      Sentry=2, DepthsLight OR BreakWall=1
      Blaze=3 OR Shuriken=3 # break the firefly egg and hover
    unsafe:
      Hammer OR Shuriken=3 OR Spear=4 # break the firefly egg and hover

  conn UpperDepths.BelowHive:
    moki:
      DoubleJump, Grapple, BreakWall=1 OR DepthsLight
      Launch, BreakWall=1 OR DepthsLight
      DepthsLight, Bash, Grenade=2, DoubleJump
    gorlek:
      DepthsLight, Grapple, Bash, Grenade=1, Damage=10
      DepthsLight, Bash, Grenade=2, Damage=10, Dash OR Glide
      DepthsLight, Bash, Grenade=3, Damage=10
      DepthsLight, Grapple, SentryJump=1, Damage=10
      DepthsLight, SentryJump=2, DoubleJump
      DepthsLight, SentryJump=2, Damage=10, Dash OR Glide
      DepthsLight, SentryJump=3, Damage=10
      BreakWall=1, DoubleJump, TripleJump
      BreakWall=1, SentryJump=4
      SentryJump=1, DoubleJump, DepthsLight OR BreakWall=1
    kii:
      DepthsLight, Grapple, Sentry=3 OR Shuriken=3 OR Sword OR Hammer
      DepthsLight, DoubleJump, TripleJump
    unsafe:
      DepthsLight, Grapple, Sentry=1 OR Shuriken=1 OR Flash=1 OR Damage=10
  conn UpperDepths.Central:
    moki: UpperDepths.CentralKeystoneDoor
  conn LowerDepths.West:
    moki:
      BreakWall=1, Dash, DoubleJump OR Glide
      DepthsLight, DoubleJump, Dash
      DepthsLight, Glide
      Launch, BreakWall=1 OR DepthsLight
    gorlek:
      Sword  # break the firefly egg and hover
      Dash, BreakWall=1 OR DepthsLight
      DoubleJump, DepthsLight OR BreakWall=1
      Damage=30, DepthsLight OR BreakWall=1
    kii:
      Sentry=2, BreakWall=1 OR DepthsLight
      Blaze=3, BreakWall=1 OR DepthsLight
    unsafe:
      Shuriken=3
  conn LowerDepths.Central:
    moki:  # the paths in the dark are a bit treacherous...
      BreakWall=1, DoubleJump, Dash, Bash
      BreakWall=1, Launch, DoubleJump OR Glide
      DepthsLight, DoubleJump, Dash, Bash OR Glide
      DepthsLight, Bash, Glide
      DepthsLight, Bash, Grenade=1, DoubleJump OR Dash OR Glide
      DepthsLight, Launch, DoubleJump OR Dash OR Bash OR Glide
    gorlek:
      BreakWall=1, Dash, Glide  # take the shortcut through the darkness
      BreakWall=1, DoubleJump, Dash, TripleJump OR Glide OR Sword OR Damage=30
      BreakWall=1, Launch, Dash OR Bash OR Sword OR Hammer OR Damage=30
      DepthsLight, Glide
      DepthsLight, Bash, DoubleJump OR Dash OR Sword OR Hammer
      DepthsLight, Damage=30, DoubleJump OR Dash OR Sword
      DepthsLight, DoubleJump, TripleJump, Dash OR Sword OR Hammer
      DepthsLight, DoubleJump, Dash, Hammer
      DepthsLight, Dash, Sword
      DepthsLight, Launch, Sword OR Hammer OR Damage=30
    kii:
      DepthsLight, Bash, Sentry=1 OR Shuriken=1 OR Flash=1 OR Spear=1
      DepthsLight, Sword, Sentry=2
      DepthsLight, Damage=30, Hammer OR Shuriken=2 OR Sentry=3
      DepthsLight, Damage=60, Shuriken=1
    unsafe:
      DepthsLight, Sword, Sentry=1 OR Flash=1 OR Shuriken=1 OR Spear=2
      DepthsLight, Damage=30, Sentry=2 OR Spear=3
      DepthsLight, Damage=60, Sentry=1 OR Spear=1 OR Flash=1 OR Blaze=2
      DepthsLight, Damage=90

region LowerDepths:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor LowerDepths.West at 322, -4510:  # At the Moki needing a Lantern
  refill Checkpoint
  refill Health=1:  # to the left. Damage boost paths are considered because there is also an energy crystal.
    gorlek:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword
      Dash, Glide OR Sword
      Bash OR Launch
      Water, WaterDash
    kii:
      Hammer, DoubleJump OR Dash
      Glide, Sword OR Hammer
      DoubleJump, Water
      DoubleJump, Damage=20, Damage=20  # Either you swim decently fast or you remember that you can double jump to delay entering the water.
      WaterDash, Damage=20, Damage=20  # the second damage is so that you can get back
    unsafe:
      Glide OR PauseHover
      Shuriken=2, DoubleJump OR Dash  # catch the shuriken
      HammerJump
      Sword, Water  # lure a fish to pogo
      Sword, Damage=140, Damage=20
      SentrySwap=2 OR BlazeSwap=2 OR FlashSwap
  refill Energy=3:  # to the left
    gorlek, BreakCrystal:
      DoubleJump, TripleJump OR Dash OR Glide OR Sword
      Dash, Glide OR Sword
      Bash OR Launch
      Water, WaterDash
    kii, BreakCrystal:
      Hammer, DoubleJump OR Dash
      Glide, Sword OR Hammer
      DoubleJump, Water
      DoubleJump, Damage=20, Damage=20  # Either you swim decently fast or you remember that you can double jump to delay entering the water.
      WaterDash, Damage=20, Damage=20  # the second damage is so that you can get back
    unsafe, BreakCrystal:
      Glide OR PauseHover
      Shuriken=2, DoubleJump OR Dash  # catch the shuriken
      HammerJump
      Sword, Water  # lure a fish to pogo
      Sword, Damage=140, Damage=20
      SentrySwap=2 OR BlazeSwap=2 OR FlashSwap
  # energy crystal on the way not considered

  quest LowerDepths.HandToHandSilk:
    moki: GladesTown.HandToHandLantern

  pickup LowerDepths.SwimEC:
    moki: Water, Bash, UpperDepths.ForestsEyes OR Flash
    gorlek: Water, Damage=10, UpperDepths.ForestsEyes OR Flash
    kii:
      Water, UpperDepths.ForestsEyes OR Flash
      WaterDash, UpperDepths.ForestsEyes, Damage=150  # Adding some damage for lenience. No Flash because you can't really see where you're going while water dashing.
    unsafe: WaterDash, Water OR Damage=120  # probably involves too much blind water dashing to be kii
  pickup LowerDepths.LeftEX:
    moki:
      DepthsLight, DoubleJump OR Dash OR Glide
      BreakWall=1, DoubleJump OR Dash OR Glide
    gorlek:
      DepthsLight, Sword OR Hammer
      BreakWall=1, Sword OR Hammer
    kii: DepthsLight OR BreakWall=1  # A little tricky, but you can see where you're jumping pretty well thanks to the pickup light.
    unsafe: Dash OR Launch

  conn DepthsShrine:
    moki:
      Water, DoubleJump, Bash, UpperDepths.ForestsEyes OR Flash
      Water, Bash, Grenade=1, Dash, UpperDepths.ForestsEyes OR Flash
      Water, Bash, Grenade=1, Glide, UpperDepths.ForestsEyes OR Flash
      Water, Launch, UpperDepths.ForestsEyes OR Flash
    gorlek:
      ShurikenBreak=20:
        DoubleJump, TripleJump OR Dash OR Glide OR Sword
        Dash, Glide OR Sword
        Bash OR Launch
        WaterDash, Water OR Damage=20
      Water, UpperDepths.ForestsEyes OR Flash:
        DoubleJump, TripleJump
        SentryJump=2
        Bash, Dash
        Bash, Grenade=1, DoubleJump OR Glide OR Sword OR Hammer
    kii:
      #ShurikenBreak=20:
      #  Hammer, DoubleJump OR Dash
      #  Glide, Sword OR Hammer
      #  DoubleJump, Water
      #  DoubleJump, Damage=20  # Either you swim decently fast or you remember that you can double jump to delay entering the water.
      #  WaterDash, Damage=20
      Bash, Water, UpperDepths.ForestsEyes  # Using Flash makes it too easy to accidentally kill the slime you need to bash off of; the jump can be done without the slime, but it's probably too precise.
    unsafe:
      ShurikenBreak=20:
        Glide OR PauseHover
        Shuriken=2, DoubleJump OR Dash  # catch the shuriken
        HammerJump
        Sword, Water  # lure a fish to pogo
        Sword, Damage=140
        SentrySwap=1 OR BlazeSwap=1 OR FlashSwap
      Water, UpperDepths.ForestsEyes OR Flash:
        DoubleJump, Dash, Sword OR Hammer  # djump + upslash + dash to the reach the wall before the shrine
        GlideJump, DoubleJump OR Dash OR PauseHover
        HammerJump
        SentryJump=1
        FlashSwap  # TODO: calculate blaze / sentry swaps
      Bash, Water, Flash
  conn UpperDepths.LowerConnection:
    moki: DepthsLight, Launch
    gorlek:  # Can make it easier by adding BreakWall=1 and using the firefly
      DepthsLight, DoubleJump, Damage=10, TripleJump OR Dash OR Glide OR Sword OR Hammer
      DepthsLight, DoubleJump, TripleJump, Dash OR Glide OR Sword
    kii:
      DepthsLight, Damage=20, DoubleJump, Dash OR Glide OR Sword  # probably fine
    unsafe:
      DepthsLight, Damage=20, Dash
      DepthsLight, Damage=10, DoubleJump
      DepthsLight, DoubleJump, Sword OR Dash
      BreakWall=1, Launch  # use the slime for light
      LaunchSwap  # squishy platform before the drop -> platform under the slime -> straight up past the slime
  conn LowerDepths.Central:
    moki, BreakWall=1 OR DepthsLight:
      DoubleJump, Bash, Dash  # combatting the bat would need bash anyway in moki
      Launch, DoubleJump OR Glide
    gorlek:
      BreakWall=1, DoubleJump, Bash, TripleJump OR Glide OR Sword OR Hammer
      BreakWall=1, Combat=Bat, DoubleJump, Dash, Glide
      BreakWall=1, SentryJump=1, Damage=10, Bash, Dash
      DepthsLight, DoubleJump, Bash, TripleJump OR Glide OR Sword OR Hammer
      DepthsLight, Combat=Bat, DoubleJump, Glide
      DepthsLight, Combat=Bat, DoubleJump, Dash, Damage=30, Sword OR Hammer
      DepthsLight, SentryJump=1, Damage=10, Bash, Dash OR Glide
      DepthsLight, Bash, Grenade=1, Damage=10, Glide OR Dash OR Sword OR Hammer
      DepthsLight, DoubleJump, TripleJump, Dash OR Sword OR Hammer  # 4 arrows with sword, 5 arrows with hammer
    kii:
      BreakWall=1 OR DepthsLight:  # The bat is kinda scary, but fighting it while also tracking a firefly and planning the jump over the spikes is equally scary.
        Sword, DoubleJump, Damage=10
        Hammer, DoubleJump, Damage=30
        Bash, Grenade=1
        # SentryJump=1, Bash, DoubleJump OR Dash OR Glide
        Launch
    unsafe:
      BreakWall=1 OR DepthsLight:
        Dash, SentryJump=1
        DoubleJump, Sword
        SentryJump=1, Damage=10, PauseHover OR Glide
        SentryJump=1, GlideJump
        HammerJump
      Launch  # Extremely Precise. Use the bat and the crystal for light.

anchor DepthsShrine at 213, -4515:
  nospawn
  refill Full

  state LowerDepths.CombatShrineCompleted:
    moki, Regenerate, Combat=3xBat+4xEnergyRefill+2xSneezeSlug+2xTentacle+4xEnergyRefill+2xBat+2xTentacle+4xEnergyRefill+Bat+SneezeSlug:
      Damage=65
      Damage=60, DoubleJump OR Dash
      Damage=50, Launch
    unsafe: Combat=3xBat+4xEnergyRefill+2xSneezeSlug+2xTentacle+4xEnergyRefill+2xBat+2xTentacle+4xEnergyRefill+Bat+SneezeSlug

  pickup LowerDepths.CombatShrine:
    moki: LowerDepths.CombatShrineCompleted

anchor LowerDepths.Central at 482, -4536:  # Below where the trial starts
  refill Checkpoint

  pickup LowerDepths.RaceStartHC:
    moki:
      DoubleJump, Grapple, Dash OR DepthsLight
      Launch
    gorlek:
      DepthsLight, Bash, Grenade=1, DoubleJump OR Dash  # easiest from the platform right of the jump pad
      DepthsLight, SentryJump=1, DoubleJump OR Dash
      DepthsLight, DoubleJump, TripleJump  # Climb the right wall.
    kii:
      DepthsLight, DoubleJump  # Might be easy enough for gorlek.
      DepthsLight, Bash, Grenade=1, Sword OR Hammer OR Shuriken=2 OR Sentry=2
      DepthsLight, Grapple, Dash OR Glide  # so...
      # - The first jump is extremely weird, it's just barely free but super awkward.
      # - Failing the jump doesn't really cause any problems for the player at all, you just drop back to where you started and try again.
      # - Any vertical movement boost at all makes it very easy.
      # - Grappling the light provides the necessary vertical height, but kii might not know that.
      # Going with the assumption that the player either knows the Grapple strat or notices that the free path is possible, but not both.
      Flash OR UpperDepths.ForestsEyes:  # Not enough time for bow light.
        Grapple, Sword OR Hammer OR Shuriken=2 OR Sentry=2
      DoubleJump, TripleJump, Dash  # Use the grapple plant for light.
    unsafe:
      DepthsLight, Bash, Grenade=1
      DepthsLight, Grapple, Shuriken=2 OR Sentry=2 OR PauseHover
      DepthsLight, GrenadeJump  # Grenade Jump from the platform right of the jump pad, Grenade Wall Jump for extra distance.
      SentryJump=1  # Sentry Jump from the platform right of the jump pad.
      Grapple, DoubleJump OR Bow=1 OR Dash  # Use the ledge above the grapple plant. The Bow shot provides both light and movement.
      HammerJump  # Hammer Jump to the wall above the grapple plant, Hammer Jump around the ledge.
      DoubleJump, TripleJump, GlideJump  # Reach the grapple plant to refresh light, glide across.

  pickup LowerDepths.SpiritTrial:
    moki: LowerDepths.TrialActivation, DoubleJump, Dash, Bash, Grapple
    kii, LowerDepths.TrialActivation:
      Dash, Bash, Grapple, Glide
      DoubleJump, Bash, Grapple, Glide  # Possible without glide, but the second lantern is hard to reach, and the timer is tight.
    unsafe, LowerDepths.TrialActivation:
      Dash, Bash, Grapple  # Swing the first firefly. It could be kii if you damage boost instead, but that damage boost looks like it qualifies as friendly spikes.
      DoubleJump, Bash, Grapple
      DoubleJump, Dash, Bash, Glide  # Swing the last firefly.

  conn LowerDepths.East:
    moki:
      Bash, DoubleJump, Dash OR Glide
      Launch, DoubleJump OR Dash OR Bash OR Glide
    gorlek:
      Bash, DoubleJump, TripleJump OR Sword OR Hammer
      Bash, Dash, Glide OR Sword
      Launch, Damage=30
      DepthsLight, DoubleJump, Dash, Glide OR Sword
      DepthsLight, DoubleJump, TripleJump, Dash OR Sword OR Glide
    kii:
      Flash=1 OR UpperDepths.ForestsEyes:  # Midair bow shot if bow is the light source.
        DoubleJump, TripleJump, Hammer
      Bash, DoubleJump, Shuriken=1 OR Sentry=1 OR Spear=1 OR Flash=1  # Flash Boost.
      Bash, Glide
      Launch  # You need to reset Launch on the wall left of the last two fireflies. Going with kii because the reset is easy (some of the wall is safe for wall jumping) and there's plenty of light to use.
    unsafe:  # There's a safe platform in the spikes below the lanterns.
      DepthsLight, DoubleJump, TripleJump OR Sword OR Hammer
      Flash=1, DoubleJump  # Activate Flash late for a boost.
      Bash, DoubleJump, Blaze=1
      Bash, Sword OR Hammer OR Shuriken=2 OR Sentry=3 OR DoubleJump OR Dash OR Damage=30 OR PauseHover
      Bash, Spear=1 OR GrenadeCancel  # Grenade/Spear Zoom off of the first firefly to reach the second.
      HammerJump  # Extended Hammer Jump from the first firefly to the second, land on the platform in the spikes.
  conn UpperDepths.LowerConnection:
    moki:
      DepthsLight, Launch, Bash
      DepthsLight, Bash, DoubleJump
    gorlek:
      DepthsLight, Launch
      DepthsLight, Combat=WeakSlug, DoubleJump, TripleJump, Dash OR Bash OR Glide OR Sword OR Hammer OR Damage=30  # need 6 arrows
    kii:
      DepthsLight, DoubleJump, TripleJump OR Dash OR Glide OR Damage=30
      Sword OR Hammer OR DoubleJump OR Grapple OR Grenade=1 OR Spear=1 OR Sentry=1:  # These are to get to the trial platform, see RaceStartHC for more info.
        DepthsLight, Bash, Dash OR Glide
      Flash=1 OR UpperDepths.ForestsEyes:  # Bow path requires a midair bow shot.
        Bash, Hammer OR Sword
    unsafe:
      DepthsLight, Bash, Hammer OR Sword
      DepthsLight, Bash, Dash OR Glide
      DepthsLight, PauseHover
      DepthsLight, GlideJump  # Glide Jump to reach the wall next to the firefly.
      DepthsLight, HammerJump
      LaunchSwap  # wall left of firefly -> wall under BelowDoorOre -> wall next to slime

# checkpoint at 478, -4517

anchor LowerDepths.East at 570, -4550:  # The lit up room on the trial path
  # hey so in case you think "I don't like the anchor layout in this area and wow this anchor is gigantic" yeah I think so too but I failed to come up with a better solution so just a heads that maybe there is a better set of anchors possible here but also maybe you're just putting yourself through useless pain for trying.
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal
  refill Energy=3:
    moki, BreakCrystal:
      Bash, DoubleJump OR Dash OR Glide
      Launch
    gorlek, BreakCrystal:
      Bash OR SentryJump=1
      DoubleJump, TripleJump OR Dash OR Glide OR Sword
    kii, BreakCrystal:
      Sword, DoubleJump OR Dash
      Hammer, DoubleJump OR Dash
      Glide
    unsafe, BreakCrystal:
      DoubleJump, Hammer
      GrenadeJump OR PauseHover
      Grapple, UltraGrapple
      Sword  # Pogo a skeeto.

  pickup LowerDepths.SpiritSurgeShard:
    moki:
      DoubleJump, Grapple, Dash OR Glide
      Launch, DoubleJump OR Dash OR Grapple OR Glide
    gorlek:
      DoubleJump, Grapple
      Launch, Sword
      DepthsLight, Grapple, Dash OR Glide OR Sword
      DepthsLight, DoubleJump, TripleJump, Dash, Glide OR Damage=30
      DepthsLight, Bash, Grenade=1, DoubleJump, TripleJump, Dash OR Glide OR Damage=30
      DepthsLight, Bash, Grenade=1, DoubleJump, Dash, Damage=30
    kii:
      DepthsLight, DoubleJump, TripleJump, Damage=30
      DoubleJump, TripleJump, Dash OR Glide  # The Glide path might be too hard due to time.
      Grapple, Sword OR Dash OR Glide  # The Glide path might be too hard due to grapple plant physics.
      Launch
    unsafe:  # There's a safe spot in the middle of the spikes.
      DepthsLight, DoubleJump, GlideJump
      DepthsLight, HammerJump
      DepthsLight, GrenadeJump, Glide
      DoubleJump, TripleJump
      Grapple, Damage=30, Damage=30  # Jump to the safe spot, grapple the plant for light, use Regenerate, grapple the plant again, jump to the bottom left platform, grapple the other plant and jump to it. Very hard.
      PauseHover, DoubleJump OR Grapple OR GlideJump
      FlashSwap
      Grapple, Hammer OR Sentry=2  # Probably too precise for kii, especially given that the grapple plants have physics.
      Shuriken=4, DoubleJump, Flash=1  # Flash Boost, catch the shuriken twice. Last shuriken is to reach the wall next to the grapple plant.
      Bash, Grapple, GrenadeCancel, GrenadeJump  # Grenade Zoom off of a skeeto, Grenade Jump onto the grapple plant.
  pickup LowerDepths.LupoMap:
    moki, SpiritLight=150:
      Grapple, DoubleJump OR Dash OR Glide
      Launch, DoubleJump, Dash
      Launch, Glide
      DepthsLight, Glide
      DepthsLight, Launch, DoubleJump OR Dash
    gorlek, SpiritLight=150:
      Grapple, Sword
      Launch
      DepthsLight, DoubleJump, TripleJump, Dash OR Sword OR Hammer
      DepthsLight, DoubleJump, Dash, Sword OR Hammer
      DepthsLight, Damage=30, DoubleJump OR Dash OR Grapple OR Sword OR Hammer
    kii, SpiritLight=150:
      DepthsLight, Damage=60
      DepthsLight, Damage=30, Shuriken=2 OR Sentry=2  # Possible with one weapon, but requires iframe abuse.
      DepthsLight, DoubleJump, Dash OR Sword OR Hammer
      DoubleJump, TripleJump OR Glide  # Triple Jump path uses the wall left of the first grapple plant.
      Grapple
    unsafe, SpiritLight=150:  # There's two safe spots in the spikes. The first one's kinda useless.
      DoubleJump, Dash  # Reset Dash on the ceiling a couple times.
      Flash=1, Damage=30  # Flash Boost for distance and light.
      PauseHover, DepthsLight OR DoubleJump
      Bash, GrenadeCancel  # Grenade Zoom.
      DoubleJump, GrenadeJump
      GlideJump
      WaveDash  # The slope on the platform is Wave-Dash-safe for some reason.
      DepthsLight, Shuriken=3  # Double shuriken catch.
      DepthsLight, Damage=30, Damage=30
      DepthsLight, Damage=30, Blaze=1 OR Sentry=1 OR Flash=1 OR Shuriken=1
      DepthsLight, DoubleJump OR Dash

  conn UpperDepths.SecondKSRoom:
    moki, BreakWall=20:
      DepthsLight, DoubleJump, Bash, Grapple
      DepthsLight, Launch
    gorlek, BreakWall=20:
      DepthsLight, Bash, Grapple, Dash
      DepthsLight, Bash, Grapple, Damage=30, Glide OR Sword
      DepthsLight, Bash, SentryJump=1, DoubleJump OR Dash
      DepthsLight, Bash, SwordSJump=1, Damage=30
      DepthsLight, Bash, SentryJump=1, Glide, Damage=30
      DepthsLight, Bash, Grenade=1, DoubleJump OR Dash
      DepthsLight, Bash, Grenade=1, Damage=30, Glide OR Sword
      DepthsLight, Bash, DoubleJump, TripleJump
      DepthsLight, DoubleJump, TripleJump, SwordSJump=1  # sjump before the lanterns, tjump+weapon stall to reach the breakable wall. Climb the right wall with tjump to reach the jumpad
      DepthsLight, DoubleJump, TripleJump, HammerSJump=1, Dash OR Glide  # sjump before the lanterns, tjump+weapon stall to reach the breakable wall. Climb the right wall with tjump to reach the jumpad
    kii, BreakWall=20:
      DepthsLight, Bash, Grapple, Sword OR Hammer OR Shuriken=1 OR Sentry=2 OR Glide
      DepthsLight, Bash, Grenade=1  # Wall Jump to catch up to the grenade.
      UpperDepths.ForestsEyes, DoubleJump, TripleJump  # Climb on the right, the path is tricky and can only be seen with full light.
    unsafe, BreakWall=20:  # Dark runs can't work because there's no way to know how quickly you can break the wall.
      DepthsLight, DoubleJump, TripleJump  # Climb on the right
      DepthsLight, Bash, SentryJump=1
      DepthsLight, Bash, DoubleJump OR Glide OR PauseHover  # Use the spiderling.
      DepthsLight, Bash, Grapple  # Use Grapple for a boost at the top of the shaft.
      DepthsLight, Bash, HammerSJump=1
      DepthsLight, HammerJump
  conn LowerDepths.BeforeTree:
    moki:
      Bash, Grapple, DoubleJump OR Dash
      Launch, Bash OR Grapple
    gorlek:
      BreakWall=1 OR DepthsLight:  # go above
        Launch, Grapple
        Launch, DoubleJump, TripleJump OR Dash OR Glide OR Bash OR Sword OR Damage=30
        Launch, Dash, Glide OR Bash OR Sword OR Damage=30
        Launch, Glide, Bash OR Damage=30
        Launch, Damage=30, Bash OR Sword
      Bash, Grapple, Glide OR Sword
      Bash, DoubleJump, TripleJump, Dash OR Glide OR Damage=30
    kii:
      Launch, Damage=30  # Top path
      Bash, DoubleJump, TripleJump, Shuriken=1 OR Sentry=1 OR Spear=1 OR Flash=1
      UpperDepths.ForestsEyes, Launch  # Using extra light to make sure that the player can see the path.
      Flash=1 OR UpperDepths.ForestsEyes:
        DoubleJump, TripleJump, Grapple OR Damage=50
    unsafe:
      Launch
      Bash, Grapple, Hammer
      Bash, DoubleJump OR Dash OR Glide OR PauseHover  # Swing the second firefly a lot.
      DepthsLight, DoubleJump, TripleJump, Grapple OR Damage=20
  conn LowerDepths.TreeArea:  # Paths that go up to the firefly egg and then across with it.
    gorlek, BreakWall=1:
      Launch, Grapple
      Launch, DoubleJump, TripleJump OR Dash OR Glide OR Bash OR Sword OR Damage=30
      Launch, Dash, Glide OR Bash OR Sword OR Damage=30
      Launch, Glide, Bash OR Damage=30
      Launch, Damage=30, Bash OR Sword
    kii, BreakWall=1:
      Launch, Damage=30
      Launch, Bash, Shuriken=1 OR Sentry=2
  conn LowerDepths.Central:
    moki:
      Bash, DoubleJump OR Launch
      DepthsLight, Launch, DoubleJump, Dash OR Glide
    gorlek:
      Bash, Dash
      Launch
      DepthsLight, DoubleJump, TripleJump, Dash, Glide, Damage=30
    kii:
      UpperDepths.ForestsEyes, DoubleJump, TripleJump  # Obscure path needs lots of light. If this is too hard, there's a lot of skills that would make it easier.
      Bash, Sword OR Shuriken=1 OR Sentry=1
      DepthsLight, Bash, Hammer
    unsafe:
      DoubleJump, TripleJump
      Bash  # make the last lantern swing to the left
      DepthsLight, DoubleJump, Damage=60

anchor LowerDepths.BeforeTree at 693, -4515:  # The last glowshroom patch before the flash tree
  refill Checkpoint

  state LowerDepths.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: DoubleJump, Bash, Grapple, Dash OR Glide
    gorlek: DoubleJump, Bash, Grapple
    kii: Dash, Bash, Grapple
    unsafe: DoubleJump, Dash, Bash, Glide

  conn LowerDepths.East:
    moki:
      Glide
      DoubleJump, Bash OR Grapple
      Dash, Bash OR Grapple
      Launch, DoubleJump OR Dash OR Bash OR Grapple
    gorlek:
      DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Damage=30
      DoubleJump, Dash, Sword OR Hammer OR Damage=30
      Sword, Damage=30, DoubleJump OR Dash
      Bash, Sword OR Damage=30
      Bash, Grapple, Hammer
      Launch
      UpperDepths.ForestsEyes OR Flash=1:  # these seemed a bit unintuitive with the darkness, or stressful with the timer
        Sword, Grapple
        Hammer, Damage=30, DoubleJump OR Dash
        Damage=30, DoubleJump OR Dash OR Sword
    kii:
      Sword, Dash OR Grapple OR Damage=30  # A little fast.
      DepthsLight, Hammer, Bash OR Grapple
      Bash, Grapple
      Dash, Sentry=3 OR Damage=30
      DoubleJump, Sentry=3 OR TripleJump OR Dash OR Flash=2 OR Damage=30  # If you don't know the path, you'll see it on your way down. Is that too much trial and error?
    unsafe:
      Damage=10, Sword OR DoubleJump OR Bash  # Some spikes deal a lot less damage than others.
      Dash  # Funky dash reset on the tip of the bottleneck.
      Hammer, Bash OR Grapple
      DepthsLight, Hammer, Damage=10
      # DoubleJump, Shuriken=2
      Shuriken=2 OR Sentry=2  # >:]
      Flash=2, Damage=30  # That is two Flash *hops*
      GrenadeJump, DoubleJump OR Damage=20
      BlazeSwap=1, DoubleJump OR Damage=10
      BlazeSwap=2
      PauseHover
  conn LowerDepths.TreeArea:
    moki:
      DepthsLight
      BreakWall=1:
        DoubleJump, Bash, Grapple, Dash OR Glide
        Launch, Bash, DoubleJump, Dash
        Launch, Bash, Glide
        Launch, Grapple, DoubleJump OR Dash OR Bash OR Glide
    gorlek, BreakWall=1:
      Bash, Grapple, DoubleJump
      Bash, Grapple, Dash, Glide OR Sword
      Bash, DoubleJump, TripleJump, Dash, Glide OR Sword
      Bash, DoubleJump, TripleJump, Damage=30, Dash OR Glide OR Sword OR Hammer
    kii, BreakWall=1:
      Launch, Sword OR DoubleJump OR Grapple OR Glide
      Launch, Bash, Shuriken=2 OR Sentry=4 OR Dash
      Launch, Damage=30, Shuriken=1 OR Sentry=2 OR Damage=30
      Bash, Grapple, Sword OR Sentry=7 OR Dash OR Glide
      Bash, Grapple, Damage=30, Shuriken=4 OR Sentry=5  # Also possible with 4 Flash Boosts. Currently, that's redundant with the DepthsLight path, but it might not be in the future.
      Bash, DoubleJump, TripleJump, Damage=30, Shuriken=2 OR Sentry=3 OR Blaze=5
      Bash, DoubleJump, TripleJump, Sword OR Glide
      Bash, DoubleJump, TripleJump, Dash, Hammer OR Shuriken=1 OR Sentry=1  # Also possible with a Flash Boost.
    unsafe:
      LaunchSwap  # Launch Swap to the ceiling over the drop, fall straight down, Launch Swap after hitting the floor.
      BreakWall=1:
        Launch
        Bash, Grapple, Hammer OR Sentry=5
        Bash, DoubleJump, TripleJump, Shuriken=3 OR Dash  # Reset Dash on the ceiling a few times.
        Bash, DoubleJump, Glide, Damage=30
        Bash, PauseHover, DoubleJump OR Dash OR Grapple OR Glide
        Bash, Damage=30, Damage=30

# checkpoint at 621, -4579

anchor LowerDepths.TreeArea at 776, -4542:  # The flash tree
  refill Checkpoint
  refill Energy=4:
    moki: BreakCrystal

  pickup LowerDepths.FlashTree: free
  pickup LowerDepths.RightEX:
    moki: DepthsLight OR Launch
    gorlek: Bash, Grenade=1
    unsafe: SentryJump=1

  conn LowerDepths.BeforeTree:
    moki: DepthsLight, DoubleJump OR Dash OR Launch
    gorlek: DepthsLight, Glide OR Sword
    kii: DepthsLight, Hammer OR Sentry=2 OR Shuriken=2 OR Spear=2
    unsafe: DepthsLight OR LaunchSwap  # Launch Swap: right side of first cocoon -> left side of second cocoon -> all the way across.

region PoolsApproach:
  moki: Danger=25, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor PoolsApproach.MillPathCheckpoint at -826, -4130:  # The checkpoint halfway between Mill Approach and Mill Path (added mostly because the paths through here reached ridiculous complexity otherwise)
  refill Checkpoint

  conn WestGlades.MillApproach:
    moki, Water:
      Grapple, DoubleJump, Dash OR Glide
      Grapple, Bash, Grenade=1, Dash, Glide
      Launch, DoubleJump OR Dash OR Grapple OR Glide  # go up the left wall
    gorlek, Water:
      Grapple, DoubleJump, TripleJump OR Sword OR Damage=15
      Grapple, Dash, Glide OR Sword OR Hammer OR Damage=15
      Grapple, Glide, Sword OR Damage=15
      Grapple, Sword, Damage=15
      Bash, Grenade=1, Launch
      Launch, Sword OR Damage=15
    kii, Water:
      Grapple, DoubleJump OR Dash OR Sword
      Grapple, Glide, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15  # wall jump from the right wall and use your energy weapon to reah the left wall
      Grapple, Bash, Grenade=1, Glide
      Grapple, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=15
      Grapple, Sentry=4 # wall jump from the right wall and use 2 sentries to reach the left wall
      Grapple, Sentry=2, Damage=15  # dboost in the first spikes then use two sentries to reach the water
      Grapple, Bash, Grenade=1, Sentry=2
      Grapple, Damage=30, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Grapple, Bash, Grenade=1, Damage=15, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Launch
      DoubleJump, TripleJump, Damage=15
    unsafe:
      Water, Grapple, Glide OR Damage=45  # grapple the plant then let you fall under it and regrapple it from bellow to have more height
      Water, DoubleJump, TripleJump  # walljumps on the wall in the ceiling
      Water, SwordJump, Damage=15
      Water, DoubleJump, Hammer, Damage=15
      Water, HammerJump
  conn PoolsApproach.MillPath:
    moki, Damage=20:  # severe enemy spam
      Combat=Crab+2xSmallSkeeto, Grapple, DoubleJump OR Dash  # go through the gap from above, you can use Grapple to reset if you fall
      Bash, Grapple, DoubleJump OR Dash  # go through the gap from above, you can use Grapple to reset if you fall
      Launch, DoubleJump OR Grapple OR Bash
    gorlek:
      Combat=2xSmallSkeeto, Grapple, Glide OR Sword OR Hammer
      Bash, Grapple, Glide OR Sword OR Hammer OR Grenade=1
      Combat=2xSmallSkeeto, SentryJump=1, DoubleJump, TripleJump
      Bash, Grenade=1, DoubleJump
    kii:
      Combat=2xSmallSkeeto, Grapple, Shuriken=1
      Bash, Grapple OR Grenade=1
      Launch, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Launch OR Bash  # Bash the ennemies but they don't really like being on the right position for you to bash them
      Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2 OR Damage=20
      DoubleJump, HammerJump, Dash OR TripleJump
      DoubleJump, TripleJump, Sword  # Reset your jumps by hitting/pogoing the ennemies

anchor PoolsApproach.MillPath at -873, -4146:  # above the water where the three paths merge
  refill Checkpoint

  state PoolsApproach.UnderwaterWallBroken:
    moki: Water  # bashing to break the wall on the way is much harder than just swimming at it and letting it happen, so didn't make Bash a requirement.
    kii:  # need enough health in order to exit the water so you can tp out
      Damage=180
      WaterDash, Damage=160
    unsafe:
      Bash, Damage=160
      WaterDash, Bash, Damage=140

  pickup PoolsApproach.MillPathEX:
    moki:
      Bash, DoubleJump OR Dash
      Combat=SpinCrab+CorruptSlug, DoubleJump, Dash
      Combat=SpinCrab+CorruptSlug, DoubleJump, Grapple, Glide  # solvable either through the right grapple point or using the wrap-around taught at glades shrine
      Launch
    gorlek:
      Bash, Water OR Glide  # there's a variety of solutions for this with the enemies around
      DoubleJump, TripleJump  # gives some room to maneuver around the corrupted slug
      Combat=SpinCrab+CorruptSlug, DoubleJump, Grapple OR Glide OR Sword OR Hammer
    kii:
      Bash
      DoubleJump, Sword  # either pogo the crab or djump toward the left wall and upslash to make the slime fall (which reset your djump)
      Combat=SpinCrab+CorruptSlug, DoubleJump
      Combat=SpinCrab+CorruptSlug, Dash, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Combat=CorruptSlug, Grapple, Glide, Dash OR DoubleJump
    unsafe:
      SwordSJump=1
      Sword, Damage=5 OR Combat=CorruptSlug
      Combat=SpinCrab+CorruptSlug, Dash  # Dash ramp
      Combat=CorruptSlug, Dash, Grapple  # grapple the right plant, and spam dash to reach the wall where the slime is
  pickup PoolsApproach.MillPathEC:
    moki: Water  # again not really a reason to even use Bash
    kii:
      Damage=120
      WaterDash, Damage=60
    unsafe:
      Damage=80  # TP under water
      WaterDash, Damage=40
  pickup PoolsApproach.MillPathHC:  # Paths using clean water originate from PoolsApproach.OnTopOfWheel. Make sure it's not redundant with going to PoolsApproach.MillPathCheckpoint first
    kii: Damage=220, WaterDash

  conn PoolsApproach.MillPathCheckpoint:
    moki, Damage=20:  # severe enemy spam
      Bash, DoubleJump, Dash OR Glide  # bash errything
      Combat=Crab+2xSmallSkeeto, Bash, Grenade=3, DoubleJump OR Dash OR Glide  # clear the space to bashnade
      Combat=Crab+2xSmallSkeeto, Bash, Grenade=2, Grapple, DoubleJump OR Dash OR Glide  # clear the space to bashnade
      Combat=Crab+2xSmallSkeeto, DoubleJump, Grapple, Dash OR Glide
      Launch, DoubleJump OR Dash OR Bash OR Glide
    gorlek:
      Bash, DoubleJump OR Dash OR Glide
      Bash, Grenade=2, Sword OR Hammer OR Damage=20  # Using Sword or Hammer it's hard to work with the bomb slugs without them doing the kaboom thing
      Combat=Crab+SmallSkeeto, Grapple, DoubleJump OR SentryJump=1
      Combat=2xSmallSkeeto, DoubleJump, TripleJump, Combat=CorruptSlug OR SentryJump=1  # climb the wall bellow the checkpoint
      Launch
    kii:
      Grapple, Sword OR Hammer
      Combat=Crab+SmallSkeeto, Grapple, Dash
      Combat=Crab+SmallSkeeto, Grapple, Shuriken=2 OR Flash=2 OR Sentry=2
      Combat=Crab+SmallSkeeto+CorruptSlug, Grapple, Damage=20, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # kill the first corrupted slime so you can climb the wall in order to have the grappable plant in range
      Combat=Crab+SmallSkeeto, Grapple, Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      DoubleJump, Sword  # Use Sword to kill everything. Pogo on the last corrupted slime.
      Bash, Grenade=1 OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20  # bash glide a grenade where the crab is or dboost in the spikes or use energy weapon to avoid the dboost (possible with just Bash but require some specific enemies positions)
    unsafe:
      # Combat=Crab+SmallSkeeto, Grapple, Spear=2
      Combat=Crab+SmallSkeeto, Grapple, Spear=1, Blaze=1  # More energy efficient than 2 spears
      Bash
      DoubleJump, Hammer
      DoubleJump, Glide, Combat=CorruptSlug  # kill the first CorruptSlug then wall jump to the left wall. Climbing that wall is a bit precise. Can make it easier with a glide jump, which means killing the second CorruptSlug
      GrenadeJump, Grapple, Combat=Crab, Sword OR Hammer OR Glide OR Damage=20  # Grenade jump from
  conn PoolsApproach.OnTopOfWheel:
    moki, PoolsApproach.UnderwaterWallBroken, Water:
      Launch
      Grapple, Combat=SpinCrab OR DoubleJump OR Bash
      PoolsApproach.WheelFreed, Combat=SpinCrab OR DoubleJump OR Bash
    gorlek, PoolsApproach.UnderwaterWallBroken, Water: PoolsApproach.WheelFreed OR DoubleJump OR Grapple OR SentryJump=1
    kii, PoolsApproach.UnderwaterWallBroken:
      Water, Hammer OR Sword OR Sentry=1 OR Flash=1 OR Spear=1
      WaterDash, Damage=100, Launch OR Grapple OR DoubleJump OR Sword OR Hammer OR Sentry=1 OR Flash=1 OR Spear=1 OR PoolsApproach.WheelFreed
    unsafe, PoolsApproach.UnderwaterWallBroken:
      Water
      Damage=240  # Require more health than possible in kii. Possible by upgrading resilience and vitality.
      Bash, Damage=200
      WaterDash, Damage=100
  conn PoolsApproach.MarshBreakableWall:  # For dirty water paths. Paths using clean water originate from PoolsApproach.OnTopOfWheel
    kii, PoolsApproach.UnderwaterWallBroken:
      Launch, Damage=120:  # Take 6 dboost in dirty water
        Grapple OR Glide
        DoubleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Dash, Sword OR Hammer OR Blaze=4 OR Sentry=2
        Sword, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Hammer, Sentry=2
      Launch, Damage=140  # Take 6 dboosts in dirty water + one dboost in the spikes
      WaterDash, Damage=60:  # Take 3 dboost in dirty water
        Launch, Grapple OR Glide
        Launch, DoubleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Launch, Dash, Sword OR Hammer OR Blaze=4 OR Sentry=2
        Launch, Sword, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Launch, Hammer, Sentry=2
        Grapple, Glide
        Grapple, DoubleJump, Dash OR Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Dash, Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
        Grapple, Hammer, Sentry=2
      WaterDash, Damage=80:  # Take 3 dboost in dirty water + one dboost in the spikes
        Launch
        Grapple, DoubleJump OR Dash OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2 # with sword/flash, land in the dirty water before the breakable wall instead of the spikes
        DoubleJump, TripleJump OR Dash OR Hammer
        DoubleJump, Glide, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
        DoubleJump, Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      WaterDash, Damage=100:  # 3 dboost in dirty water + 2 dboost in spikes
        DoubleJump
        Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # jumping in the water can be easier than taking a second dboost in the spikes
        Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
        Sword, Glide OR Hammer OR Shuriken=1
        Hammer, Glide
      WaterDash, Damage=120, Grapple OR Dash OR Sword OR Hammer  # 3 dboost in dirty water + 3 dboost in spikes
      WaterDash, Damage=140, Glide  # 3 dboost in dirty water + 4 dboost in spikes
      WaterDash, Damage=180
    unsafe, PoolsApproach.UnderwaterWallBroken:
      Damage=120:
        Launch
        DoubleJump, Hammer, Grapple OR Glide
      Damage=140:
        DoubleJump, Hammer, Dash OR TripleJump
      WaterDash, Damage=60:
        Launch
        Grapple, Sentry=3  # Nedd to grapple the plant multiple time so you get a better angle
        Grapple, Sword, Spear=1 OR Blaze=1
      WaterDash, Damage=80, Grapple, Blaze=3
      WaterDash, Damage=100:
        Sword OR Blaze=1
        Hammer, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Damage=200, Grapple, DoubleJump

anchor PoolsApproach.MarshBreakableWall at -820, -4185:  # At the breakable wall on the way to MarshPastOpher
# This anchor helps with pathfinding for PoolsApproach.MillPathHC, especially in kii and above because of dirty swims, spikes dboosts and regen

  state PoolsApproach.UnderwaterWallBroken:  # Only for dirty swims, clean water one originate from OnTopOfWheel
    kii:
      Spear=1, Damage=20:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Bash, Grenade=1
      Spear=1, Damage=40:
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
        Launch
      Spear=1, Damage=80, DoubleJump OR Dash OR Hammer
      Spear=1, Damage=100, Sword
      Spear=1, Damage=120
      Bash, Damage=180:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Grenade=1
      Bash, Damage=200:
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
        Launch
    unsafe:
      Spear=1:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Bash, Grenade=1
      Spear=1, Damage=20:
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
        Launch
      Spear=1, Damage=40, DoubleJump OR Dash OR Hammer
      Spear=1, Damage=60, Sword
      Spear=1, Damage=80
      Bash, Damage=160:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Grenade=1
      Bash, Damage=180:
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
        Launch

  pickup PoolsApproach.MillPathHC:
    moki, Water:
      DoubleJump, Dash, WaterDash, Damage=20
      DoubleJump, Launch
    gorlek, Water:
      Bash, DoubleJump, TripleJump
      WaterDash, Damage=20, DoubleJump OR Dash OR Glide OR Sword OR Hammer  # Analog swimming can avoid the damage boost but its hard to do with keyboard swimming
      Bash, Damage=20, DoubleJump
      Launch
    kii:
      Bash, DoubleJump, Water OR Damage=180
      Bash, Water OR Damage=200
      WaterDash, Dash, Water OR Damage=60
      Water, WaterDash, Damage=20  # Analog swimming can avoid the damage boost but its hard to do with keyboard swimming
      WaterDash, Damage=80
      Damage=100, Launch
    unsafe:
      WaterDash, Water OR Damage=40
      Bash, Water OR Damage=100
      Water, DoubleJump, TripleJump OR Sticky
      Damage=80, Launch

  conn MarshPastOpher.PoolsPathWest:
    moki: BreakWall=20
  conn PoolsApproach.OnTopOfWheel:
    moki, Water:
      Grapple, Launch
      Launch, Glide, DoubleJump OR Dash
      Grapple, DoubleJump, Dash OR Glide
    gorlek, Water:
      Grapple, DoubleJump OR Dash
      Grapple, Damage=20, Glide OR Sword
      Damage=20, DoubleJump, TripleJump, Dash OR Glide OR Sword OR Hammer
      Launch, Damage=20
      Launch, DoubleJump, Dash OR Sword OR Hammer
      Launch, Dash, Sword OR Hammer
      Grapple, WaterDash, Hammer, Damage=20
    kii:
      Water OR Damage=180:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Bash, Grenade=1
      Water:
        DoubleJump, Damage=20, TripleJump OR Dash
        DoubleJump, Sword, Hammer, Damage=20
        Damage=60, DoubleJump OR Hammer
        Damage=60, Dash, PoolsApproach.WheelFreed
        Damage=80, Sword
        Damage=100, PoolsApproach.WheelFreed
      WaterDash, Damage=80:
        Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Bash, Grenade=1
      WaterDash, Damage=100:
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
        Launch
      WaterDash, Damage=140:
        DoubleJump OR Hammer
        Dash, PoolsApproach.WheelFreed
      WaterDash, Damage=160, Sword
      WaterDash, Damage=180, PoolsApproach.WheelFreed
      DoubleJump, Damage=200, TripleJump OR Dash
      DoubleJump, Sword, Hammer, Damage=200
    unsafe:
      Water, BreakWall=20, Bash, Grenade=1, Dash, DoubleJump OR Glide OR Sword OR Hammer OR Damage=20
      Water, DoubleJump, Damage=40
      Water, Launch
      Water, Damage=80, Sword
      Water, Damage=100
      WaterDash, Damage=140, Dash
      WaterDash, Damage=160, Sword
      WaterDash, Damage=180
  conn PoolsApproach.MillPath:  # dirty swims only. Clean water paths originate from OnTopOfWheel
    kii, PoolsApproach.UnderwaterWallBroken:
      Damage=60, WaterDash:
        Launch, Glide OR DoubleJump OR Dash OR Sword
        Launch, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
        Launch, Bash, Grenade=1
        Bash, Grapple, Dash OR Glide OR Sword OR Hammer  # Bash to deal with the ennemy at the end
        Grapple, DoubleJump
      Damage=80, WaterDash:
        Launch
        DoubleJump, TripleJump OR Dash
        DoubleJump, Sword, Hammer
      Damage=120, Bash, Launch:
        Grenade=1 OR Glide OR DoubleJump OR Dash OR Sword
        Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=130, Launch:  # same as above but take a dboost on the tentacle
        Glide OR DoubleJump OR Dash OR Sword
        Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=140, Bash, Launch
      Damage=160, Bash, Grapple, Dash OR Glide OR Sword OR Hammer
      Damage=120, WaterDash, Bash, DoubleJump OR Dash OR Hammer  # Bash to deal with the ennemy at the end
      Damage=130, WaterDash, DoubleJump
      Damage=140, WaterDash, Bash, Sword  # Bash to deal with the ennemy at the end
      Damage=180, WaterDash, Bash, Sword  # Bash to deal with the ennemy at the end

anchor PoolsApproach.OnTopOfWheel at -971, -4164:  # Highest point on the wheel
  refill Checkpoint:  # Need skills to get back to the anchor coordinates
    moki, Water:
      Launch OR Grapple OR PoolsApproach.WheelFreed
      DoubleJump, Dash
    gorlek, Water: DoubleJump OR SentryJump=1
    kii:
      Water, Hammer
      Damage=20, Launch OR Grapple OR DoubleJump OR Hammer OR SentryJump=1 OR PoolsApproach.WheelFreed
    unsafe: Water OR Damage=20

  state PoolsApproach.WheelFreed:
    moki: Water, Bash
    unsafe: Spear=1 OR Grenade=2
  state PoolsApproach.UnderwaterWallBroken:
    moki: Water, Bash
    kii:
      Spear=1, Water OR Damage=180
      Damage=80, WaterDash, Spear=1
      Damage=220, Bash
      Damage=160, WaterDash, Bash
    unsafe:
      Damage=180, Bash
      Damage=160, Spear=1
      Flap, Water OR Damage=220
      Flap, WaterDash, Damage=100
      GrenadeRedirect=1, Water OR Damage=180  # grenade redirect

  pickup PoolsApproach.AboveWheelEX:
    moki:
      Launch
      Bash, Grenade=1, DoubleJump, Dash  # solve when the wheel is spinning by using the path bellow
      PoolsApproach.WheelFreed, DoubleJump, Dash
    gorlek:
      DoubleJump, Hammer, Dash  # djump + upswing then dash to the wall
      DoubleJump, TripleJump OR SentryJump=1 OR PoolsApproach.WheelFreed
      Bash, Grenade=1, DoubleJump  # If the wheel is spinning, this is solved by just using double jump
      PoolsApproach.WheelFreed, DoubleJump
    kii:
      DoubleJump, Dash, Spear=1
      Bash, Grenade=1, Dash, Hammer  # if the wheel is spinning, it's solving with the path on the next line
      PoolsApproach.WheelFreed, Dash, Hammer
    unsafe:
      GlideJump, DoubleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      SwordJump OR HammerJump
      GrenadeJump, GrenadeCancel  # gjump to reach the platform then cancel second one to the pickup, cancel it and grenade float (which you also need to cancel so you can wjump)
      SentryJump=1
  pickup PoolsApproach.MarshPathCurrentEX:
    moki: Water, WaterDash
    kii: Damage=100, WaterDash
    unsafe: Damage=40, WaterDash
  pickup PoolsApproach.MillPathEC:
    moki, PoolsApproach.UnderwaterWallBroken: Water, Bash, Damage=10
    gorlek, PoolsApproach.UnderwaterWallBroken: Water, Bash OR Damage=10  # dboost on the tentacle
    kii, PoolsApproach.UnderwaterWallBroken:
      WaterDash, Water OR Damage=180
    unsafe:
      PoolsApproach.UnderwaterWallBroken, Water
      PoolsApproach.UnderwaterWallBroken, Bash, Damage=300
      PoolsApproach.UnderwaterWallBroken, WaterDash, Damage=120
  pickup PoolsApproach.MillPathHC:
    moki, Water:
      DoubleJump, Dash, WaterDash, Grapple
      DoubleJump, Grapple, Launch
    gorlek, Water:
      WaterDash, Grapple, Damage=20, DoubleJump OR Dash  # Analog swimming can avoid the damage boost but its hard to do with keyboard swimming
      Bash, DoubleJump, TripleJump, Damage=20 OR Grapple
      Bash, DoubleJump, TripleJump, Dash, Glide OR Sword
      Bash, DoubleJump, TripleJump, Glide, Sword
      Launch, DoubleJump OR Grapple OR Glide
      Launch, Dash, Sword OR Hammer OR Damage=20
      Launch, Damage=20, WaterDash OR Bash
    kii:  # Be carefull it's not redundant with going to MarshBreakableWall first
      Water, WaterDash:
        Damage=20, Grapple, Dash OR Sword OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # dboost in the muncher bellow the pickup. Possible to avoid the dboost but it's hard on keyboard swimming.
        Damage=40, Grapple
        Damage=60, Glide  # 2 dboost in spikes + 1 in munchers
        Damage=100
        Damage=80, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # same as above but avoid a dboost with one energy weapon
      Water, Bash:
        Grapple, DoubleJump
        Damage=20, Grapple, Dash OR Sword OR Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # dboost in the muncher bellow the pickup
        Damage=20, DoubleJump, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # dboost in the spikes
        Damage=40, Grapple
        Damage=60, Glide
        Damage=100
        Damage=80, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # same as above but avoid a dboost with one energy weapon
      Damage=220, WaterDash
    unsafe:
      Water, WaterDash, Damage=60, Shuriken=2 OR Sentry=3
      Water, DoubleJump, Bash, Grapple, Sword OR Hammer  # the air stalling to skip grapple is quite hard + need an upslash and a precise shot to get to the HC but you can't refill your upsash anywhere
      Water, DoubleJump, Bash, Damage=20, Sword OR Hammer  # the air stalling to skip grapple is quite hard + need an upslash and a precise shot to get to the HC but you can't refill your upsash anywhere
      Water, WaterDash, DoubleJump, Grapple  # the waterdash to get to the hc is really hard with keyboard swimming
      Water, DoubleJump, HammerJump, Damage=20, Dash OR TripleJump
      Water, DoubleJump, HammerJump, Grapple OR Glide
      Water, Bash, Damage=20, Hammer, Sword

  conn PoolsApproach.MarshBreakableWall:
    moki, Water:
      WaterDash, DoubleJump, Dash, Grapple
      Grapple, Launch
    gorlek, Water:
      WaterDash, DoubleJump, Grapple
      WaterDash, Grapple, Damage=20, Dash OR Glide  # damage not mandatory
      WaterDash, DoubleJump, Damage=20, TripleJump OR Dash OR Glide OR Sword
      Bash, Grapple, Damage=20, Dash, Sword
      Bash, Grapple, Damage=20, Glide
      Bash, Grapple, DoubleJump, TripleJump OR Dash OR Sword
      Bash, Grapple, DoubleJump, Hammer, Damage=20
      Bash, DoubleJump, Damage=20, TripleJump, Dash OR Glide OR Sword
      Bash, DoubleJump, Damage=20, Dash, Glide OR Sword
      Launch, DoubleJump OR Grapple OR Glide
      Launch, Dash, Sword OR Hammer OR Damage=20
      Launch, Damage=20, WaterDash OR Bash
    kii:  # OK look I'm sorry, I probably hate this connection as much as you do
      # Validator here : this is miserable, good luck if you have to change something here. You can copy many paths starting from MillPath if you already checked them and change the damage value (except for the Water, WaterDash paths).
      Water, Launch, Dash OR Sword OR Hammer OR Blaze=4 OR Sentry=2 OR Damage=20
      Water, WaterDash:
        Grapple, Dash OR Glide OR Sword OR Shuriken=2 OR Flash=2 OR Sentry=2
        Grapple, Hammer, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20
        Damage=20, Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # dboost in the spikes after grappling the plant then wdash+energy weapon to reach the wall
        Damage=20, Dash, Glide OR Sword OR Hammer OR Sentry=2
        Damage=20, DoubleJump, Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
        Damage=20, Hammer, Shuriken=3 OR Flash=3 OR Sentry=3  # It is possible to save one energy weapon by reseting upslash underwater
        Damage=40, Hammer, Glide OR Sword OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # It is possible to save one energy weapon by reseting upslash underwater
        Damage=40, Dash OR DoubleJump OR Sword
        Damage=40, Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # land in the water after 2 dboosts in spikes and use waterdash+energy weapon to reach the breakable wall
        Damage=60, Glide OR Hammer
        Damage=100  # 4 dboost ion the spikes bellow the grappable plant then land in the water and another dboost next to the breakable wall
        Damage=80, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # land in the water after 4 dboosts in spikes and use waterdash+energy weapon to reach the breakable wall
        Damage=60, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2  # same as above but avoid a dboost with one energy weapon
        Damage=40, Shuriken=3 OR Sentry=4  # same as above but avoid even more dboosts. With sentry: dboost->1 sentry->dboost->2 sentris->water->1 sentry
      Water, Bash:
        Grapple, Glide
        Grapple, DoubleJump, Dash OR Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Dash, Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
        Grapple, Hammer, Sentry=2
        Damage=20, Grapple, DoubleJump OR Dash OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2 # with sword/flash, land in the dirty water before the breakable wall instead of the spikes
        Damage=20, DoubleJump, TripleJump OR Dash OR Hammer
        Damage=20, DoubleJump, Glide, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
        Damage=20, DoubleJump, Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Damage=40, DoubleJump
        Damage=40, Grapple, Spear=2 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Second spear, as it is too hard with only one
        Damage=40, Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
        Damage=40, Sword, Glide OR Hammer OR Shuriken=1
        Damage=40, Hammer, Glide
        Damage=60, Grapple OR Dash OR Sword OR Hammer
        Damage=80, Glide
      Damage=80, WaterDash:  # 4 dboosts in dirty water
        Launch, Grapple OR Glide
        Launch, DoubleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Launch, Dash, Sword OR Hammer OR Blaze=4 OR Sentry=2
        Launch, Sword, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Launch, Hammer, Sentry=2
        Grapple, Glide
        Grapple, DoubleJump, Dash OR Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Dash, Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
        Grapple, Hammer, Sentry=2
      Damage=100, WaterDash:  # Take 4 dboost in dirty water + one dboost in the spikes
        Launch
        Grapple, DoubleJump OR Dash OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2 # with sword/flash, land in the dirty water before the breakable wall instead of the spikes
        DoubleJump, TripleJump OR Dash OR Hammer
        DoubleJump, Glide, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
        DoubleJump, Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=120, WaterDash:  # 4 dboost in dirty water + 2 dboost in spikes
        DoubleJump
        Grapple, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # jumping in the water can be easier than taking a second dboost in the spikes
        Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
        Sword, Glide OR Hammer OR Shuriken=1
        Hammer, Glide
      Damage=140, WaterDash, Grapple OR Dash OR Sword OR Hammer  # 4 dboost in dirty water + 3 dboost in spikes
      Damage=160, WaterDash, Glide  # 4 dboost in dirty water + 4 dboost in spikes
      Damage=200, WaterDash
      Damage=200, Bash:  # 10 dboost before the spikes, regen near the breakable wall then 8 dbosts in the water + 1 in the muncher. The muncher one is avoidable with some skills but since you are on a clock, it's better to acount for an extra dboost.
        Grapple, Glide
        Grapple, DoubleJump, Dash OR Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Dash, Sword OR Hammer OR Blaze=3 OR Sentry=2
        Grapple, Sword, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
        Grapple, Hammer, Sentry=2
      Damage=220, Bash:
        Grapple, DoubleJump OR Dash OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2 # with sword/flash, land in the dirty water before the breakable wall instead of the spikes
        DoubleJump, TripleJump OR Dash OR Hammer
        DoubleJump, Glide, Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
        DoubleJump, Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=160, Launch:
        Grapple OR Glide # 8 in dirty water
        DoubleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Dash, Sword OR Hammer OR Blaze=4 OR Sentry=2
        Sword, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
        Hammer, Sentry=2
      Damage=180, Launch  # same as above but take an additional dboost in the spieks to reach the breakable wall
    unsafe:
      Water, WaterDash, Damage=60, Spear=1, Blaze=1  # Same as above but more energy efficient. Use Blaze to avoid a dboost and Spear to reach the wall.
      Water, WaterDash, Grapple, Hammer
      Water, WaterDash, Hammer, Damage=20, Glide OR Sword OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, WaterDash, Sword, Glide, Damage=20
      Water, Bash, Grapple, DoubleJump
      Water, Bash, Grapple, Flash=2, Damage=20
      Water, Bash, Dash, Damage=40
      Water, Bash, Damage=100
      Water, Bash, Grapple, Sword, Spear=1 OR Blaze=1
      Water, Bash, Damage=40, Hammer, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, Launch  # reset launch with ceiling
      Water, DoubleJump, Damage=20, WaterDash OR Bash
      Water, Grapple, WaterDash, Sword OR Hammer  # Need an upslash but you can't refill it anywhere near
      Water, Grapple, Bash, Sword OR Hammer  # Need an upslash but you can't refill it anywhere near
      Water, DoubleJump, HammerJump, Damage=20, Dash OR TripleJump
      Water, DoubleJump, HammerJump, Grapple OR Glide
      Damage=60, WaterDash, Launch
      Damage=60, WaterDash, Spear=1 OR Blaze=1
      Damage=60, WaterDash, Hammer, Shuriken=1
      Damage=80, WaterDash, DoubleJump, Glide OR Sword OR Shuriken=2 OR Blaze=4 OR Flash=2 OR Sentry=2  # walljump of the wall bellow the spikes at the end
      Damage=100, WaterDash, Dash, Spear=1 OR Blaze=1
      Damage=100, WaterDash, Sword, Flash=1 OR Sentry=1
      Damage=160, Bash, Grapple, DoubleJump OR Sword
      Damage=180, Bash, Grapple, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Damage=160, Launch
  conn EastPools.LeverRoom:
    moki:
      Launch, Glide OR Water
      Bash, Grenade=1, Launch, DoubleJump OR Dash
      DoubleJump, Dash, Launch, Damage=20
      PoolsApproach.WheelFreed, DoubleJump, Glide
    gorlek:
      Glide, DoubleJump, Hammer, Dash  # djump + upswing then dash to the wall
      Glide, DoubleJump, TripleJump
      Glide, SentryJump=1, DoubleJump OR Dash OR Damage=20
      Launch, DoubleJump, Dash OR Sword  # refresh your double jump with launch, equivalently for all paths below
      Launch, Hammer, Damage=20, DoubleJump OR Dash
      Launch, Dash, Sword
      PoolsApproach.WheelFreed, Glide, Dash
      PoolsApproach.WheelFreed, Glide, Damage=20, Sword OR Hammer  # weapon not necessary, but you can use an upswing to make the jump off the wheel easier
      Water, WaterDash, DoubleJump, TripleJump OR Damage=20
      WaterDash, Damage=20, DoubleJump, TripleJump, Dash OR Sword OR Hammer  # touch the dirty water
      Launch, SentryJump=1, DoubleJump OR Dash  # use the weapons to float over the spikes at the end
      Launch, Damage=20, DoubleJump OR Dash OR Sword OR Hammer OR WaterDash  # touch the dirty water
    kii:
      Launch, Sword OR Blaze=9 OR Damage=20  # dboost in dirty water
      Launch, Bash, Grenade=1
      Launch, Dash, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Launch, DoubleJump, TripleJump OR Hammer OR Shuriken=1 OR Blaze=2 OR Sentry=2
      Launch, Hammer, Shuriken=1 OR Blaze=3 OR Sentry=2
      DoubleJump, Dash, Spear=1, Glide  # Spear to reach the wall to the right
      Bash, Grenade=1, Glide
      PoolsApproach.WheelFreed, Glide
      DoubleJump, TripleJump, Dash, Sword, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      DoubleJump, TripleJump, Dash, Hammer, Blaze=3 OR Sentry=2
      DoubleJump, TripleJump, Dash, Hammer, Damage=20, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Dash, Grenade=1 OR PoolsApproach.WheelFreed:
        DoubleJump OR Sword
        Hammer, Damage=20
      Bash, Grenade=1, DoubleJump, Dash, TripleJump OR Hammer OR Spear=1
      Water, WaterDash, Hammer, DoubleJump OR Damage=20
      Water, WaterDash, DoubleJump, Hammer  # water dash straight up, double jump, upslash
      WaterDash, Damage=60, DoubleJump OR Hammer # 2 dboost in dirty water
      WaterDash, DoubleJump, Damage=40, TripleJump OR Dash OR Sword
      WaterDash, Hammer, Dash, Damage=40  # 1 dboost in dirty water
      WaterDash, Hammer, Dash, DoubleJump, Damage=20  # 1 dboost in dirty water
    unsafe:
      Launch  # https://youtu.be/uWfkQOtjX5Y
      DoubleJump, Sword  # please don't put this in a supported difficulty thank you
      Water, WaterDash, DoubleJump, Dash, Hammer  # water dash straight up, double jump, upslash, dash
      WaterDash, Water OR Damage=20  # :3
      Water, DoubleJump, TripleJump, HammerJump
      Bash, Grenade=1, Dash, Grenade=1 OR PoolsApproach.WheelFreed:
        Spear=2 OR Blaze=3 OR Sentry=2
        Damage=20, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
  conn PoolsApproach.MillPath:
    moki, PoolsApproach.UnderwaterWallBroken:
      Water, Bash, Damage=10, Grapple, DoubleJump, Dash OR Glide
      Water, Bash, WaterDash
      Water, Bash, Damage=10, Launch
    gorlek, PoolsApproach.UnderwaterWallBroken:
      Water, Bash  # Bash the projectile and use it to bash the crab thing to reach the connection
      Water, Damage=10, Launch
      Water, WaterDash, Launch OR DoubleJump OR Combat=SpinCrab  # pass over the crab. No dboost because it can knock you back into the water
    kii, PoolsApproach.UnderwaterWallBroken:
      Damage=120, WaterDash, Launch OR DoubleJump OR Bash
      Water, Grapple, Damage=10, Combat=SpinCrab, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer
      Water, Grapple, Damage=10, Combat=SpinCrab, Dash
    unsafe, PoolsApproach.UnderwaterWallBroken:
      Damage=100, WaterDash
      Water, Grapple, Dash
  conn MarshSpawn.PoolsPath:
    moki: Water, WaterDash  # <3
    unsafe: WaterDash, Damage=180  # 'u'

region EastPools:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor EastPools.LeverRoom at -1160, -4152:  # At the amulet Moki
  refill Checkpoint
  refill Health=1

  state EastPools.EntryLever:
    moki:
      Bash, DoubleJump, Dash OR Glide
      Bash, Dash, Glide
      Launch
    gorlek:
      Combat=CorruptSlug, DoubleJump, TripleJump OR Sword OR Hammer OR Damage=20  # wait for another bubble when on the right upper wall
      Bash, DoubleJump, TripleJump OR Sword OR Hammer OR Damage=20
      DoubleJump, Damage=10, Sword OR Hammer  # tank the explosion damage from the slug
      Dash, Damage=20, Combat=CorruptSlug OR Bash
    kii:
      Combat=CorruptSlug OR Bash OR Damage=10:  # with damage: touch the slime to start the explosion countdown then fall and wait for the explosion
        Dash
        DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Sword
      Bash, Damage=20, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash  # Bash the skeeto, bash the slime twice. Could be kii but the slime explode when you bash it if you touched it too soon ater the bash on the moskito
      Sword  # https://youtu.be/i5HqEsRt5SI
      DoubleJump  #jump on the ledge above where the right slime is to avoid the combat requirement
      #SentryJump=1, DoubleJump  # wait for another bubble when on the right upper wall. Use weapon stall
  state EastPools.BelowEntryLeverBubble:
    moki: Hammer OR Spear=1
    unsafe: Sword, Flap  # You'll love this, I swear https://youtu.be/i5HqEsRt5SI
  state PoolsApproach.WheelFreed:
    moki: Water, Bash
    unsafe:
      Damage=60, Spear=1
      WaterDash, Damage=40, Spear=1

  quest EastPools.KwolokAmuletQI: free

  pickup EastPools.TwoCrushersEX:
    moki: Water, WaterDash
    kii: WaterDash, Damage=80
    unsafe:
      Water OR Damage=200
      WaterDash, Damage=20
  pickup EastPools.RightOre:
    moki:
      DoubleJump, Grapple, Flap, Combat=CorruptSlug, Dash OR Glide  # Need to flap from the green spot so the bubble don't go too far to the right
      Launch, Grapple
    gorlek:
      Launch  # Jump on the bubble before using launch
      DoubleJump, Grapple, Flap, Combat=CorruptSlug, TripleJump OR Sword OR Hammer OR Damage=20  # Need to flap from the green spot so the bubble don't go too far to the right
      DoubleJump, Grapple, Flap, Bash, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=20
    kii:
      DoubleJump, Grapple, Flap, TripleJump OR Damage=30  # avoid the slime or one dboost in the spikes + one the the slime
      DoubleJump, Grapple, Flap, Damage=10, Dash OR Glide OR Sword OR Hammer
      DoubleJump, Grapple, Flap, Combat=CorruptSlug, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Not adding the energy options to the bash/dboost variant because autoaim can screw you pretty hard because of the slime explosion
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=20  # can jump on the bubble but not mandatory
    unsafe:
      Grapple, Flap, Dash OR DoubleJump  # precise jump from the right wall to barely reach the left wall without taking damage. Then wait for the slime to be in a position where you can avoid it
      Bash, Grenade=1, DoubleJump  # jump on the bubble to reach your grenade
  pickup EastPools.BubbleCurrentEX:
    moki: Water, WaterDash
    kii: WaterDash, Damage=80
    unsafe: WaterDash, Damage=40
  pickup EastPools.BelowLeverEX:
    moki:  # kinda dangerous with the spikes? but damage seemed mostly avoidable
      DoubleJump, Bash, Grenade=1
      EastPools.BelowEntryLeverBubble, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      EastPools.BelowEntryLeverBubble
      Bash, DoubleJump, TripleJump
    kii:
      Bash  # Bait the skeeto, bash it when it's under the hole
      DoubleJump, TripleJump, Combat=CorruptSlug, Dash OR Glide
    unsafe:
      DoubleJump, TripleJump, Combat=CorruptSlug  # kill the slug on the left wall, tjump from this wall into the spikes under the pickup
      SentryJump=1, DoubleJump OR Damage=20  # The tree is swinging a bit. sjump from the left (Ori should almost fall) when the tree is swinging to the left
  pickup PoolsApproach.MarshPathCurrentEX:
    moki: Water, WaterDash
    kii: WaterDash, Damage=80
    unsafe:
      WaterDash, Damage=40
      Bash, Grenade=1, Water OR Damage=140  # https://youtu.be/JAhGlvPAFj8

  conn EastPools.BehindEntryDoor:
    moki: EastPools.EntryLever
  conn PoolsApproach.OnTopOfWheel:  # make sure it's possible with both states of the wheel
    moki:
      Water, PoolsApproach.WheelFreed OR DoubleJump OR Launch
      Water, Bash, Grenade=1  # if the wheel is rotating, this solve with the line above
      Bash, Grenade=2, Glide
      Bash, Grenade=1, Glide, DoubleJump
      Glide, Launch
      DoubleJump, Dash, Launch
      Bash, Grenade=1, Launch, DoubleJump OR Dash
    gorlek:
      Water, Hammer OR SentryJump=1
      DoubleJump, Damage=20, TripleJump OR Dash
      Bash, Grenade=1, Launch
      Bash, Grenade=1, Damage=20, DoubleJump
      Glide, DoubleJump, TripleJump OR Dash OR Damage=20
      WaterDash, Damage=20, DoubleJump, Sword OR Hammer
      Launch, DoubleJump, TripleJump OR Sword OR Hammer
      Launch, Dash, Sword OR Hammer
      SentryJump=1, Damage=20, Dash, DoubleJump
      SentryJump=1, Launch  # Use weapon to stall before and after the launch
    kii:
      Water, Spear=1
      WaterDash, Damage=100, PoolsApproach.WheelFreed OR DoubleJump OR Hammer OR Spear=1
      DoubleJump, Damage=20, Sword OR Shuriken=2 OR Blaze=5 OR Sentry=3
      Bash, Grenade=1, DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Shuriken=1 OR Blaze=3 OR Flash=1 OR Sentry=1 OR Spear=1
      Bash, Grenade=1, Damage=20, Dash, Hammer  # hammer for the static wheel, damage for the rotating wheel
      Glide, Dash, Hammer
      Glide, DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Launch, DoubleJump OR Dash OR Sword OR Hammer OR Spear=3 OR Blaze=3 OR Sentry=3  # climb the left wall
    unsafe:
      Water  # Precise wall jump where the tentacle is grabbing the wheel
      Damage=240  # Only require 60 damage if the wheel isn't spinning but has to also work when the wheel is spinning
      WaterDash, Damage=100  # Only requires 40 Damage if the wheel isn't spinning but has to also work when the wheel is spinning
      Launch  # climb the left wall then ceiling boost
  conn MarshSpawn.PoolsPath:
    moki: Water, WaterDash  # <3
    unsafe: WaterDash, Damage=160  # 'u'

anchor EastPools.BehindEntryDoor at -1239, -4162:  # behind the door opened by EastPools.EntryLever
  refill Checkpoint

  state EastPools.BelowEntryLeverBubble:
    moki, EastPools.EntryLever: Hammer OR Spear=1

  pickup EastPools.AboveDoorOre:
    moki:
      Launch
      Bash, Grenade=2
      Bash, Grenade=1, DoubleJump OR Grapple
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap, DoubleJump OR Dash
    gorlek:
      SentryJump=2, Damage=20  # damage if you sjump into the spikes
      SentryJump=1, DoubleJump OR Grapple
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap, Sword OR Hammer
    kii: EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap, Combat=Crab OR Bash OR Damage=10
    unsafe:
      Sword, Bash, Hammer OR Grapple OR Dash  # hammer upswing + sword upswing + sword pogo to get below slime. With dash, either dash ramp if the door is opened or wall jump off the door. Hit the slime off the ceiling with sword and then bash it (hammer kill the slime with both ancestral light in easy).
      DoubleJump, Bash  # Bash the slug when its at the right of the ceiling

  conn EastPools.TokkBubble:
    moki:
      Launch OR Water OR DoubleJump OR Dash OR Glide
      Bash, Grenade=1
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Bash OR Combat=Crab
    gorlek: Sword OR Hammer OR Damage=20
    kii: free
  conn EastPools.TPArea:
    moki:
      Launch
      Bash, Grenade=1, DoubleJump
      Bash, Grenade=1, Grapple, Dash OR Glide
      Bash, Grenade=2, Dash OR Glide
    gorlek:
      Bash, Grenade=1, Grapple, Sword OR Hammer OR Damage=20
      SentryJump=1, Grapple OR DoubleJump
      SentryJump=2, Damage=20  # weapon stall under the slug, damage is if you sjump into the spikes
      Bash, Grenade=2, Sword OR Hammer OR Damage=20
      Bash, Grenade=3  # bash grenade from under AboveDoorOre and bash the slime to reach the left ledge
      Bash, DoubleJump, TripleJump, Dash OR Sword OR Glide  # Possible with just bash/tjump but there is a small colider at the left that make it hard when the slug is right next to it
    kii:
      Bash, Grenade=1, Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, DoubleJump, TripleJump, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Possible with just bash/tjump but there is a small colider at the left that make it hard when the slug is right next to it
      DoubleJump, TripleJump, Sword  # tjump, hit the slime then tjump+upslash
    #unsafe:  # Unsafe can just do puzzle skip in order to reach that anchor from the TP
    #  Grapple, Spear=1 OR Blaze=1
    #  Dash  # either dash ramp if the door is opened or wall jump off the door
  conn EastPools.LeverRoom:
    moki, EastPools.EntryLever: Combat=Crab OR Bash OR Launch OR EastPools.BelowEntryLeverBubble
    gorlek, EastPools.EntryLever: Water, Damage=10  # dboost on the crab then wait for the bubble in the water
    unsafe: EastPools.EntryLever

#anchor EastPools.BelowTokk at -1278, -4158:  # at the checkpoint where you do puzzle skip, between Tokk and the slime
#
#  Anchor is now obsolete because of EastPools.TokkBubble. Keeping it commentated in case we want to add it back one day
#
#  refill Checkpoint
#
#  state EastPools.BelowTokkBubbleFree:  # Be sure it's not redundant with going to EastPools.BehindEntryDoor first
#    moki: Water, Bash OR WaterDash
#    unsafe: EastPools.BelowTokkPurpleWall, Bow=1 OR Grenade=1
#  state EastPools.BelowTokkPurpleWall:  # Be sure it's not redundant with going to EastPools.BehindEntryDoor first
#    moki: Water, Bash
#    kii:
#      Water OR Damage=160
#      WaterDash, Damage=120
#    unsafe:
#      Combat=Crab, Damage=125  # dboost on the slug's projectile before dropping into the water
#      Damage=130  # dboost on the crab before dropping in the water
#  state EastPools.LowerWaterDrained:  # Puzzle skip
#    unsafe: free  # Take the checkpoint bellow and die in the right water pound. If you have clean water, you can bait a torpedo instead https://cdn.discordapp.com/attachments/942484861569105990/1045401688229560381/2022-11-24_19-10-22.mp4
#
#  pickup EastPools.AboveDoorOre:  # Make sure it's not redundant with paths comming from EastPools.BehindEntryDoor
#    gorlek:
#      Bash, Grenade=1, Damage=20
#      SentryJump=1, Damage=20
#
#  conn EastPools.BehindEntryDoor:
#    moki:
#      Launch OR Grapple  # with grapple, go below
#      Bash, Grenade=1  # either go below or bash the slime after bashing your grenade if going above
#      DoubleJump, Dash OR Glide
#    gorlek: DoubleJump OR SentryJump=1 OR Damage=20  # sjump from below. Use your weapon to kill the crab
#    kii:
#      Bash  # Go below
#      Combat=CorruptSlug, Hammer  # if you hit the slug it gets weird because you can hit it again which makes it explodes so it's better to kill it before going over the spikes
#  conn EastPools.TPArea:
#    moki:
#      Launch
#      Bash, Grenade=1
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Combat=Crab, Grapple, Flap, DoubleJump OR Dash OR Glide
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Bash, Grapple, Flap, DoubleJump OR Dash OR Glide
#    gorlek:
#      SentryJump=1
#      Bash, DoubleJump, TripleJump, Dash OR Sword OR Glide  # Possible with just bash/tjump but there is a small colider at the left that make it hard when the slug is right next to it
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Flap, Combat=Crab, Grapple, Sword OR Hammer OR Damage=20
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Flap, Bash, Grapple, Sword OR Hammer OR Damage=20
#    kii:
#      Bash, DoubleJump, TripleJump, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Possible with just bash/tjump but there is a small colider at the left that make it hard when the slug is right next to it
#      DoubleJump, TripleJump, Sword  # tjump, hit the slime then tjump+upslash
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Flap, Combat=Crab, Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
#      EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Flap, Bash, Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
#    #unsafe:  # Unsafe can just do puzzle skip in order to reach that anchor from the TP
#    #  EastPools.BelowTokkBubbleFree, EastPools.BelowTokkPurpleWall, Grapple, Bash OR Combat=Crab:  # Push the bubble by jumping on it rather than using flap
#    #    DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
#    #  Bash, DoubleJump  # Bash the slug to the left of the spike, bash it again to reach tokk
#    #  DoubleJump, TripleJump, Damage=20  # tjump in the spikes under Tokk to reset your tjump. Make sure to use your tjump before eating the spikes
#  conn EastPools.Teleporter:
#    unsafe: EastPools.LowerWaterDrained  # Do puzzle skip then reload or die to respawn on the teleporter. This doesn't soflock: even if you already drained the water you can die redo the same manipulation to activate the checkpoint (you won't have the cutscene) then QTM/die to respawn on the teleporter

anchor EastPools.TokkBubble at -1276, -4175:  # Left of the bubble spawner used to reach Tokk in a casual playthrough
  refill Checkpoint

  state EastPools.TokkBubbleFree:
    moki:
      Water, Bash
      Water, WaterDash, EastPools.TokkBubblePurpleWall OR Combat=Crab
    kii:
      Bash, Damage=120
      Combat=Crab, WaterDash, Damage=80
      EastPools.TokkBubblePurpleWall, WaterDash, Damage=60
    unsafe:
      Bash, Damage=65  # dboost on the slug's projectile
      Combat=Crab, WaterDash, Damage=60
      EastPools.TokkBubblePurpleWall, WaterDash, Damage=40
      EastPools.TokkBubblePurpleWall, Bow=1 OR Grenade=1
  state EastPools.TokkBubblePurpleWall:
    moki: Water, Bash
    kii:
      Combat=Crab, Water OR Damage=160  # bait the torpedo into touching the wall
      Combat=Crab, WaterDash, Damage=120
      Bash, Damage=140  # snipe the wall so you can leave earlier
      WaterDash, Bash, Damage=100  # snipe the wall so you can waterdash earlier
    unsafe:
      Bash  # bash the corrupted slime to blow the wall
      Combat=Crab, Damage=125  # dboost on the slug's projectile before dropping into the water
      Damage=130  # dboost on the crab before dropping in the water
  state EastPools.LowerWaterDrained:  # Puzzle skip
    unsafe: free  # Die in the right water pound. If you have clean water, you can bait a torpedo instead https://youtu.be/rnRBUmY2NN4

  pickup EastPools.AboveDoorOre:  # Paths using the bubble spawner or that aren't redundant with going to either BehindEntryDoor or TPArea first
    moki: EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap, DoubleJump OR Dash
    gorlek:
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap, Sword OR Hammer
      Bash, Grenade=2, Damage=20
    kii: EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Grapple, Flap

  conn EastPools.TPArea:
    moki:
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Combat=Crab, Grapple, DoubleJump OR Dash OR Glide
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Bash, Grapple, DoubleJump OR Dash OR Glide
    gorlek:
      Bash, Grenade=2
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Combat=Crab, Grapple, Sword OR Hammer OR Damage=20
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Bash, Grapple, Sword OR Hammer OR Damage=20
    kii:
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Combat=Crab, Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      EastPools.TokkBubbleFree, EastPools.TokkBubblePurpleWall, Flap, Bash, Grapple, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    # unsafe can just do puzzle skip for free
  conn EastPools.BehindEntryDoor:
    moki:
      Launch
      Grapple, DoubleJump OR Dash OR Glide OR Bash OR Combat=CorruptSlug+Crab # Possible with just grapple but added some airstall because the plant can be a bit hard to see from that anchor
      Bash, Grenade=1 OR DoubleJump  # either bash your grenade or bash the crab+ djump
    gorlek:
      Grapple OR SentryJump=1
      DoubleJump, Combat=CorruptSlug+Crab, TripleJump OR Dash OR Sword OR Hammer  # Climb the right wall
    kii:
      Bash
      DoubleJump, Sword OR TripleJump OR Combat=CorruptSlug+Crab  # Pogo the crab or tjump on the wall on the left of the grapple plant or just kill everything and climb the right wall
    # unsafe paths can do puzzle skip and reach BehindEntryDoor from TpArea
  conn EastPools.Teleporter:
    unsafe: EastPools.LowerWaterDrained  # Do puzzle skip then reload or die to respawn on the teleporter. This doesn't soflock: even if you already drained the water you can die redo the same manipulation to activate the checkpoint (you won't have the cutscene) then QTM/die to respawn on the teleporter

anchor EastPools.TPArea at -1297, -4143:  # Where Tokk stands
  refill Checkpoint
  refill Full:  # use the teleporter
    moki: EastPools.LowerWaterDrained

  state EastPools.LowerWaterDrained:
    moki: Water, WaterBreath
    gorlek: Water
    kii: WaterDash, Damage=120
    unsafe:  # Puzzle Skip. Dirty water swim is redundant with doing puzzle skip which need way less health
      Glide OR Sword OR Bash OR Shuriken=1 OR Sentry=2  # Even if you want to die to do this, it's important to have non-damage paths because 20 damages does 40 in hard, which can kill you if you only have 30 HP
      Blaze=1, Damage=10  # hit the slime with blaze and get hit by the explosion to make it across
      Spear=1, Blaze=2 OR Flash=1  # hitting the slime while hovering can make it explode so kill with Spear beforehand
      Grenade=1, Blaze=2 OR Flash=1  # hitting the slime while hovering can make it explode so kill with Grenade beforehand

  pickup EastPools.AboveDoorOre:  # Make sure it's not redundant with paths from EastPools.BehindEntryDoor and EastPools.BelowTokk
    moki: Bash, Grenade=1, Dash OR Glide
    gorlek:
      Bash, Grenade=1, Damage=20
      Bash, Grenade=2, Sword OR Hammer  # Weapon stall above the spikes after killing the slug
      SentryJump=1, Spear=1 OR Grenade=1 OR Damage=20  # Weapon stall above the spikes after killing the slug or just dboost in the spikes
    unsafe: Sword, Bash  # Hit slug with sword to make it fall off the ceiling and then bash it

  # this Tokk disappears after Kwolok's death
  conn EastPools.Teleporter:
    moki: EastPools.LowerWaterDrained
  conn EastPools.FishingPool:
    moki:
      Grapple, DoubleJump OR Dash
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      Grapple, Glide OR Sword OR Hammer
      SentryJump=1, DoubleJump
      Bash, Grenade=1, Dash OR Sword OR Hammer
      DoubleJump, TripleJump, Dash  # climb the left wall, dash then tjump to reach the wall above the grapple plant
    kii:
      Bash, Grenade=1
      Grapple, Shuriken=1 OR Sentry=2
      DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 # climb the left wall, tjump to get under the wall above the grapple plant and energy weapon to get the extra mobility needed
      DoubleJump, Dash, Hammer
    unsafe:
      Grapple, Damage=40
      DoubleJump, TripleJump
      SentryJump=1
  conn EastPools.WaterdashArena:
    moki, EastPools.ArenaWall: Water
    kii, EastPools.ArenaWall:  # Requires an header which remove the wall blocking the arena but doesn't drain the water
      Damage=60
      WaterDash, Damage=40
  conn EastPools.NextToLupoOre:
    moki: Water
    kii:
      Damage=140
      WaterDash, Damage=60
  conn EastPools.BehindEntryDoor:  # Make sure it's not redundant with going to TokkBubble first
    moki:
      DoubleJump OR Dash OR Glide
      Bash, Grenade=1  # Land on the groung bellow the slime, bash grenade then bash the slime
    gorlek:
      Damage=20
      Spear=1, Sword OR Hammer  # hitting the slime while hovering can make it explode so kill with Spear beforehand
      Grenade=1, Sword OR Hammer  # hitting the slime while hovering can make it explode so kill with Grenade beforehand
    kii:
      Spear=1, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # hitting the slime while hovering can make it explode so kill with Spear beforehand
      Grenade=1, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # hitting the slime while hovering can make it explode so kill with Grenade beforehand
      Combat=CorruptSlug, Hammer  # Land on the groung bellow the slime. If you hit the slug it gets weird because you can hit it again which makes it explodes so it's better to kill it before going over the spikes
  conn EastPools.TokkBubble:
    moki: Launch OR DoubleJump OR Dash OR Glide
    gorlek: free

anchor EastPools.Teleporter at -1316, -4153:  # At the teleporter after draining the water
  refill Full

  state EastPools.LowerWaterDrained: free  # the randomizer drains the water if you aquire the teleporter, and for non-teleporter connections this anchor is strictly locked behind already having the state
  state NonGladesTeleporter: free
  state EastPools.ArenaWall:
    moki, EastPools.LowerWaterDrained: Water, Bash
    kii, EastPools.LowerWaterDrained: Water, Damage=20
    unsafe, EastPools.LowerWaterDrained:
      Water, Launch OR Dash
      Bash, Damage=300

  pickup EastPools.UltraBashShard:
    moki, EastPools.LowerWaterDrained: Water, WaterBreath, Bash
    gorlek, EastPools.LowerWaterDrained: Water, Bash
    kii, EastPools.LowerWaterDrained:
      Water  # move a bit on the side when the torpedo is getting close to the wall
      WaterDash, Damage=180
      WaterDash, Bash, Damage=140  # snipe the wall so you can start swimming earlier
    unsafe, EastPools.LowerWaterDrained:
      Damage=240
      Bash, Damage=220

  conn Teleporters:
    moki: EastPools.LowerWaterDrained
  conn EastPools.TPArea:
    moki: EastPools.LowerWaterDrained OR Water
  conn EastPools.WaterdashArena:
    moki, EastPools.ArenaWall, EastPools.LowerWaterDrained: DoubleJump OR Dash OR Glide OR Launch
    gorlek, EastPools.ArenaWall, EastPools.LowerWaterDrained: Sword OR Damage=20
    kii, EastPools.ArenaWall, EastPools.LowerWaterDrained: Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe, EastPools.ArenaWall: EastPools.LowerWaterDrained  # jump on the bubble to avoid a dboost in dirty water
  conn EastPools.NextToLupoOre:
    kii, EastPools.LowerWaterDrained:
      Damage=100
      WaterDash, Damage=40
    unsafe, EastPools.LowerWaterDrained:
      Damage=80

anchor EastPools.FishingPool at -1278, -4124:  # At the fisher moki
  quest EastPools.HandToHandSpyglass:
    moki: LowerDepths.HandToHandSilk

  conn EastPools.AboveFishingPool:
    moki:
      Water, WaterDash, DoubleJump, Dash, Combat=CorruptSlug OR Bash
      Water, WaterDash, DoubleJump, Glide, Combat=CorruptSlug OR Bash
      Bash, Grenade=1, DoubleJump
      Launch
    gorlek:
      WaterDash, DoubleJump, Water OR Damage=20
      WaterDash, Dash, Sword, Water OR Damage=20  # upslash makes it easier to reach the wall above the water
      Bash, Grenade=1, Dash
      SentryJump=1, DoubleJump OR Dash
    kii:
      Bash, Grenade=1, Sword OR Hammer
      Bash, Grenade=1, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      WaterDash, Water, Sword
      WaterDash, Water, Hammer, Glide OR Shuriken=2  # Would be possible with 2 sentries/flash but this makes the slime explodes which knock you back down
      WaterDash, Water, Glide, Shuriken=2  # Would be possible with 2 sentries/flash but this makes the slime explodes which knock you back down
    unsafe:
      Bash, Grenade=1
      WaterDash, Hammer, Water OR Damage=20
      DoubleJump, TripleJump  # ceiling jump on the wall above the fishing pond
      SentryJump=1
  conn EastPools.TPArea: free

anchor EastPools.AboveFishingPool at -1300, -4102:  # Above the fishing Moki
  pickup EastPools.AboveTpEX:  # this needs water to not softlock when the player drains the upper water
    moki: Water
    kii:  # dirty swim
      Damage=80
      WaterDash, Damage=40
  pickup EastPools.PurpleWallHC:  # paths using the slime to break the purple wall
    unsafe:
      Bash, Launch OR SentryJump=1 OR Grenade=1
      Bash, DoubleJump, TripleJump, Damage=20, Sword OR Hammer  # dboost to climb the left wall

  conn EastPools.FishingPool: free
  conn UpperPools.DrainPuzzleExit:
    moki, UpperPools.UpperWaterDrained:
      Launch
      Bash, Grenade=1, DoubleJump
    gorlek, UpperPools.UpperWaterDrained:
      Bash, Grenade=2
      SentryJump=1, DoubleJump
    kii, UpperPools.UpperWaterDrained:
      Water, WaterDash, DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Damage=20, WaterDash, DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump  # Bash the slime
      Bash, Grenade=1, WaterDash, Water OR Damage=20
    unsafe, UpperPools.UpperWaterDrained:
      DoubleJump, TripleJump, Damage=20  # climb the left wall

anchor EastPools.NextToLupoOre at -1373, -4166:  # Checkpoint between Lupo and the ore
  refill Checkpoint

  pickup EastPools.LupoOre: free
  pickup EastPools.UltraBashShard:
    moki, EastPools.LowerWaterDrained: Water, WaterBreath, Bash
    gorlek, EastPools.LowerWaterDrained: Water, Bash
    kii, EastPools.LowerWaterDrained:
      Water  # move a bit on the side when the torpedo is getting close to the wall
      WaterDash, Bash, Damage=140  # snipe the wall so you can start swimming earlier
    unsafe, EastPools.LowerWaterDrained:
      Damage=240
      WaterDash, Damage=180
      Bash, Damage=220

  conn EastPools.LupoArea:
    gorlek: ShurikenBreak=20
  conn EastPools.Teleporter:
    moki, EastPools.LowerWaterDrained: Water
    kii, EastPools.LowerWaterDrained:
      Damage=100
      WaterDash, Damage=40
    unsafe, EastPools.LowerWaterDrained:
      Damage=60, DoubleJump OR Dash OR Launch OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      EastPools.ArenaWall, Bash, Grenade=1, Damage=60
  conn EastPools.TPArea:
    moki: Water
    kii:
      Damage=160
      WaterDash, Damage=60
    unsafe: Damage=120, Launch OR Grapple OR Glide OR DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
  conn EastPools.WaterdashArena:
    kii, EastPools.ArenaWall:
      Damage=120
      WaterDash, Damage=60
      EastPools.LowerWaterDrained:
        Damage=100
        WaterDash, Damage=40
    unsafe, EastPools.ArenaWall:
      Damage=100
      WaterDash, Damage=40
      EastPools.LowerWaterDrained, Damage=80

anchor EastPools.LupoArea at -1409, -4163:  # Checkpoint to the left of Lupo
  refill Checkpoint

  state EastPools.LupoPurpleFloor:
    unsafe, EastPools.LowerWaterDrained: Water, Bash, Dash

  pickup EastPools.LupoEX:
    moki:
      Launch OR DoubleJump
      EastPools.LupoPurpleFloor, Water, WaterDash
    gorlek:
      Hammer OR SentryJump=1
      EastPools.LupoPurpleFloor, WaterDash, Damage=20
    kii: free
  pickup EastPools.LupoMap:
    moki: SpiritLight=150
  pickup EastPools.BehindCrusherEX:
    kii, EastPools.LupoPurpleFloor:
      Damage=160
      WaterDash, Damage=80
    unsafe, EastPools.LupoPurpleFloor:
      Damage=80
      WaterDash, Damage=40

  conn EastPools.NextToLupoOre:
    moki: BreakWall=20
  conn EastPools.MissilePuzzle:
    moki, EastPools.LupoPurpleFloor: Water
    kii, EastPools.LupoPurpleFloor: WaterDash, Damage=80
    unsafe, EastPools.LupoPurpleFloor: Damage=180
  conn EastPools.CentralRoom:
    kii, EastPools.LupoPurpleFloor, EastPools.CentralRoomPurpleWall: WaterDash, Damage=100
    unsafe, EastPools.LupoPurpleFloor, EastPools.CentralRoomPurpleWall:
      Damage=240
      WaterDash, Damage=80

anchor EastPools.WaterdashArena at -1348, -4139:  # Checkpoint at the right of the pools arena
  refill Checkpoint

  # There are two Arenas here: you get one if you enter without WaterDash and another if you enter with it.
  # This path is assuming the worse case of getting the strictly harder WaterDash arena, but doesn't list WaterDash explicitly because you don't need it unless you have it.
  # And any other way would lock basically all of Pools behind WaterDash. So it makes sense, right?
  state EastPools.FightArenas:
    moki: Regenerate, Damage=20, Water, WaterBreath, Combat=4xCrab+Tentacle+2xSkeeto, Bash
    gorlek: Regenerate, Damage=20, Water, Combat=4xCrab+Tentacle+2xSkeeto, Bash
    unsafe: Water, Combat=4xCrab+Tentacle+2xSkeeto, Launch OR Dash OR Damage=20  # Land on the left then jump under the purple wall to correct the torpedo angle. launch in order to avoid the blast damage

  pickup EastPools.FightRoomHC:  # The HC only gets unlocked if you finish the alternate WaterDash arena; FightArenas doesn't have WaterDash as requirement included for reasons explained above, so it's needed here
    moki, EastPools.FightArenas, WaterDash:
      DoubleJump, Dash OR Grapple
      Bash, Grenade=1
      Launch
    gorlek, EastPools.FightArenas, WaterDash:
      Water OR Damage=20  # WaterDash on the bubble
      DoubleJump, TripleJump
    kii, EastPools.FightArenas, WaterDash: DoubleJump
    unsafe, EastPools.FightArenas, WaterDash:
      Hammer  #Jump on the bubble then stall until a new one spawn
      Dash OR Glide OR Sword # jump on the bubble, wait on the left wall by wall jumping then go back to jump on a new bubble

  conn EastPools.TPArea:
    moki, EastPools.ArenaWall: Water
    kii, EastPools.ArenaWall:
      Damage=80
      WaterDash, Damage=40
  conn EastPools.Teleporter:
    moki, EastPools.ArenaWall, EastPools.LowerWaterDrained: DoubleJump OR Dash OR Launch OR Glide
    gorlek, EastPools.ArenaWall, EastPools.LowerWaterDrained: Sword OR Hammer OR Damage=20
    kii, EastPools.ArenaWall, EastPools.LowerWaterDrained:
      Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1
  conn EastPools.NextToLupoOre:
    kii, EastPools.ArenaWall:
      Damage=120
      WaterDash, Damage=60
      EastPools.LowerWaterDrained:
        Damage=100
        WaterDash, Damage=40
    unsafe, EastPools.ArenaWall:
      Damage=100
      WaterDash, Damage=40
      EastPools.LowerWaterDrained, Damage=80
  conn EastPools.MissilePuzzle:
    moki, EastPools.FightArenas: Water OR DoubleJump OR Dash OR Glide OR Launch
    gorlek, EastPools.FightArenas: Sword OR Hammer OR Damage=20
    kii: EastPools.FightArenas
    unsafe:
      Water  # Water to avoid the fighting room altogether. Can QTM if the door is here.
      Damage=40  # Drop in the water just before the arena trigger
      WaterDash, Damage=20
      Launch, DoubleJump OR Dash OR Glide  # Under the platform, and avoid touching the water

anchor EastPools.MissilePuzzle at -1425, -4144:  # Below where the trial starts
  refill Checkpoint

  state EastPools.CentralRoomPurpleWall:
    moki: Water, WaterBreath, Bash
    gorlek: Water, Bash
    kii: Water
    unsafe:
      Damage=200, Bash
      Damage=140, Bash, WaterDash
  state EastPools.LupoPurpleFloor:
    moki: Water, WaterBreath, Bash
    gorlek: Water, Bash
    kii: Water
    unsafe:
      Damage=300, Bash
      Damage=200, Bash, WaterDash

  pickup EastPools.EnergyHarvestShard:
    moki:
      Water, WaterDash, DoubleJump
      Bash, Grenade=1
      Launch
    gorlek:
      Damage=20, WaterDash, DoubleJump
      Water, Bash, DoubleJump OR WaterDash  # Use the torpedo
      SentryJump=1
    kii:
      WaterDash, Hammer, Water OR Damage=20
      WaterDash, Spear=1, Water OR Damage=20
      DoubleJump, TripleJump, Hammer  # tjump + upslash from the left wall
    unsafe:
      WaterDash, Sword, Water OR Damage=20
      DoubleJump, TripleJump, Sword  # tjump + upslash from the left wall
      Bash, Water OR Damage=220  # Bash the torpedo out of the water (near the floor so you don't get too much speed), go out of the water and bash it again
  pickup EastPools.BehindCrusherEX:
    moki: Water, WaterBreath
    gorlek: Water
    kii:
      EastPools.LupoPurpleFloor, Damage=200  # Go back to safety at lupo instead of the the original anchor
      EastPools.LupoPurpleFloor, WaterDash, Damage=120  # Go back to safety at lupo instead of the the original anchor
      WaterDash, Damage=140
    unsafe:
      Damage=220
      WaterDash, Damage=100
  pickup EastPools.SpiritTrial:
    moki: UpperPools.TrialActivation, EastPools.CentralRoomPurpleWall, Water, DoubleJump, Dash, Glide, Grapple, WaterDash
    kii, UpperPools.TrialActivation, EastPools.CentralRoomPurpleWall:
      Water, Grapple, WaterDash, DoubleJump
      Water, Grapple, WaterDash, Glide, Dash, Bash OR Launch OR Hammer OR Spear=1  # The last condition is for reaching the start, the weapon/ability is not used during the trial
    unsafe, UpperPools.TrialActivation, EastPools.CentralRoomPurpleWall:
      Water, Grapple, WaterDash, Glide, Bash OR Launch OR Sword OR Hammer OR Spear=1  # The last condition is for reaching the start, the weapon is not used during the trial
      Water, Grapple, WaterDash, Dash, Bash OR Launch OR Sword OR Hammer OR Spear=1  # The last condition is for reaching the start, the weapon is not used during the trial

  conn EastPools.CentralRoom:
    moki, EastPools.CentralRoomPurpleWall: Water
    kii, EastPools.CentralRoomPurpleWall:
      Damage=180
      WaterDash, Damage=80
    unsafe, EastPools.CentralRoomPurpleWall:
      Damage=160
      WaterDash, Damage=60
  conn EastPools.WaterdashArena:
    moki: EastPools.FightArenas, Water OR DoubleJump OR Dash OR Glide OR Launch
    gorlek: EastPools.FightArenas
    unsafe:  # die to open the door if it's closed
      Water OR Damage=60
      WaterDash, Damage=20
  conn EastPools.LupoArea:
    moki, EastPools.LupoPurpleFloor: Water
    kii, EastPools.LupoPurpleFloor:
      Damage=100
      Damage=40, WaterDash
    unsafe, EastPools.LupoPurpleFloor: Damage=80

anchor EastPools.CentralRoom at -1485, -4148:  # The room where you meet Kwolok when he's still fine
  refill Checkpoint

  state EastPools.CentralRoomPurpleWall:  # @Validator Could had moki/gorlek paths if knowing that a tentacle projectile can break the wall isn't too heavy of the knowledge side
    kii: Water OR Damage=100  # no waterdash path because the tentacle is not shooting a projectile if you water dash into it
    unsafe: WaterDash, Damage=60
  state EastPools.CentralRoomBubbleFree:
    moki: Water, Bash OR WaterDash
    kii:
      Damage=120, Bash
      Damage=80, WaterDash
    unsafe:
      Bash, Damage=100
      WaterDash, Damage=60
      Water, Deflector, Sword
      Water, Bow=1
      Water, Grenade=1, Fracture

  quest EastPools.GrassSeed:
    moki:
      Water, WaterDash
      EastPools.CentralRoomBubbleFree, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      WaterDash, Damage=20
      Water, Bash  # Use the tentacle's projectile
      Bash, Grenade=1, Sword OR Hammer
      Bash, DoubleJump, Glide OR Sword
      Bash, Dash, Glide OR Sword
      DoubleJump, TripleJump, Glide
    kii:
      EastPools.CentralRoomBubbleFree, Water OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20  # possible with blaze but the aoe breaking the bubble is annoying
      Damage=100, Bash  # Use the tentacle's projectile
      Bash, Grenade=1, EastPools.CentralRoomBubbleFree OR Shuriken=1 OR Blaze=3 OR Flash=1 OR Sentry=1  # possible with as little as 1 blaze but might be too precise for kii?
      Bash, DoubleJump OR Glide  # Bashglide from the lantern
      Bash, Dash, Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, Sword, Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Hammer, Sentry=3  # bashglide from the lantern then one hammer swing and 3 sentries
      DoubleJump, Glide, Dash OR Sword OR Hammer OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Spear=1
    unsafe:
      EastPools.CentralRoomBubbleFree
      Bash, Grenade=1, Spear=1 OR Blaze=1
      Bash, Sword  # hover to reach the lantern, extend bash glide with upslash then hover again
      DoubleJump, Glide
      SentryJump=1

  conn UpperPools.KeystoneRoomEntrance:
    moki:
      EastPools.CentralRoomBubbleFree, Bash, DoubleJump, Dash OR Glide
      EastPools.CentralRoomBubbleFree, Bash, Launch
    gorlek:
      EastPools.CentralRoomBubbleFree, DoubleJump, TripleJump, Dash, Glide
      EastPools.CentralRoomBubbleFree, DoubleJump, TripleJump, Bash
      EastPools.CentralRoomBubbleFree, Bash, Grenade=1, DoubleJump
      EastPools.CentralRoomBubbleFree, SentryJump=1, DoubleJump, TripleJump OR Dash OR Glide  # sjump from EastPools.GrassSeed
      Launch, DoubleJump OR Dash OR Glide OR EastPools.CentralRoomBubbleFree
    kii:
      Launch
      EastPools.CentralRoomBubbleFree, DoubleJump, TripleJump  # from the seed, jump on a bubble to reach the wall near the lantern and wait for another bubble from there
      EastPools.CentralRoomBubbleFree, Bash, DoubleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # with sword/hammer, hover before jumping to avoid touching the bubble
      EastPools.CentralRoomBubbleFree, Bash, Grenade=1, Grenade=1 OR Water OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20  # bashnade from the seed to jump on the bubble then wait another bubble
    unsafe:
      EastPools.CentralRoomBubbleFree, Bash, DoubleJump, Blaze=1
      EastPools.CentralRoomBubbleFree, Bash, Grenade=1  # bashnade from the seed to jump on the bubble then wait another bubble
      EastPools.CentralRoomBubbleFree, SentryJump=1  # sjump from GrassSeed
      EastPools.CentralRoomBubbleFree, GrenadeJump, DoubleJump OR Glide  # grenade jump on the bubble, use the other ability to stall, repeat until at the top
      EastPools.CentralRoomBubbleFree, PauseHover  # Pause float spam is just barely enough stall to gain height. This is just as much fun as it sounds.
      SentryJump=2  # sjump to GrassSeed, sjump from GrassSeed
  conn WestPools.Teleporter:
    moki: Water, WaterBreath, WaterDash, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Water, WaterDash, DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Damage=20
    kii:
      WaterDash, Water, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      WaterDash, Damage=160, DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      WaterDash, Damage=180
    unsafe:
      WaterDash, Damage=120, DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      WaterDash, Damage=140
      Water, WaterBreath, Launch
      Water, WaterBreath, DoubleJump, GrenadeJump OR HammerJump  # With grenade jumps, start a grenade jump while in the water then use your doublejump
      Water, WaterBreath, DoubleJump, TripleJump, Damage=20
      Water, WaterBreath, SwordJump, Damage=20  # sword jump in the left munchers, walljump then sword jump+ uplash on the right wall
  conn EastPools.MissilePuzzle:
    moki, EastPools.CentralRoomPurpleWall: Water
    kii, EastPools.CentralRoomPurpleWall:
      Damage=180
      WaterDash, Damage=80
    unsafe, EastPools.CentralRoomPurpleWall:
      Damage=160
      WaterDash, Damage=60
  conn EastPools.LupoArea:
    kii, EastPools.CentralRoomPurpleWall, EastPools.LupoPurpleFloor: WaterDash, Damage=80
    unsafe, EastPools.CentralRoomPurpleWall, EastPools.LupoPurpleFloor: Damage=180

region UpperPools:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

# checkpoint at -1425, -4144

anchor UpperPools.KeystoneRoomEntrance at -1535, -4115:  # At the bottom entrance to the keystone room
  refill Checkpoint

  state UpperPools.KeystoneRoomBubbleFree:
    kii:
      Combat=SpinCrab, Bow=1 OR Grenade=1 OR Spear=1
      Bash, Bow=1 OR Grenade=1 OR Spear=1

  quest EastPools.GrassSeed:
    moki:
      Combat=SpinCrab OR Bash OR Launch
      DoubleJump, Dash
    gorlek: Dash OR Glide OR Damage=10
    kii: free

  pickup UpperPools.LowerKS:
    moki:
      Water, DoubleJump, Bash
      Water, WaterDash OR Launch
    gorlek: Water, Bash, Hammer
    kii:
      Damage=60, WaterDash
      Damage=120, Launch
      Damage=160, Bash, DoubleJump OR Sword OR Hammer OR Spear=1
      Bash, Water OR Damage=180  # wall jump on the left wall above the spikes
    unsafe:
      Water, DoubleJump, TripleJump, Damage=20
      Damage=120, DoubleJump, TripleJump
      Damage=40, WaterDash
      Damage=100, Launch
      Damage=140, Bash

  conn EastPools.CentralRoom:
    moki:
      Combat=SpinCrab OR Bash OR Launch
      DoubleJump, Dash
    gorlek: Dash OR Glide OR Damage=10
    kii: free
  conn UpperPools.KeystoneRoomBubbleSpawner:
    moki:
      Water OR Launch
      DoubleJump, Glide
    gorlek:
      Damage=20
      DoubleJump, TripleJump OR Dash OR Sword OR UpperPools.KeystoneRoomBubbleFree
      Dash, Glide OR Sword OR UpperPools.KeystoneRoomBubbleFree
      Bash, DoubleJump OR Dash OR Glide  # bashes interfere with weapons weirdly; it can easily happen in this scenario
    kii:
      Bash
      Sword  # pogo the crab
      DoubleJump, Hammer OR Shuriken=1 OR Sentry=2
      Dash, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Hammer OR Shuriken=1 OR Sentry=2
      Hammer, Sentry=2
      UpperPools.KeystoneRoomBubbleFree, Glide OR Sword OR Hammer OR Sentry=2
    unsafe:
      Dash OR GlideJump
      DoubleJump, Flash=1 OR Sentry=1
  conn UpperPools.KeystoneRoom:
    kii: Bash  # bash the crab
  conn WestPools.Teleporter:
    unsafe:  # Glitch the crushers so you don't need Water Breath
      Water, Launch
      Water, DoubleJump, GrenadeJump OR HammerJump  # With grenade jumps, start a grenade jump while in the water then use your doublejump
      Water, DoubleJump, TripleJump, Damage=20
      Water, SwordJump, Damage=20  # sword jump in the left munchers, walljump then sword jump+ uplash on the right wall
  conn WestPools.RightKwolokPlatform:
    unsafe: Water, ShurikenBreak=20, Damage=20, Damage=20, Damage=20  # https://youtu.be/MVD8IxJuysQ

anchor UpperPools.KeystoneRoomBubbleSpawner at -1566, -4115:  # Between the bubble spawner and the bounce pad
  refill Checkpoint

  state UpperPools.KeystoneRoomBubbleFree:
    moki: Water, WaterDash OR Bash
    kii:
      Grenade=1 OR Spear=1 OR Bow=1
      Shuriken=1, Water OR Damage=20
      Sentry=1, Water OR Damage=20
    # unsafe: ChargeBlaze=1

  pickup UpperPools.UpperLeftKS:  # connections using the bubble have to start from here, others use the higher anchor
    moki: UpperPools.KeystoneRoomBubbleFree, Flap, DoubleJump
    gorlek: UpperPools.KeystoneRoomBubbleFree, Flap, Dash OR Glide
    kii: UpperPools.KeystoneRoomBubbleFree, Flap, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: UpperPools.KeystoneRoomBubbleFree, Damage=20  # pretty cute
  pickup UpperPools.LowerKS:  # Dirty water only. Paths with clean water originate from UpperPools.KeystoneRoomEntrance
    kii:
      Damage=60, WaterDash
      Damage=120, Launch
      Damage=160, Bash, DoubleJump OR Sword OR Hammer OR Spear=1
      Damage=180, Bash  # wall jump on the left wall above the spikes
    unsafe:
      Damage=120, DoubleJump, TripleJump
      Damage=40, WaterDash
      Damage=100, Launch
      Damage=140, Bash

  conn UpperPools.KeystoneRoom:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1, Dash
    gorlek:
      Dash OR Glide
      Water, WaterDash, Bash  # use the missile
    kii:  # No dirty water path for the bash+torpedo path because using the crab from UpperPools.KeystoneRoomBubbleSpawner is just way less damage
      Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      UpperPools.KeystoneRoomBubbleFree, WaterDash, Flap, Water OR Damage=20
  conn UpperPools.BeforeKeystoneDoor:  # connections using the bubble have to start from here, others originate from UpperPools.KeystoneRoom
    gorlek, UpperPools.KeystoneRoomBubbleFree: Flap, DoubleJump, TripleJump  # guide the bubble to UpperPools.KeystoneRoom then jump on it
    unsafe, UpperPools.KeystoneRoomBubbleFree: Flap, SwordSJump=1
  conn UpperPools.RightBubbleSpamRoom:  # connections using the bubble have to start from here, others originate from BeforeKeystoneDoor
    moki, UpperPools.KeystoneRoomBubbleFree: Flap, DoubleJump, Dash, Grapple  # seems to be the intended strat
    gorlek, UpperPools.KeystoneRoomBubbleFree: Flap, Grapple, DoubleJump OR Dash
    unsafe, UpperPools.KeystoneRoomBubbleFree:
      Dash  # I'm so sorry
      Flap, Grapple, Sword OR Hammer OR Shuriken=3  # flap from the far left of the platform after the bouncepad so the bubble get slowed down by the ceiling
  conn UpperPools.KeystoneRoomEntrance:
    moki:  # with at least Double Jump it's easier to go over the top
      Water
      Dash, Glide
    gorlek:  # almost always easier to go over the top
      Damage=20, Bash OR Sword OR Hammer  # the enemy likes to get in the way
    kii:
      Damage=30
      Damage=20, Combat=SpinCrab
    unsafe: UpperPools.KeystoneRoomBubbleFree

anchor UpperPools.KeystoneRoom at -1540, -4095:  # Autosave below the two upper left keystones
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  pickup UpperPools.UpperLeftKS:
    moki:
      Bash, Grenade=1
      Launch
    gorlek:
      SentryJump=1
      DoubleJump, TripleJump, Hammer  # Can either reach the left or right wall; for the right wall you can even do it starting from a grounded upswing
      WaterDash, DoubleJump, TripleJump, Water OR Damage=20
    kii:
      DoubleJump, TripleJump, Sword OR Spear=1
      WaterDash, DoubleJump, Water, Dash OR Glide OR Sword OR Hammer OR Flash=1 OR Sentry=1
      WaterDash, DoubleJump, Damage=20, Dash OR Glide OR Sword OR Hammer OR Flash=1 OR Sentry=1
    unsafe:
      # DoubleJump, TripleJump, Flash=1 OR Sentry=1
      DoubleJump, TripleJump  # Small ledge on the ceiling to the left
      WaterDash, DoubleJump, Water OR Damage=20
  pickup UpperPools.UpperMidKS:  # the majority of paths will go through connections around the top
    gorlek:
      DoubleJump, WaterDash, Water OR Damage=20  # wdash to reach the right wall
      Bash, Grenade=1, DoubleJump
      Bash, Grenade=1, Dash, Damage=20
    kii:
      Bash, Grenade=1, Damage=20
      WaterDash, Water, Damage=20, Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # wdash+upslash/energy weapon to reach the right wall, wjump in the spikes to get the key
      WaterDash, Damage=40, Sword OR Hammer OR Spear=1 OR Flash=1 OR Sentry=1  # wdash+upslash/energy weapon to reach the right wall, wjump in the spikes to get the key
    unsafe:
      WaterDash, Damage=40  # wdash to the right wall
      WaterDash, Water, Damage=20  # wdash to the right wall
  pickup UpperPools.UpperRightKS:
    moki:
      Bash, Grenade=1, Water OR DoubleJump OR Dash OR Glide
      Grapple, DoubleJump OR Dash OR Glide
      Water, WaterDash, DoubleJump
      Launch
    gorlek:
      SentryJump=1
      Bash, Grenade=1, Sword OR Damage=20  # sword/damage boost to reach the platform below the pickup
      WaterDash, Water OR Damage=20
      Grapple, Sword
      Grapple, Hammer, Water OR Damage=20
      DoubleJump, TripleJump OR Sword OR Hammer OR Bash  # Bash the crab enemy
    kii:
      Bash, Grenade=1, Grenade=1 OR Hammer OR Shuriken=1 OR Flash=1  # also possile with sentry but that's redundant with a second grenade
      Grapple, Hammer OR Shuriken=2 OR Flash=2 OR Sentry=2
      DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # djump+energy weapon from where the crabs are
    unsafe: Grapple, Water OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=20  # grapple the plant to make it swing. When the plant is swinging at the left, grapple it with a good angle to grab the keystone

  conn UpperPools.KeystoneRoomEntrance: free
  conn UpperPools.KeystoneRoomBubbleSpawner: free
  conn UpperPools.BeforeKeystoneDoor:
    moki:
      Grapple, DoubleJump OR Dash OR Glide
      Water, Grapple, Bash, Grenade=1
      Bash, Grenade=1, Water, WaterDash
      Bash, Grenade=2, Water OR DoubleJump OR Dash OR Glide
      Bash, Grenade=3
      Launch
    gorlek:
      Grapple, Damage=20 OR Sword OR Water
      Grapple, Bash, Grenade=1
      DoubleJump, TripleJump, Dash  # wjump from UpperRightKS
      Bash, DoubleJump  # bash the crab enemy
      Bash, Grenade=1, WaterDash, Damage=20
      Bash, Grenade=2, Sword OR Damage=20
      SentryJump=1, Combat=Crab+SpinCrab, WaterDash, Water OR Damage=20
      SentryJump=1, Bash, WaterDash, Water OR Damage=20
      SwordSJump=2, Bash OR Damage=10
      HammerSJump=2, Bash, Water OR Dash OR Glide OR Damage=20
    kii:
      WaterDash, Bash, Water OR Damage=20  # bash the crab upward then jump and bash it again to reach the wooden platform or the door directly.
      Grapple, Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Grenade=1 OR Water OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Damage=20  # bash the crab upward then jump and bash it again to reach the wooden platform or the door directly. Possible with sentry as well but 1 grenade+1 sentry is redundant with 2 grenade
      DoubleJump, TripleJump, Hammer  # wjump from UpperRightKS
      DoubleJump, Sword # Pogo the crab. Have to jump from the small edge under the spikes to get enough height.
    unsafe:
      Bash, Grenade=1  # https://youtu.be/LJNUBDzZ_oU
      WaterDash, Damage=20, DoubleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Similar to the bashnade path
      WaterDash, Water, DoubleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Similar to the bashnade path
      Dash, Hammer, Bash

anchor UpperPools.BeforeKeystoneDoor at -1506, -4068:  # In front of the door blocking waterdash tree
  refill Checkpoint
  refill Health=1:
    moki: DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek: free

  state UpperPools.KeystoneDoor:
    moki: Keystone=4
  state UpperPools.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: Grapple
    gorlek: DoubleJump
    unsafe: Dash

  pickup UpperPools.UpperMidKS:
    moki: DoubleJump OR Dash OR Glide
    gorlek: Sword OR Hammer OR Damage=20
    kii:
      Bash, Grenade=1
      Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: free
  pickup UpperPools.UpperLeftKS:
    gorlek: DoubleJump, TripleJump
    kii: DoubleJump, Dash OR Glide OR Sword
    unsafe: DoubleJump, Hammer OR Flash=1 OR Sentry=1

  conn UpperPools.TreeRoomEntrance:
    moki: UpperPools.KeystoneDoor
  conn UpperPools.KeystoneRoom:
    moki: DoubleJump OR Dash OR Glide OR Grapple OR Launch
    gorlek: free
  conn UpperPools.RightBubbleSpamRoom:
    moki:
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      SwordSJump=1
      HammerSJump=1, DoubleJump OR Dash OR Glide OR Bash OR Damage=20
      Bash, Grenade=1, Dash OR Glide OR Sword
      Bash, Grenade=1, Hammer, Damage=20
      DoubleJump, TripleJump, Dash OR Glide  # you can come from the trial start and complete this path with just triple jump, the extra abilities allow alternatives to make it more likely that the player finds this path
    kii:
      Bash, Grenade=1, Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=40
      Bash, Grenade=1, Spear=1, Damage=20
      DoubleJump, TripleJump OR Dash  # From the trial's activation
    unsafe:
      Bash, Grenade=1  # Bash grenade to reach the slime, bash glide from it
      HammerSJump=1
      Grapple, UltraGrapple, Sword OR Hammer OR BlazeSwap=1 OR Sentry=1 OR SpearJump=1 OR Shuriken=1 OR DoubleJump OR Dash OR Bash OR Glide OR FlashSwap OR PauseHover  # Use the slime.
      GrenadeJump, Hammer OR BlazeSwap=1 OR SentrySwap=1 OR Shuriken=1 OR DoubleJump OR Dash OR FlashSwap OR Damage=20  # Grenade Wall Jump from under the spikes. Might be possible with very precise pause floats.
      HammerJump
      DoubleJump, Glide  # hardcore parkour

anchor UpperPools.TreeRoomEntrance at -1467, -4075:  # The ledge to the left of Waterdash tree
  refill Checkpoint

  state UpperPools.KeystoneDoor:
    moki: Keystone=4
  state UpperPools.TreeRoomLeftBubbleFree:
    unsafe: Bow=1 OR Grenade=1 OR Spear=1

  pickup UpperPools.RoofEX:  # only for paths using the bubble all the way
    unsafe: UpperPools.TreeRoomLeftBubbleFree, Dash

  conn UpperPools.BeforeKeystoneDoor:
    moki: UpperPools.KeystoneDoor
  conn UpperPools.TreeRoom:
    moki: Water OR DoubleJump OR Dash OR Glide
    gorlek: free
  conn UpperPools.AboveTree:  # paths using the bubbles originate from here
    moki, UpperPools.TreeRoomLeftBubbleFree:
      Flap, DoubleJump
      Launch
    gorlek, UpperPools.TreeRoomLeftBubbleFree:
      Flap, Dash
      Flap, Glide, Damage=20
      DoubleJump, TripleJump, Dash, Damage=20  # free the bubble, jump on it and tjump to the wall above the tree
    kii, UpperPools.TreeRoomLeftBubbleFree:
      Flap, Hammer
      Flap, Glide, Shuriken=1
      Bash, Grenade=1  # Throw a grenade and jump on the bubble to reach your grenade
      DoubleJump, TripleJump, Damage=20  # jump on the bubble and dboost in the spikes above
    unsafe, UpperPools.TreeRoomLeftBubbleFree:
      Flap  # https://youtu.be/qKgm-Cyus-g
      Dash  # https://youtu.be/rpaRDaJj8sY

anchor UpperPools.TreeRoom at -1429, -4081:  # At Waterdash tree
  state UpperPools.TreeRoomLeftBubbleFree:
    moki: Water, WaterDash
    kii:
      WaterDash, Damage=40
      Bow=1 OR Grenade=1 OR Spear=1
      Shuriken=1, Water OR Damage=20  # also possible with sentry but it can target the ennemy instead
    unsafe:
      Shuriken=1 OR Sentry=1 # tp before hitting the water
      WaterDash, Damage=20
  state UpperPools.TreeRoomRightBubbleFree:
    moki: Water, WaterDash
    kii:
      Bow=1 OR Grenade=1 OR Spear=1
      WaterDash, Damage=40
      Shuriken, Water OR Damage=20  # also possible with sentry but it usually target the fish instead
    unsafe:
      Shuriken=1 OR Sentry=1 # tp before hitting the water
      WaterDash, Damage=20
  state UpperPools.ButtonDoorAboveTree:
    moki: Water, WaterDash
    kii: WaterDash, Damage=80
    unsafe: WaterDash, Damage=40  # tp after pushing it

  pickup UpperPools.SwimDashTree: free
  pickup UpperPools.SwimDashCurrentEX:
    moki: Water, WaterDash
    kii: WaterDash, Damage=60
    unsafe: WaterDash, Damage=40

  conn UpperPools.AboveTree:  # paths using the bubbles originate from UpperPools.TreeRoomEntrance
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump, Dash, Damage=20  # bash grenade to reach the wall above the tree
      SentryJump=1, DoubleJump, TripleJump, Dash, Damage=20  # same path as above, replace bash grenade by sentry jump
      Launch  # use the small bubbles for a launch reset or use the wall above the tree
    kii: Bash, Grenade=1, DoubleJump, Damage=20, TripleJump OR Dash OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1  # bash grenade to reach the wall above the tree
  conn UpperPools.TreeRoomEntrance:
    moki:
      Launch
      Water, WaterDash
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
    gorlek:
      SwordSJump=1  # Weapon hover as well
      HammerSJump=1, DoubleJump OR Dash OR Glide
      Bash, Grenade=1
      WaterDash, Damage=20  # dboost in water
      UpperPools.TreeRoomLeftBubbleFree
    kii: DoubleJump, TripleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: DoubleJump, TripleJump
  conn UpperPools.DrainPuzzleEntrance:
    moki, UpperPools.ButtonDoorAboveTree:
      UpperPools.TreeRoomRightBubbleFree, Water, WaterDash, DoubleJump
      UpperPools.TreeRoomRightBubbleFree, Launch
    gorlek, UpperPools.ButtonDoorAboveTree:
      Launch
      UpperPools.TreeRoomRightBubbleFree, Water, WaterDash, Sword OR Hammer
      UpperPools.TreeRoomRightBubbleFree, Damage=20, WaterDash, DoubleJump OR Sword OR Hammer
      UpperPools.TreeRoomRightBubbleFree, Bash, Grenade=1, DoubleJump OR Sword OR Hammer
    kii, UpperPools.ButtonDoorAboveTree:
      Bash, Grenade=1, DoubleJump, TripleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1  # Sentry causes the enemy to explode
      UpperPools.TreeRoomRightBubbleFree  # let one bubble go out of the water, jump on the next one and use it to land on the first bubble
    unsafe, UpperPools.ButtonDoorAboveTree:
      HammerSJump=1
      Bash, Grenade=1, DoubleJump, Sentry=1

anchor UpperPools.AboveTree at -1450, -4053:  # Paths to simplify the xp pickup above swimdash tree
  pickup UpperPools.RoofEX:
    moki:
      Launch
      Water, WaterDash
      Bash, Grenade=1
    gorlek:
      Damage=20, WaterDash
      SentryJump=1
    kii:
      DoubleJump, Combat=CorruptSlug, TripleJump OR Dash OR Glide
      DoubleJump, TripleJump, Hammer OR Spear=1
    unsafe: DoubleJump, Combat=CorruptSlug, Sword

  conn UpperPools.TreeRoom: free
  conn UpperPools.TreeRoomEntrance:
    moki: DoubleJump OR Dash OR Glide
    gorlek: Sword OR Hammer
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1

anchor UpperPools.DrainPuzzleEntrance at -1386, -4062:  # At the right of the door opened by the water dash button in the tree room
  refill Checkpoint

  # Be careful because solving that puzzle room is a huuuge negative that has to be taken into account
  state UpperPools.UpperWaterDrained:
    moki:
      Water, WaterDash, Grapple, DoubleJump OR Dash
      Water, WaterDash, Launch, DoubleJump, Dash OR Glide
      Water, Launch, Grapple
    gorlek:
      Water, WaterDash, Grapple, Glide OR Sword OR Hammer
      Water, Grapple, DoubleJump, TripleJump
      Water, Launch, Damage=20, DoubleJump OR Dash OR Glide
      Water, WaterDash, Launch, DoubleJump OR Dash OR Sword OR Damage=20
    kii:
      Water, WaterDash, Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Water, Grapple, DoubleJump, Dash OR Hammer OR Spear=1  # with dash, land on the left platform after triggering the first anemone and dash+djump to the wall. Use Hammer/Spear to reach the wall from the water.
      Water, Launch, WaterDash OR Damage=20
      Damage=120, Grapple, DoubleJump, TripleJump OR Dash OR Hammer OR Spear=1
      Damage=140, Launch
      Damage=80, WaterDash, Launch
      Damage=80, WaterDash, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Water, Grapple, DoubleJump, Sentry=1
      Water, Launch, Dash
      Water, WaterDash, DoubleJump, TripleJump, Damage=40
      Water, DoubleJump, Sword, Damage=20
      Damage=100, Grapple, DoubleJump, TripleJump OR Dash OR Hammer OR Spear=1 OR Sentry=1
      Damage=100, Launch, Dash
      Damage=120, Launch
      Damage=60, WaterDash, Launch
      Damage=60, WaterDash, Grapple, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Damage=100, WaterDash, DoubleJump, TripleJump

  pickup UpperPools.WaterfallEC:  # have to solve with and without the water drained so it doesn't softlock
    moki:
      DoubleJump, Dash, Grapple
      Bash, Grenade=1, Grapple, Glide
      Launch
    gorlek:
      DoubleJump, Grapple, TripleJump OR Glide OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump
      Bash, Grenade=1, Grapple, Dash OR Sword
      SentryJump=1, Grapple, Dash OR Glide
      SwordSJump=1, Grapple
    kii:
      Grapple, DoubleJump
      Grapple, Dash, Sword OR Hammer
      Grapple, Hammer, Shuriken=1
      Bash, Grenade=1, Grapple  # Bash the slime after grappling the plant
    unsafe:
      # Grapple, Hammer, Sword  # use both upslashes in order to reach the wall
      Grapple, Hammer
      Grapple, Dash, Spear=1
      Bash, Grenade=2
      SwordSJump=1
      HammerSJump=1, HammerSJump=1 OR Grapple

  conn UpperPools.TreeRoom:
    moki: UpperPools.ButtonDoorAboveTree
  conn UpperPools.DrainPuzzleRight:  # have to solve with and without the water drained so it doesn't softlock
    moki:
      DoubleJump, Dash, Grapple
      Bash, Grenade=1, Grapple, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, Launch
      Launch, DoubleJump OR Dash OR Glide OR Grapple OR UpperPools.DrainRoomPurpleWall
      UpperPools.DrainRoomPurpleWall, DoubleJump, Dash OR Glide
    gorlek:
      DoubleJump, Grapple, TripleJump OR Glide OR Sword OR Hammer
      Bash, Grenade=1, Grapple, Sword OR Hammer
      Bash, Grenade=1, DoubleJump, Damage=20, TripleJump OR Dash OR Glide OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, TripleJump, Dash OR Glide OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, Dash, Glide OR Sword OR Hammer
      SentryJump=1, Grapple
      SentryJump=1, DoubleJump, TripleJump, Dash, Glide, Damage=20
      Launch
      UpperPools.DrainRoomPurpleWall, DoubleJump, TripleJump OR Sword OR Hammer
    kii:
      Grapple, DoubleJump
      Grapple, Dash, Sword OR Hammer
      Grapple, Bash, Grenade=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20
      Bash, Grenade=1, Damage=120
      Bash, Grenade=1, Dash, Damage=60
      Bash, Grenade=1, DoubleJump, Damage=20
      Bash, Grenade=1, DoubleJump, TripleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, DoubleJump, Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      UpperPools.DrainRoomPurpleWall, DoubleJump OR Dash
      UpperPools.DrainRoomPurpleWall, Sword, Hammer OR Spear=1 OR Shuriken=1
      UpperPools.DrainRoomPurpleWall, Hammer, Water OR UpperPools.UpperWaterDrained OR Damage=20:  # If the water is drained, you can walljump. Otherwise, you'll land in the water
        Shuriken=1 OR Flash=1 OR Sentry=1 OR Spear=1
      UpperPools.DrainRoomPurpleWall, Hammer, Shuriken=2 OR Flash=2 OR Sentry=2
    unsafe:
      Grapple, Hammer  # just need to upslash to be in range for grappling the plant
      Grapple, Bash, Grenade=1
      Bash, Grenade=1, DoubleJump, TripleJump OR Dash
      Bash, Grenade=1, Damage=80
      Bash, Grenade=2, Damage=20
      UpperPools.DrainRoomPurpleWall, Sword OR GlideJump
      UpperPools.DrainRoomPurpleWall, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1 OR Spear=1
      UpperPools.DrainRoomPurpleWall, UpperPools.UpperWaterDrained, Bash, Grenade=2  # micro ledge on the left of the muncher after the breakable wall
  conn UpperPools.DrainPuzzleExit:  # Make sure it's not redundant with going to UpperPools.DrainPuzzleRight first
    moki, UpperPools.UpperWaterDrained:
      UpperPools.DrainRoomPurpleWall, Dash, Glide
      UpperPools.DrainRoomPurpleWall, Water, Bash, Grenade=1  # Fall at the puddle at the end of the waterfall
    gorlek, UpperPools.UpperWaterDrained:
      Bash, Grenade=1, Grapple, Water OR Damage=20
      UpperPools.DrainRoomPurpleWall, DoubleJump OR Dash OR Glide OR Sword OR HammerSJump=1
    kii, UpperPools.UpperWaterDrained:
      UpperPools.DrainRoomPurpleWall, Hammer
      UpperPools.DrainRoomPurpleWall, Bash, Grenade=1, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=40
    unsafe, UpperPools.UpperWaterDrained:
      UpperPools.DrainRoomPurpleWall, Bash, Grenade=1, Damage=20

anchor UpperPools.DrainPuzzleRight at -1324, -4060:  # On the ground next to the energy cristal
  refill Energy=3:
    moki: BreakCrystal
  refill Health=1

  state UpperPools.DrainRoomPurpleWall:
    moki: Bash, Water, WaterDash OR Launch
    gorlek:
      Water, Bash
      UpperPools.UpperWaterDrained, Bash, Launch, Damage=20
    kii:
      Damage=100, Bash
      WaterDash, Damage=80, Bash
    unsafe: Water, Launch
  state UpperPools.UpperWaterDrained:
    gorlek: Water, Launch, UpperPools.DrainRoomPurpleWall  # Break the purple wall, do the right side then the left side
    kii: UpperPools.DrainRoomPurpleWall, WaterDash, Bash, Grenade=1, DoubleJump, Water OR Damage=60
    unsafe:
      UpperPools.DrainRoomPurpleWall, WaterDash, Bash, Grenade=1, Water, Sword OR Hammer OR Spear=1 OR GlideJump
      UpperPools.DrainRoomPurpleWall, WaterDash, Bash, Grenade=1, Damage=60, Sword OR Hammer OR Spear=1 OR GlideJump

  conn UpperPools.DrainPuzzleExit:
    moki, UpperPools.UpperWaterDrained: Water OR Glide OR DoubleJump OR Launch OR Dash
    gorlek: UpperPools.UpperWaterDrained
  conn UpperPools.DrainPuzzleEntrance:
    moki:
      Launch, Grapple OR UpperPools.DrainRoomPurpleWall
      Launch, DoubleJump, Dash OR Glide
      Launch, Dash, Glide
      Launch, Bash, Grenade=1
      Bash, Grenade=1, Grapple, Dash OR Glide OR DoubleJump
      Bash, Grenade=1, DoubleJump, Glide
      UpperPools.DrainRoomPurpleWall, DoubleJump, Dash
    gorlek:
      Launch, Glide OR Damage=20
      Launch, DoubleJump, Sword OR Hammer
      Launch, Dash, Sword OR Hammer
      Bash, Grenade=1, Damage=20, Glide OR DoubleJump OR Dash OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, TripleJump, Dash OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, Dash, Sword OR Hammer
      Bash, Grenade=1, Grapple, Sword OR Hammer
      UpperPools.DrainRoomPurpleWall, DoubleJump, TripleJump
      UpperPools.DrainRoomPurpleWall, Water OR UpperPools.UpperWaterDrained OR Damage=20:  # If the water is drained, you can walljump. Otherwise, you'll land in the water
        DoubleJump, Glide OR Sword OR Hammer
        Dash, Glide OR Sword
    kii:
      Launch, DoubleJump OR Dash OR Sword OR Hammer OR Sentry=3  # wall jump on the wall after the spikes
      Bash, Grenade=1, Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, DoubleJump, TripleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # with energy weapons, wall jump on the wall after the spikes
      UpperPools.DrainRoomPurpleWall, DoubleJump, Glide OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
      UpperPools.DrainRoomPurpleWall, Dash, Sword OR Hammer
      UpperPools.DrainRoomPurpleWall, Water OR UpperPools.UpperWaterDrained OR Damage=20:  # If the water is drained, you can walljump. Otherwise, you'll land in the water
        Glide, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Launch, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # wall jump from the wall above the energy cristal then launch, use you energy weapon and wall jump of the wall under the spikes
      Bash, Grenade=1, DoubleJump OR Dash OR GlideJump
      UpperPools.DrainRoomPurpleWall, DoubleJump, Spear=1 OR Flash=1 OR Sentry=1 # wall jump on the wall after the spikes

anchor UpperPools.DrainPuzzleExit at -1318, -4081:  # After solving the Drain Puzzle, on the ledge before dropping down
  refill Checkpoint

  # This is inside a rock, but you can just walk out of it so it's not a problem
  # Keep in mind that for all paths involving the puzzle room you have to consider both states of the water being drained or not

  state UpperPools.DrainRoomPurpleWall:  # Make sure it's not redundant with going to UpperPools.DrainPuzzleRight first
    moki: Bash, Water, WaterDash
    gorlek: Water, Bash
    kii:
      Damage=100, Bash
      WaterDash, Damage=80, Bash

  pickup EastPools.PurpleWallHC:
    moki, UpperPools.UpperWaterDrained:
      Water, Bash, Glide OR Launch
      Water, Bash, DoubleJump, Dash
    gorlek, UpperPools.UpperWaterDrained:
      Water, Bash, Dash OR Sword OR Grenade=1
      Water, Bash, DoubleJump, Hammer
    kii, UpperPools.UpperWaterDrained:
      Damage=60, Bash, Launch OR DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Grenade=1 OR Sentry=2  # Bash + damage to break the wall, the rest to reach the pickup
      Damage=60, Damage=60, Bash  # bash a torpedo to break the wall then bash glide another one to reach the pickup
      Water, Bash  # bash a torpedo to break the wall then bash glide another one to reach the pickup
    unsafe, UpperPools.UpperWaterDrained:  # You can manipulate the torpedo enemy in a way that it hits the purple wall without needing any skills
      Water, DoubleJump OR Dash OR Glide OR Bash OR Launch OR Sword OR Hammer OR Shuriken=2
      Damage=20, DoubleJump OR Dash OR Glide OR Launch OR Sword OR Hammer OR Shuriken=2
      Damage=20, Damage=20, Bash  # bash a torpedo to break the wall then bash glide another one to reach the pickup

  conn EastPools.AboveFishingPool: free
  conn UpperPools.DrainPuzzleRight:  # have to solve with and without the water drained so it doesn't softlock
    moki:
      Water, Launch
      Water, WaterDash, DoubleJump, Dash
    gorlek:
      UpperPools.UpperWaterDrained OR Water:
        Launch
        Bash, Grenade=1, DoubleJump
      Water, Bash, DoubleJump, WaterDash OR TripleJump OR Dash OR Glide OR Sword OR Hammer
    kii:
      Launch, UpperPools.UpperWaterDrained OR Water OR Damage=60
      Bash, Grenade=1, DoubleJump, UpperPools.UpperWaterDrained OR Water OR Damage=60
      Bash, DoubleJump, Water OR Damage=60  # Possible with only 40 damage but it also need to solve for before draining the water
      Bash, Grenade=1, Dash, UpperPools.UpperWaterDrained OR Water OR Damage=60
      Bash, WaterDash, Water OR Damage=60
  conn UpperPools.DrainPuzzleEntrance:  # Make sure it's not redundant with going to UpperPools.DrainPuzzleRight first
    gorlek:
      UpperPools.DrainRoomPurpleWall, Water OR UpperPools.UpperWaterDrained:  # If you haven't drained the water, you need clean water to avoid the damage
        Bash, Grenade=1, Dash, Glide OR Sword
    kii:
      UpperPools.DrainRoomPurpleWall, Water OR UpperPools.UpperWaterDrained:  # If the water is drained, you can walljump. Otherwise, you'll land in the water
        Bash, Grenade=1, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      UpperPools.DrainRoomPurpleWall, Damage=60, Damage=20, Bash, Grenade=1, Glide, Shuriken=1 OR Flash=1 OR Sentry=1

anchor UpperPools.RightBubbleSpamRoom at -1586, -4052:  # To the right of where all the bubbles rise
  refill Checkpoint

  state UpperPools.BubbleSpamLever:
    moki:
      Combat=Bee+Skeeto, DoubleJump, Dash OR Glide
      Bash, DoubleJump, Dash OR Glide
      Launch, DoubleJump OR Dash OR Glide
    gorlek:
      Launch OR Bash
      Combat=Bee+Skeeto, DoubleJump, TripleJump OR Sword OR Hammer OR Damage=20
    kii:
      Combat=Bee+Skeeto, DoubleJump OR Dash
    unsafe:
      Sword OR Hammer OR BlazeSwap=1 OR SentrySwap=1 OR Sentry=2 OR Shuriken=1 OR DoubleJump OR Dash OR Glide OR GrenadeJump OR FlashSwap OR PauseHover
      Grapple, UltraGrapple  # wait for the bee to go up and then grapple to it

  pickup UpperPools.FishPoolEX:
    moki: Water, Bash OR WaterDash OR Damage=10  # just in case someone's troubled by the fish
    gorlek: Water
    kii:
      Damage=40
      WaterDash, Damage=20
    unsafe:
      Damage=25  # dboost on a fish to avoid one water dboost
      Bash  # You can bash the fishes before entering the water
  pickup UpperPools.FishPoolOre:
    moki:
      DoubleJump, Bash, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek:
      SentryJump=1
      DoubleJump, Bash, TripleJump OR Sword
    kii:
      Bash  # Juggle the exploding enemy
    unsafe:
      DoubleJump, TripleJump, GlideJump OR PauseHover  # you can glide jump after bouncing on a bubble
      DoubleJump, GlideJump, PauseHover
      SentrySwap=2 OR BlazeSwap=2 OR FlashSwap
      GrenadeJump
      HammerJump  # extended hammer jump
      Dash  # walljump on the bubbles by dashing into them
  pickup UpperPools.RightBubblesEX:  # paths using the torpedo originate from LeftBubbleSpamRoom
    moki: Water, WaterDash
    kii: WaterDash, Damage=100
    unsafe:
      Grenade=1, Water OR Damage=80
      WaterDash, Damage=60
  pickup UpperPools.BubblesEC:
    moki: UpperPools.BubbleSpamLever, DoubleJump OR Dash OR Glide OR Launch
    gorlek: UpperPools.BubbleSpamLever

  conn UpperPools.BeforeKeystoneDoor: free
  conn UpperPools.LeftBubbleSpamRoom:
    moki: Water  # Don't actually need anything, Water is just in case you missed a bubble
    gorlek: free

anchor UpperPools.LeftBubbleSpamRoom at -1634, -4052:  # At the checkpoint on top of the torpedo
  refill Checkpoint

  pickup UpperPools.LeftBubblesEX:  # beautiful autosave placement right there
    moki: Water
    kii:
      Damage=140
      WaterDash, Damage=60
    unsafe:
      Damage=60
      WaterDash, Damage=40
  pickup UpperPools.RightBubblesEX:  # These paths use the torpedo to break the wall. Paths using another solution for the wall originate from UpperPools.RightBubbleSpamRoom
    moki: Water, Bash, WaterBreath, DoubleJump OR Launch
    gorlek: Water, Bash, Grenade=1 OR DoubleJump OR Launch
    kii:  # bait the torpedo into the wall. No dirty swim path because you can't afford to stay in the water
      Water, Launch
      Water, DoubleJump, TripleJump  # Climb the anemone wall once it's closed again
    unsafe:
      Water, Bash  # bait the torpedo, return to the checkpoint and jump from there to catch the torpedo and activating the anemone
      Bash, Damage=120, Damage=140, Launch OR SwordSJump=1  # bash the torpedo when it spawns then regen and use the bubbles to return safely to the other side
      Water, DoubleJump, Sword OR Hammer  # Climb the anemone wall once it's closed again

  conn UpperPools.RightBubbleSpamRoom:
    moki:
      Water, Bash, WaterBreath, DoubleJump OR Launch
      Water, Bash, WaterDash
    gorlek: Water, Bash, Grenade=1 OR DoubleJump OR Launch
    kii:
      Launch, Water OR Damage=80
      DoubleJump, TripleJump, Water OR Damage=80
      Water, WaterDash, DoubleJump, Sword OR Hammer OR Spear=1
      Damage=60, WaterDash, DoubleJump, Sword OR Hammer OR Spear=1
    unsafe:
      WaterDash, Sword, Water OR Damage=120  # Pogo the torpedo
      Water, Launch OR SwordSJump=1
      Damage=60, Launch OR SwordSJump=1

# checkpoint at -1386, -4062

region WestPools:
  moki: Danger=40, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WestPools.Teleporter at -1656, -4171:  # the west Pools TP
  refill Full

  state NonGladesTeleporter: free

  pickup WestPools.TpEX:
    moki:
      Water, WaterDash, DoubleJump, Dash  # hard on keyboard, but I guess this is intended, and no other ability would even help
      Launch
    gorlek:
      Water, WaterDash, DoubleJump, TripleJump
      Damage=20, WaterDash, DoubleJump, Dash OR TripleJump
    kii:  # note that only one wheel ability should be used since you can only use the 3rd ability
      Water, WaterDash, DoubleJump, Sword OR Hammer OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      Damage=20, WaterDash, DoubleJump, Sword OR Hammer OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1
      DoubleJump, TripleJump, Sword OR Hammer OR Sentry=1 OR Flash=1 OR Blaze=1 OR Spear=1 OR Shuriken=1  # jump from the right wall (no climbing it since it is too obscure)
    unsafe:
      Bash, Grenade=1  # Stand on the left of the TP, launch the grenade with a curve so it won't touch the ceiling and bash it when it falls down
      WaterDash, Dash, Hammer, Water OR Damage=20  # Already hard with analog swimming but it's a nightmare on keyboard
      DoubleJump, TripleJump OR Dash OR Sword OR Hammer  # wall jump from the right wall. With weapons, climb the right wall then djump+ upslash.
      Sentry=2 OR Blaze=2
  pickup WestPools.BurrowEX:
    moki: Water, Burrow
    kii: Damage=60, Burrow
  pickup WestPools.BurrowOre:  # intended path omitted in moki, as some players cannot reach this in time even with all skills
    gorlek: WestPools.ForestsStrength, Water, WaterDash, Burrow
    kii: WestPools.ForestsStrength, Damage=100, Damage=80, Damage=100, WaterDash, Burrow
    unsafe, WestPools.ForestsStrength:
      Water, Burrow
      Damage=80, Damage=60, Damage=80, WaterDash, Burrow

  conn Teleporters: free
  conn WestPools.LeftKwolokPlatform:  # WaterDash/Bash to deal with the fishes and crabs which spawns after you defeated Kwolok
    moki:
      Water, WaterBreath, WaterDash, DoubleJump OR Dash OR Launch
      Water, WaterBreath, Bash, DoubleJump OR Dash OR Launch
    gorlek:
      Water, WaterDash
      Water, Combat=SpinCrab, Bash OR Damage=3
    kii:
      Water, Bash
      Damage=100, WaterDash
      Damage=220, Bash  # 220 health if the mobs haven't spawned yet. Bashing them on your way will result in less damage
    unsafe:
      Water
      WestPools.ForestsStrength, Bash, Damage=160
      Damage=200, Burrow, Blaze=1, DoubleJump OR Launch
  conn EastPools.CentralRoom:
    moki: Water, WaterBreath, WaterDash
    gorlek: Water, WaterDash
    kii: Damage=160, WaterDash
    unsafe: Water, WaterBreath

anchor WestPools.LeftKwolokPlatform at -1668, -4127:  # Left side of the platform where the Kwolok's escape starts
  tprestriction:
    moki: WestPools.ForestsStrength
  refill Checkpoint:  # Checkpoint only appears after you defeated Kwolok
    moki: WestPools.ForestsStrength

  conn KwolokEscape: free  # Doesn't need any requirement since the enemies will only spawn after Kwolok is defeated
  conn WestPools.Teleporter:  # WaterDash/Bash to deal with the fishes and crabs which spawns after you defeated Kwolok
    moki: Water, WaterBreath, Bash OR WaterDash
    gorlek: Water, Bash OR WaterDash OR Damage=3
    kii:
      Damage=100, WaterDash
      Damage=220, Bash  # 220 health if the mobs haven't spawned yet. Bashing them on your way will result in less damage
    unsafe: Water
  conn WestPools.RightKwolokPlatform:
    moki: WestPools.ForestsStrength, Bash OR Launch OR Combat=Crab+SpinCrab
    gorlek: WestPools.ForestsStrength, DoubleJump OR Damage=10
    unsafe:
      WestPools.ForestsStrength
      #pass over the Kwolok's escape trigger
      Launch
      DoubleJump, HammerJump
      DoubleJump, TripleJump, Sword  # https://youtu.be/ZpMyu0vLan0

anchor WestPools.RightKwolokPlatform at -1637, -4127:  # Right side of the platform where the Kwolok's escape starts
  tprestriction:
    moki: WestPools.ForestsStrength
  refill Checkpoint:
    moki: WestPools.ForestsStrength  # Checkpoint only appears after you defeated Kwolok

  pickup WestPools.EscapeRevisitEX:
    moki: Water
    kii:
      Damage=140
      WaterDash, Damage=80
    unsafe:
      Damage=60
      WaterDash, Damage=20
  pickup UpperPools.LowerKS:  # Only dirty water paths. Solves through the UpperPools.KeystoneRoomEntrance connection with clean water
    kii: WaterDash, Damage=80

  conn KwolokEscape: free  # Doesn't need any requirement since the enemies will only spawn after Kwolok is defeated
  conn WestPools.LeftKwolokPlatform:
    moki: WestPools.ForestsStrength, Bash OR Launch OR Combat=Crab+SpinCrab
    gorlek: WestPools.ForestsStrength, DoubleJump OR Damage=10
    unsafe:
      WestPools.ForestsStrength
      #pass over the Kwolok's escape trigger
      Launch, Water OR DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=20  # Additional skill because the slow zone prevents you from jumping https://youtu.be/GxZYdw0JC7s
      DoubleJump, TripleJump, Dash, HammerJump
  conn UpperPools.KeystoneRoomEntrance:
    moki: Water, WaterBreath, WaterDash
    gorlek: Water, WaterDash
    kii: Damage=120, WaterDash
    unsafe:
      Damage=100, WaterDash
      Water, BreakWall=20, Shuriken OR Grenade OR Bow  # Also possible with Spear and Sentry but it will targets the ennemies which spawn after you defeated Kwolok first

anchor KwolokEscape at -1650, -4125:
  nospawn
  tprestriction:
    moki: WestPools.ForestsStrength  # Necessary so logic doesn't assume a Right/LeftKwolokPlatform->Escape->use teleporter
  refill Full

  conn KwolokFight:  # Abilities needed for the escape part
    moki:
      Water, WaterDash, Bash, DoubleJump, Dash OR Launch
      Water, WaterDash, Dash, Launch
    gorlek:
      Water, WaterDash, Dash, Bash
      Water, WaterDash, Launch
      Water, Launch, Dash, Bash
    kii:
      Launch, Water
      Launch, Bash, Damage=180  # Bash the fish at the end of the escape. You don't need to abuse bash iframes
      Launch, WaterDash, Damage=100
      Dash, WaterDash, Water OR Damage=120  # water dash to reach the wall at the start
    unsafe:
      Launch, Damage=160
      Dash, DoubleJump, TripleJump, Water OR Damage=160
      WaterDash, Bash, DoubleJump, Grenade=1, Water OR Damage=100

anchor KwolokFight at -1978, -4135:
  nospawn
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  quest WestPools.ForestsStrength:
    moki:
      SkipKwolok  # Impossible state used to logically support skipping Kwolok's fight through headers
      Boss=250, Regenerate, Damage=85, Water, WaterDash, Bash, DoubleJump, Launch OR Dash
    gorlek: Boss=250, Regenerate, Damage=85, Water, WaterDash, Bash, DoubleJump OR Launch OR Dash
    kii: Boss=250, Regenerate, Damage=85, Water, WaterDash, DoubleJump OR Launch OR Dash
    unsafe: Boss=250

region LowerWastes:
  moki: Danger=50, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor LowerWastes.WestTP at 1456, -3997:  # At the Western Wastes TP
  refill Full

  state NonGladesTeleporter: free

  pickup LowerWastes.WestTPOre:
    moki: Burrow
  pickup WoodsMain.FeedingGroundsEX:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow

  conn Teleporters: free
  conn LowerWastes.SunsetView:
    moki:
      DoubleJump, Grapple
      Bash, Grenade=1, DoubleJump OR Dash
      DoubleJump, Burrow
      Launch
    gorlek:
      Bash, Grenade=1, Damage=30
      DoubleJump, TripleJump
      Grapple, Dash  # done by jumping off the muncher
      Grapple, Sword, Damage=30
      SentryJump=1, Damage=30 OR DoubleJump OR Dash
      SwordSJump=2
      HammerSJump=2, Glide
    kii:
      DoubleJump, Hammer OR Sword  # djump+upslash to climb the wall
      Burrow, Dash OR Hammer OR Shuriken=2
      Burrow, Damage=30, Sword OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Burrow, Glide, Sword OR Flash=2 OR Sentry=2
      Burrow, Sword, Spear=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # upslash then energy weapon to pass over the spikes
      Grapple, Hammer
      Grapple, Sentry=2, Shuriken=1 OR Damage=30
      Grapple, Glide, Sword OR Shuriken=2 OR Flash=2 OR Sentry=2
      Grapple, Glide, Damage=30, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Grapple, Sword, Spear=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=30  # upslash then energy weapon to pass over the spikes
    unsafe:
      DoubleJump  # precise....? This is another rough path. Can turn it to triple jump to make it freeTM, or can add weapons
      Burrow, Damage=30  # This is a pretty rough path. Might be too tricky. Sticky makes it a bit easier though?
      Burrow, Sword OR Sentry=3 OR Shuriken=1
      Grapple, Glide, Spear=2 OR Blaze=2
      Grapple, Shuriken=3 OR Sentry=4
  conn WoodsMain.FeedingGrounds:
    moki: WindtornRuins.Seir, Burrow  # Seir to make it a safe path
    gorlek: Burrow
  conn WeepingRidge.Bottom:  # These paths need to be solvable after cat and mouse, since there is less platforms at that point and you can't pass above the teleporter
    moki, Burrow, WindtornRuins.Seir:  # Seir to make it a safe path
      DoubleJump, Glide, Grapple
      DoubleJump, Bash, Grenade=1, Grapple
      Launch
    gorlek, Burrow, WindtornRuins.Seir:  # these are paths that rely on the wind, which you don't have if you remove the killplane
      Grapple, Glide
      DoubleJump, TripleJump, Glide
      Bash, Grenade=1, Dash, Glide
    gorlek, Burrow, RemoveKillPlane OR WindtornRuins.Seir:  # these paths work no matter whether you actually have Seir or just removed the killplane
      Launch
      SentryJump=1, Grapple
      SentryJump=1, DoubleJump, TripleJump
      Bash, Grenade=1, Grapple
      Bash, Grenade=1, DoubleJump, TripleJump
      Bash, Grenade=2, Dash
    kii, Burrow, WindtornRuins.Seir:  # these are paths that rely on the wind, which you don't have if you remove the killplane
      Glide, Dash, DoubleJump, Sword OR Hammer
      Glide, DoubleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Bash, Grenade=1, DoubleJump
    kii, Burrow, RemoveKillPlane OR WindtornRuins.Seir:  # these paths work no matter whether you actually have Seir or just removed the killplane
      Bash, Grenade=1, Dash, DoubleJump, Sword OR Hammer
      Bash, Grenade=1, DoubleJump, Hammer, Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=2, DoubleJump
    unsafe, WindtornRuins.Seir:
      Burrow, DoubleJump, TripleJump  # deemed too precise
      Burrow, HammerSJump=1, DoubleJump, Dash, Hammer  # Pretty tight
      Burrow, SentryJump=2, DoubleJump, TripleJump OR Dash OR Glide  # moving SentryJump
      Burrow, SentryJump=2, Dash OR Glide  # moving SentryJump

# checkpoint at 1509, -3987

anchor LowerWastes.SunsetView at 1552, -3984:  # At the Sunset View checkpoint
  refill Checkpoint

  pickup LowerWastes.SunsetViewEX: free
  pickup LowerWastes.PurpleWallEX:
    moki: Burrow, Bash
    unsafe: Burrow  # didn't want to be mean
  pickup LowerWastes.SpiritTrial:
    moki: LowerWastes.TrialActivation, Burrow, DoubleJump, Dash, Grapple
    gorlek: LowerWastes.TrialActivation, Burrow, Dash, Grapple

  conn LowerWastes.WestTP:
    moki: DoubleJump OR Dash OR Glide OR Launch
    gorlek: Damage=30 OR Sword OR Hammer  # Multiple side slashes, not difficult
    kii:
      Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Grenade=1  # deemed too obscure
      Blaze=1  # This is a little tight
  conn LowerWastes.Shovel:
    moki:  # I think this is fine without Combat?
      Grapple, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, DoubleJump, Dash
      Launch  # Pretty free. Only difficulty is wall jumping pre-Launch to go over the grapples.
    gorlek:
      Grapple  # Hope that the camera likes you
      Bash, Grenade=1, DoubleJump
      SwordSJump=1, DoubleJump, Dash OR Glide OR Damage=30
      HammerSJump=1, DoubleJump
    kii:
      Bash, Grenade=1  # can either bash off the gorlek, then the grenade - or climb the wall to get additional height out of the bashgrenade
      Bash, DoubleJump  # Bash the gorlek's projectile
    unsafe:
      SentryJump=1  # sentry jumps are OP
      Bash  # bash the gorlek then its projectile
      GrenadeJump, DoubleJump

anchor LowerWastes.Shovel at 1635, -3981:  # On the ground to the left of the Sand Bridge
  refill Energy=3:
    moki, BreakCrystal:
      DoubleJump OR Launch
      Bash, Grenade=1
    kii: BreakCrystal

  quest LowerWastes.EerieGemQI:
    moki: Burrow

  pickup LowerWastes.SandBridgeOre: free

  conn LowerWastes.SunsetView:
    moki: Combat=MaceMiner OR Bash OR Grapple OR Launch
    gorlek: Glide
    kii: DoubleJump OR Dash
    unsafe: free
  conn LowerWastes.SkeetoHive:
    moki: Burrow
  conn LowerWastes.MuncherTunnel: free

anchor LowerWastes.MuncherTunnel at 1681, -4002:  # Above the sand/muncher tunnel
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  pickup LowerWastes.MuncherTunnelEC:
    moki: Burrow

  conn LowerWastes.Shovel:
    moki:
      DoubleJump OR Launch
      Bash, Grenade=1
    gorlek:
      Damage=30 OR Dash OR SentryJump=1
      Bash, Glide OR Sword OR Hammer  # lure the mantis
    kii: Bash OR Hammer OR Sword  # with sword, bait the mantis and pogo
  conn LowerWastes.SandPot:
    moki:
      Combat=Mantis+ShieldSlug
      Combat=Mantis, DoubleJump OR Burrow OR Hammer
      Bash, DoubleJump OR Burrow OR Grenade=1
      Launch
    gorlek: DoubleJump OR Dash OR Burrow OR Sword  # slash the enemy off the wall
    kii:
      Combat=ShieldSlug OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Bash  # use the mantis
    unsafe: Blaze=1

anchor LowerWastes.SandPot at 1726, -3990:  # To the left of the sand pot
  refill Checkpoint

  pickup LowerWastes.SandPotHC:
    moki:
      Burrow, DoubleJump
      Launch
    gorlek:
      Burrow  # mostly just hold left
      SentryJump=1
      DoubleJump, TripleJump OR Sword OR Hammer  # just something to help
    kii:
      DoubleJump
      Bash, Hammer OR Spear=1 OR Grenade=1  # Break the slime's shell in order to bash it
  pickup LowerWastes.SandPotEX:
    moki, Burrow:
      Dash, Grapple, DoubleJump OR Glide
      Bash, Grenade=1
      Launch
    gorlek, Burrow:
      DoubleJump, TripleJump  # either evade the coal damage or burrow on top of the sand pot
      Dash, DoubleJump OR Grapple
      Damage=30, DoubleJump
      Damage=30, Grapple, Glide OR Sword
      SentryJump=1
    kii, Burrow:
      DoubleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, Glide OR Blaze=3
    unsafe: Burrow

  conn LowerWastes.MuncherTunnel:
    moki: Combat=Mantis OR Bash OR Launch
    gorlek: free
  conn LowerWastes.WoodenBridge:
    moki:
      Dash, DoubleJump OR Grapple
      Dash, Bash, Grenade=1
      Bash, Grenade=2, DoubleJump OR Glide
      Bash, Grenade=1, Grapple, DoubleJump OR Glide
      Bash, Grenade=1, DoubleJump, Glide
      Launch
    gorlek:
      Burrow, DoubleJump, TripleJump  # either evade the coal damage or burrow on top of the sand pot
      DoubleJump, Damage=30, TripleJump OR Glide OR Sword OR Hammer  # take damage in the coals
      Grapple, Damage=30, DoubleJump OR Glide OR Sword OR Hammer
      Damage=30, Bash, Grenade=1, DoubleJump OR Sword OR Hammer
      SentryJump=1, Glide  # glide from the sand pot
      SwordSJump=1, Damage=30  # hover from the sand pot
      SentryJump=1, Grapple  # grapple from the sand pot, use the weapon to hover
      Bash, Grenade=1, Glide
      Bash, Grenade=1, Sword, Damage=30
      Bash, Grenade=1, Grapple, Sword OR Hammer OR Damage=30
      Bash, Grenade=2, Sword OR Hammer OR Damage=30
    kii:
      Sword
      Hammer, Glide OR Dash OR DoubleJump OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=30
      DoubleJump, TripleJump OR Grapple OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Damage=30
      Grapple, DoubleJump OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=30
      Bash, Grenade=1
      Bash, Hammer OR Spear=2  # break the slime's shell and bash it
      Dash, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Dash, Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Dash, Damage=30, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump, Spear=1
      Hammer, Spear=1
      Bash, Spear=1  # break the slime's shell and bash it
      Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=30
      Dash, Burrow  # burrow in the sand pot so you can dash into the ceiling to reset your dash
      Glide  # climb on the sand pot from the right then hover

anchor LowerWastes.WoodenBridge at 1796, -3977:  # Directly above MuncherPitEX
  refill Checkpoint

  pickup LowerWastes.SandPotEX:  # Make sure it's not redundant with paths doing WoodenBridge->SandPot->SandPotEX. Kii and above make going from one side of the pot to the other free so it doesn't need any paths
    moki, Burrow:
      Grapple, DoubleJump OR Glide
      Grapple, Bash, Grenade=1
      Bash, Grenade=1, DoubleJump, Dash OR Glide
    gorlek, Burrow:
      DoubleJump, Glide OR Sword OR Hammer OR Damage=30
      Grapple, Sword OR Hammer
  pickup LowerWastes.MuncherPitEX:
    moki:
      DoubleJump OR Launch  # Slightly precise to land on the sand sphere.
      Burrow, Glide
    gorlek: Burrow OR Hammer
    kii:
      Spear=1
      Glide, Shuriken=1 OR Flash=1 OR Sentry=1  # Could add Grapple so you can retry more easily or Damage=30 so the gliding section is less precise
      Glide, Sword, Grapple OR Damage=30  # Grapple or damage to make it less precise
    unsafe:
      Sword OR Flash=1 OR Sentry=1  # Make the sphere swing by wall jumping on it
      # Glide, Sword
      Dash  # Dash when falling

  conn LowerWastes.SandPot:
    moki:
      Grapple, DoubleJump OR Glide OR Dash
      DoubleJump, Dash
      Bash, Grenade=1, Grapple
      Bash, Grenade=1, DoubleJump, Glide
      Launch
    gorlek:
      Grapple, Glide OR Sword OR Hammer
      DoubleJump, TripleJump OR Glide
      Damage=30, DoubleJump OR Dash OR Glide  # extra abilities just for convenience
    kii:
      Damage=60
      Damage=30, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      Damage=30
      DoubleJump, Blaze=1
      # SentryJump=1, Damage=30  # Maybe too dumb. Gotta do a sentry jump in the spikes, and even then it can be close
  conn LowerWastes.LeverArea:
    moki: DoubleJump OR Burrow OR Launch
    gorlek:
      Dash OR SentryJump=1
      Bash, Grenade=1  # either find a place where you can throw a grenade or do the bash-only path
    kii:
      Sword OR Hammer  # With sword, pogo the gorlek
      Bash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Can add another use of energy weapons if the jump into the bridge feels too awkward
    unsafe: GlideJump
  conn LowerWastes.BeforeMinesEntrance:
    gorlek: ShurikenBreak=20, Combat=MaceMiner OR DoubleJump OR Bash OR Launch

anchor LowerWastes.BeforeMinesEntrance at 1849, -3986:  # To the right of the breakable wall leading to the Wooden Bridge
  pickup LowerWastes.BottomRightHC: free

  conn LowerWastes.MinesEntranceEnemyPaths:
    moki:
      Combat=MaceMiner+Mantis, DoubleJump OR Dash OR Glide OR Grapple
      Bash, DoubleJump OR Dash OR Glide OR Grapple
      Launch
    gorlek:
      Combat=MaceMiner+Mantis, Sword OR Hammer OR Damage=30
      Bash, Sword OR Hammer OR Damage=30
    kii:
      Combat=MaceMiner+Mantis, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Bash, Grenade=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump  # Jump over the enemies
    unsafe:
      Combat=MaceMiner+Mantis, Spear=1 OR Blaze=1
      Bash, Spear=1 OR Blaze=1
  conn LowerWastes.WoodenBridge:
    moki, BreakWall=20: Combat=MaceMiner OR Bash OR Launch
    gorlek, BreakWall=20: DoubleJump
    kii: BreakWall=20
  conn LowerWastes.LeverArea:  # make sure it's not redundant with BeforeMinesEntrance->WoodenBridge->LeverArea and that it still solves if the wall is broken
    gorlek:
      DoubleJump  # if the wall is broken, go through WoodenBridge
      Launch
    kii: Bash, Grenade=1  # if the wall is broken, go through WoodenBridge

anchor LowerWastes.MinesEntranceEnemyPaths at 1921, -4001:  # Enemy path counterpart for LowerWastes.MinesEntrance
  nospawn
  # these are exclusively non-redundant paths relying on the mantis enemy that despawns if you spawn on this anchor
  # since checkpoint-despawning enemies are generally not gorlek, paths are only kii and upwards

  pickup LowerWastes.BottomRightEX:  # Make sure it solves even after destroying the breakable wall
    kii: Bash  # Bash the gorlek to reach the mantis when it jumps
    unsafe: Combat=MaceMiner, Bash  # bash glide from the mantis

  conn LowerWastes.MinesEntrance: free  # connection to non-enemy reliant paths

anchor LowerWastes.MinesEntrance at 1921, -4001:  # To the left of the ruins breakable wall
  pickup LowerWastes.BottomRightEX:  # Make sure it solves even after destroying the breakable wall
    moki:
      Grapple, Combat=MaceMiner+Mantis OR Bash
      Bash, Grenade=1, DoubleJump OR Dash  # Very much not a mandatory grenade... This is only important if the Ruins Wall is broken, and then only if you don't use the enemies
      Launch
    gorlek:
      DoubleJump, TripleJump, Hammer
      SentryJump=1  # can either jump good or use the right wall and weapon float
      Bash, Grenade=1 OR DoubleJump OR Glide
      Bash, Dash OR Sword OR Hammer  # the Miner enemy here doesn't despawn, even if this is your spawn anchor
    kii:
      Grapple
      Sword, DoubleJump  # pogo (needed if the wall is broken)
      Combat=MaceMiner+Mantis, DoubleJump, TripleJump, Spear=1
    unsafe:
      DoubleJump, TripleJump  # https://youtu.be/tuMG8O-Mifc
  pickup LowerWastes.BottomRightHC:  # Make sure it's not redundant with conn LowerWastes.BeforeMinesEntrance
    moki:
      Grapple, Combat=MaceMiner+Mantis OR Bash  # Use both Grapple points
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch
    gorlek:
      Combat=MaceMiner+Mantis OR Bash:
        Damage=30, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      DoubleJump, TripleJump OR Dash OR Glide OR Sword  # Sword solves the Combat
      Bash, DoubleJump OR Dash OR Glide
      Grapple  # Grapple the wheel to avoid combat requirement.
    kii:
      Damage=40  # dboost in the spikes and the gorlek
      Damage=30, Combat=MaceMiner+Mantis OR Bash
      DoubleJump, Hammer OR Shuriken=1 OR Blaze=3 OR Sentry=2
      Bash, Sword OR Hammer OR Shuriken=1 OR Blaze=3 OR Sentry=2

  conn LowerWastes.BeforeMinesEntrance:  # Make sure it solves with and without the Ruins wall
    moki:
      Combat=MaceMiner+Mantis, DoubleJump, Grapple
      Bash, DoubleJump, Grapple
      Launch, DoubleJump OR Dash OR Grapple
    gorlek:
      SentryJump=1, DoubleJump, TripleJump, Dash OR Glide
      Bash, DoubleJump, TripleJump, Dash
      Grapple, Dash, Combat=MaceMiner+Mantis OR Bash  # Pretty straightforward. Rest of these paths you're able to avoid enemies so Combat isnt included.
      Launch
    kii:
      Grapple, Dash OR DoubleJump OR Sword OR Hammer
      Grapple, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump, TripleJump OR Dash  # Bash glide from the gorlek's projectile
    unsafe:
      Grapple, Glide, Spear=1
  conn WindtornRuins.LowerRuins:
    gorlek: ShurikenBreak=20, Burrow

anchor LowerWastes.LeverArea at 1833, -3959:  # At the arrow sign below the lever
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state LowerWastes.SandPlatformLever:
    moki:
      DoubleJump OR Burrow OR Launch  # Requires a vertical burrow through a vertical sand platform
      Bash, Grenade=2
      Bash, Grenade=1, Dash
    gorlek:
      Dash
      SentryJump=2
      SentryJump=1, Glide
      Bash, Grenade=1, Glide
    kii: Bash, Grenade=1
    unsafe: free  # wall jump on the right wall so you can jump on top of the first crumbling sand wall
      # Sword  # Pogo the energy crystal
      # Sentry=3

  conn LowerWastes.WoodenBridge: free
  conn LowerWastes.BeforeMinesEntrance: free
  conn LowerWastes.EastTP:
    moki: Burrow
  conn LowerWastes.MuncherClimb:
    moki:
      Bash, Grenade=1
      Launch
      LowerWastes.SandPlatformLever, DoubleJump, Dash OR Glide OR Burrow  # If the double jump is too tight this makes it free
      LowerWastes.SandPlatformLever, Dash, Burrow
    gorlek:
      SentryJump=1
      LowerWastes.SandPlatformLever, DoubleJump
      LowerWastes.SandPlatformLever, Burrow, Glide OR Sword
    unsafe:
      LowerWastes.SandPlatformLever, Dash
  conn LowerWastes.LastStandArea:  # Every solutions which needs to land on the left edge should originate from MuncherClimb
    moki: Bash, Grenade=1, DoubleJump
    gorlek:  # some amount of puzzle knowledge is assumed
      SentryJump=1, DoubleJump
      LowerWastes.SandPlatformLever:
        Burrow, Glide OR Sword
        Bash, Grenade=1, Glide OR Burrow OR Hammer
    kii:
      Bash, Grenade=1, LowerWastes.SandPlatformLever OR Hammer OR Spear=1
      LowerWastes.SandPlatformLever, Burrow, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Bash, Grenade=1  # Aggro the mantis with a bashnade then bash it when it jumps. Path isn't from MuncherClimb because the mantis doesn't spawn if you respawn at that checkpoint.
      SentryJump=1  # might have been gorlek
      LowerWastes.SandPlatformLever, Burrow  # burrow through the sand below to get a boost

anchor LowerWastes.MuncherClimb at 1791, -3953:  # Checkpoint before the munchers on the way to the tree
  refill Checkpoint

  pickup LowerWastes.MuncherClimbEX:
    moki: Grapple, Launch OR DoubleJump
    gorlek:
      Grapple, Dash
      Launch, DoubleJump, TripleJump
      Launch, Damage=30
    kii:
      Launch
      Grapple, Hammer OR Sentry=2  # With sentry, easier from a wall jump instead of jumping from the muncher
      Grapple, Sword, Shuriken=1 OR Flash=1 OR Sentry=1
      Grapple, Glide, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Grapple, Sword  # Upslash->Downslash to get the pickup
      Grapple, Glide, Spear=1 OR Blaze=1  # Jump from the wall
      DoubleJump, TripleJump, Damage=30  # really precise wall jump to avoid getting one more dboost

  conn LowerWastes.LeverArea: free
  conn LowerWastes.LastStandArea:  # Make sure it's not redundant with paths from LeverArea
    moki:
      Launch
      LowerWastes.SandPlatformLever, DoubleJump
    gorlek:
      DoubleJump, TripleJump
      LowerWastes.SandPlatformLever, Dash
    kii:
      DoubleJump
      LowerWastes.SandPlatformLever, Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Sentry=2  # With hammer, upslash before the sand platform
    unsafe:
      Hammer OR Spear=1
      LowerWastes.SandPlatformLever, Burrow  # Way harder on keyboard
  conn LowerWastes.SkeetoHive:
    moki:
      Grapple, DoubleJump OR Launch
      Grapple, Dash, Glide  # This path is fun. Glide is just to make it moki-safe
    gorlek:
      Grapple, Dash OR Glide
      Launch, DoubleJump, TripleJump  # Can do it with just double jump but the timing is tight
    kii:
      Grapple, Sword OR Sentry=3 OR Damage=90  # With sword, you have to delay a bit your sword hover after the last muncher or you'll target the sand platform
      Grapple, Damage=30, Hammer OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2
      Grapple, Hammer, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # energy between the 3rd and 4th muncher
      Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=30  # Possible with Spear=1 OR Blaze=1, but precise
    unsafe:
      Launch
      Grapple, Hammer OR Shuriken=2 OR Sentry=2 OR Damage=30  # There's friendly spikes on the ground between the 3rd and 4th muncher. Grab the 4th muncher from there.
      Grapple, Damage=30, Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Damage=30  # really precise wall jump to avoid getting one more dboost

anchor LowerWastes.LastStandArea at 1794, -3938:  # next to the projectile spawner above the wooden bridge
  pickup LowerWastes.LastStandShard:
    moki: DoubleJump OR Dash OR Burrow  # for the puzzle, it is considered solvable in moki with one of doublejump, dash or burrow.
    gorlek: Launch OR Glide  # some amount of puzzle knowledge is assumed
    kii: free  # just wall jump on the purple wall until the shot arrives
  pickup LowerWastes.LastStandEX:
    moki: Burrow, Launch OR DoubleJump
    gorlek:
      Burrow, Glide
      Burrow, Damage=30, Dash OR Sword
    kii: Burrow, Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=30
    unsafe: Burrow  # friendly spikes

  conn LowerWastes.LeverArea: free
  conn LowerWastes.MuncherClimb:  # Make sure it's not redundant with paths fromLeverArea
    moki: Glide OR DoubleJump OR Dash OR LowerWastes.SandPlatformLever
    gorlek: Sword OR Hammer
    kii: free

anchor LowerWastes.SkeetoHive at 1715, -3935:  # The ledge right of SkeetoHive on the way to the tree
  refill Checkpoint

  pickup LowerWastes.SkeetoHiveEX:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow

  conn LowerWastes.ThirstyGorlek:
    moki:
      DoubleJump OR Burrow OR Launch
      Bash, Grenade=2  # literally never going to get used but you can do it
    gorlek:
      SentryJump=2
      SentryJump=1, Bash OR Grapple
      Bash, Grapple OR Grenade=1
    kii:
      Bash
      Sword, Grapple  # Pogo a skeeto
    unsafe:
      Sword, Damage=30  # Pogo a skeeto, wait for another one to reach the sand bag level and pogo it as well
      Hammer, Damage=30  # wall jumping of the sand restore your upslash for some reason
  conn LowerWastes.Shovel:
    moki: Burrow
  conn LowerWastes.UpperPath:
    moki, Burrow:
      DoubleJump OR Launch
      Bash, Grenade=1  # literally never going to get used but you can do it
    gorlek, Burrow:
      Bash
      Grapple, Dash
      SentryJump=1
    kii, Burrow:
      Hammer OR Spear=1
      Sword  # pogo a skeeto. Skeeto can be kinda hard to manipulate, adding dash makes it easier if necessary. Also works with a upslash.
      Grapple, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Burrow  # "daulphin jump" from the ground to reach the floating sand platform
      # Burrow, Glide OR Dash OR Grapple
  conn LowerWastes.MuncherClimb:
    moki:
      Grapple, Launch
      Grapple, DoubleJump, Dash  # still sort of tight
    gorlek:
      Grapple, DoubleJump OR Dash
      Launch, DoubleJump OR Dash OR Glide OR Sword OR Damage=30
    kii:
      Launch  # Reset on the ceiling
      Bash, Damage=60, DoubleJump OR Dash  # bash glide a skeeto
      DoubleJump, Damage=30, Dash OR TripleJump OR Sword
      DoubleJump, Glide, Damage=30, Hammer OR Shuriken=1
      Bash, DoubleJump, TripleJump, Glide OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Grapple, Sword OR Hammer  # Land on the friendly spikes between the 1st and 2nd muncher. Upslash + grapple from there
      Grapple, Damage=30, Shuriken=2 OR Sentry=3
      Grapple, Damage=60, Shuriken=1 OR Sentry=2
      DoubleJump, Glide, Spear=1, Damage=30  # Use spear with the 2nd jump
      DoubleJump, GlideJump, Damage=30

anchor LowerWastes.ThirstyGorlek at 1681, -3923:  # next to the Gorlek on the way to the tree
  refill Checkpoint

  state LowerWastes.TrialActivation:  # Since you have to reach this place again in a race to get an advantage, only paths possible during a trial are meaningful
    moki: Burrow, DoubleJump OR Dash OR Glide

  quest LowerWastes.HandToHandMapstone:
    moki: GladesTown.HandToHandCanteen

  pickup LowerWastes.BurrowTree: free
  pickup LowerWastes.BurrowTreeEX:
    moki: Burrow
  pickup LowerWastes.LupoMap:
    moki, SpiritLight=150:
      Burrow OR Launch
      Bash, Grenade=2  # literally never going to get used but you can do it
    gorlek, SpiritLight=150:
      SentryJump=2
      DoubleJump, TripleJump, Hammer
    kii, SpiritLight=150:
      DoubleJump, Bash, Grenade=1  # Bash grenade from the floor directly to the wall
      DoubleJump, Spear=2, Hammer OR TripleJump
    unsafe, SpiritLight=150:
      DoubleJump, Sword, Spear=2
      DoubleJump, TripleJump, Sword OR Spear=1 OR Flash=1 OR Sentry=1  # land on the wood structure on the left of the sand bag. Make the sand bag swing to reach the wood structure with just tjump.
      SentryJump=1
      GrenadeJump

  conn LowerWastes.SkeetoHive:
    moki: Burrow
    kii: Launch, DoubleJump, TripleJump OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Launch, Spear=1  # Launch on the sand and reach the wall on the left with double jump to reset ; or spear jump from the ground
      DoubleJump  # Use a ceilingjump
      # DoubleJump, TripleJump, Sword OR Hammer  # upslash from the ground
      # Launch, DoubleJump, Blaze=1  # Not Kii because of the imputlock after blaze
      # Launch, DoubleJump  # Launch on the sand and reach the wall on the left with double jump to reset

anchor LowerWastes.UpperPath at 1761, -3898:  # on the left side of the path connecting tree and east teleporter
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  pickup LowerWastes.UpperPathEC:
    moki: Burrow
  pickup LowerWastes.UpperPathEX:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow, Sword OR Hammer OR Damage=30
    kii: Burrow  # you can reenter the sand right after taking the pickup or just tp out
  pickup LowerWastes.UpperPathHiddenEX:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    kii: Burrow, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # extra ability so you don't have to do the wall jump on the hidden wall
    unsafe: Burrow  # precise maneuver

  conn LowerWastes.SkeetoHive:
    moki: Burrow
  conn LowerWastes.EastTP:
    moki: Burrow

# checkpoint at no actually just bad refill situation below. Could be solved easily.

anchor LowerWastes.EastTP at 1992, -3902:  # Location of the east teleporter
  refill Full

  state NonGladesTeleporter: free

  pickup LowerWastes.EastTPOre:
    moki, BreakWall=20:
      Burrow OR Launch
      DoubleJump, Bash, Grenade=1
      Bash, Grenade=3  # it had to be done
    gorlek, BreakWall=20:
      DoubleJump OR SentryJump=1
      Bash, Grenade=1, Sword OR Hammer
    unsafe, BreakWall=20:
      Dash, Damage=60, Spear=1 OR Flash=1 OR Sentry=1
      Dash, Damage=30, Sword  # Damage boost on the left
      Dash, Hammer OR Spear=2  # Jump low from the wall on the right to avoid the ceiling, then upslash or spear
      # Dash, Damage=30, Hammer OR Spear=2  # Damage boost on the left
  pickup LowerWastes.UpperPathHC:
    moki: Burrow

  conn Teleporters: free
  conn Tokk:
    moki:
      DoubleJump OR Burrow OR Launch
      Bash, Grenade=1
    gorlek: Sword OR Hammer
    kii: Spear=1 OR Flash=1 OR Sentry=1
  conn LowerWastes.LeverArea:
    moki: Burrow
  conn LowerWastes.UpperPath:
    moki: Burrow, DoubleJump OR Dash OR Launch
    gorlek: Burrow, Glide OR Sword OR Hammer OR Damage=30
    kii: Burrow
  conn UpperWastes.KeystoneRoom:
    moki: Burrow, DoubleJump OR Dash OR Launch
    gorlek: Burrow, Glide OR Sword OR Damage=30
    kii: Burrow

region UpperWastes:
  moki: Danger=50, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor UpperWastes.KeystoneRoom at 1900, -3831:  # Autosave underneath keystone door
  refill Checkpoint

  state UpperWastes.KeystoneDoor:
    moki, Keystone=2:
      Burrow, Bash, DoubleJump OR Dash OR Glide
      Burrow, Combat=ShieldSlug, DoubleJump OR Dash OR Glide
      Launch
    gorlek, Keystone=2:
      Burrow, DoubleJump OR Dash OR Glide OR Sword OR Hammer  # can either avoid or deal with the shield slug
      SentryJump=2
      Bash, Grenade=1, Burrow  # could be moki with some Combat requirement, the jump to the wooden platform might be hard for Moki
    kii, Keystone=2:
      Burrow, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, DoubleJump, TripleJump, Hammer OR Spear=1  # Bash the gorlek's projectile to reach the sand bag. tjump + upslash/spear from here
    unsafe, Keystone=2:
      Burrow
      # Burrow, Bash  # Break the slug shell with gorlek's projectile
      DoubleJump, TripleJump, Sword OR Hammer OR Damage=30  # tjump+upslash from right wall, tjump+dboost from left wall
      Bash, DoubleJump, TripleJump  # bash the gorlek projectile then stupid wall jump you won't see how to do without debug renderer
      # Bash, DoubleJump, TripleJump, Sword  # tjump + upslash, too precise for Kii. Redundant
      Bash, SentryJump=1  # Remove the shell of the ShieldSlug and bash it twice to reach the pickup
      Bash, DoubleJump, SentryJump=1  # Bash the gorlek's projectile
      DoubleJump, TripleJump, Damage=30  # you can refresh your tjump on the ^ mark in the ceiling above the sandbag

  pickup UpperWastes.LowerKS:
    moki:
      Burrow, DoubleJump OR Dash OR Glide
      Launch, DoubleJump OR Dash OR Glide
    gorlek:
      Burrow OR Launch
      DoubleJump, TripleJump
    kii: Damage=30
    unsafe: free  # TP out after getting the pickup
  pickup UpperWastes.UpperKS:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow  # land on the right platform, burrow the sandbag from there
  pickup UpperWastes.TurmoilShard:
    moki, Burrow: Bash, Launch  # intended path omitted in moki
    gorlek, Burrow:
      Bash, DoubleJump, Dash OR TripleJump
      Launch, DoubleJump
      Launch, Damage=30, Dash OR Glide OR Sword OR Hammer
    kii, Burrow:
      Launch, Damage=30  # refresh launch on ceiling at the first turret
      DoubleJump, TripleJump, Damage=120
    unsafe, Burrow:
      Launch
      Bash, Dash OR DoubleJump
      DoubleJump, TripleJump, Damage=36  # dboost between 1st and 2nd turrets then precise wall jump and take a dboost on the projectile to reach the sand platform
      DoubleJump, Bash, SentryJump=1, Damage=30  # sjump in the spikes below the 3rd projectile
      DoubleJump, TripleJump, Dash, Damage=6, Hammer OR Sword  # tjump + upslash, immediatly dash and start air combo. Precise tjump to get a walljump, dboost on the projectile in order to walk in the spikes above.
  pickup UpperWastes.KSDoorEX:
    moki:
      Burrow, DoubleJump OR Dash OR Glide
      DoubleJump, Bash, Grenade=1
      Launch
    gorlek:
      Burrow, Sword OR Hammer
      Combat=ShieldSlug, Bash, Grenade=1
      SentryJump=1
    kii:
      Burrow, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1 OR Sword OR Hammer OR Spear=1  # either bash grenade or break the slug's shell in order to bash it
      Bash, DoubleJump, TripleJump  # Bash the gorlek's projectile
      DoubleJump, TripleJump, Damage=30
    unsafe:
      Bash  # Break slug's shell with a gorlek's projectile
      Burrow
      DoubleJump, TripleJump, Dash, Sword  # tjump+upslash+dash to climb the right wall
      SwordJump, TripleJump

  conn LowerWastes.EastTP:
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow, Sword OR Hammer OR Damage=30
    kii: Burrow
  conn UpperWastes.MissilePuzzleLeft:
    moki, UpperWastes.KeystoneDoor, Burrow:
      Bash, DoubleJump OR Dash OR Glide
      Combat=ShieldSlug, DoubleJump OR Dash OR Glide
      Launch
    gorlek, UpperWastes.KeystoneDoor, Burrow:
      DoubleJump OR Dash OR Glide OR Sword OR Hammer
      Bash, Grenade=1  # could be moki with some Combat requirement, the jump to the wooden platform might be hard for Moki
    kii, UpperWastes.KeystoneDoor, Burrow:
      Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe, UpperWastes.KeystoneDoor: Burrow

anchor UpperWastes.MissilePuzzleLeft at 1937, -3794:  # Immediately to the right of the sand after the keystone door
  refill Checkpoint

  state UpperWastes.KeystoneDoor:
    moki, Keystone=2: Burrow

  pickup UpperWastes.LedgeEC:
    moki:
      Burrow, Bash, DoubleJump OR Dash
      Launch
    gorlek:
      Burrow, Bash, Glide
      Bash, Grenade=1, DoubleJump
      Combat=MaceMiner, SentryJump=1, DoubleJump
    kii:
      Bash, Grenade=1  # use the miner as well
      DoubleJump, TripleJump, Sword  # tjump->pogo->tjump->upslash
      Burrow, Bash
      Burrow, DoubleJump, TripleJump, Hammer OR Spear=1
    unsafe:
      Burrow, DoubleJump, Sword  # pogo the torpedo
      SentryJump=1
      Bash, DoubleJump, TripleJump  # Lure the miner on higher ground to the left
  pickup UpperWastes.MissileSpawnEX:
    moki: Burrow
  pickup UpperWastes.KSDoorEX:
    moki: UpperWastes.KeystoneDoor, Burrow

  conn UpperWastes.KeystoneRoom:
    moki: UpperWastes.KeystoneDoor, Burrow
  conn UpperWastes.MissilePuzzleMiddle:
    moki: Burrow

anchor UpperWastes.MissilePuzzleMiddle at 2005, -3802:  # On top of the sand beneath the lever
  refill Checkpoint:
    gorlek: Burrow, Bash OR Damage=14
    unsafe: Burrow, Dash OR Launch

  state UpperWastes.LeverDoor:
    moki: Burrow, Bash
    gorlek: Burrow, Damage=14  # take the hit
    unsafe: Burrow, Dash OR Launch  # Dash/Launch to avoid the explosion.

  pickup UpperWastes.PurpleWallEX:
    moki: Combat=MaceMiner, Burrow, Bash
    gorlek: Combat=MaceMiner, Burrow, Dash OR Damage=14  # Dodge or tank the hit
    kii: Combat=MaceMiner, Burrow  # Jump to avoid the explosion
    unsafe: Burrow  # hug the right wall before impact

  conn UpperWastes.MissilePuzzleLeft:  # for better random spawn
    gorlek: Burrow, Bash
    kii: Burrow
  conn UpperWastes.MissilePuzzleRight:
    moki: UpperWastes.LeverDoor, Burrow

anchor UpperWastes.MissilePuzzleRight at 2058, -3813:  # On top of sand to the right of lever gate, underneath a laser.
  pickup UpperWastes.PurpleWallHC:
    moki: Burrow

  conn UpperWastes.SpinLasers:
    moki, Burrow:
      Bash, DoubleJump, Dash OR Glide  # dash or glide to make the lasers better
      DoubleJump, Dash  # you can retry the burrow with DoubleJump, so I think this is fine
      Launch
    gorlek, Burrow:
      Dash, Bash OR SentryJump=1 OR Damage=30  # Dash gets the player past the lasers pretty well; for sentryjump the tools to kill the slime are there
      Glide, DoubleJump OR Bash OR SentryJump=1 OR Damage=30  # same as above
      DoubleJump, TripleJump OR Dash OR Glide
    kii, Burrow:
      Dash OR DoubleJump OR Hammer OR Shuriken=2 OR Flash=2 OR Sentry=2 OR Damage=60
      Damage=30, Bash OR Glide OR Sword OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: Burrow
  conn UpperWastes.MissilePuzzleMiddle:  # for better random spawn
    moki: UpperWastes.LeverDoor, Burrow

anchor UpperWastes.SpinLasers at 2037, -3751:  # checkpoint before the laser spinner
  refill Checkpoint

  pickup UpperWastes.RoofEX:
    moki:
      DoubleJump, Bash, Grenade=1
      DoubleJump, Burrow, Dash OR Glide
      Launch
    gorlek:
      DoubleJump, Burrow, TripleJump OR Sword
      Bash, DoubleJump OR Dash  # Bash the Mantis
      Bash, Damage=30, Glide OR Sword OR Hammer  # Bash the Mantis
      SentryJump=1, DoubleJump OR Dash OR Damage=30  # Kill the Mantis
    kii:
      Bash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      DoubleJump, Burrow, Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Glide, Burrow, Hammer OR Shuriken=1
      Burrow, Sword, Hammer  # Drop from the wall, upswing with hammer, then hover with sword
    unsafe:
      Dash, Burrow
      Bash  # Bash the Mantis to reach the wall under the pickup, then get a weird boost on the wall after bashing the mantis a second time
      Burrow, Sword OR Shuriken=3
      # Burrow, Sword, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      SentryJump=1

  conn UpperWastes.MissilePuzzleRight:
    moki: Burrow, DoubleJump OR Launch
    gorlek, Burrow:
      SwordSJump=1
      HammerSJump=1, Dash OR Glide
      Dash, Damage=30
    kii, Burrow:
      Bash OR Glide OR Dash OR Hammer
      Sword, Shuriken=1
      Damage=60
      Damage=30, Sword OR Shuriken=1 OR Spear=1 OR Flash=1 OR Sentry=1 OR Blaze=1  # Extra skill for convenience
    unsafe: Burrow  # friendly spikes between the lasers
      # Burrow, Sword  # pogo the mantis
      # Burrow, Damage=10  # Damage boost of the Mantis shockwave rather than the spikes
  conn UpperWastes.RuinsApproach:  # this covers all connections to the pickups in the spinning lasers.
    moki: Burrow, DoubleJump OR Dash OR Glide OR Launch
    gorlek: Burrow

anchor UpperWastes.RuinsApproach at 2002, -3698:  # checkpoint after the laser spinner
  refill Checkpoint

  pickup UpperWastes.SpinLasersRightEX:
    moki: Burrow
  pickup UpperWastes.SpinLasersMiddleEX:
    moki: Burrow
  pickup UpperWastes.SpinLasersLowerEX:
    moki: Burrow

  conn UpperWastes.NorthTP:
    moki: Burrow
  conn UpperWastes.SpinLasers:
    moki: Burrow

anchor UpperWastes.NorthTP at 2044, -3679:  # Left of the teleporter, on top of the sand
  refill Full

  state NonGladesTeleporter: free

  quest UpperWastes.FlowersSeed:  # most paths here would be redundant with the connection upwards
    gorlek:
      Burrow, Bash, DoubleJump OR Dash
      Burrow, Bash, Dash, Grenade=1 OR SentryJump=1 OR Damage=30  # Dash wasn't considered gorlek to climb the last part up to ruins
      Burrow, DoubleJump, TripleJump, Damage=30, Dash OR SentryJump=1
      Burrow, SentryJump=1, DoubleJump, TripleJump, Dash
      Burrow, SentryJump=2, DoubleJump, TripleJump
      Launch, SentryJump=1  # weapon + launch allows you to kill the enemies
    kii:
      Bash, Grenade=1, DoubleJump, Glide OR Sword OR Sentry=2 OR Damage=30  # Use grenade on the left of the sandpot
      Bash, Grenade=2, DoubleJump
    unsafe:
      SentryJump=1, Damage=30, DoubleJump  # dboost in the spikes and sjump to the seed (use djump+upslash as well), sjump again to reach the lantern, djump on the sand ball, djump on the wall above and djump + use weapon to air stall to the pickup
      Bash, Grenade=1, DoubleJump, Shuriken=1

  pickup UpperWastes.WallOre:  # Most paths here would be redundant with the connection upwards. Paths to WallOre which can't reach the ruins not considered for moki/gorlek
    kii:
      # Use a bashnade to reach the sand bag above the sand pot. All the following paths are combination of different variations in order to optimize energy and health. Key parts are:
      # 1.a Take a dboost in the spikes on the way to the sand pot
      # 1.b Avoid the spikes on the way to the sand pot
      # 2.a Reach the bashable lantern, take a dboost in the spikes under the 2nd sand bag in order to reach it
      # 2.b Use a bashnade in order to land on the ledge above the sand bag and simply djump to the 2nd sand bag
      # Then Bashnade + djump to reach the ore
      Bash, Grenade=2, DoubleJump, Damage=30, Damage=30, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.a + 2.a
      Bash, Grenade=2, DoubleJump, Glide, Damage=30, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.b (with glide) + 2.a
      Bash, Grenade=2, DoubleJump, Sentry=3, Damage=30  # 1.b (2 sentries) + 2.a
      Bash, Grenade=3, DoubleJump, Damage=30  # 1.a + 2.b
      Bash, Grenade=3, DoubleJump, Glide OR Sentry=2  # 1.b + 2.b
      Bash, Grenade=4, DoubleJump  # 1.b (bashnade near the spikes) + 2.b

  conn UpperWastes.OutsideRuins:
    moki:
      Bash, Launch
      Burrow, Bash, DoubleJump, Dash OR Glide
      Burrow, Bash, Dash, Glide  # Slightly tight getting across to the sand pit but pretty easily doable. Semi precise angle on the burrow but with glide its easy to reattempt
      Burrow, Launch, DoubleJump OR Glide  # djump or glide lets you reattempt
    gorlek:
      Burrow, Bash, DoubleJump, TripleJump, Dash OR Sword
      Burrow, Bash, DoubleJump, Dash, Sword
      Burrow, Bash, DoubleJump, Grenade=1 OR SentryJump=1 OR Damage=30
      Burrow, Bash, Glide
      Bash, Grenade=1, DoubleJump, TripleJump, Dash OR Glide OR Sword OR Damage=30
      Bash, Grenade=2, DoubleJump, TripleJump
      Launch, DoubleJump, Combat=MaceMiner
      Launch, DoubleJump, TripleJump OR Dash  # go from the ledge above the teleporter
      Launch, Bash OR Burrow
    kii:
      Launch  # climb the left wall
      Burrow, DoubleJump, TripleJump, Damage=30
      Burrow, DoubleJump, TripleJump, Hammer, Glide OR Dash OR Sword OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      Burrow, Bash, DoubleJump, TripleJump OR Dash OR Glide OR Sword OR Hammer OR Sentry=2 OR Damage=30
      Burrow, Bash, Dash, Glide OR Sword OR Hammer OR Damage=30
      # Use a bashnade to reach the sand bag above the sand pot. All the following paths are combination of different variations in order to optimize energy and health. Key parts are:
      # 1.a Take a dboost in the spikes on the way to the sand pot
      # 1.b Avoid the spikes on the way to the sand pot
      # 2.a Reach the bashable lantern, take a dboost in the spikes under the 2nd sand bag in order to reach it
      # 2.b Use a bashnade in order to land on the ledge above the sand bag and simply djump to the 2nd sand bag
      # 3.a Reach the second lantern and reach OutsideRuins from there
      # 3.b Use a bashnade to land in the spikes above the sand bag and djump from there to OutsideRuins
      Bash, Grenade=1, DoubleJump, Burrow OR TripleJump OR Dash OR Hammer  # 1.b + 2.a (but you can avoid the dboost) + 3.a
      Bash, Grenade=1, DoubleJump, Damage=30, Damage=30, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2  # 1.a + 2.a + 3.a
      Bash, Grenade=1, DoubleJump, Glide, Damage=30, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2  # 1.b (with glide) + 2.a + 3.a
      Bash, Grenade=1, DoubleJump, Sword, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.b (with sword) + 2.a (energy to reach the lantern, avoid the dboost with an upslash) + 3.a (upslash to reach the lantern)
      Bash, Grenade=1, DoubleJump, Sentry=4, Damage=30  # 1.b (2 sentries) + 2.a + 3.a
      Bash, Grenade=2, DoubleJump, Damage=30, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.a + 2.b + 3.a
      Bash, Grenade=2, DoubleJump, Sword  # 1.b + 2.b + 3.a
      Bash, Grenade=2, DoubleJump, Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.b + 2.b + 3.a
      Bash, Grenade=2, DoubleJump, Sentry=3  # 1.b (2 sentries) + 2.b + 3.a
      Bash, Grenade=3, DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # 1.b (bashnade near the spikes) + 2.b + 3.a
      Bash, Grenade=3, DoubleJump, Damage=30, Damage=30  # 1.a + 2.b + 3.b
      Bash, Grenade=3, DoubleJump, Glide  # 1.b + 2.b + 3.b (but you can avoid the dboost with glide)
      Bash, Grenade=3, DoubleJump, Sentry=2, Damage=30  # 1.b (2 sentries) + 2.b + 3.b
      Bash, Grenade=4, DoubleJump, Damage=30  # 1.b (bashnade near the spikes) + 2.b + 3.b
    unsafe:
      Bash, Grenade=1, DoubleJump, Glide OR Sword OR Shuriken=1 OR Sentry=2 OR Damage=30
      Bash, Grenade=2, DoubleJump, Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      Bash, SentryJump=2, Damage=30, DoubleJump  # dboost in the spikes and sjump to the seed (use djump+upslash as well), sjump again to reach the lantern, djump on the sand ball, djump on the wall above and djump + use weapon to air stall to the pickup
      Bash, DoubleJump, TripleJump  # bash the mantis when it does its third jump
      Burrow, Bash, Sword OR Hammer  # Bash the gorlek when the Mantis is jumping above it. Bash it as well, air stall using weapons
      Burrow, Dash, Damage=30
      Burrow, DoubleJump, Dash, Damage=30
      Burrow, Bash, DoubleJump  # bash the lantern then a gorlek's projectile
      Burrow, DoubleJump, TripleJump, Hammer
  conn UpperWastes.RuinsApproach:
    moki: Burrow

anchor UpperWastes.OutsideRuins at 2014, -3609:  # Just outside the door
  refill Checkpoint

  quest UpperWastes.FlowersSeed: free

  pickup UpperWastes.WallOre:
    moki:
      Burrow, DoubleJump, Dash OR Glide
      Burrow, Dash, Glide
      Launch, DoubleJump OR Glide OR Burrow
    gorlek:
      Burrow, DoubleJump, Sword OR Hammer
      Burrow, Glide
      DoubleJump, TripleJump  # triple jump can spam climb the left wall
      DoubleJump, Glide
      Damage=30, Dash OR Glide OR Sword  # a suboptimal double jump gets stuck in the spikes
      Bash, Grenade=1, DoubleJump OR Dash OR Glide  # can either Bashglide or use the sand ball as ground
      SentryJump=1, Glide
      Launch
    kii:
      Bash, Grenade=1, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Burrow  # Use energy to reach the sand bag, then bashnade
      Bash, Grenade=2
      Burrow, DoubleJump OR Sentry=3
      Damage=30, DoubleJump

  conn WindtornRuins.UpperRuinsDoor:
    moki: EastHollow.ForestsVoice, LowerReach.ForestsMemory, UpperDepths.ForestsEyes, WestPools.ForestsStrength
  conn UpperWastes.NorthTP:
    moki: Burrow OR Launch OR Bash
    gorlek:
      Glide
      Combat=Mantis+MaceMiner, SentryJump=1
      Combat=Mantis+MaceMiner, DoubleJump, TripleJump
    kii:
      Sword OR Hammer OR Blaze=4 OR Sentry=2  # Drop from the seed platform
      DoubleJump, TripleJump OR Dash OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Combat=Mantis
      Dash, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # Just dash might be fit for kii tbh
    unsafe: free  # Precise wall jumping required. Lure the mantis onto the platform to get it out of the way.
  # Connecting to RuinsApproach would be redundant because it needs Burrow

region WindtornRuins:
  moki: Danger=50, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WindtornRuins.UpperRuinsDoor at 2163, -3835:  # Just inside the door.
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  state WindtornRuins.RuinsLever:
    moki: Burrow, BreakWall=6, BreakWall=6
    unsafe: Burrow, Sentry=2 OR Grenade=1 OR Blaze=1

  conn UpperWastes.OutsideRuins: free
  conn WindtornRuins.BrokenMural:
    moki, WindtornRuins.RuinsLever: Burrow

anchor WindtornRuins.BrokenMural at 2108, -3959:  # At the broken mural above the teleporter
  refill Checkpoint

  conn WindtornRuins.UpperRuinsDoor:
    moki, WindtornRuins.RuinsLever: Burrow
  conn WindtornRuins.FallenPillar: free
  conn WindtornRuins.RuinsTP:  # check for redundancies with FallenPillar
    gorlek:
      Burrow, DoubleJump OR Dash OR Glide OR Sword  # Just hold right. Or if you drop down, some can recover jumping from the right wall and burrowing through the sand platform
      WindtornRuins.HeartBarrier, Glide OR Dash
      WindtornRuins.HeartBarrier, DoubleJump, TripleJump OR Sword OR Hammer
    kii:
      WindtornRuins.HeartBarrier, Hammer OR Sword OR Sentry=2
      Burrow, Hammer
      Burrow, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # burrow the crumbing platform
    unsafe: Burrow  # at the pilar, hold up+right and burrow through the crumbing platform

anchor WindtornRuins.FallenPillar at 2090, -4012:  # After dropping down from the Broken Mural
  state WindtornRuins.HeartBarrier:
    # Most of these paths go to the teleporter and break the corruption heart. But they can't be used as connection to the teleporter anchor because after you broke the heart, you can't go to the teleporter again by using those paths.
    # While breaking the heart always teleport you near the teleporter afterwards (even when using Shuriken/Sentry breaks, which means you'll be able to teleport there whenever you want), the edgecase of using an header to break this corruption from the start makes those paths not viable as connections to the teleporter.
    moki, BreakWall=16:
      Burrow, DoubleJump OR Dash OR Glide OR Launch
      Burrow, Bash, Grenade=1
    gorlek: Burrow, BreakWall=16
    unsafe: ShurikenBreak=16 OR SentryBreak=16

  conn WindtornRuins.RuinsTP:  # this accounts for both situations of having broken the heart or not
    moki:
      Burrow, DoubleJump, Dash OR Glide
      Burrow, Bash, Grenade=1, Glide
      Launch, Burrow OR WindtornRuins.HeartBarrier
    gorlek:
      Burrow, Bash, Grenade=1, DoubleJump OR Dash OR Sword OR Hammer OR Damage=40
      Burrow, SentryJump=1
    kii:
      Burrow, Bash, Grenade=1
    unsafe: Burrow  # at the pilar, hold up+right and burrow through the crumbing platform
  conn WindtornRuins.Escape:  # this connection doesn't have to account for the gap in the floor because it only exists after you finished the escape
    moki: WindtornRuins.HeartBarrier
  conn WindtornRuins.LowerRuins:  # connection after the escape is finished
    # if you completed the escape, there's a gap in the floor that you have to cross, but Burrow alone is enough to do so
    # Since Burrow solves this connection, it accounts for all paths to the escape revisit pickup
    moki, WindtornRuins.HeartBarrier, WindtornRuins.Seir:
      DoubleJump OR Dash OR Glide OR Burrow OR Launch
      Bash, Grenade=1
    gorlek, WindtornRuins.HeartBarrier, WindtornRuins.Seir: Sword OR Hammer
    kii, WindtornRuins.HeartBarrier, WindtornRuins.Seir: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: WindtornRuins.HeartBarrier, WindtornRuins.Seir
  conn WindtornRuins.BrokenMural:
    # If the HeartBarrier is not broken, this connection is free, so it is sufficient to test these paths with the HeartBarrier broken
    moki, Burrow OR WindtornRuins.HeartBarrier:  # these account for both situations of having broken the heart or not
      Bash, Grenade=1, DoubleJump OR Dash
      Glide, DoubleJump OR Dash
      Launch
    gorlek, Burrow OR WindtornRuins.HeartBarrier:
      SentryJump=1
      Bash, Grenade=1

anchor WindtornRuins.RuinsTP at 2130, -3984:  # Windtorn Ruins teleporter.
  refill Full

  state WindtornRuins.HeartBarrier:  # Barrier next to the teleporter that stops you from getting the Heart.
    moki: BreakWall=16
  state NonGladesTeleporter: free

  conn Teleporters: free
  conn WindtornRuins.FallenPillar:
    moki: WindtornRuins.HeartBarrier OR Burrow
  conn WindtornRuins.BrokenMural:  # check for redundancies with FallenPillar
    # Each path which isn't including WindtornRuins.HeartBarrier is done with this state resolved and is burrowing through the crumbling platform. But since these are also possible with only Burrow before breaking the heart, you don't actually need WindtornRuins.HeartBarrier at all.
    moki, Burrow OR WindtornRuins.HeartBarrier:  # these account for both situations of having broken the heart or not
      Glide, DoubleJump OR Dash
    gorlek, Burrow OR WindtornRuins.HeartBarrier:
      Glide
      Sword, DoubleJump OR Dash
      DoubleJump, Dash, Hammer
    kii:
      WindtornRuins.HeartBarrier, DoubleJump, TripleJump OR Dash OR Hammer OR Blaze=4 OR Sentry=2
      WindtornRuins.HeartBarrier, Dash, Hammer OR Sentry=2
      WindtornRuins.HeartBarrier, Sword, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1 OR Hammer
      WindtornRuins.HeartBarrier, Hammer, Sentry=2
      Burrow, Sword  # jump on the left side of the crumbing platform and burrow it from underneath. You can slow yourself down with slashes
      Burrow, DoubleJump, TripleJump OR Dash OR Hammer OR Blaze=3 OR Sentry=2
      Burrow, Dash, Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # burrow the crumbing platform from the left side
      Burrow, Hammer, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      Burrow OR WindtornRuins.HeartBarrier:
        Sword, Spear=1 OR Blaze=1
      Burrow, DoubleJump  # right side of the crumbing platform, touch it just before burrowing into it so you get a lot more speed
      Burrow, Sentry=3
      Burrow, Hammer, Spear=1 OR Blaze=1

anchor WindtornRuins.Escape at 2021, -4026:
  nospawn
  refill Full

  # After you complete the escape, there's a gap in the floor to its right, making the location unreachable with skillsets
  # that would have reached it before completing the escape. That's why this has no outside connections; the paths to here
  # can softlock after achieving the EscapeComplete state, so this anchor is only safe as long as it does nothing else than handling that state.
  quest WindtornRuins.Seir:
    moki, WindtornRuins.HeartBarrier:
      Burrow, Dash, Grapple, DoubleJump OR Glide
      Burrow, DoubleJump, Glide, Grapple
      Burrow, DoubleJump, Launch, Dash OR Glide
      Burrow, Grapple, Launch, Glide
    gorlek, WindtornRuins.HeartBarrier:
      Burrow, Grapple, DoubleJump, Damage=40, Sword OR Hammer
      Burrow, Grapple, Dash, Damage=40, Sword OR Hammer
      Burrow, Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Damage=40
    kii, WindtornRuins.HeartBarrier:
      Burrow, Launch
      Burrow, Grapple, Glide OR DoubleJump OR Dash OR Sword OR Hammer
      Burrow, Grapple, Sentry=5 OR Shuriken=5  # Same path, different energy weapon
      Burrow, Grapple, Damage=30, Sentry=3 OR Shuriken=3  # Sentry=5 / Shuriken=5 path but saving 2 uses by dboosting in the section where you fall down
      Burrow, Grapple, Damage=70, Sentry=2 OR Shuriken=2  # Sentry=5 / Shuriken=5 path but saving the first 3 uses by dboosting
      Burrow, Dash, DoubleJump  # djump at the end of the second sandball+grapple section before dashing in order to avoid the spikes
    unsafe, WindtornRuins.HeartBarrier:
      Burrow, Dash, Hammer  # upslash at the end of the second sandball+grapple section before dashing in order to avoid the spikes
      Burrow, Grapple, Damage=10  # You are allowed to hate me if this is forced progression https://youtu.be/H3UIH4FyU4Q
      Burrow, Grapple, Blaze=5 OR Flash=5
      Burrow, Dash, Damage=40, Sentry=1 OR Flash=1
      Burrow, FlashSwap

anchor WindtornRuins.LowerRuins at 1969, -4024:  # At the ancient map pedestal
  # requires escape to be done
  quest WindtornRuins.HandToHandComplete:
    moki: LowerWastes.HandToHandMapstone

  pickup WindtornRuins.EscapeRevisitEC:
    moki: WindtornRuins.Seir, Burrow

  conn WindtornRuins.Escape: free  # walk over the invisible sandworm
  conn WindtornRuins.FallenPillar:
    moki, WindtornRuins.HeartBarrier, WindtornRuins.Seir:
      DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek, WindtornRuins.HeartBarrier, WindtornRuins.Seir:
      DoubleJump, TripleJump OR Sword
      SentryJump=1
    kii, WindtornRuins.HeartBarrier, WindtornRuins.Seir:
      DoubleJump, Burrow OR Hammer OR Spear=1 OR Sentry=1 OR Flash=1 OR Shuriken=1 OR Blaze=1
      Dash, Glide OR Sword OR Hammer OR Spear=1 OR Sentry=1 OR Flash=1 OR Shuriken=1 OR Blaze=1
    unsafe, WindtornRuins.HeartBarrier, WindtornRuins.Seir:
      Dash OR DoubleJump
  conn LowerWastes.MinesEntranceEnemyPaths:
    moki: Burrow, BreakWall=20

region WeepingRidge:
  moki: Danger=60, Regenerate
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WeepingRidge.Bottom at 1210, -3830:  # After crossing the portal to weeping ridge
  refill Checkpoint
  refill Health=1
  refill Energy=3:
    moki: BreakCrystal

  state WeepingRidge.ElevatorFightCompleted:
    moki, Combat=2xCrystalMiner+2xShieldCrystalMiner:
      DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek: Combat=2xCrystalMiner+2xShieldCrystalMiner, DoubleJump OR SentryJump=1
    kii:
      Combat=2xCrystalMiner+2xShieldCrystalMiner, Dash OR Hammer
      Combat=2xCrystalMiner+2xShieldCrystalMiner, Sword, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:
      Combat=2xCrystalMiner+2xShieldCrystalMiner, Sword  # upslash+downslash
      Combat=2xCrystalMiner+2xShieldCrystalMiner, Glide, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1

  conn WeepingRidge.LaunchArea:
    moki, WeepingRidge.ElevatorFightCompleted:
      DoubleJump, Dash OR Glide
      Bash, Grenade=1
      Launch
    gorlek, WeepingRidge.ElevatorFightCompleted: DoubleJump OR SentryJump=1
    kii, WeepingRidge.ElevatorFightCompleted:
      Dash OR Hammer
      Sword, Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe: WeepingRidge.ElevatorFightCompleted, Glide OR Sword
  conn LowerWastes.WestTP:  # covers connections into woods
    moki: WindtornRuins.Seir, Burrow  # Seir to make it a safe path
    gorlek: Burrow  # won't softlock if you did the cat and mouse because you'll have unlocked the teleporter

anchor WeepingRidge.LaunchArea at 1189, -3716:  # After the portal at the top of the elevator
  refill Checkpoint
  refill Health=1

  pickup WeepingRidge.Ore:
    moki: Launch, Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Launch, DoubleJump OR Dash OR Bash OR Glide
      Launch, Sword, Damage=20
    kii:  # launch path is redundant with AboveTree->Ore
      Bash, Dash
      Bash, DoubleJump, Damage=20, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # Damage is for weird laser patterns
      DoubleJump, TripleJump, Sword
    unsafe:
      SentryJump=2, DoubleJump, Bow=1, Damage=40
      SentryJump=2, DoubleJump, TripleJump OR Dash OR Glide  # Use weapon stall to reach the edge below the portal
      Bash, Glide  # wait on the left wall until the elemental gives you a shot to bash
      DoubleJump, TripleJump
      DoubleJump, Sword, Damage=40, Bow=1  # Reset your jump by slashing the elemental, pogo him to reach the wall above the portal, djump + upslash from under the Mine to reach the spikes
      Bash, DoubleJump

  conn WeepingRidge.AboveTree:
    moki:
      Glide
      Launch, Bash OR DoubleJump OR Dash
    gorlek:
      Launch, Bow=1
      Bash, Dash, Bow=1
      DoubleJump, Bow=1, Damage=40
      Bash, DoubleJump, TripleJump
      Bash, DoubleJump, Bow=1, Sword OR Hammer
      DoubleJump, TripleJump, Sword OR Hammer OR Dash
    kii:
      Launch
      Damage=40, DoubleJump OR Dash
      Bash, Dash
      Bash, DoubleJump, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1
      Sword, DoubleJump OR Dash  # Use sword on elemental to reset your djump/dash (don't use portal with dash)
      DoubleJump, Dash, Hammer OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
    unsafe:
      Damage=40, Sword OR Hammer
      Dash, Hammer OR DoubleJump  # Dash against the ceiling to refresh your dash
      Bash, DoubleJump, Blaze=1
  conn WillowsEnd.Entry:
    moki, WeepingRidge.ElevatorFightCompleted: Launch, DoubleJump, Dash OR Glide
    gorlek, WeepingRidge.ElevatorFightCompleted: Launch, DoubleJump OR Dash
    kii, WeepingRidge.ElevatorFightCompleted:
      Launch, Glide OR Sword OR Hammer OR Shuriken=2 OR Sentry=3
      Launch, Bash, Grenade=1
      Bash, Grenade=3, DoubleJump, TripleJump
    unsafe, WeepingRidge.ElevatorFightCompleted:
      Launch
      SentryJump=3, DoubleJump, TripleJump, Dash
      Bash, Grenade=3, DoubleJump
  conn WeepingRidge.Bottom:
    moki, WeepingRidge.ElevatorFightCompleted:
      Launch
      Bash, Grenade=1, DoubleJump
      DoubleJump, Dash, Glide
    gorlek, WeepingRidge.ElevatorFightCompleted:
      SwordSJump=1
      DoubleJump, TripleJump OR Dash OR Glide
    kii, WeepingRidge.ElevatorFightCompleted:
      Glide OR Dash OR DoubleJump
      Sword OR Hammer
      Sentry=5
      Bash, Grenade=2
    unsafe, WeepingRidge.ElevatorFightCompleted:
      Shuriken=3 OR Sentry=3

anchor WeepingRidge.AboveTree at 1344, -3791:  # The ledge above Launch tree
  refill Checkpoint

  pickup WeepingRidge.LaunchTree: free
  pickup WeepingRidge.PortalEX:
    moki: Launch
    unsafe:
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40  # take a dboost in the left spikes
      SwordSJump=2, Damage=40
      DoubleJump, TripleJump, Damage=40, Damage=80
  pickup WeepingRidge.SpikeClimbEX:
    moki: Launch, DoubleJump, Bow=2
    gorlek:
      Launch, Bow=1 OR Spear=1 OR Grenade=1 OR Damage=20
      Bash, Grenade=2, DoubleJump, TripleJump, Damage=40
      SentryJump=2, DoubleJump, TripleJump, Damage=40
    kii:
      Launch
      Bash, Grenade=2, DoubleJump, TripleJump
      Bash, Grenade=2, DoubleJump, Dash, Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1
    unsafe:  # may be inaccurate after moving paths to this anchor
      Bash, Grenade=3, DoubleJump
      SentryJump=3, DoubleJump, Bash OR Sword OR Damage=40
      SentryJump=2, DoubleJump, TripleJump, Dash  # Dash from the wall above the tree + tjump + weapon combo to reach the right platform
      DoubleJump, TripleJump, Sword, Dash OR Hammer OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # pogo the mine near the tree | wasn't consistent enough for kii
  pickup WeepingRidge.Ore:
    moki: Launch, DoubleJump OR Dash OR Bash OR Glide
    gorlek: Launch
    kii:
      Bash, Grenade=2, Damage=20, DoubleJump OR Dash  # Damage for wonky lasers
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=60  # 20 of the damage for wonky lasers
    unsafe:
      DoubleJump, TripleJump, Sword  # pogo the mines
      DoubleJump, TripleJump, Hammer, Damage=40
      Bash, Grenade=2, DoubleJump OR Dash
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40

  conn WeepingRidge.LaunchArea:
    moki: Launch, Bash, Glide  # Glide is the only ability that really helps you outwait the laser attack
    gorlek:
      Launch, Bash
      Launch, DoubleJump, Dash  # this gives you good mobility to avoid the enemies
    kii:
      Launch, DoubleJump OR Dash OR Damage=20  # dboost on the mine inbetween the two elementals
    unsafe:
      Launch
      DoubleJump, TripleJump, Sword, Damage=40
      Bash, Grenade=2, DoubleJump, TripleJump
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40

region WillowsEnd:
  moki: Danger=60, Regenerate  # need more than 6 health and Regen to do ANYTHING in willow
  gorlek: Regenerate
  kii: Regenerate
  unsafe: free

anchor WillowsEnd.Entry at 495, -3951:  # At the lower door
  refill Checkpoint
  refill Energy=4:
    moki:
      BreakCrystal, Launch
      Bow=1
  # a lot of energy crystals not considered, mostly because they are on the way to hearts which aren't currently tracked

  # the paths are kind of inaccurate because the platform above the door has no anchor of its own

  state WillowsEnd.GrappleWheelsHeart:
    unsafe: ShurikenBreak=30, Launch

  pickup WillowsEnd.EntryEX:  # Be carefull it's not redundant with Entry->BoulderHeartPath->EntryEX
    moki:
      DoubleJump, Bash, Grenade=2
      Launch
    gorlek:
      Bash, Grenade=2, Dash OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, TripleJump
      SentryJump=2, Damage=20  # Get hit by the offscreen mine
      SentryJump=1, DoubleJump, TripleJump
    kii:
      Bash, Grenade=2, Bow=1 OR Grenade=1  # kill the mine with either bow or grenade (bow is more energy efficient) and jump from the left wall to the right one
    unsafe:
      Bash, Grenade=2
      DoubleJump, TripleJump, Damage=20  # dboost an the mine so you can stand on the lava thingy and jump from it to the floating platform
      SwordJump, TripleJump, Dash  # land on floating platform otw to GrappleHeart then sword jumps + upslash->dash towards the floating platform at the entrance

  conn WillowsEnd.InnerTP:
    moki:
      Launch, Bash, DoubleJump OR Dash OR Glide  # mine in the way, but I think it's managable
      Launch, WillowsEnd.PortalShortcut
    gorlek:
      Launch, Bash, Sword OR Hammer OR Damage=40
      Bash, Grenade=2, DoubleJump, TripleJump, Damage=40 OR WillowsEnd.PortalShortcut  # Bash the elemental, tjump, bash its projectiles
      Bash, Grenade=3, DoubleJump, TripleJump
    kii:
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40, Glide OR Dash OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump, TripleJump, WillowsEnd.PortalShortcut, Glide OR Dash OR Sword OR Hammer
      Bash, Grenade=2, DoubleJump, TripleJump, Glide OR Dash OR Sword OR Hammer
      Launch, Sword OR Damage=40  # refresh your launch on the wall under Lupo. With sword, hit the elemental to refresh your launch. Dboost in the spikes otherwise
      Launch, Bash, Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      Launch, Bash, Spear=1  # Too precise for Kii, and can kill the elemental
      Bash, Grenade=1, DoubleJump, TripleJump, Grenade=1 OR Dash OR WillowsEnd.PortalShortcut OR Damage=40
      DoubleJump, TripleJump, Damage=20, WillowsEnd.PortalShortcut  # dboost on the mine so you can stand on the lava thingy and jump from it to the floating platform
      DoubleJump, TripleJump, Bash, Damage=20, Dash OR Grenade=1 OR Damage=40
  conn WillowsEnd.BoulderHeartPath:
    moki:
      Launch
      Bash, Grenade=1, DoubleJump
    gorlek:
      DoubleJump, TripleJump, Glide
      Bash, Grenade=1, Dash
      Bash, Grenade=1, Damage=40, Glide OR Sword
      SentryJump=1, DoubleJump  # float with the weapon
      SentryJump=1, Damage=40, Dash OR Glide  # float with the weapon if needed
    kii:
      Bash, Grenade=1
      DoubleJump, TripleJump, Dash  # Under the wheel
    unsafe: DoubleJump, TripleJump, Sword OR Hammer  # Under the wheel
  conn WillowsEnd.GrappleHeartMidPoint:
    moki: Grapple, Launch, DoubleJump OR Dash OR Glide
    gorlek: Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer
    kii:
      Launch, Grapple, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # use energy weapon before touching the wall before the first portal
      Launch, Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # same as above but one more energy weapon in order to touch the wall before the last wheel
      Bash, Grenade=2, DoubleJump, TripleJump, Grapple  # bashnade to reach the floating platform at the entrance, tjump to the second floating platform and bashnade towards the portals
      Bash, Grenade=1, DoubleJump, TripleJump, Grapple, Dash OR Glide OR Sword OR Hammer OR Shuriken=1 OR Flash=1  # same as above but condition instead of second bashnade. Possible with more energy weapons but these are the only which cost less energy than grenade
    unsafe:
      Launch
      Bash, Grenade=1, Glide, DoubleJump, TripleJump, Grapple, Damage=20  # land on the floating platform, glide, climb the wall after the first wheel to pass the laser without taking damage. At the wheel next to the chakpoint, wjump on the wall next to the laser. Take a damage boost in the double laser.
      SentryJump=1, Glide, DoubleJump, TripleJump, Grapple, Damage=20  # Same as above
  conn WillowsEnd.GrappleHeart:
    moki, WillowsEnd.GrappleWheelsHeart:
      Bash, Grenade=2, DoubleJump, Glide
      Launch
    gorlek, WillowsEnd.GrappleWheelsHeart:
      SwordSJump=2, DoubleJump  # weapon air stall (Hammer too hard for gorlek)
      Bash, Grenade=2, Sword, DoubleJump OR Dash
      Bash, Grenade=2, DoubleJump, Dash
      Bash, Grenade=3, DoubleJump OR Dash
    kii, WillowsEnd.GrappleWheelsHeart:
      Bash, Grenade=2, DoubleJump OR Dash OR Glide OR Sword OR Hammer OR Sentry=2
      Bash, Grenade=3  # bash glide
    unsafe, WillowsEnd.GrappleWheelsHeart:
      SwordSJump=2, Dash  # weapon air stall
      SentryJump=2, DoubleJump  # weapon air stall (compatible with hammer)
      SwordSJump=1, DoubleJump  # djump, pogo the mine, djump+upslash to reach the floating platform
      Sword, DoubleJump, Bash, Grenade=1  # djump, pogo the mine, djump+upslash to reach the floating platform
      SentryJump=1, DoubleJump, Damage=20  # use the iframes from the mine to use the lava thingy as a platform then djump+weapon combo to the left floating platform
      Bash, Grenade=1, DoubleJump, Damage=20, Sword OR Hammer  # use the iframes from the mine to use the lava thingy as a platform then djump+weapon combo to the left floating platform
  conn WeepingRidge.LaunchArea:  # Could be just the elevator state but adding more requirement in lower difficulties because not all lasers are visible at once
    gorlek, WeepingRidge.ElevatorFightCompleted:
      Glide OR Damage=20
    kii, WeepingRidge.ElevatorFightCompleted:  # land on top of the second laser
      Launch OR Dash OR Sword OR Hammer OR Blaze=4 OR Sentry=2
      DoubleJump, TripleJump OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe: WeepingRidge.ElevatorFightCompleted

anchor WillowsEnd.GrappleHeartMidPoint at 335, -3887:  # Checkpoint on the way to the lower left heart
  refill Checkpoint
  refill Health=1

  conn WillowsEnd.GrappleHeart:
    moki:
      Grapple, Launch, DoubleJump, Dash
      Grapple, Launch, Glide
    gorlek:
      Launch, Dash OR Glide
      Launch, DoubleJump, Sword OR Damage=40
      Launch, Sword, Damage=40
    kii:
      Launch, DoubleJump OR Sword OR Hammer OR Shuriken=1 OR Flash=1 OR Sentry=1 OR Damage=40
      DoubleJump, TripleJump, Glide, Damage=20  # wjump on the wall next to the laser. Take a damage boost in the double laser.
      DoubleJump, TripleJump, Damage=60, Dash OR Sword OR Hammer OR Shuriken=1 OR Blaze=3 OR Sentry=2  # dboost in the double laser (20) then in the spikes underneath (40)
      DoubleJump, TripleJump, Damage=100  # dboost in the spikes next to the double laser (40) + dboost in the spikes in between the double laser (40) + dboost in the last laser (20)
    unsafe:
      Launch
      DoubleJump, TripleJump, Damage=20, Sword OR Hammer OR Shuriken=1 OR Blaze=3 OR Sentry=2 # Land after dboost in the double laser, tjump to the wall next to the last portal
      DoubleJump, HammerJump  # https://youtu.be/nWob6QqkKpM
      DoubleJump, TripleJump OR Dash OR GrenadeJump  # https://youtu.be/DRJrr9v-6xg
  conn WillowsEnd.Entry:  # Be sure it's not redundant with going to WillowsEnd.GrappleHeart first
    kii:
      Launch, Glide
      Launch, DoubleJump, TripleJump  # tjump in more for stalling than for movement itself. Use it in order to await the end of lasers and slow yourself down
    unsafe:
      Launch
      DoubleJump, GrenadeJump
      DoubleJump, TripleJump, Dash  #https://youtu.be/kEzMDyc-G1k

anchor WillowsEnd.GrappleHeart at 399, -3928:  # right next to the grapple wheels heart
  refill Checkpoint
  refill Energy=3:
    moki:
      BreakCrystal, Launch
      Bow=1
    gorlek: SentryJump=1 OR Grenade=1
    kii:
      BreakCrystal, DoubleJump, TripleJump OR Dash
      Spear=1 OR Shuriken=1 OR Sentry=1
  refill Health=1

  state WillowsEnd.GrappleWheelsHeart:
    moki: BreakWall=30

  pickup WillowsEnd.PoisonfallHC:
    moki:
      Launch
      WillowsEnd.GrappleWheelsHeart, DoubleJump, Dash
    gorlek:
      DoubleJump, TripleJump
      DoubleJump, Dash, Damage=4
      WillowsEnd.GrappleWheelsHeart, DoubleJump OR Dash
      WillowsEnd.GrappleWheelsHeart, Bash, Grenade=1
    kii:
      DoubleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=4
      Bash, Grenade=1, DoubleJump OR Dash OR Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1  # bash grenade above the heart to avoid a dboost
      WillowsEnd.GrappleWheelsHeart, Sword OR Spear=2 OR Shuriken=2 OR Flash=2 OR Sentry=2
      WillowsEnd.GrappleWheelsHeart, Hammer, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
    unsafe:
      DoubleJump
      WillowsEnd.GrappleWheelsHeart, Blaze=1, Spear=1  # Blaze for the first jump, spear for the second. More energy efficient than 2 spears
      WillowsEnd.GrappleWheelsHeart, Hammer

  conn WillowsEnd.Entry:  # going backwards without breaking the heart has many weird spots, saving it for later difficulties
    moki, WillowsEnd.GrappleWheelsHeart:
      Glide, DoubleJump OR Dash
      Launch, DoubleJump OR Dash OR Glide
    gorlek, WillowsEnd.GrappleWheelsHeart:
      DoubleJump, TripleJump, Dash OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch, Sword OR Hammer
    kii, WillowsEnd.GrappleWheelsHeart:
      Launch
      DoubleJump, TripleJump, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Dash, DoubleJump OR Glide OR Sword OR Hammer OR Sentry=2
    unsafe, WillowsEnd.GrappleWheelsHeart:
      Glide  # Not hard but need to jump on the right lava thingy cycle without seeing them
      Bash, Grenade=1
      Dash, Damage=40  # Dash on the lava thingy and use it as an elevator

anchor WillowsEnd.BoulderHeartPath at 555, -3939:  # below the shortcut back from boulder heart
  refill Checkpoint
  refill Energy=3:
    moki: BreakCrystal

  # state WillowsEnd.BoulderHeart:
  #   moki: BreakWall=30, Launch, DoubleJump, Dash

  pickup WillowsEnd.SpikesOre:
    moki: Launch, Dash OR Glide
    gorlek:
      Launch, DoubleJump OR Sword OR Hammer OR Damage=40
      Grapple, DoubleJump, TripleJump, Dash OR Glide
      SentryJump=1, Damage=40, DoubleJump, TripleJump, Dash OR Glide  # damage because the maneuver is a bit tricky
      Bash, Grenade=1, Damage=40, DoubleJump, TripleJump, Dash OR Glide  # damage because the maneuver is a bit tricky
    kii:
      Launch # launch on the wall bellow the spikes in order to reach the second wheel
      Grapple, DoubleJump, Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=40  # condition in order to reach the portal then land on the ledge when you exit the portal and coyote dash->dash->djump
      Grapple, DoubleJump, TripleJump, Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # land on the ledge when exiting the portal
      Grapple, DoubleJump, TripleJump, Damage=40, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # same as above but land on the wheel to reach the portal
      Bash, Grenade=1, DoubleJump, Dash, Glide OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1 OR Damage=40  # condition in order to reach the portal then land on the ledge when you exit the portal and coyote dash->dash->djump
      Bash, Grenade=1, DoubleJump, TripleJump, Glide OR Dash OR Sword OR Hammer OR Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2  # land on the ledge when exiting the portal
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # same as above but land on the wheel to reach the portal
    unsafe:  # paths may not make sense after moving them from entry
      Bash, Grenade=1, DoubleJump, Dash, Damage=40  # dboost on the wheel to reach the portal
      Grapple, DoubleJump, TripleJump, Damage=40
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=40
      SentryJump=1, Grapple, DoubleJump, TripleJump OR Dash  # land on the small floor after the portal then tjump+upslash
      SwordSJump=1, Grapple, DoubleJump, Glide  # land on the small floor after the portal then tjump+upslash
      SentryJump=2, DoubleJump, TripleJump OR Dash  # land on the small floor after the portal then tjump+upslash
      SwordSJump=2, DoubleJump, Glide  # land on the small floor after the portal then tjump+upslash
      HammerSJump=3, DoubleJump, Glide  # land on the small floor after the portal then tjump+upslash
  pickup WillowsEnd.EntryEX:  # Make sure it's not redundant with paths from WillowsEnd.Entry
    gorlek:
      DoubleJump, TripleJump, Grapple, Glide  # use the right wheels then glide to the floating platform
      DoubleJump, TripleJump, Grapple, Dash, Sword OR Hammer  # use the right wheels then glide to the floating platform
    kii:
      DoubleJump, TripleJump, Glide, Damage=40  # dboost on the first wheel
      DoubleJump, TripleJump, Dash, Damage=40, Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # dboost on the first wheel
      Grapple, DoubleJump, TripleJump, Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2  # jump from the wall on the left and not the wheel directly
    unsafe:
      Grapple, DoubleJump, TripleJump, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1

  conn WillowsEnd.Entry:
    moki: DoubleJump OR Dash OR Launch
    gorlek:
      Glide OR Sword OR Hammer
      Bash, Grenade=2
    kii:
      Spear=2 OR Shuriken=2 OR Blaze=2 OR Flash=2 OR Sentry=2 OR Damage=80
      Damage=40, Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1
      Bash, Grenade=1, Damage=40
  conn WillowsEnd.InnerTP:
    kii:
      Grapple, DoubleJump, TripleJump, WillowsEnd.PortalShortcut, Glide OR Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
      Grapple, DoubleJump, TripleJump, Bash, Grenade=1, Glide OR Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
      Grapple, DoubleJump, TripleJump, Bash, Damage=40, Glide OR Dash OR Sword OR Hammer OR Shuriken=1 OR Sentry=2
    unsafe:
      Grapple, DoubleJump, TripleJump, WillowsEnd.PortalShortcut, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1
      Grapple, DoubleJump, TripleJump, Bash, Grenade=1, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1
      Grapple, DoubleJump, TripleJump, Bash, Damage=40, Spear=2 OR Blaze=2 OR Flash=1 OR Sentry=1
      Grapple, DoubleJump, TripleJump, Bash, Glide OR Dash OR Sword OR Hammer

anchor WillowsEnd.InnerTP at 422, -3864:  # The teleporter inside
  refill Full

  state NonGladesTeleporter: free
  state WillowsEnd.PortalShortcut:
    moki, BreakWall=20: DoubleJump OR Dash OR Launch OR Bow=1
    gorlek: BreakWall=20

  pickup WillowsEnd.LupoMap:
    moki: SpiritLight=50, DoubleJump OR Dash OR Launch OR Bow=1
    gorlek: SpiritLight=50  # jump to trigger the mine, back off to avoid taking damages

  conn Teleporters: free
  conn WillowsEnd.Entry:
    moki:
      WillowsEnd.PortalShortcut, DoubleJump OR Dash OR Launch OR Bow=1  # open the portal shortcut
      DoubleJump, Dash
      Glide OR Launch
    gorlek:  # No paths using Sword/Hammer because they solve PortalShortcut
      WillowsEnd.PortalShortcut  # jump to trigger the mine, back off to avoid taking damages
      Bash, Damage=40, DoubleJump OR Dash
      DoubleJump, TripleJump, Damage=40
    kii:
      Dash  # Reset dash on ceiling
      DoubleJump, TripleJump OR Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # touch the wall bellow Lupo
      Bash, DoubleJump OR Damage=40
    unsafe: Bash OR DoubleJump
  conn WillowsEnd.AboveInnerTP:
    moki:
      DoubleJump, Bash, Grenade=1, Dash OR Glide
      Launch, DoubleJump OR Dash
    gorlek:
      Launch, Glide OR Sword OR Hammer OR Damage=40
      Bash, Grenade=1, DoubleJump
      Bash, Grenade=1, BreakWall=20, Dash OR Glide OR Sword OR Hammer OR Damage=40
      Bash, Grenade=1, Dash, Damage=40
      SentryJump=1, Combat=CrystalMiner, DoubleJump, Dash OR Glide  # you can break the wall with the weapon
      SentryJump=1, Combat=CrystalMiner, Damage=40, DoubleJump OR Dash  # you can break the wall with the weapon
    kii:
      Launch  # wjump on the shortcut's breakable wall or launch from the the ground next to the portal if the barrier is broken
      Bash, Grenade=1  # wjump on the shortcut's breakable wall or bashnade from the ground next to the portal if the barrier is broken
    unsafe:
      SwordSJump=1, Damage=40
      #DoubleJump, TripleJump, Dash, Damage=40, Combat=CrystalMiner #I don't think this work anymore? # if the shortcut is open, tjump + dash in the spikes

anchor WillowsEnd.AboveInnerTP at 530, -3844:  # at the lava pit before bash puzzle
  refill Checkpoint
  refill Energy=4:
    moki:
      BreakCrystal, Launch
      Bow=1, Combat=CrystalMiner OR Bash
    kii:
      Spear=1 OR Grenade=1 OR Sentry=1
      Shuriken=1, DoubleJump OR Sword OR Hammer
      DoubleJump, Blaze=1, TripleJump OR Hammer

  conn WillowsEnd.InnerTP:
    moki: Combat=CrystalMiner OR Bash OR Launch
    gorlek: Damage=10  # Dboost on the gorlek.
    unsafe: free  # reload to despawn the gorlek
  conn WillowsEnd.East:
    moki:
      DoubleJump, Bash, Grenade=1, Dash OR Glide
      Launch, DoubleJump OR Dash
    gorlek:
      Launch, Glide OR Sword OR Hammer
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Bash, DoubleJump, TripleJump, Dash OR Glide OR Sword OR Hammer
      Bash, DoubleJump, Dash, Glide OR Sword OR Hammer
      Bash, DoubleJump, Glide, Damage=20, Sword OR Hammer  # weapon stall leaves you vulnerable to the projectiles
      Bash, SwordSJump=1, DoubleJump OR Dash
      Bash, HammerSJump=1, DoubleJump, Dash
      Bash, SentryJump=1, Glide
    kii:
      Launch  # Reset your launch on the walls
      Bash, Grenade=1
      Bash, DoubleJump OR Glide OR Sword OR Hammer # Bash glide from the gorlek to the elemental
      Bash, Dash, Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1
      DoubleJump, TripleJump, Sword, Dash OR Glide  # slash the element to reset your jumps, pogo it then tjump+upslash to reach the wall above it
    unsafe:
      Bash, Dash  # Bash glide from the gorlek to the elemental
      DoubleJump, TripleJump, Sword  # slash the element to reset your jumps, pogo it then tjump + up slash to reach the left wall
  # So far, connection towards RedirectHeartPath are handled by going to East first

anchor WillowsEnd.East at 547, -3805:  # To the left of the redirect puzzle
  conn WillowsEnd.AboveInnerTP:
    moki:
      Glide
      Bash, DoubleJump, Dash
      Launch, DoubleJump OR Dash OR Bash
    gorlek:
      Launch
      Bash, DoubleJump
      DoubleJump, Dash
      DoubleJump, TripleJump, Sword OR Hammer  # Sword/Hammer/Djump so don't need to add combat requirement
    unsafe:
      DoubleJump, Sword
      Dash, Bash OR Sword
  conn WillowsEnd.RedirectHeartPath:
    moki:
      Launch
      Bash, DoubleJump OR Dash OR Glide
    gorlek:
      Bash
      DoubleJump, TripleJump
    kii: Damage=20, Glide OR DoubleJump OR Dash OR Sword OR Hammer OR Spear=1 OR Shuriken=1 OR Blaze=2 OR Flash=1 OR Sentry=1  # dboost through the laser
    unsafe: DoubleJump
  conn WillowsEnd.Upper:
    moki: Bash, Launch  # some other paths would be possible, but with how far back the last checkpoint is...
    gorlek:
      Launch
      Bash, DoubleJump
    unsafe:
      Bash
      SwordSJump=1, DoubleJump, TripleJump, Damage=20  # sjump+ tjump to rech the right wall. dboost in the laser. tjump+ sword combo to reach the right wall. Pogo the elemental+tjump

anchor WillowsEnd.RedirectHeartPath at 584, -3814:  # on the edge near the energy refill on the way to the redirect heart
  refill Health=1
  refill Energy=4:  # these paths need to be able to return to the starting point
    # paths using energy or health AFTER grabbing the refill would be invalid here because they would misrepresent the resulting health or energy
    moki:
      BreakCrystal, Launch OR DoubleJump OR Glide
      Bow=1, Dash
    unsafe: BreakCrystal

  conn WillowsEnd.East:
    moki: Launch OR DoubleJump OR Dash OR Glide
    gorlek: Bash OR Sword OR Hammer
    kii: Spear=1 OR Shuriken=1 OR Blaze=1 OR Flash=1 OR Sentry=1  # to slow yourself down before entering the portal
    unsafe: PauseHover
  conn WillowsEnd.RedirectHeartPuzzle: free
  # most likely there will be non-redundant paths to WillowsEnd.AboveInnerTP here in the future, just right now there aren't any

anchor WillowsEnd.RedirectHeartPuzzle at 614, -3836:  # standing in front of the first portal used for the puzzle
  refill Checkpoint

  # state WillowsEnd.RedirectHeart:
  #   moki: BreakWall=10, BreakWall=30, DoubleJump, Bash, Launch

  pickup WillowsEnd.RedirectEX:
    moki:
      BreakWall=10, Bash, Launch, DoubleJump OR Dash OR Glide
      Bash, Grenade=1, Launch
    gorlek:
      Launch, DoubleJump OR Dash OR Glide OR Sword OR Hammer
      Glide, DoubleJump, TripleJump, Bash, Damage=20, Sword OR Hammer  # redirect the projectile so it pass under the pickup, dboost in the double lasser at the left so you can re-entre the top portal. Glide under the pickup then bash. Upslash can help if needed
    kii:
      Bash, Grenade=1, DoubleJump
      # redirect the projectile so it pass under the pickup
      Bash, DoubleJump, TripleJump, BreakWall=10, Glide OR Sword OR Damage=40
      Bash, DoubleJump, TripleJump, BreakWall=10, Dash, Hammer OR Sentry=2 OR Blaze=4
      Bash, Grenade=1, Glide, BreakWall=10 # use a second projectile so you can land on the edge above the double laser then throw a grenade and bash from the 1st projectile in order to reach your grenade
    unsafe:
      Launch
      Bash, Grenade=1, BreakWall=10, Damage=160

  conn WillowsEnd.RedirectHeartPath:
    moki:
      Bash, Grenade=1
      Launch
    gorlek:
      SentryJump=1
      DoubleJump, TripleJump, Damage=40
    kii: DoubleJump, Damage=40
    unsafe: DoubleJump, Sword  # pogo the mine

anchor WillowsEnd.Upper at 499, -3748:  # At the upper door
  refill Checkpoint
  refill Energy=4:  # on the way to burrow heart
    gorlek, BreakCrystal:
      Bash OR Launch
      Combat=CrystalMiner, SentryJump=1
      Combat=CrystalMiner, DoubleJump, TripleJump
    kii, BreakCrystal:
      DoubleJump, Sword OR Hammer
      Dash, Sword  # Pogo the gorlek
      Combat=CrystalMiner, DoubleJump, Spear=1 OR Shuriken=1 OR Flash=1 OR Sentry=1

  # state WillowsEnd.BurrowHeart:
  #   moki, BreakWall=30:
  #     Burrow, DoubleJump, Dash, Bash, Grapple, Glide
  #     Burrow, Bash, Grapple, Launch, DoubleJump OR Glide

  # conn MiniBossFight:
  #   moki:
  #     Launch, DoubleJump
  #     Launch, Dash, Glide
  conn WillowsEnd.East:
    moki:
      Combat=CrystalMiner, DoubleJump OR Dash OR Glide
      Bash OR Launch
    gorlek: Damage=10, DoubleJump OR Dash OR Glide
    kii: Combat=CrystalMiner, Sword OR Hammer OR Shuriken=1 OR Blaze=2 OR Sentry=2
  conn WillowsEnd.West:
    moki: Launch
    gorlek:
      Bash, Grenade=1, DoubleJump, TripleJump, Damage=20  # damage because the lasers are hard
      Bash, Grenade=2, DoubleJump, Damage=20
      SentryJump=1, DoubleJump, TripleJump, Damage=20
    kii:
      Damage=90, Combat=CrystalMiner
      Bash, Grenade=2
    unsafe:
      SwordJump, TripleJump  # From the left on the laser, sword jumps in order to reset your jump on a small wall then sword jumps+upslash to reach the portal
      DoubleJump, TripleJump, Dash  # Dash ramp from the left side + tjump in order to touch a small wall in the ceilling. Then tjump+dash toward the portal
      Damage=90  # That checkpoint box is really big so you don't have to bother with the CrystalMiner
  conn WillowsEnd.UpperHeartPath:
    moki:
      Bash, Grenade=1, DoubleJump, Bow=1
      Bash, Grenade=2, DoubleJump
      Launch
    gorlek:
      SentryJump=1, DoubleJump
      Bash, Grenade=1, DoubleJump
    kii: Bash, Grenade=1
    unsafe:
      SentryJump=1
      DoubleJump, TripleJump  # tjump on the left wall to start climbing it

anchor WillowsEnd.West at 437, -3840:  # To the left of the one-way above Lupo
  refill Checkpoint
  refill Energy=4:
    moki: BreakCrystal

  # state WillowsEnd.SpinLasersHeart:
  #   moki: BreakWall=30, Launch, DoubleJump OR Dash OR Glide

  conn WillowsEnd.InnerTP:
    moki: BreakWall=20, Combat=MaceMiner OR Bash OR Launch
  conn WillowsEnd.Upper:  # this works because the portal wheel drops if you step below
    moki, BreakWall=10:
      Bash, Grenade=1, DoubleJump OR Dash OR Glide
      Launch
    gorlek, BreakWall=10:
      Bash, DoubleJump, TripleJump
      Bash, Grenade=1, DoubleJump  # the portal here is glitchy in patch 3
      Bash, Grenade=2
      Bash, SentryJump=1, DoubleJump
      Bash, SentryJump=2
      SentryJump=1, DoubleJump, TripleJump
    kii, BreakWall=10:
      Bash, Grenade=1 OR Damage=40  # bashnade to avoid dboost on the falling wheel
      Bash, DoubleJump, Hammer  # djump+upslash to avoid dboost on the falling wheel
      DoubleJump, Sword  # Pogo the Crystal Miner then djump+upslash to avoid dboost on the falling wheel
    unsafe:
      BreakWall=10:
        Combat=MaceMiner, DoubleJump, TripleJump OR Damage=40  # get a wjump on the energy crystal
      SentryJump=2
      Launch
  conn WillowsEnd.GlideHeartPath:
    moki: Launch
    gorlek:
      DoubleJump, Dash, Glide
      Damage=20
    kii: free

anchor WillowsEnd.GlideHeartPath at 374, -3824:  # one room before the first wind
  refill Checkpoint
  refill Health=1

  conn WillowsEnd.GlideRooms:
    moki: DoubleJump, Launch
    gorlek:
      Launch
      DoubleJump, TripleJump
      Combat=Mantis, SentryJump=1, DoubleJump OR Damage=20
    kii: DoubleJump, Hammer # djump+upslash to land on the platform in the wheel
    unsafe: free  # https://youtu.be/rWO35ruudfw
      # Bash  # stun-lock the mantis by bashing it so it doesn't jump on the wheel
  conn WillowsEnd.West: free  # :D

anchor WillowsEnd.GlideRooms at 360, -3861:  # At the first wind
  refill Checkpoint
  refill Energy=4:
    moki:
      BreakCrystal, Launch OR Glide
      Bow=1
    kii: Spear=1 OR Shuriken=1 OR Grenade=1 OR Sentry=1

  # state WillowsEnd.GlideHeart:
  #   moki: BreakWall=30, DoubleJump, Glide, Launch

  pickup WillowsEnd.WindSpinOre:
    moki: Glide
    kii: Launch, DoubleJump, Damage=40, Damage=80  # dboost on the first wheel, dboost twice on the second one
    unsafe:
      Launch, DoubleJump, TripleJump OR Damage=40  # dboost on the 2nd wheel (close to its center), there is a small ledge on the 1st wheel to wait

  conn WillowsEnd.GlideHeartPath: free  # :D

# checkpoint at 315, -3862
# checkpoint at 487, -3780

# anchor LaserRockFight:
#   refill Full
#   state WillowsEnd.ElementalDefeated:
#     moki: Combat=smth

anchor WillowsEnd.UpperHeartPath at 506, -3711:  # Right above the exit blocked by vines
  refill Checkpoint
  refill Energy=4:
    moki:
      BreakCrystal, Launch
      Bow=1

  pickup WillowsEnd.UpperLeftEX:
    moki: Grapple, Launch, DoubleJump OR Dash OR Glide
    gorlek:
      Launch, Grapple
      Launch, DoubleJump, TripleJump
      WillowsEnd.SpinPortalsHeart, Launch, DoubleJump, Glide, Bash
    kii:
      Launch, Damage=80
      Launch, Damage=40, Bash OR Sword # bash/pogo the elemental, dboost in the spike bellow UpperLeftEX
      DoubleJump, TripleJump, Grapple, Damage=60  # dboost on the laser at the second room then dboost on the wheel next to the pickup
      WillowsEnd.SpinPortalsHeart, Launch, Bash  # bash the first elemental then bash one of its projectile in order to reach the 2nd elemental
    unsafe:
      Launch
      DoubleJump, TripleJump, Grapple, Bash  # using the last portal without taking damage is hard, bash glide from the elemental after that

  conn WillowsEnd.Upper: free
  conn WillowsEnd.UpperHeartCheckpoint:
    moki:
      Bash, Grapple, Launch, DoubleJump, Dash
      Bash, Grapple, Launch, Glide
    gorlek:
      Launch, Grapple, Bash
      Launch, DoubleJump, TripleJump, Damage=40, Grapple OR Bash OR Glide
      WillowsEnd.SpinPortalsHeart, Launch, Bash, DoubleJump
      WillowsEnd.SpinPortalsHeart, Launch, Bash, Grenade=1, Dash OR Glide OR Sword OR Hammer
      WillowsEnd.SpinPortalsHeart, Launch, DoubleJump, TripleJump
    kii:
      Launch, Damage=160  # one dboost at the first elemental, a second one under UpperLeftEX then two dboost on the way to the last portal
      Launch, Damage=120, DoubleJump OR Dash # one dboost at the first elemental, a second one under UpperLeftEX, another one before the last portal
      Launch, Damage=80:
        Glide  # one dboost at the first elemental, a second one under UpperLeftEX
        Grapple  # dboost twice in the spikes before the last portal
      Launch, Damage=40:
        Bash OR Sword  # dboost in the spikes bellow UpperLeftEX
        DoubleJump, Glide OR Dash  # dboost in the spikes bellow UpperLeftEX
      Launch, Grapple, Sword  # reset your launch by hitting elemental with your sword
      Launch, DoubleJump, TripleJump OR Sword
      DoubleJump, TripleJump, Grapple, Bash, Damage=100  # dboost on the laser before the 2nd wheel (20) then on spikes before the last portal (40). Since it's hard to avoid taking a dboost on the wheel when entering the portal under UpperLeftEX, adding an extra dboost (40)
      WillowsEnd.SpinPortalsHeart, Launch, DoubleJump OR Dash OR Sword OR Hammer
      WillowsEnd.SpinPortalsHeart, Bash, Grenade=1, DoubleJump
    unsafe:
      Launch, DoubleJump OR Damage=40
      DoubleJump, TripleJump, Grapple, Bash  # using the last portal without taking damage is hard
      WillowsEnd.SpinPortalsHeart, Bash, Grenade=1, Spear=1  # Grenade, then spear jump to bash it from higher

anchor WillowsEnd.UpperHeartCheckpoint at 514, -3638:  # Checkpoint next to the upper heart
  refill Checkpoint

  state WillowsEnd.SpinPortalsHeart:
    moki: BreakWall=30

  pickup WillowsEnd.UpperRightEX:
    moki: Launch
    kii:
      DoubleJump, TripleJump
      Bash, Grenade=1
    unsafe: DoubleJump
  pickup WillowsEnd.UpperLeftEX:  # So far, paths using WillowsEnd.SpinPortalsHeart are the same as going to UpperHeartPath first
    gorlek: Launch, DoubleJump, Glide, Bash
    kii: Launch, Bash

  conn WillowsEnd.UpperHeartPath:
    moki: WillowsEnd.SpinPortalsHeart
    # backward connection without this state has some weird spot, saving it for higher difficulties

anchor Tokk:  # Tokk's talks
  quest GladesTown.HandToHandPouch:
    moki: EastHollow.HandToHandMap

anchor TwillenShop:
  quest GladesTown.TwillenGemQuest:
    moki: LowerWastes.EerieGemQI

  pickup TwillenShop.Overcharge:
    moki: SpiritLight=1200
  pickup TwillenShop.Wingclip:
    moki: SpiritLight=1200
  pickup TwillenShop.Swap:
    moki: SpiritLight=1200
  pickup TwillenShop.Vitality:
    moki: SpiritLight=1200
  pickup TwillenShop.Energy:
    moki: SpiritLight=1200
  pickup TwillenShop.Finesse:
    moki: SpiritLight=1200
  pickup TwillenShop.TripleJump:
    moki: SpiritLight=1200
  pickup TwillenShop.LightHarvest:
    moki: SpiritLight=1200

anchor OpherShop:  # Opher's offers
  pickup OpherShop.Spike:
    moki: SpiritLight=1200
  pickup OpherShop.SpiritSmash:
    moki: SpiritLight=1200
  pickup OpherShop.SpiritStar:
    moki: SpiritLight=1200
  pickup OpherShop.Blaze:
    moki: SpiritLight=1200
  pickup OpherShop.Sentry:  # used for keystones if necessary; filtered by gen
    moki: SpiritLight=1200
  pickup OpherShop.Teleport:
    moki: SpiritLight=1200
  pickup OpherShop.ShockSmash:
    moki: SpiritLight=1200
  pickup OpherShop.StaticStar:
    moki: SpiritLight=1200
  pickup OpherShop.ExplodingSpike:
    moki: SpiritLight=1200
  pickup OpherShop.RapidSentry:
    moki: SpiritLight=1200
  pickup OpherShop.ChargeBlaze:
    moki: SpiritLight=1200
  pickup OpherShop.WaterBreath:
    moki: InnerWellspring.WaterEscape, SpiritLight=1200

anchor TuleyShop at -173, -4139:
  nospawn

  quest GladesTown.RegrowTheGlades:
    moki: TuleyShop.SelaFlowers, TuleyShop.StickyGrass, TuleyShop.Lightcatchers, TuleyShop.BlueMoon, TuleyShop.SpringPlants, TuleyShop.LastTree

  state TuleyShop.LastTreeBranchRejected:  # written out the steps in case they give pickups
    moki: WoodsEntry.LastTreeBranch
  state TuleyShop.SelaFlowers:
    moki: UpperWastes.FlowersSeed
  state TuleyShop.StickyGrass:
    moki: EastPools.GrassSeed
  state TuleyShop.Lightcatchers:
    moki: UpperDepths.LightcatcherSeed
  state TuleyShop.BlueMoon:
    moki: InnerWellspring.BlueMoonSeed
  state TuleyShop.SpringPlants:
    moki: UpperReach.SpringSeed
  state TuleyShop.LastTree:
    moki: WoodsEntry.TreeSeed
